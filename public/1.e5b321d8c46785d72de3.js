(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"3PW2":function(e,t,n){var i=n("8DpU"),o=n("ee4Z");e.exports=function(e,t,n,r,a){var s=this.pipeline,l=s._tempMatrix1,c=s._tempMatrix2,u=s._tempMatrix3;e.setPipeline(s),c.applyITRS(t.x,t.y,t.rotation,t.scaleX,t.scaleY),l.copyFrom(r.matrix),a?(l.multiplyWithOffset(a,-r.scrollX*t.scrollFactorX,-r.scrollY*t.scrollFactorY),c.e=t.x,c.f=t.y):(c.e-=r.scrollX*t.scrollFactorX,c.f-=r.scrollY*t.scrollFactorY),l.multiply(c,u);var h=t._displayOriginX,d=t._displayOriginY,p=r.alpha*t.alpha;t.isFilled&&i(s,u,t,p,h,d),t.isStroked&&o(s,t,p,h,d)}},"8DpU":function(e,t){var n=Phaser.Renderer.WebGL.Utils;e.exports=function(e,t,i,o,r,a){for(var s=n.getTintAppendFloatAlphaAndSwap(i.fillColor,i.fillAlpha*o),l=i.pathData,c=i.pathIndexes,u=0;u<c.length;u+=3){var h=2*c[u],d=2*c[u+1],p=2*c[u+2],f=l[h+0]-r,g=l[h+1]-a,m=l[d+0]-r,y=l[d+1]-a,b=l[p+0]-r,v=l[p+1]-a,w=t.getX(f,g),x=t.getY(f,g),C=t.getX(m,y),k=t.getY(m,y),T=t.getX(b,v),P=t.getY(b,v);e.setTexture2D(),e.batchTri(w,x,C,k,T,P,0,0,1,1,s,s,s,e.tintEffect)}}},KOM0:function(e,t,n){"use strict";function i(e,t,n){n=n||2;var i,s,l,c,u,p,g,m=t&&t.length,y=m?t[0]*n:e.length,b=o(e,0,y,n,!0),v=[];if(!b||b.next===b.prev)return v;if(m&&(b=function(e,t,n,i){var a,s,l,c=[];for(a=0,s=t.length;a<s;a++)(l=o(e,t[a]*i,a<s-1?t[a+1]*i:e.length,i,!1))===l.next&&(l.steiner=!0),c.push(f(l));for(c.sort(h),a=0;a<c.length;a++)d(c[a],n),n=r(n,n.next);return n}(e,t,b,n)),e.length>80*n){i=l=e[0],s=c=e[1];for(var w=n;w<y;w+=n)(u=e[w])<i&&(i=u),(p=e[w+1])<s&&(s=p),u>l&&(l=u),p>c&&(c=p);g=0!==(g=Math.max(l-i,c-s))?1/g:0}return a(b,v,n,i,s,g),v}function o(e,t,n,i,o){var r,a;if(o===P(e,t,n,i)>0)for(r=t;r<n;r+=i)a=C(r,e[r],e[r+1],a);else for(r=n-i;r>=t;r-=i)a=C(r,e[r],e[r+1],a);return a&&b(a,a.next)&&(k(a),a=a.next),a}function r(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!b(i,i.next)&&0!==y(i.prev,i,i.next))i=i.next;else{if(k(i),(i=t=i.prev)===i.next)break;n=!0}}while(n||i!==t);return t}function a(e,t,n,i,o,h,d){if(e){!d&&h&&function(e,t,n,i){var o=e;do{null===o.z&&(o.z=p(o.x,o.y,t,n,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var t,n,i,o,r,a,s,l,c=1;do{for(n=e,e=null,r=null,a=0;n;){for(a++,i=n,s=0,t=0;t<c&&(s++,i=i.nextZ);t++);for(l=c;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(o=n,n=n.nextZ,s--):(o=i,i=i.nextZ,l--),r?r.nextZ=o:e=o,o.prevZ=r,r=o;n=i}r.nextZ=null,c*=2}while(a>1)}(o)}(e,i,o,h);for(var f,g,m=e;e.prev!==e.next;)if(f=e.prev,g=e.next,h?l(e,i,o,h):s(e))t.push(f.i/n),t.push(e.i/n),t.push(g.i/n),k(e),e=g.next,m=g.next;else if((e=g)===m){d?1===d?a(e=c(e,t,n),t,n,i,o,h,2):2===d&&u(e,t,n,i,o,h):a(r(e),t,n,i,o,h,1);break}}}function s(e){var t=e.prev,n=e,i=e.next;if(y(t,n,i)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(g(t.x,t.y,n.x,n.y,i.x,i.y,o.x,o.y)&&y(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function l(e,t,n,i){var o=e.prev,r=e,a=e.next;if(y(o,r,a)>=0)return!1;for(var s=o.x>r.x?o.x>a.x?o.x:a.x:r.x>a.x?r.x:a.x,l=o.y>r.y?o.y>a.y?o.y:a.y:r.y>a.y?r.y:a.y,c=p(o.x<r.x?o.x<a.x?o.x:a.x:r.x<a.x?r.x:a.x,o.y<r.y?o.y<a.y?o.y:a.y:r.y<a.y?r.y:a.y,t,n,i),u=p(s,l,t,n,i),h=e.prevZ,d=e.nextZ;h&&h.z>=c&&d&&d.z<=u;){if(h!==e.prev&&h!==e.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,h.x,h.y)&&y(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,d!==e.prev&&d!==e.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;h&&h.z>=c;){if(h!==e.prev&&h!==e.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,h.x,h.y)&&y(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;d&&d.z<=u;){if(d!==e.prev&&d!==e.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function c(e,t,n){var i=e;do{var o=i.prev,r=i.next.next;!b(o,r)&&v(o,i,i.next,r)&&w(o,r)&&w(r,o)&&(t.push(o.i/n),t.push(i.i/n),t.push(r.i/n),k(i),k(i.next),i=e=r),i=i.next}while(i!==e);return i}function u(e,t,n,i,o,s){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&m(l,c)){var u=x(l,c);return l=r(l,l.next),u=r(u,u.next),a(l,t,n,i,o,s),void a(u,t,n,i,o,s)}c=c.next}l=l.next}while(l!==e)}function h(e,t){return e.x-t.x}function d(e,t){if(t=function(e,t){var n,i=t,o=e.x,r=e.y,a=-1/0;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){var s=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=o&&s>a){if(a=s,s===o){if(r===i.y)return i;if(r===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(o===a)return n.prev;var l,c=n,u=n.x,h=n.y,d=1/0;for(i=n.next;i!==c;)o>=i.x&&i.x>=u&&o!==i.x&&g(r<h?o:a,r,u,h,r<h?a:o,r,i.x,i.y)&&((l=Math.abs(r-i.y)/(o-i.x))<d||l===d&&i.x>n.x)&&w(i,e)&&(n=i,d=l),i=i.next;return n}(e,t)){var n=x(t,e);r(n,n.next)}}function p(e,t,n,i,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*o)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*o)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function f(e){var t=e,n=e;do{t.x<n.x&&(n=t),t=t.next}while(t!==e);return n}function g(e,t,n,i,o,r,a,s){return(o-a)*(t-s)-(e-a)*(r-s)>=0&&(e-a)*(i-s)-(n-a)*(t-s)>=0&&(n-a)*(r-s)-(o-a)*(i-s)>=0}function m(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&v(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&w(e,t)&&w(t,e)&&function(e,t){var n=e,i=!1,o=(e.x+t.x)/2,r=(e.y+t.y)/2;do{n.y>r!=n.next.y>r&&n.next.y!==n.y&&o<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)}function y(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function b(e,t){return e.x===t.x&&e.y===t.y}function v(e,t,n,i){return!!(b(e,t)&&b(n,i)||b(e,i)&&b(n,t))||y(e,t,n)>0!=y(e,t,i)>0&&y(n,i,e)>0!=y(n,i,t)>0}function w(e,t){return y(e.prev,e,e.next)<0?y(e,t,e.next)>=0&&y(e,e.prev,t)>=0:y(e,t,e.prev)<0||y(e,e.next,t)<0}function x(e,t){var n=new T(e.i,e.x,e.y),i=new T(t.i,t.x,t.y),o=e.next,r=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,i.next=n,n.prev=i,r.next=i,i.prev=r,i}function C(e,t,n,i){var o=new T(e,t,n);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function k(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function T(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(e,t,n,i){for(var o=0,r=t,a=n-i;r<n;r+=i)o+=(e[a]-e[r])*(e[r+1]+e[a+1]),a=r;return o}e.exports=i,i.deviation=function(e,t,n,i){var o=t&&t.length,r=Math.abs(P(e,0,o?t[0]*n:e.length,n));if(o)for(var a=0,s=t.length;a<s;a++)r-=Math.abs(P(e,t[a]*n,a<s-1?t[a+1]*n:e.length,n));var l=0;for(a=0;a<i.length;a+=3){var c=i[a]*n,u=i[a+1]*n,h=i[a+2]*n;l+=Math.abs((e[c]-e[h])*(e[u+1]-e[c+1])-(e[c]-e[u])*(e[h+1]-e[c+1]))}return 0===r&&0===l?0:Math.abs((l-r)/r)},i.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},i=0,o=0;o<e.length;o++){for(var r=0;r<e[o].length;r++)for(var a=0;a<t;a++)n.vertices.push(e[o][r][a]);o>0&&n.holes.push(i+=e[o-1].length)}return n}},MwAz:function(e,t,n){"use strict";n.r(t);var i,o=n("CcnG"),r=function(){function e(){}return e.prototype.ngOnInit=function(){},e}(),a=function(){function e(){}return e.prototype.ngOnInit=function(){},e}(),s=function(){function e(e){this.activeModal=e,this.modalContent="Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy\n      nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis\n      nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat."}return e.prototype.closeModal=function(){this.activeModal.close()},e.prototype.ngOnInit=function(){},e}(),l=function(){function e(e){this.modalService=e,this.zns=!0,this.scaling="knowing-board"}return e.prototype.ngOnInit=function(){this.run(this.scaling)},e.prototype.run=function(e){},e.prototype.showModal=function(e){var t=this.modalService.open(s,{size:"lg",backdrop:"static",container:"nb-layout"});t.componentInstance.status=e.status,t.componentInstance.modalHeader=e.header,t.componentInstance.modalContent=e.content},e}(),c=function(){function e(){}return e.prototype.ngOnInit=function(){},e}(),u=n("mrSG"),h=n("liQ+"),d=n.n(h)()(),p=(i=d.getGlobals())[0],f=i[6],g=i[10],m=function(){function e(){}return e.prototype.confirmAnswer=function(e,t){var n;return e.correct_answer===e.user_response?(this.status=!0,n=this.feedBackMessage(this.status)):void 0===e.user_response?(this.status=void 0,n=this.feedBackMessage(this.status)):(this.status=!1,n=this.feedBackMessage(this.status)),n},e.prototype.feedBackMessage=function(e){var t={header:"What is your answer to the question?",content:"Maybe you made a mistake\n                        try again.",status:e},n=[{header:"Great job, Sandra!",content:"You answered correctly,\n                good job. Keep practicing till you become perfect",status:e},{header:"Genius girl",content:"You are doing good,\n                 keep this up and you will soon master counting",status:e},{header:"Correct answer!",content:"The numbers love you, they are singing your praises",status:e}],i=[{header:"No! thats wrong",content:"You missed this one,\n                don't rush to answer, count carefully.",status:e},{header:"Not correct!",content:"Maybe you are going too fast, Count the shapes carefully",status:e},{header:"Wrong answer",content:"Change your approach, be sure of your answer before you submit",status:e}];return!0===e?(p("Brilliant, good counting!"),this.feedback_message=g([n])):!1===e?(p("Wrong, are you going too fast?"),this.feedback_message=g([i])):this.feedback_message=t,this.feedback_message},e.prototype.getExplanation=function(){},e.prototype.getCorrection=function(){},e.prototype.sendScore=function(){},e.prototype.diagnosticFeedback=function(){},e}(),y=(new m,function(){function e(){}return e.prototype.ask=function(e){this.label=new d.Label({text:this.text,size:40,font:"Gotham",color:"#999999",fontOptions:" bold"}).pos(90,120),e.addChild(this.label,this.shapes),e.update()},e.prototype.show=function(){},e.prototype.answer=function(e){"Count total"===this.type&&(this.user_response=this.answerPicker.currentValue),e.removeChild(this.label,this.shapes)},e.prototype.explain=function(){},e.prototype.review=function(){},e}()),b=function(e){function t(t){var n=e.call(this)||this;return n.type="Count total",n.shapeTypes=["circle","rectangle","triangle","ice cream","bee","pot","crab","tea cup"],n.shapeFactory=t,n.row1=new d.Container(700,100).alp(0).animate({obj:{alpha:1},time:1e3}),n.row2=new d.Container(700,100).alp(0).animate({obj:{alpha:1},time:1e3}),n.row1.x=120,n.row1.y=120,n.row2.x=120,n.row2.y=250,n.createQuestion(),n}return Object(u.b)(t,e),t.prototype.createQuestion=function(){var e=g(this.shapeTypes);this.numOfShapes=d.rand(1,10),this.correct_answer=this.numOfShapes;var t=this.shapeFactory.makeShapes(this.numOfShapes,e),n=this.createAnswerPicker();this.shapes=this.positionShapes(t),this.shapes.addChild(n),this.text="How many "+e+"s are there?"},t.prototype.createAnswerPicker=function(){return this.answerPicker=new Stepper({list:[1,2,3,4,5,6,7,8,9,10],vertical:!0,stepperType:"number",min:0,max:10}),this.answerPicker.pos(400,400).sca(.5),this.answerPicker},t.prototype.positionShapes=function(e){var t=new d.Container(900,500).alp(0).animate({obj:{alpha:1},time:500});function n(e,t){"Triangle"===e.type?e.y=t:"Circle"===e.type&&(e.y=t)}t.x=70,t.y=70,t.drag();for(var i=0;i<e.length;i++){var o=e[i];i>=5?(this.row2.addChild(o),o.x=this.row2.x*i+60-600,n(o,50)):(this.row1.addChild(o),o.x=this.row1.x*i+60,n(o,50))}return t.addChild(this.row1,this.row2),t},t}(y),v=function(){function e(e){this.frame=e,this.ice_cream=this.frame.asset("ice_cream_cone.png").image,this.pot=this.frame.asset("pot.png").image,this.crab=this.frame.asset("crab.png").image,this.tea_cup=this.frame.asset("tea_cup.png").image,this.bee=this.frame.asset("bee.png").image}return e.prototype.makeShapes=function(e,t){var n;switch(t){case"circle":n=this.makeMany(e,"circle");break;case"rectangle":n=this.makeMany(e,"rectangle");break;case"triangle":n=this.makeMany(e,"triangle");break;case"ice cream":n=this.makeMany(e,"ice cream");break;case"bee":n=this.makeMany(e,"bee");break;case"pot":n=this.makeMany(e,"pot");break;case"crab":n=this.makeMany(e,"crab");break;case"tea cup":n=this.makeMany(e,"tea cup");break;default:n=this.makeMany(e,"rectangle")}return n},e.prototype.makeMany=function(e,t){for(var n,i=[],o=0;o<e;++o)switch(t){case"rectangle":n=new d.Rectangle({color:"#cccccc"}),i.push(n);break;case"triangle":n=new d.Triangle({color:"#cccccc"}).pos(90,50),i.push(n);break;case"circle":n=new d.Circle(50,"#cccccc").pos(50,50),i.push(n);break;case"ice cream":n=new d.Bitmap(this.ice_cream,200,200).sca(.18),i.push(n);break;case"bee":n=new d.Bitmap(this.bee).sca(.2).pos(30,5),i.push(n);break;case"pot":n=new d.Bitmap(this.pot).sca(.2).pos(0,5),i.push(n);break;case"crab":n=new d.Bitmap(this.crab).sca(.2).pos(30,7),i.push(n);break;case"tea cup":n=new d.Bitmap(this.tea_cup).sca(.2).pos(30,8),i.push(n);break;default:n=new d.Rectangle,i.push(n)}return i},e}(),w=function(e){function t(t){var n=e.call(this)||this;return n.offColor="#1A5A77",n.onColor="green",n.type="pick group",n.shapeTypes=["circle","rectangle","triangle","bee","pot","crab","tea cup"],n.shapeFactory=t,n.shapes=new d.Container(900,500),n.shapes.pos(70,150),n.createQuestion(),n}return Object(u.b)(t,e),t.prototype.createQuestion=function(){var e=g(this.shapeTypes),t=d.rand(1,4),n=d.rand(5,8),i=g([230,670]),o=this.shapeFactory.makeShapes(t,e),r=this.shapeFactory.makeShapes(n,e),a=this.positionShapes(o).alp(0).animate({obj:{alpha:1},time:700});a.name="Group 1";var s,l=this.positionShapes(r).alp(0).animate({obj:{alpha:1},time:700});l.name="Group 2",a.x=i,l.x=670===a.x?230:670,this.group1=a,this.group2=l,this.addClickListeners(),"more"===(s=g(["more","more number of shapes","less","less number of shapes"]))?(this.text="Which group has more "+e+"s?",this.correct_answer=l.name):"more number of shapes"===s?(this.text="Which group has "+n+" "+e+"s?",this.correct_answer=l.name):"less number of shapes"===s?(this.text="Which group has "+t+" "+e+"s?",this.correct_answer=a.name):(this.text="Which group has less "+e+"s?",this.correct_answer=a.name)},t.prototype.positionShapes=function(e){var t=new d.Container(700,100),n=new d.Container(700,100),i=new d.Container(420,240);i.reg(i.width/2,i.height/2);var o=new Rectangle(420,240,this.offColor);o.borderColor="#fff";var r=e[0].type;i.center(this.shapes),t.x=120,t.y=30,n.x=120,n.y=130;for(var a=0;a<e.length;a++){var s=e[a];a>=4?(n.addChild(s),s.x=n.x*a+60-600):(t.addChild(s),s.x=t.x*a)}return i.addChild(o,t,n),i.drag({currentTarget:!0}),i.y=150,"Triangle"===r?(t.x=68,n.x=110,t.y=2,n.y=90):"Circle"===r?(t.x=68,t.y=-5,n.y=90):"Rectangle"===r?(t.x=25,n.x=75):(t.x=20,n.x=65),t.sca(.8),n.sca(.8),i},t.prototype.addClickListeners=function(){var e=this.group2,t=this.group1,n=this;this.group1.on("click",function(t){this.getChildAt(0).color="#02d611",this.animate({obj:{scale:1.2},time:500,rewind:!0,id:"scale"}),e.getChildAt(0).color="#1A5A77",n.user_response=this.name}),this.group2.on("click",function(e){this.getChildAt(0).color="#02d611",this.animate({obj:{scale:1.2},time:500,rewind:!0,id:"scale"}),t.getChildAt(0).color="#1A5A77",n.user_response=this.name})},t}(y);function x(e,t,n,i){e.center(t),e.animate({obj:{x:n},time:700,ease:"bounceOut"})}var C=function(e){function t(t,n){var i=e.call(this)||this;return i.type="drag answer",i.shapeTypes=["circle","triangle","bee","pot","crab","tea cup"],i.shapeFactory=t,i.shapes=new d.Container(900,500),i.shapes.x=70,i.shapes.y=160,i.stage=n,i.createQuestion(),i}return Object(u.b)(t,e),t.prototype.createQuestion=function(){var e=g(this.shapeTypes);this.numOfShapes=d.rand(1,10),this.correct_answer=this.numOfShapes,this.group_background=new Rectangle(660,270,"#1A5A77").alp(0).animate({obj:{alpha:1},time:700}),this.group_background.name="Answer rectangle",this.group_background.borderColor="#fff";var t=this.shapeFactory.makeShapes(1,e)[0],n=this.positionShapes(t);this.answer_drop_point=this.createDropPoint(),this.shapes.addChild(this.answer_drop_point,n,t),this.text=1===this.numOfShapes?"Drag and drop "+this.numOfShapes+" "+e+" into the box?":"Drag and drop "+this.numOfShapes+" "+e+"s into the box?"},t.prototype.positionShapes=function(e){var t=this.stage,n=this,i=new d.Container(t.width,t.height);i.name="Shapes container";var o,r,a=this.group_background,s=new d.Container(620,100),l=new d.Container(620,100),c=[],u=0;function h(e,i){if(e.hitTestBounds(a))switch(n.user_response=++u,p(u),u){case 1:x(e,s,50);break;case 2:x(e,s,163);break;case 3:x(e,s,276);break;case 4:x(e,s,389);break;case 5:x(e,s,502);break;case 6:x(e,l,50);break;case 7:x(e,l,163);break;case 8:x(e,l,276);break;case 9:x(e,l,389);break;case 10:x(e,l,502)}f(i||window.event),t.update()}return s.x=l.x=18,s.y=25,l.y=150,e.drag(),e.on("mousedown",function(e){r=(o=e.target).clone().addTo(i).drag(),i.setChildIndex(o,i.numChildren-1),o.startX=copy.x=o.x,o.startY=copy.y=o.y,t.update()},!1),e.on("pressup",function(e){o=e.currentTarget,swapProperties("x",o,r),swapProperties("y",o,r),c.push(r),h(r,e),function(e){for(var n=function(n){var i=e[n];i.on("pressup",function(e){o=e.currentTarget,h(i),f(e||window.event),t.update()})},i=0;i<e.length;i++)n(i)}(c),t.update()}),a.addChild(s,l),i},t.prototype.createDropPoint=function(){var e=new d.Container(500,400);return e.name="answer container",e.addChild(this.group_background),e.x=200,e.y=20,e},t}(y),k=function(){function e(e){this.frame=e,this.shapeFactory=new v(this.frame)}return e.prototype.createAQuestion=function(e,t){switch(e){case"pick answer":this.question=new b(this.shapeFactory);break;case"drag answer":this.question=new C(this.shapeFactory,t);break;case"pick group":this.question=new w(this.shapeFactory);break;default:this.question=new b(this.shapeFactory)}return this.question},e}(),T=function(){function e(e){this.frame=e,this.questions=[],this.questionFactory=new k(this.frame)}return e.prototype.generateQuestion=function(e,t){var n=this.questionFactory.createAQuestion(e,t);this.questions.push(n),this.questionChanged(t,n)},e.prototype.registerFrame=function(e){},e.prototype.removeFrame=function(e){},e.prototype.updateStage=function(){},e.prototype.questionChanged=function(e,t){t.ask(e),this.question=t},e}(),P=function(){function e(){this.questionTypes=["pick group","pick answer","drag answer"],this.frame=new d.Frame("counting-lesson"),this.frame.loadAssets(["ice_cream_cone.png","bee.png","tea_cup.png","crab.png","pot.png"],"assets/images/"),this.answer_checker=new m}return e.prototype.getQuestion=function(e){var t=g(this.questionTypes);this.manager=new T(this.frame),this.manager.generateQuestion(t,e)},e.prototype.start=function(e,t){var n,i=this;this.board=t,this.frame.on("ready",function(){p("ready from ZIM Frame"),n=this.stage,this.color="white";var e=new d.Waiter(n);this.on("complete",function(){i.getQuestion(n);var t={width:150,height:60,label:new Label({text:"CHECK",font:"Gotham",rollColor:"yellow",fontOptions:" bold",color:"white",size:28}),backgroundColor:"#66ff33"},o={width:150,height:60,label:new Label({text:"SKIP",font:"Gotham",rollColor:"yellow",fontOptions:" bold",color:"white",size:28}),backgroundColor:"#666666"},r=new Button(t),a=new Button(o);r.pos(800,500).addTo(n),a.pos(100,500).addTo(n),r.on("click",function(){i.submit(i.manager.question,n)}),e.dispose()}),n.update(),this.on("resize",function(){p("resizing"),i.resize(n,!0,"both",!0,1),n.update()})})},e.prototype.submit=function(e,t){e.answer(t),this.answer_checker.confirmAnswer(e,t),this.getQuestion(t),t.update()},e.prototype.resize=function(e,t,n,i,o){var r,a,s=document.getElementById("counting-lessonCanvas"),l=1;function c(){var c=e.width,u=e.height,h=window.innerWidth,d=window.innerHeight,p=window.devicePixelRatio||1,f=h/c,g=d/u,m=1;t&&("width"===n&&r===h||"height"===n&&a===d?m=l:i?1===o?m=Math.min(f,g):2===o&&(m=Math.max(f,g)):(h<c||d<u)&&(m=Math.min(f,g))),s.width=c*p*m,s.height=u*p*m,s.style.width=c*m+"px",s.style.height=u*m+"px",e.scaleX=p*m,e.scaleY=p*m,r=h,a=d,l=m,e.tickOnUpdate=!1,e.update(),e.tickOnUpdate=!0}window.addEventListener("resize",c),c()},e}(),O=function(){function e(e,t){this.countingService=e,this.modalService=t,this.zns=!0,this.scaling="full"}return e.prototype.ngOnInit=function(){this.run(this.scaling)},e.prototype.run=function(e){return t=this,void 0,i=function(){return function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(t){return[2,this.countingService.start(e,this)]})},new((n=void 0)||(n=Promise))(function(e,o){function r(e){try{s(i.next(e))}catch(t){o(t)}}function a(e){try{s(i.throw(e))}catch(t){o(t)}}function s(t){t.done?e(t.value):new n(function(e){e(t.value)}).then(r,a)}s((i=i.apply(t,[])).next())});var t,n,i},e.prototype.showModal=function(e){var t=this.modalService.open(s,{size:"lg",backdrop:"static",container:"nb-layout"});t.componentInstance.status=e.status,t.componentInstance.modalHeader=e.header,t.componentInstance.modalContent=e.content},e}(),A=function(){return function(){}}(),S=n("pMnS"),I=n("jXVt"),E=n("ZYCi"),M=o.Ib({encapsulation:2,styles:[[""]],data:{}});function B(e){return o.gc(0,[(e()(),o.Kb(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),o.Jb(1,212992,null,0,E.q,[E.b,o.gb,o.m,[8,null],o.j],null,null)],function(e,t){e(t,1,0)},null)}function z(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,1,"app-subjects",[],null,null,null,B,M)),o.Jb(1,114688,null,0,r,[],null,null)],function(e,t){e(t,1,0)},null)}var j=o.Gb("app-subjects",r,z,{},{},[]),_=n("Xk95"),D=o.Ib({encapsulation:0,styles:[[".nb-theme-default   [_nghost-%COMP%]   nb-tabset[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.nb-theme-default   [_nghost-%COMP%]   .shape-container[_ngcontent-%COMP%]{margin:1.25rem 1.25rem 0}.nb-theme-default   [_nghost-%COMP%]     ngx-tab1, .nb-theme-default   [_nghost-%COMP%]     ngx-tab2{display:block}.nb-theme-dark   [_nghost-%COMP%]   nb-tabset[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.nb-theme-dark   [_nghost-%COMP%]   .shape-container[_ngcontent-%COMP%]{margin:1.25rem 1.25rem 0}.nb-theme-dark   [_nghost-%COMP%]     ngx-tab1, .nb-theme-dark   [_nghost-%COMP%]     ngx-tab2{display:block}.nb-theme-cosmic   [_nghost-%COMP%]   nb-tabset[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.nb-theme-cosmic   [_nghost-%COMP%]   .shape-container[_ngcontent-%COMP%]{margin:1.25rem 1.25rem 0}.nb-theme-cosmic   [_nghost-%COMP%]     ngx-tab1, .nb-theme-cosmic   [_nghost-%COMP%]     ngx-tab2{display:block}.nb-theme-corporate   [_nghost-%COMP%]   nb-tabset[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.nb-theme-corporate   [_nghost-%COMP%]   .shape-container[_ngcontent-%COMP%]{margin:1.25rem 1.25rem 0}.nb-theme-corporate   [_nghost-%COMP%]     ngx-tab1, .nb-theme-corporate   [_nghost-%COMP%]     ngx-tab2{display:block}.nb-theme-knowing   [_nghost-%COMP%]   nb-tabset[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.nb-theme-knowing   [_nghost-%COMP%]   .shape-container[_ngcontent-%COMP%]{margin:1.25rem 1.25rem 0}.nb-theme-knowing   [_nghost-%COMP%]     ngx-tab1, .nb-theme-knowing   [_nghost-%COMP%]     ngx-tab2{display:block}@media (max-width:399.98px){.nb-theme-default   [_nghost-%COMP%]   nb-tabset[_ngcontent-%COMP%]     ul{font-size:1rem;padding:0 .25rem}.nb-theme-dark   [_nghost-%COMP%]   nb-tabset[_ngcontent-%COMP%]     ul{font-size:1rem;padding:0 .25rem}.nb-theme-cosmic   [_nghost-%COMP%]   nb-tabset[_ngcontent-%COMP%]     ul{font-size:1rem;padding:0 .25rem}.nb-theme-corporate   [_nghost-%COMP%]   nb-tabset[_ngcontent-%COMP%]     ul{font-size:1rem;padding:0 .25rem}.nb-theme-knowing   [_nghost-%COMP%]   nb-tabset[_ngcontent-%COMP%]     ul{font-size:1rem;padding:0 .25rem}}"]],data:{}});function L(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,264,"div",[["class","row"]],null,null,null,null,null)),(e()(),o.Kb(1,0,null,null,37,"div",[["class","col-md-12 col-lg-6"]],null,null,null,null,null)),(e()(),o.Kb(2,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["The Solar System"])),(e()(),o.Kb(4,0,null,null,34,"nb-card",[["size","small"]],[[2,"size-tiny",null],[2,"size-small",null],[2,"size-medium",null],[2,"size-large",null],[2,"size-giant",null],[2,"status-primary",null],[2,"status-info",null],[2,"status-success",null],[2,"status-warning",null],[2,"status-danger",null],[2,"status-basic",null],[2,"status-control",null],[2,"accent",null],[2,"accent-primary",null],[2,"accent-info",null],[2,"accent-success",null],[2,"accent-warning",null],[2,"accent-danger",null],[2,"accent-basic",null],[2,"accent-control",null]],null,null,I.P,I.u)),o.Jb(5,49152,null,0,_.nb,[],{size:[0,"size"]},null),(e()(),o.Kb(6,0,null,2,32,"nb-tabset",[],[[2,"full-width",null]],null,null,I.db,I.I)),o.Jb(7,1097728,null,1,_.Ed,[E.a,o.j],null,null),o.cc(603979776,1,{tabs:1}),(e()(),o.Kb(9,0,null,0,19,"nb-tab",[["tabTitle","Intro"]],[[2,"disabled",null],[2,"content-active",null]],null,null,I.cb,I.H)),o.Jb(10,49152,[[1,4]],0,_.Bd,[],{tabTitle:[0,"tabTitle"]},null),(e()(),o.Kb(11,0,null,0,17,"p",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["In 1975, the first general purpose home automation network technology, "])),(e()(),o.Kb(13,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/X10_(industry_standard)"],["target","_blank"],["title","X10 (industry standard)"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["X10"])),(e()(),o.ec(-1,null,[", was developed. It is a communication protocol for electronic devices. It primarily uses "])),(e()(),o.Kb(16,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Electric_power_transmission"],["target","_blank"],["title","Electric power transmission"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["electric power transmission"])),(e()(),o.ec(-1,null,[" wiring for signalling and control, where the signals involve brief "])),(e()(),o.Kb(19,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Radio_frequency"],["target","_blank"],["title","Radio frequency"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["radio frequency"])),(e()(),o.ec(-1,null,[" bursts of "])),(e()(),o.Kb(22,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Digital_data"],["target","_blank"],["title","Digital data"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["digital data"])),(e()(),o.ec(-1,null,[", and remains the most widely available."])),(e()(),o.Kb(25,0,null,null,2,"sup",[["class","reference"],["id","cite_ref-8"]],null,null,null,null,null)),(e()(),o.Kb(26,0,null,null,1,"a",[["href","https://en.wikipedia.org#cite_note-8"],["target","_blank"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["[8]"])),(e()(),o.ec(-1,null,[" By 1978, X10 products included a 16 channel command console, a lamp module, and an appliance module. Soon after came the wall switch module and the first X10 timer."])),(e()(),o.Kb(29,0,null,0,5,"nb-tab",[["tabTitle","Learn"]],[[2,"disabled",null],[2,"content-active",null]],null,null,I.cb,I.H)),o.Jb(30,49152,[[1,4]],0,_.Bd,[],{tabTitle:[0,"tabTitle"]},null),(e()(),o.Kb(31,0,null,0,3,"div",[["class","shape-container"]],null,null,null,null,null)),(e()(),o.Kb(32,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),o.Kb(33,0,null,null,1,"button",[["class","btn btn-success btn-round btn-demo"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["Launch"])),(e()(),o.Kb(35,0,null,0,3,"nb-tab",[["tabTitle","Test"]],[[2,"disabled",null],[2,"content-active",null]],null,null,I.cb,I.H)),o.Jb(36,49152,[[1,4]],0,_.Bd,[],{tabTitle:[0,"tabTitle"]},null),(e()(),o.Kb(37,0,null,0,1,"span",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["Content #3"])),(e()(),o.Kb(39,0,null,null,35,"div",[["class","col-md-12 col-lg-6"]],null,null,null,null,null)),(e()(),o.Kb(40,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["Plants"])),(e()(),o.Kb(42,0,null,null,32,"nb-card",[["size","small"]],[[2,"size-tiny",null],[2,"size-small",null],[2,"size-medium",null],[2,"size-large",null],[2,"size-giant",null],[2,"status-primary",null],[2,"status-info",null],[2,"status-success",null],[2,"status-warning",null],[2,"status-danger",null],[2,"status-basic",null],[2,"status-control",null],[2,"accent",null],[2,"accent-primary",null],[2,"accent-info",null],[2,"accent-success",null],[2,"accent-warning",null],[2,"accent-danger",null],[2,"accent-basic",null],[2,"accent-control",null]],null,null,I.P,I.u)),o.Jb(43,49152,null,0,_.nb,[],{size:[0,"size"]},null),(e()(),o.Kb(44,0,null,2,30,"nb-tabset",[],[[2,"full-width",null]],null,null,I.db,I.I)),o.Jb(45,1097728,null,1,_.Ed,[E.a,o.j],null,null),o.cc(603979776,2,{tabs:1}),(e()(),o.Kb(47,0,null,0,19,"nb-tab",[["tabTitle","Intro"]],[[2,"disabled",null],[2,"content-active",null]],null,null,I.cb,I.H)),o.Jb(48,49152,[[2,4]],0,_.Bd,[],{tabTitle:[0,"tabTitle"]},null),(e()(),o.Kb(49,0,null,0,17,"p",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["In 1975, the first general purpose home automation network technology, "])),(e()(),o.Kb(51,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/X10_(industry_standard)"],["target","_blank"],["title","X10 (industry standard)"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["X10"])),(e()(),o.ec(-1,null,[", was developed. It is a communication protocol for electronic devices. It primarily uses "])),(e()(),o.Kb(54,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Electric_power_transmission"],["target","_blank"],["title","Electric power transmission"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["electric power transmission"])),(e()(),o.ec(-1,null,[" wiring for signalling and control, where the signals involve brief "])),(e()(),o.Kb(57,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Radio_frequency"],["target","_blank"],["title","Radio frequency"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["radio frequency"])),(e()(),o.ec(-1,null,[" bursts of "])),(e()(),o.Kb(60,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Digital_data"],["target","_blank"],["title","Digital data"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["digital data"])),(e()(),o.ec(-1,null,[", and remains the most widely available."])),(e()(),o.Kb(63,0,null,null,2,"sup",[["class","reference"],["id","cite_ref-8"]],null,null,null,null,null)),(e()(),o.Kb(64,0,null,null,1,"a",[["href","https://en.wikipedia.org#cite_note-8"],["target","_blank"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["[8]"])),(e()(),o.ec(-1,null,[" By 1978, X10 products included a 16 channel command console, a lamp module, and an appliance module. Soon after came the wall switch module and the first X10 timer."])),(e()(),o.Kb(67,0,null,0,3,"nb-tab",[["tabTitle","Learn"]],[[2,"disabled",null],[2,"content-active",null]],null,null,I.cb,I.H)),o.Jb(68,49152,[[2,4]],0,_.Bd,[],{tabTitle:[0,"tabTitle"]},null),(e()(),o.Kb(69,0,null,0,1,"span",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["Content #2"])),(e()(),o.Kb(71,0,null,0,3,"nb-tab",[["tabTitle","Test"]],[[2,"disabled",null],[2,"content-active",null]],null,null,I.cb,I.H)),o.Jb(72,49152,[[2,4]],0,_.Bd,[],{tabTitle:[0,"tabTitle"]},null),(e()(),o.Kb(73,0,null,0,1,"span",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["Content #3"])),(e()(),o.Kb(75,0,null,null,94,"div",[["class","col-md-6"]],null,null,null,null,null)),(e()(),o.Kb(76,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["The Human Body"])),(e()(),o.Kb(78,0,null,null,91,"nb-card",[["size","small"]],[[2,"size-tiny",null],[2,"size-small",null],[2,"size-medium",null],[2,"size-large",null],[2,"size-giant",null],[2,"status-primary",null],[2,"status-info",null],[2,"status-success",null],[2,"status-warning",null],[2,"status-danger",null],[2,"status-basic",null],[2,"status-control",null],[2,"accent",null],[2,"accent-primary",null],[2,"accent-info",null],[2,"accent-success",null],[2,"accent-warning",null],[2,"accent-danger",null],[2,"accent-basic",null],[2,"accent-control",null]],null,null,I.P,I.u)),o.Jb(79,49152,null,0,_.nb,[],{size:[0,"size"]},null),(e()(),o.Kb(80,0,null,2,89,"nb-tabset",[["fullWidth",""]],[[2,"full-width",null]],null,null,I.db,I.I)),o.Jb(81,1097728,null,1,_.Ed,[E.a,o.j],{fullWidth:[0,"fullWidth"]},null),o.cc(603979776,3,{tabs:1}),(e()(),o.Kb(83,0,null,0,78,"nb-tab",[["tabTitle","Intro"]],[[2,"disabled",null],[2,"content-active",null]],null,null,I.cb,I.H)),o.Jb(84,49152,[[3,4]],0,_.Bd,[],{tabTitle:[0,"tabTitle"]},null),(e()(),o.Kb(85,0,null,0,39,"p",[],null,null,null,null,null)),(e()(),o.Kb(86,0,null,null,1,"b",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["Home automation"])),(e()(),o.ec(-1,null,[" or "])),(e()(),o.Kb(89,0,null,null,1,"b",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["smart home"])),(e()(),o.Kb(91,0,null,null,2,"sup",[["class","reference"],["id","cite_ref-Smart_Home_1-0"]],null,null,null,null,null)),(e()(),o.Kb(92,0,null,null,1,"a",[["href","https://en.wikipedia.org#cite_note-Smart_Home-1"],["target","_blank"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["[1]"])),(e()(),o.ec(-1,null,[" (also known as "])),(e()(),o.Kb(95,0,null,null,1,"b",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["domotics"])),(e()(),o.Kb(97,0,null,null,2,"sup",[["class","reference"],["id","cite_ref-t3_2-0"]],null,null,null,null,null)),(e()(),o.Kb(98,0,null,null,1,"a",[["href","https://en.wikipedia.org#cite_note-t3-2"],["target","_blank"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["[2]"])),(e()(),o.ec(-1,null,[") is "])),(e()(),o.Kb(101,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Building_automation"],["target","_blank"],["title","Building automation"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["building automation"])),(e()(),o.ec(-1,null,[" for the home. It involves the control and automation of lighting, heating (such as "])),(e()(),o.Kb(104,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Smart_thermostat"],["target","_blank"],["title","Smart thermostat"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["smart thermostats"])),(e()(),o.ec(-1,null,["), ventilation, air conditioning ("])),(e()(),o.Kb(107,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/HVAC"],["target","_blank"],["title","HVAC"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["HVAC"])),(e()(),o.ec(-1,null,["), and security, as well as "])),(e()(),o.Kb(110,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Home_appliance"],["target","_blank"],["title","Home appliance"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["home appliances"])),(e()(),o.ec(-1,null,[" such as washer/dryers, ovens or refrigerators/freezers. "])),(e()(),o.Kb(113,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Wi-Fi"],["target","_blank"],["title","Wi-Fi"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["Wi-Fi"])),(e()(),o.ec(-1,null,[" is often used for remote monitoring and control. Home devices, when remotely monitored and controlled via the Internet, are an important constituent of the "])),(e()(),o.Kb(116,0,null,null,1,"a",[["class","mw-redirect"],["href","https://en.wikipedia.org/wiki/Internet_of_Things"],["target","_blank"],["title","Internet of Things"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["Internet of Things"])),(e()(),o.ec(-1,null,['. Modern systems generally consist of switches and sensors connected to a central hub sometimes called a "gateway" from which the system is controlled with a '])),(e()(),o.Kb(119,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/User_interface"],["target","_blank"],["title","User interface"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["user interface"])),(e()(),o.ec(-1,null,[" that is interacted either with a wall-mounted terminal, mobile phone software, "])),(e()(),o.Kb(122,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Tablet_computer"],["target","_blank"],["title","Tablet computer"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["tablet computer"])),(e()(),o.ec(-1,null,[" or a web interface, often but not always via Internet cloud services."])),(e()(),o.Kb(125,0,null,0,36,"p",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["While there are many competing vendors, there are very few worldwide accepted industry standards and the smart home space is heavily fragmented."])),(e()(),o.Kb(127,0,null,null,2,"sup",[["class","reference"],["id","cite_ref-3"]],null,null,null,null,null)),(e()(),o.Kb(128,0,null,null,1,"a",[["href","https://en.wikipedia.org#cite_note-3"],["target","_blank"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["[3]"])),(e()(),o.ec(-1,null,[" Popular "])),(e()(),o.Kb(131,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Communications_protocol"],["target","_blank"],["title","Communications protocol"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["communications protocol"])),(e()(),o.ec(-1,null,[" for products include "])),(e()(),o.Kb(134,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/X10_(industry_standard)"],["target","_blank"],["title","X10 (industry standard)"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["X10"])),(e()(),o.ec(-1,null,[", "])),(e()(),o.Kb(137,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Ethernet"],["target","_blank"],["title","Ethernet"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["Ethernet"])),(e()(),o.ec(-1,null,[", "])),(e()(),o.Kb(140,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/RS-485"],["target","_blank"],["title","RS-485"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["RS-485"])),(e()(),o.ec(-1,null,[", "])),(e()(),o.Kb(143,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/6LoWPAN"],["target","_blank"],["title","6LoWPAN"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["6LoWPAN"])),(e()(),o.ec(-1,null,[", "])),(e()(),o.Kb(146,0,null,null,1,"a",[["class","mw-redirect"],["href","https://en.wikipedia.org/wiki/Bluetooth_low_energy"],["target","_blank"],["title","Bluetooth low energy"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["Bluetooth LE (BLE)"])),(e()(),o.ec(-1,null,[", "])),(e()(),o.Kb(149,0,null,null,1,"a",[["class","mw-redirect"],["href","https://en.wikipedia.org/wiki/ZigBee"],["target","_blank"],["title","ZigBee"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["ZigBee"])),(e()(),o.ec(-1,null,[" and "])),(e()(),o.Kb(152,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Z-Wave"],["target","_blank"],["title","Z-Wave"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["Z-Wave"])),(e()(),o.ec(-1,null,[", or other proprietary protocols all of which are incompatible with each other."])),(e()(),o.Kb(155,0,null,null,2,"sup",[["class","reference"],["id","cite_ref-crhomephone_4-0"]],null,null,null,null,null)),(e()(),o.Kb(156,0,null,null,1,"a",[["href","https://en.wikipedia.org#cite_note-crhomephone-4"],["target","_blank"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["[4]"])),(e()(),o.ec(-1,null,[" Manufacturers often prevent independent implementations by withholding documentation and by litigation."])),(e()(),o.Kb(159,0,null,null,2,"sup",[["class","reference"],["id","cite_ref-5"]],null,null,null,null,null)),(e()(),o.Kb(160,0,null,null,1,"a",[["href","https://en.wikipedia.org#cite_note-5"],["target","_blank"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["[5]"])),(e()(),o.Kb(162,0,null,0,3,"nb-tab",[["tabTitle","Learn"]],[[2,"disabled",null],[2,"content-active",null]],null,null,I.cb,I.H)),o.Jb(163,49152,[[3,4]],0,_.Bd,[],{tabTitle:[0,"tabTitle"]},null),(e()(),o.Kb(164,0,null,0,1,"span",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["Content #2"])),(e()(),o.Kb(166,0,null,0,3,"nb-tab",[["tabTitle","Test"]],[[2,"disabled",null],[2,"content-active",null]],null,null,I.cb,I.H)),o.Jb(167,49152,[[3,4]],0,_.Bd,[],{tabTitle:[0,"tabTitle"]},null),(e()(),o.Kb(168,0,null,0,1,"span",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["Content #3"])),(e()(),o.Kb(170,0,null,null,94,"div",[["class","col-md-6"]],null,null,null,null,null)),(e()(),o.Kb(171,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["The Weather"])),(e()(),o.Kb(173,0,null,null,91,"nb-card",[["size","small"]],[[2,"size-tiny",null],[2,"size-small",null],[2,"size-medium",null],[2,"size-large",null],[2,"size-giant",null],[2,"status-primary",null],[2,"status-info",null],[2,"status-success",null],[2,"status-warning",null],[2,"status-danger",null],[2,"status-basic",null],[2,"status-control",null],[2,"accent",null],[2,"accent-primary",null],[2,"accent-info",null],[2,"accent-success",null],[2,"accent-warning",null],[2,"accent-danger",null],[2,"accent-basic",null],[2,"accent-control",null]],null,null,I.P,I.u)),o.Jb(174,49152,null,0,_.nb,[],{size:[0,"size"]},null),(e()(),o.Kb(175,0,null,2,89,"nb-tabset",[["fullWidth",""]],[[2,"full-width",null]],null,null,I.db,I.I)),o.Jb(176,1097728,null,1,_.Ed,[E.a,o.j],{fullWidth:[0,"fullWidth"]},null),o.cc(603979776,4,{tabs:1}),(e()(),o.Kb(178,0,null,0,78,"nb-tab",[["tabTitle","Intro"]],[[2,"disabled",null],[2,"content-active",null]],null,null,I.cb,I.H)),o.Jb(179,49152,[[4,4]],0,_.Bd,[],{tabTitle:[0,"tabTitle"]},null),(e()(),o.Kb(180,0,null,0,39,"p",[],null,null,null,null,null)),(e()(),o.Kb(181,0,null,null,1,"b",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["Home automation"])),(e()(),o.ec(-1,null,[" or "])),(e()(),o.Kb(184,0,null,null,1,"b",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["smart home"])),(e()(),o.Kb(186,0,null,null,2,"sup",[["class","reference"],["id","cite_ref-Smart_Home_1-0"]],null,null,null,null,null)),(e()(),o.Kb(187,0,null,null,1,"a",[["href","https://en.wikipedia.org#cite_note-Smart_Home-1"],["target","_blank"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["[1]"])),(e()(),o.ec(-1,null,[" (also known as "])),(e()(),o.Kb(190,0,null,null,1,"b",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["domotics"])),(e()(),o.Kb(192,0,null,null,2,"sup",[["class","reference"],["id","cite_ref-t3_2-0"]],null,null,null,null,null)),(e()(),o.Kb(193,0,null,null,1,"a",[["href","https://en.wikipedia.org#cite_note-t3-2"],["target","_blank"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["[2]"])),(e()(),o.ec(-1,null,[") is "])),(e()(),o.Kb(196,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Building_automation"],["target","_blank"],["title","Building automation"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["building automation"])),(e()(),o.ec(-1,null,[" for the home. It involves the control and automation of lighting, heating (such as "])),(e()(),o.Kb(199,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Smart_thermostat"],["target","_blank"],["title","Smart thermostat"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["smart thermostats"])),(e()(),o.ec(-1,null,["), ventilation, air conditioning ("])),(e()(),o.Kb(202,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/HVAC"],["target","_blank"],["title","HVAC"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["HVAC"])),(e()(),o.ec(-1,null,["), and security, as well as "])),(e()(),o.Kb(205,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Home_appliance"],["target","_blank"],["title","Home appliance"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["home appliances"])),(e()(),o.ec(-1,null,[" such as washer/dryers, ovens or refrigerators/freezers. "])),(e()(),o.Kb(208,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Wi-Fi"],["target","_blank"],["title","Wi-Fi"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["Wi-Fi"])),(e()(),o.ec(-1,null,[" is often used for remote monitoring and control. Home devices, when remotely monitored and controlled via the Internet, are an important constituent of the "])),(e()(),o.Kb(211,0,null,null,1,"a",[["class","mw-redirect"],["href","https://en.wikipedia.org/wiki/Internet_of_Things"],["target","_blank"],["title","Internet of Things"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["Internet of Things"])),(e()(),o.ec(-1,null,['. Modern systems generally consist of switches and sensors connected to a central hub sometimes called a "gateway" from which the system is controlled with a '])),(e()(),o.Kb(214,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/User_interface"],["target","_blank"],["title","User interface"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["user interface"])),(e()(),o.ec(-1,null,[" that is interacted either with a wall-mounted terminal, mobile phone software, "])),(e()(),o.Kb(217,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Tablet_computer"],["target","_blank"],["title","Tablet computer"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["tablet computer"])),(e()(),o.ec(-1,null,[" or a web interface, often but not always via Internet cloud services."])),(e()(),o.Kb(220,0,null,0,36,"p",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["While there are many competing vendors, there are very few worldwide accepted industry standards and the smart home space is heavily fragmented."])),(e()(),o.Kb(222,0,null,null,2,"sup",[["class","reference"],["id","cite_ref-3"]],null,null,null,null,null)),(e()(),o.Kb(223,0,null,null,1,"a",[["href","https://en.wikipedia.org#cite_note-3"],["target","_blank"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["[3]"])),(e()(),o.ec(-1,null,[" Popular "])),(e()(),o.Kb(226,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Communications_protocol"],["target","_blank"],["title","Communications protocol"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["communications protocol"])),(e()(),o.ec(-1,null,[" for products include "])),(e()(),o.Kb(229,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/X10_(industry_standard)"],["target","_blank"],["title","X10 (industry standard)"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["X10"])),(e()(),o.ec(-1,null,[", "])),(e()(),o.Kb(232,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Ethernet"],["target","_blank"],["title","Ethernet"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["Ethernet"])),(e()(),o.ec(-1,null,[", "])),(e()(),o.Kb(235,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/RS-485"],["target","_blank"],["title","RS-485"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["RS-485"])),(e()(),o.ec(-1,null,[", "])),(e()(),o.Kb(238,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/6LoWPAN"],["target","_blank"],["title","6LoWPAN"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["6LoWPAN"])),(e()(),o.ec(-1,null,[", "])),(e()(),o.Kb(241,0,null,null,1,"a",[["class","mw-redirect"],["href","https://en.wikipedia.org/wiki/Bluetooth_low_energy"],["target","_blank"],["title","Bluetooth low energy"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["Bluetooth LE (BLE)"])),(e()(),o.ec(-1,null,[", "])),(e()(),o.Kb(244,0,null,null,1,"a",[["class","mw-redirect"],["href","https://en.wikipedia.org/wiki/ZigBee"],["target","_blank"],["title","ZigBee"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["ZigBee"])),(e()(),o.ec(-1,null,[" and "])),(e()(),o.Kb(247,0,null,null,1,"a",[["href","https://en.wikipedia.org/wiki/Z-Wave"],["target","_blank"],["title","Z-Wave"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["Z-Wave"])),(e()(),o.ec(-1,null,[", or other proprietary protocols all of which are incompatible with each other."])),(e()(),o.Kb(250,0,null,null,2,"sup",[["class","reference"],["id","cite_ref-crhomephone_4-0"]],null,null,null,null,null)),(e()(),o.Kb(251,0,null,null,1,"a",[["href","https://en.wikipedia.org#cite_note-crhomephone-4"],["target","_blank"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["[4]"])),(e()(),o.ec(-1,null,[" Manufacturers often prevent independent implementations by withholding documentation and by litigation."])),(e()(),o.Kb(254,0,null,null,2,"sup",[["class","reference"],["id","cite_ref-5"]],null,null,null,null,null)),(e()(),o.Kb(255,0,null,null,1,"a",[["href","https://en.wikipedia.org#cite_note-5"],["target","_blank"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["[5]"])),(e()(),o.Kb(257,0,null,0,3,"nb-tab",[["tabTitle","Learn"]],[[2,"disabled",null],[2,"content-active",null]],null,null,I.cb,I.H)),o.Jb(258,49152,[[4,4]],0,_.Bd,[],{tabTitle:[0,"tabTitle"]},null),(e()(),o.Kb(259,0,null,0,1,"span",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["Content #2"])),(e()(),o.Kb(261,0,null,0,3,"nb-tab",[["tabTitle","Test"]],[[2,"disabled",null],[2,"content-active",null]],null,null,I.cb,I.H)),o.Jb(262,49152,[[4,4]],0,_.Bd,[],{tabTitle:[0,"tabTitle"]},null),(e()(),o.Kb(263,0,null,0,1,"span",[],null,null,null,null,null)),(e()(),o.ec(-1,null,["Content #3"]))],function(e,t){e(t,5,0,"small"),e(t,10,0,"Intro"),e(t,30,0,"Learn"),e(t,36,0,"Test"),e(t,43,0,"small"),e(t,48,0,"Intro"),e(t,68,0,"Learn"),e(t,72,0,"Test"),e(t,79,0,"small"),e(t,81,0,""),e(t,84,0,"Intro"),e(t,163,0,"Learn"),e(t,167,0,"Test"),e(t,174,0,"small"),e(t,176,0,""),e(t,179,0,"Intro"),e(t,258,0,"Learn"),e(t,262,0,"Test")},function(e,t){e(t,4,1,[o.Wb(t,5).tiny,o.Wb(t,5).small,o.Wb(t,5).medium,o.Wb(t,5).large,o.Wb(t,5).giant,o.Wb(t,5).primary,o.Wb(t,5).info,o.Wb(t,5).success,o.Wb(t,5).warning,o.Wb(t,5).danger,o.Wb(t,5).basic,o.Wb(t,5).control,o.Wb(t,5).hasAccent,o.Wb(t,5).primaryAccent,o.Wb(t,5).infoAccent,o.Wb(t,5).successAccent,o.Wb(t,5).warningAccent,o.Wb(t,5).dangerAccent,o.Wb(t,5).basicAccent,o.Wb(t,5).controlAccent]),e(t,6,0,o.Wb(t,7).fullWidthValue),e(t,9,0,o.Wb(t,10).disabled,o.Wb(t,10).activeValue),e(t,29,0,o.Wb(t,30).disabled,o.Wb(t,30).activeValue),e(t,35,0,o.Wb(t,36).disabled,o.Wb(t,36).activeValue),e(t,42,1,[o.Wb(t,43).tiny,o.Wb(t,43).small,o.Wb(t,43).medium,o.Wb(t,43).large,o.Wb(t,43).giant,o.Wb(t,43).primary,o.Wb(t,43).info,o.Wb(t,43).success,o.Wb(t,43).warning,o.Wb(t,43).danger,o.Wb(t,43).basic,o.Wb(t,43).control,o.Wb(t,43).hasAccent,o.Wb(t,43).primaryAccent,o.Wb(t,43).infoAccent,o.Wb(t,43).successAccent,o.Wb(t,43).warningAccent,o.Wb(t,43).dangerAccent,o.Wb(t,43).basicAccent,o.Wb(t,43).controlAccent]),e(t,44,0,o.Wb(t,45).fullWidthValue),e(t,47,0,o.Wb(t,48).disabled,o.Wb(t,48).activeValue),e(t,67,0,o.Wb(t,68).disabled,o.Wb(t,68).activeValue),e(t,71,0,o.Wb(t,72).disabled,o.Wb(t,72).activeValue),e(t,78,1,[o.Wb(t,79).tiny,o.Wb(t,79).small,o.Wb(t,79).medium,o.Wb(t,79).large,o.Wb(t,79).giant,o.Wb(t,79).primary,o.Wb(t,79).info,o.Wb(t,79).success,o.Wb(t,79).warning,o.Wb(t,79).danger,o.Wb(t,79).basic,o.Wb(t,79).control,o.Wb(t,79).hasAccent,o.Wb(t,79).primaryAccent,o.Wb(t,79).infoAccent,o.Wb(t,79).successAccent,o.Wb(t,79).warningAccent,o.Wb(t,79).dangerAccent,o.Wb(t,79).basicAccent,o.Wb(t,79).controlAccent]),e(t,80,0,o.Wb(t,81).fullWidthValue),e(t,83,0,o.Wb(t,84).disabled,o.Wb(t,84).activeValue),e(t,162,0,o.Wb(t,163).disabled,o.Wb(t,163).activeValue),e(t,166,0,o.Wb(t,167).disabled,o.Wb(t,167).activeValue),e(t,173,1,[o.Wb(t,174).tiny,o.Wb(t,174).small,o.Wb(t,174).medium,o.Wb(t,174).large,o.Wb(t,174).giant,o.Wb(t,174).primary,o.Wb(t,174).info,o.Wb(t,174).success,o.Wb(t,174).warning,o.Wb(t,174).danger,o.Wb(t,174).basic,o.Wb(t,174).control,o.Wb(t,174).hasAccent,o.Wb(t,174).primaryAccent,o.Wb(t,174).infoAccent,o.Wb(t,174).successAccent,o.Wb(t,174).warningAccent,o.Wb(t,174).dangerAccent,o.Wb(t,174).basicAccent,o.Wb(t,174).controlAccent]),e(t,175,0,o.Wb(t,176).fullWidthValue),e(t,178,0,o.Wb(t,179).disabled,o.Wb(t,179).activeValue),e(t,257,0,o.Wb(t,258).disabled,o.Wb(t,258).activeValue),e(t,261,0,o.Wb(t,262).disabled,o.Wb(t,262).activeValue)})}function Y(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,1,"app-science",[],null,null,null,L,D)),o.Jb(1,114688,null,0,a,[],null,null)],function(e,t){e(t,1,0)},null)}var R=o.Gb("app-science",a,Y,{},{},[]),X=n("Ip0R"),W=n("gIcY");function F(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}var V=n("K9Ia");n("26FU"),n("dzgT"),n("gI3B"),n("6blF"),n("+umK");var N=n("bne5"),G=(n("p0ib"),n("4HpG")),H=(n("isby"),n("IUTb"),n("MGBS")),K=n("zotm"),q=n("67Y/"),U=(n("p0Sj"),n("ad02"),n("15JJ"),n("ny24")),Z=n("VnD/");function J(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n;return"function"==typeof e[e.length-1]&&(n=e.pop()),t.lift(new $(e,n))}}n("t9fZ");var $=function(){function e(e,t){this.observables=e,this.project=t}return e.prototype.call=function(e,t){return t.subscribe(new Q(e,this.observables,this.project))},e}(),Q=function(e){function t(t,n,i){var o=e.call(this,t)||this;o.observables=n,o.project=i,o.toRespond=[];var r=n.length;o.values=new Array(r);for(var a=0;a<r;a++)o.toRespond.push(a);for(a=0;a<r;a++){var s=n[a];o.add(Object(K.a)(o,s,s,a))}return o}return G.a(t,e),t.prototype.notifyNext=function(e,t,n,i,o){this.values[n]=t;var r=this.toRespond;if(r.length>0){var a=r.indexOf(n);-1!==a&&r.splice(a,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){if(0===this.toRespond.length){var t=[e].concat(this.values);this.project?this._tryProject(t):this.destination.next(t)}},t.prototype._tryProject=function(e){var t;try{t=this.project.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)},t}(H.a);function ee(e){return null!=e}n("vubp"),n("S1nX"),n("xMyE"),"undefined"==typeof Element||Element.prototype.closest||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});var te=function(){var e={Tab:9,Enter:13,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40};return e[e.Tab]="Tab",e[e.Enter]="Enter",e[e.Escape]="Escape",e[e.Space]="Space",e[e.PageUp]="PageUp",e[e.PageDown]="PageDown",e[e.End]="End",e[e.Home]="Home",e[e.ArrowLeft]="ArrowLeft",e[e.ArrowUp]="ArrowUp",e[e.ArrowRight]="ArrowRight",e[e.ArrowDown]="ArrowDown",e}();"undefined"!=typeof navigator&&navigator.userAgent&&navigator;var ne=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function ie(e){var t=Array.from(e.querySelectorAll(ne)).filter(function(e){return-1!==e.tabIndex});return[t[0],t[t.length-1]]}var oe=function(e,t,n){void 0===n&&(n=!1);var i=Object(N.a)(e,"focusin").pipe(Object(U.a)(t),Object(q.a)(function(e){return e.target}));Object(N.a)(e,"keydown").pipe(Object(U.a)(t),Object(Z.a)(function(e){return e.which===te.Tab}),J(i)).subscribe(function(t){var n=F(t,2),i=n[0],o=n[1],r=F(ie(e),2),a=r[0],s=r[1];o!==a&&o!==e||!i.shiftKey||(s.focus(),i.preventDefault()),o!==s||i.shiftKey||(a.focus(),i.preventDefault())}),n&&Object(N.a)(e,"click").pipe(Object(U.a)(t),J(i),Object(q.a)(function(e){return e[1]})).subscribe(function(e){return e.focus()})},re=function(){function e(){this.backdrop=!0,this.keyboard=!0}return e.ngInjectableDef=Object(o.kc)({factory:function(){return new e},token:e,providedIn:"root"}),e}(),ae=function(){return function(e,t,n){this.nodes=e,this.viewRef=t,this.componentRef=n}}(),se=function(){},le=function(){function e(e){this._document=e}return e.prototype.compensate=function(){return this._isPresent()?this._adjustBody(this._getWidth()):se},e.prototype._adjustBody=function(e){var t=this._document.body,n=t.style.paddingRight,i=parseFloat(window.getComputedStyle(t)["padding-right"]);return t.style["padding-right"]=i+e+"px",function(){return t.style["padding-right"]=n}},e.prototype._isPresent=function(){var e=this._document.body.getBoundingClientRect();return e.left+e.right<window.innerWidth},e.prototype._getWidth=function(){var e=this._document.createElement("div");e.className="modal-scrollbar-measure";var t=this._document.body;t.appendChild(e);var n=e.getBoundingClientRect().width-e.clientWidth;return t.removeChild(e),n},e.ngInjectableDef=Object(o.kc)({factory:function(){return new e(Object(o.lc)(X.c))},token:e,providedIn:"root"}),e}(),ce=function(){return function(){}}(),ue=function(){function e(){}return e.prototype.close=function(e){},e.prototype.dismiss=function(e){},e}(),he=function(){function e(e,t,n,i){var o=this;this._windowCmptRef=e,this._contentRef=t,this._backdropCmptRef=n,this._beforeDismiss=i,e.instance.dismissEvent.subscribe(function(e){o.dismiss(e)}),this.result=new Promise(function(e,t){o._resolve=e,o._reject=t}),this.result.then(null,function(){})}return Object.defineProperty(e.prototype,"componentInstance",{get:function(){if(this._contentRef.componentRef)return this._contentRef.componentRef.instance},enumerable:!0,configurable:!0}),e.prototype.close=function(e){this._windowCmptRef&&(this._resolve(e),this._removeModalElements())},e.prototype._dismiss=function(e){this._reject(e),this._removeModalElements()},e.prototype.dismiss=function(e){var t=this;if(this._windowCmptRef)if(this._beforeDismiss){var n=this._beforeDismiss();n&&n.then?n.then(function(n){!1!==n&&t._dismiss(e)},function(){}):!1!==n&&this._dismiss(e)}else this._dismiss(e)},e.prototype._removeModalElements=function(){var e=this._windowCmptRef.location.nativeElement;if(e.parentNode.removeChild(e),this._windowCmptRef.destroy(),this._backdropCmptRef){var t=this._backdropCmptRef.location.nativeElement;t.parentNode.removeChild(t),this._backdropCmptRef.destroy()}this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._backdropCmptRef=null,this._contentRef=null},e}(),de=function(){var e={BACKDROP_CLICK:0,ESC:1};return e[e.BACKDROP_CLICK]="BACKDROP_CLICK",e[e.ESC]="ESC",e}(),pe=function(){function e(e,t){this._document=e,this._elRef=t,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new o.t}return e.prototype.backdropClick=function(e){!0===this.backdrop&&this._elRef.nativeElement===e.target&&this.dismiss(de.BACKDROP_CLICK)},e.prototype.escKey=function(e){this.keyboard&&!e.defaultPrevented&&this.dismiss(de.ESC)},e.prototype.dismiss=function(e){this.dismissEvent.emit(e)},e.prototype.ngOnInit=function(){this._elWithFocus=this._document.activeElement},e.prototype.ngAfterViewInit=function(){if(!this._elRef.nativeElement.contains(document.activeElement)){var e=this._elRef.nativeElement.querySelector("[ngbAutofocus]"),t=ie(this._elRef.nativeElement)[0];(e||t||this._elRef.nativeElement).focus()}},e.prototype.ngOnDestroy=function(){var e=this._document.body,t=this._elWithFocus;(t&&t.focus&&e.contains(t)?t:e).focus(),this._elWithFocus=null},e}(),fe=function(){function e(e,t,n,i,o){var r=this;this._applicationRef=e,this._injector=t,this._document=n,this._scrollBar=i,this._rendererFactory=o,this._activeWindowCmptHasChanged=new V.a,this._ariaHiddenValues=new Map,this._backdropAttributes=["backdropClass"],this._modalRefs=[],this._windowAttributes=["ariaLabelledBy","backdrop","centered","keyboard","scrollable","size","windowClass"],this._windowCmpts=[],this._activeWindowCmptHasChanged.subscribe(function(){if(r._windowCmpts.length){var e=r._windowCmpts[r._windowCmpts.length-1];oe(e.location.nativeElement,r._activeWindowCmptHasChanged),r._revertAriaHidden(),r._setAriaHidden(e.location.nativeElement)}})}return e.prototype.open=function(e,t,n,i){var o=this,r=ee(i.container)?this._document.querySelector(i.container):this._document.body,a=this._rendererFactory.createRenderer(null,null),s=this._scrollBar.compensate(),l=function(){o._modalRefs.length||(a.removeClass(o._document.body,"modal-open"),o._revertAriaHidden())};if(!r)throw new Error('The specified modal container "'+(i.container||"body")+'" was not found in the DOM.');var c=new ue,u=this._getContentRef(e,i.injector||t,n,c,i),h=!1!==i.backdrop?this._attachBackdrop(e,r):null,d=this._attachWindowComponent(e,r,u),p=new he(d,u,h,i.beforeDismiss);return this._registerModalRef(p),this._registerWindowCmpt(d),p.result.then(s,s),p.result.then(l,l),c.close=function(e){p.close(e)},c.dismiss=function(e){p.dismiss(e)},this._applyWindowOptions(d.instance,i),1===this._modalRefs.length&&a.addClass(this._document.body,"modal-open"),h&&h.instance&&this._applyBackdropOptions(h.instance,i),p},e.prototype.dismissAll=function(e){this._modalRefs.forEach(function(t){return t.dismiss(e)})},e.prototype.hasOpenModals=function(){return this._modalRefs.length>0},e.prototype._attachBackdrop=function(e,t){var n=e.resolveComponentFactory(ce).create(this._injector);return this._applicationRef.attachView(n.hostView),t.appendChild(n.location.nativeElement),n},e.prototype._attachWindowComponent=function(e,t,n){var i=e.resolveComponentFactory(pe).create(this._injector,n.nodes);return this._applicationRef.attachView(i.hostView),t.appendChild(i.location.nativeElement),i},e.prototype._applyWindowOptions=function(e,t){this._windowAttributes.forEach(function(n){ee(t[n])&&(e[n]=t[n])})},e.prototype._applyBackdropOptions=function(e,t){this._backdropAttributes.forEach(function(n){ee(t[n])&&(e[n]=t[n])})},e.prototype._getContentRef=function(e,t,n,i,r){return n?n instanceof o.ab?this._createFromTemplateRef(n,i):"string"==typeof n?this._createFromString(n):this._createFromComponent(e,t,n,i,r):new ae([])},e.prototype._createFromTemplateRef=function(e,t){var n=e.createEmbeddedView({$implicit:t,close:function(e){t.close(e)},dismiss:function(e){t.dismiss(e)}});return this._applicationRef.attachView(n),new ae([n.rootNodes],n)},e.prototype._createFromString=function(e){var t=this._document.createTextNode(""+e);return new ae([[t]])},e.prototype._createFromComponent=function(e,t,n,i,r){var a=e.resolveComponentFactory(n),s=o.B.create({providers:[{provide:ue,useValue:i}],parent:t}),l=a.create(s),c=l.location.nativeElement;return r.scrollable&&c.classList.add("component-host-scrollable"),this._applicationRef.attachView(l.hostView),new ae([[c]],l.hostView,l)},e.prototype._setAriaHidden=function(e){var t=this,n=e.parentElement;n&&e!==this._document.body&&(Array.from(n.children).forEach(function(n){n!==e&&"SCRIPT"!==n.nodeName&&(t._ariaHiddenValues.set(n,n.getAttribute("aria-hidden")),n.setAttribute("aria-hidden","true"))}),this._setAriaHidden(n))},e.prototype._revertAriaHidden=function(){this._ariaHiddenValues.forEach(function(e,t){e?t.setAttribute("aria-hidden",e):t.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()},e.prototype._registerModalRef=function(e){var t=this,n=function(){var n=t._modalRefs.indexOf(e);n>-1&&t._modalRefs.splice(n,1)};this._modalRefs.push(e),e.result.then(n,n)},e.prototype._registerWindowCmpt=function(e){var t=this;this._windowCmpts.push(e),this._activeWindowCmptHasChanged.next(),e.onDestroy(function(){var n=t._windowCmpts.indexOf(e);n>-1&&(t._windowCmpts.splice(n,1),t._activeWindowCmptHasChanged.next())})},e.ngInjectableDef=Object(o.kc)({factory:function(){return new e(Object(o.lc)(o.g),Object(o.lc)(o.x),Object(o.lc)(X.c),Object(o.lc)(le),Object(o.lc)(o.S))},token:e,providedIn:"root"}),e}(),ge=function(){function e(e,t,n,i){this._moduleCFR=e,this._injector=t,this._modalStack=n,this._config=i}return e.prototype.open=function(e,t){void 0===t&&(t={});var n=Object.assign({},this._config,t);return this._modalStack.open(this._moduleCFR,this._injector,e,n)},e.prototype.dismissAll=function(e){this._modalStack.dismissAll(e)},e.prototype.hasOpenModals=function(){return this._modalStack.hasOpenModals()},e.ngInjectableDef=Object(o.kc)({factory:function(){return new e(Object(o.lc)(o.m),Object(o.lc)(o.x),Object(o.lc)(fe),Object(o.lc)(re))},token:e,providedIn:"root"}),e}(),me=o.Ib({encapsulation:2,styles:[["#knowing-board{min-width:0;overflow:overlay!important}"]],data:{}});function ye(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,1,"section",[["id","scene"]],null,null,null,null,null)),(e()(),o.Kb(1,0,null,null,0,"div",[["id","knowing-board"]],null,null,null,null,null))],null,null)}function be(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,1,"app-canvas-board",[],null,null,null,ye,me)),o.Jb(1,114688,null,0,l,[ge],null,null)],function(e,t){e(t,1,0)},null)}var ve=o.Gb("app-canvas-board",l,be,{},{},[]),we=o.Ib({encapsulation:0,styles:[[""]],data:{}});function xe(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,1,"h2",[],null,null,null,null,null)),(e()(),o.ec(-1,null,[" math works!\n"]))],null,null)}function Ce(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,1,"app-math",[],null,null,null,xe,we)),o.Jb(1,114688,null,0,c,[],null,null)],function(e,t){e(t,1,0)},null)}var ke=o.Gb("app-math",c,Ce,{},{},[]),Te=o.Ib({encapsulation:2,styles:[["#counting-lessonCanvas{overflow:overlay!important;width:100%!important;height:100%!important}"]],data:{}});function Pe(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,1,"section",[["id","board"]],null,null,null,null,null)),(e()(),o.Kb(1,0,null,null,0,"div",[["id","counting-lesson"]],null,null,null,null,null))],null,null)}function Oe(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,1,"app-lesson",[],null,null,null,Pe,Te)),o.Jb(1,114688,null,0,O,[P,ge],null,null)],function(e,t){e(t,1,0)},null)}var Ae,Se,Ie=o.Gb("app-lesson",O,Oe,{},{},[]),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(u.b)(t,e),Object.defineProperty(t.prototype,"gameWidth",{get:function(){return this.sys.game.config.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gameHeight",{get:function(){return this.sys.game.config.height},enumerable:!0,configurable:!0}),t.prototype.setView=function(){this.cameras.main.centerOn(0,0)},t}(Phaser.Scene),Me=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.name=t.Name,n}return Object(u.b)(t,e),t.prototype.create=function(){console.log("Boot"),this.scene.start("Preloader")},t.Name="Boot",t}(Ee),Be=n("vC38"),ze=function(){function e(){}return e.GAME_SCALE=1,e.CALCULATED_WIDTH=0,e.CALCULATED_HEIGHT=0,e.GAME_WIDTH=800,e.GAME_HEIGHT=600,e.SAVE_KEY="languages_game_save",e.SPONSOR_ASSOCIATION="",e.GAME_KEY="64512ec40a7abc77a9e10de091ac9d6a",e.SECRET_KEY="a5a926b1a0f140b149e20f2e206ccd03cdf0179a",e.GOOGLE_ID="UA-78960661-2",e.GOOGLE_APP_NAME="Knowing",e}(),je=function(){return function(){this.musicOn=!0,this.soundOn=!0}}(),_e=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.name=t.Name,n}return Object(u.b)(t,e),t.prototype.init=function(e){this.settingsRef=e.mySettings,this.language=e.language},t.prototype.create=function(){console.log("Preloader"),this.scene.start("Menu");var e=this;Be.e.load(ze.SAVE_KEY).then(function(t){null!=t?(e.settingsRef=t,console.log("Settings loaded...")):console.log("No saved settings."),e.scene.start("Menu")})},t.prototype.preload=function(){console.log("Loading assets..."),this.load.atlas("Sprites","assets/sprites/Sprites.png","assets/sprites/Sprites.json"),this.load.json("Dictionary","assets/words/"+this.language+"_words.json")},t.Name="Preloader",t}(Ee),De=function(e){return e[e.NONE=0]="NONE",e[e.EDGI=1]="EDGI",e[e.FACEBOOK=2]="FACEBOOK",e}({}),Le=function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}l((i=i.apply(e,t||[])).next())})},Ye=function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},Re=function(){function e(t){this._features=null,this._game=null,e._instance=this,this._features=t,Ae=this,Se=t.id}return Object.defineProperty(e,"instance",{get:function(){if(null==e._instance)throw new Error("Sponsor is "+e._instance+". Sponsor must be always initialized.");return e._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e,"initialized",{get:function(){return null!=e._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.features.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"features",{get:function(){return this._features},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"game",{set:function(e){this._game=e},enumerable:!0,configurable:!0}),e.prototype.startGameSession=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Le(this,void 0,void 0,function(){return Ye(this,function(t){return console.log("Sponsor "+De[this.id]+": startGameSession() with parameters "+e),[2]})})},e.prototype.endGameSession=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Le(this,void 0,void 0,function(){return Ye(this,function(t){return console.log("Sponsor "+De[this.id]+": endGameSession() with parameters "+e),[2]})})},e.prototype.submitScore=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Le(this,void 0,void 0,function(){return Ye(this,function(t){return console.log("Sponsor "+De[this.id]+": submitScore() with parameters "+e),[2]})})},e.prototype.showAd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Le(this,void 0,void 0,function(){return Ye(this,function(t){return console.log("Sponsor "+De[this.id]+": showAd() with parameters "+e),[2]})})},e._instance=null,e}(),Xe=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.name=t.Name,n}return Object(u.b)(t,e),t.prototype.init=function(e){this.settingsRef=e.mySettings,this.language=e.language},t.prototype.create=function(){console.log("Menu"),this.cameras.main.backgroundColor=Phaser.Display.Color.ValueToColor(16777215),this.setView(),this.addMessage(this),this.addActionButtons()},t.prototype.addAudioControls=function(){var e=-this.gameHeight/2+50,t=this.add.sprite(-40,e,"Sprites",this.settingsRef.soundOn?"IconSoundOn":"IconSoundOff");t.setInteractive(),t.on("pointerdown",function(){this.settingsRef.soundOn=!this.settingsRef.soundOn,t.setFrame(this.settingsRef.soundOn?"IconSoundOn":"IconSoundOff"),this.saveSettings()},this);var n=this.add.sprite(40,e,"Sprites",this.settingsRef.musicOn?"IconMusicOn":"IconMusicOff");n.setInteractive(),n.on("pointerdown",function(){this.settingsRef.musicOn=!this.settingsRef.musicOn,n.setFrame(this.settingsRef.musicOn?"IconMusicOn":"IconMusicOff"),this.saveSettings()},this)},t.prototype.saveSettings=function(){Be.e.save(ze.SAVE_KEY,this.settingsRef).then(function(){console.log("Settings saved...")}).catch(function(e){console.log(e)})},t.prototype.addPlayButton=function(){var e=this.add.sprite(0,0,"Sprites","IconPlay");e.setInteractive(),e.on("pointerdown",function(){this.startGame()},this)},t.prototype.startGame=function(){var e=this;Ae.startGameSession().then(function(){e.scene.start("Finish")})},t.prototype.addMessage=function(e){this.title=e.make.text({x:20,y:-120,text:"Learn "+this.language,style:{font:"bold 72px Gotham",fill:"#ffcc00",align:"center",wordWrap:{width:200}}}),this.message=e.make.text({x:5,y:10,text:"Complete each exercise to know the language better",style:{font:"22px Gotham",fill:"#999999",align:"center",wordWrap:{width:370}}}),this.message.setOrigin(.5,.5),this.title.setOrigin(.5,.5)},t.prototype.addActionButtons=function(){var e=this,t=this.plugins.get("rexButton"),n=this.rexUI.add.roundRectangle(10,130,300,70,20,7401244),i=this.add.text(10,130,"START",{fill:"#ffffff",font:"bold 25px Gotham"}).setOrigin(.5,.5),o=t.add(n,{});return o.on("click",function(t){e.startGame()}),o.on("button.over",function(e){console.log("overed")}),[n,i]},t.Name="Menu",t}(Ee),We=function(){function e(e,t,n,i,o,r,a){this.count=0,this.colour=15694848,this.backgroundColour=14606046,this.steps=10,this.highlightColour=16758117,r&&(this.colour=r),a&&(this.steps=a),this.container=e.add.graphics(),this.bar=e.add.graphics(),this.highlight=e.add.graphics(),this.scene=e,this.bar.fillStyle(this.colour,1),this.highlight.fillStyle(this.highlightColour,1),this.barWidth=n,this.barHeight=i,this.barCorner=o,this.configObj=t,this.container.fillStyle(this.backgroundColour,.8),this.container.fillRoundedRect(t.x,t.y,n,i,o),this.infoText()}return e.prototype.increaseCount=function(){return this.count<this.barWidth?(this.count>=.25*this.barWidth&&(this.progressText.destroy(),this.infoText("GOOD!"),this.bar.fillStyle(15714816,1),this.highlight.fillStyle(16639330,1)),this.count>=.75*this.barWidth&&(this.progressText.destroy(),this.infoText("ALMOST DONE!"),this.bar.fillStyle(7401244,1),this.highlight.fillStyle(10747775,1)),this.count=this.count+1/this.steps*this.barWidth,this.bar.fillRoundedRect(this.configObj.x,this.configObj.y,this.count,this.barHeight,this.barCorner),this.highlight.fillRoundedRect(this.configObj.x+10,this.configObj.y+5,this.count/1.3,this.barHeight/4,this.barCorner/3),this.count>=1*this.barWidth&&(this.progressText.destroy(),this.infoText("SUCCESS!"))):(console.log(this.count),this.count=0,this.bar.clear(),this.progressText.destroy(),this.infoText(),this.bar.fillStyle(this.colour,1),this.highlight.fillStyle(this.highlightColour,1)),this},e.prototype.removeFromScene=function(){this.container.destroy(),this.bar.destroy(),this.progressText.destroy()},e.prototype.infoText=function(e){var t=1.2;return e?(this.text=e,"ALMOST DONE!"===this.text&&(t=1.4)):this.text="START...",this.progressText=this.scene.make.text({x:this.configObj.x/t,y:this.configObj.y/2-140,text:this.text,style:{font:"14px Gotham",fill:"#858585"}}),this.progressText.setOrigin(.5,.5),this},e}(),Fe={setEventEmitter:function(e,t){return void 0===t&&(t=Phaser.Events.EventEmitter),this._privateEE=void 0===e,this._eventEmitter=this._privateEE?new t:e,this},destroyEventEmitter:function(){this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown()},getEventEmitter:function(){return this._eventEmitter},on:function(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function(){return this._eventEmitter&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]}},Ve=Phaser.Scene,Ne=function(e){return e instanceof Ve},Ge=function(e){return Ne(e)?e:e.scene&&Ne(e.scene)?e.scene:e.parent&&e.parent.scene&&Ne(e.parent.scene)?e.parent.scene:void 0},He=Phaser.Utils.Objects.GetValue,Ke=function(){function e(e,t){this.gameObject=e,this.scene=Ge(e),this.setEventEmitter(He(t,"eventEmitter",void 0)),e.setInteractive(He(t,"inputConfig",void 0)),this.resetFromJSON(t),this.boot()}return e.prototype.resetFromJSON=function(e){return this.pointer=void 0,this.lastClickTime=void 0,this.setEnable(He(e,"enable",!0)),this.setMode(He(e,"mode",1)),this.setClickInterval(He(e,"clickInterval",100)),this.setDragThreshold(He(e,"threshold",void 0)),this},e.prototype.boot=function(){this.gameObject.on("pointerdown",this.onPress,this),this.gameObject.on("pointerup",this.onRelease,this),this.gameObject.on("pointerout",this.onPointOut,this),this.gameObject.on("pointermove",this.onMove,this),this.gameObject.once("destroy",this.destroy,this)},e.prototype.shutdown=function(){this.destroyEventEmitter(),this.pointer=void 0,this.gameObject=void 0,this.scene=void 0},e.prototype.destroy=function(){this.shutdown()},e.prototype.setEnable=function(e){return void 0===e&&(e=!0),this.enable===e?this:(e||this.cancel(),this.enable=e,this.gameObject.input.enabled=e,this)},e.prototype.setMode=function(e){return"string"==typeof e&&(e=Ue[e]),this.mode=e,this},e.prototype.setClickInterval=function(e){return this.clickInterval=e,this},e.prototype.setDragThreshold=function(e){return this.dragThreshold=e,this},e.prototype.onPress=function(e){void 0===this.pointer&&(this.pointer=e,0===this.mode&&this.click(e.downTime,e))},e.prototype.onRelease=function(e){this.pointer===e&&(1===this.mode&&this.click(e.upTime,e),this.pointer=void 0)},e.prototype.onPointOut=function(e){this.pointer===e&&this.cancel()},e.prototype.onMove=function(e){this.pointer===e&&void 0!==this.dragThreshold&&e.getDistance()>=this.dragThreshold&&this.cancel()},e.prototype.click=function(e,t){if(void 0===e)return this.emit("click",this,this.gameObject,t),this;this.pointer=void 0;var n=this.lastClickTime;return void 0!==n&&e-n<=this.clickInterval?this:(this.lastClickTime=e,this.emit("click",this,this.gameObject,t),this)},e.prototype.cancel=function(){return this.pointer=void 0,this},e}();Object.assign(Ke.prototype,Fe);var qe,Ue={press:0,pointerdown:0,release:1,pointerup:1},Ze=Ke,Je=Ze,$e=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Qe=function(e){function t(t){return e.call(this,t)||this}return $e(t,e),t.prototype.start=function(){this.game.events.once("destroy",this.destroy,this)},t.prototype.add=function(e,t){return new Je(e,t)},t}(Phaser.Plugins.BasePlugin),et=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),tt=Phaser.GameObjects.RenderTexture,nt=Phaser.Utils.Objects.GetValue,it=Phaser.Math.Distance.Between,ot=Phaser.Math.Angle.Between,rt=function(e){function t(t,n){var i=this,o=nt(n,"start",void 0),r=nt(n,"end",void 0),a=nt(n,"body",void 0);return(i=e.call(this,t)||this).setOrigin(0,.5).setLineStartPosition(nt(o,"x",0),nt(o,"y",0)).setLineEndPosition(nt(r,"x",0),nt(r,"y",0)).setLineStartTexture(nt(o,"key",o),nt(o,"frame",void 0)).setLineEndTexture(nt(r,"key",r),nt(r,"frame",void 0)).setLineBodyTexture(nt(a,"key",a),nt(a,"frame",void 0),nt(a,"width",void 0)),i}return et(t,e),Object.defineProperty(t.prototype,"x0",{get:function(){return this._x0},set:function(e){this._x0!==e&&(this.redraw=!0),this._x0=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y0",{get:function(){return this._y0},set:function(e){this._y0!==e&&(this.redraw=!0),this._y0=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x1",{get:function(){return this._x1},set:function(e){this._x1!==e&&(this.redraw=!0),this._x1=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y1",{get:function(){return this._y1},set:function(e){this._y1!==e&&(this.redraw=!0),this._y1=e},enumerable:!0,configurable:!0}),t.prototype.setLineStartPosition=function(e,t){return this.x0=e,this.y0=t,this},t.prototype.setLineEndPosition=function(e,t){return this.x1=e,this.y1=t,this},t.prototype.setLineStartTexture=function(e,t){return this.lineStartTexture=e,this.lineStartFrameName=t,this.redraw=!0,this},t.prototype.setLineEndTexture=function(e,t){return this.lineEndTexture=e,this.lineEndFrameName=t,this.redraw=!0,this},t.prototype.setLineBodyTexture=function(e,t,n){return this.lineBodyTexture=e,this.lineBodyFrameName=t,this.lineBodyWidth=n,this.redraw=!0,this},t.prototype.updateLineTexture=function(){if(!this.redraw)return this;this.redraw=!1,this.clear();var e=this.scene.textures.getFrame(this.lineStartTexture,this.lineStartFrameName),t=this.scene.textures.getFrame(this.lineEndTexture,this.lineEndFrameName),n=this.scene.textures.getFrame(this.lineBodyTexture,this.lineBodyFrameName),i=it(this.x0,this.y0,this.x1,this.y1),o=0,r=ot(this.x0,this.y0,this.x1,this.y1);if(e&&(o=e.cutHeight),t&&(o=Math.max(o,t.cutHeight)),n){var a=void 0!==this.lineBodyWidth?this.lineBodyWidth:n.cutHieght;o=Math.max(o,a)}if(0===i||0===o)return this.setPosition(this.x0,this.y0).setSize(1,1).setRotation(r),this;this.setPosition(this.x0,this.y0).setSize(i,o).setRotation(r);var s=this.width;return e&&(this.drawFrame(this.lineStartTexture,this.lineStartFrameName,0,(this.height-e.cutHeight)/2),s-=e.cutWidth),t&&(this.drawFrame(this.lineEndTexture,this.lineEndFrameName,this.width-t.cutWidth,(this.height-t.cutHeight)/2),s-=t.cutWidth),n&&(qe||(qe=this.scene.make.tileSprite({add:!1,origin:{x:0,y:0}})),qe.setSize(s,a).setTexture(this.lineBodyTexture,this.lineBodyFrameName),this.draw(qe,e?e.cutWidth:0,(this.height-qe.height)/2)),this},t.prototype.renderWebGL=function(t,n,i,o,r){this.updateLineTexture(),e.prototype.renderWebGL.call(this,t,n,i,o,r)},t.prototype.renderCanvas=function(t,n,i,o,r){this.updateLineTexture(),e.prototype.renderCanvas.call(this,t,n,i,o,r)},t}(tt),at=function(e){var t=new rt(this.scene,e);return this.scene.add.existing(t),t},st=Phaser.GameObjects.BuildGameObject,lt=function(e,t){void 0!==t&&(e.add=t);var n=new rt(this.scene,e);return st(this.scene,n,e),n},ct=function(e){return null==e||""===e||0===e.length},ut=function(e,t,n){if("object"==typeof e)if(ct(t)){if(null==n)return;"object"==typeof n&&(e=n)}else{"string"==typeof t&&(t=t.split("."));var i=t.pop();(function(e,t,n){void 0===n&&(n={});var i=e;if(ct(t));else{var o;"string"==typeof t&&(t=t.split("."));for(var r=0,a=t.length;r<a;r++)null!=i[o=t[r]]&&"object"==typeof i[o]||(i[o]=r===a-1?n:{}),i=i[o]}return i}(e,t))[i]=n}},ht=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),dt=function(e){function t(t){var n=e.call(this,t)||this;return t.registerGameObject("rexLine",at,lt),n}return ht(t,e),t.prototype.start=function(){this.game.events.once("destroy",this.destroy,this)},t}(Phaser.Plugins.BasePlugin);ut(window,"RexPlugins.GameObjects.Line",rt);var pt=dt,ft=function(e,t,n,i,o){void 0===n&&(n=10),void 0===i&&(i=.5),void 0===o&&(o=16777215),e.add.graphics().fillStyle(o).fillRect(0,0,n*i,2).generateTexture(t,n,2).destroy()},gt=Math.sqrt(3),mt=Math.sqrt(3),yt={},bt={},vt={},wt={},xt={},Ct=n("abzJ"),kt=n.n(Ct),Tt=function(){function e(e){this.resetFromJSON(e)}return e.prototype.resetFromJSON=function(e){if(this.setType(kt()(e,"staggeraxis",1),kt()(e,"staggerindex",1)),this.setDirectionMode(),this.setOriginPosition(kt()(e,"x",0),kt()(e,"y",0)),this.size=kt()(e,"size",void 0),void 0!==this.size){var t={size:this.size,type:this.staggeraxis},n=function(e){return 0===e.type?2*e.size:gt*e.size}(t),i=function(e){return 0===e.type?mt*e.size:2*e.size}(t);this.setCellSize(n,i)}else this.setCellSize(kt()(e,"cellWidth",0),kt()(e,"cellHeight",0))},e.prototype.setType=function(e,t){return"string"==typeof e&&(e=Pt[e]),"string"==typeof t&&(t=Ot[t]),this.staggeraxis=e,this.staggerindex=t,this.mode=0===e?0===t?3:2:0===t?1:0,this},e.prototype.setDirectionMode=function(){return this.directions=6,this},e.prototype.setOriginPosition=function(e,t){return this.x=e,this.y=t,this},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this._halfWidth=e/2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this._halfHeight=e/2},enumerable:!0,configurable:!0}),e.prototype.setCellSize=function(e,t){return this.width=e,this.height=t,this},Object.defineProperty(e.prototype,"cellWidth",{get:function(){return this.width},set:function(e){this.width=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellHeight",{get:function(){return this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellHieght",{set:function(e){this.height=e},enumerable:!0,configurable:!0}),e}();Object.assign(Tt.prototype,{getWorldXY:function(e,t,n){void 0===n?n={}:!0===n&&(n=yt);var i=e*this.width,o=t*this.height;switch(this.mode){case 0:1&t&&(i+=this._halfWidth),o*=.75;break;case 1:1&t&&(i-=this._halfWidth),o*=.75;break;case 2:i*=.75,1&e&&(o+=this._halfHeight);break;case 3:i*=.75,1&e&&(o-=this._halfHeight)}return o+=this.y,n.x=i+=this.x,n.y=o,n},getWorldX:function(e,t){return this.getWorldXY(e,t,!0).x},getWorldY:function(e,t){return this.getWorldXY(e,t,!0).y},getTileXY:function(e,t,n){var i,o;switch(void 0===n?n={}:!0===n&&(n=xt),e-=this.x,t-=this.y,this.mode){case 0:case 1:o=t*(4/3)/this.height,i=e/this.width-2/3*(t/this.height);break;case 2:case 3:o=t/this.height-2/3*(e/this.width),i=e*(4/3)/this.width}var r=function(e,t,n){return void 0===n?n={}:!0===n&&(n=bt),n.x=e,n.y=-e-t,n.z=t,n}(i,o,wt);return function(e,t,n,i){"number"!=typeof e&&(e=(i=e).x,t=i.y,n=i.z),void 0===i?i={}:!0===i&&(i=bt);var o=Math.round(e),r=Math.round(t),a=Math.round(n),s=Math.abs(o-e),l=Math.abs(r-t),c=Math.abs(a-n);s>l&&s>c?o=-r-a:l>c?r=-o-a:a=-o-r,i.x=o,i.y=r,i.z=a}(r),function(e,t,n,i,o){switch(void 0===o?o={}:!0===o&&(o=vt),e){case 0:o.x=t+(i-(1&i))/2,o.y=i;break;case 1:o.x=t+(i+(1&i))/2,o.y=i;break;case 2:o.x=t,o.y=i+(t-(1&t))/2;break;case 3:o.x=t,o.y=i+(t+(1&t))/2}}(this.mode,r.x,0,r.z,n),n},getTileX:function(e,t){return this.getTileXY(e,t,!0).x},getTileY:function(e,t){return this.getTileXY(e,t,!0).y}});var Pt={y:0,x:1},Ot={even:0,odd:1},At=Tt,St=function(){},It=new Phaser.GameObjects.Zone({sys:{queueDepthSort:St,events:{once:St}}},0,0,1,1);It.setOrigin(0);var Et=It,Mt=Phaser.Display.Align.In.QuickSet,Bt=Phaser.Utils.Objects.GetFastValue,zt=new At,jt={},_t={},Dt=function(){function e(e){this.resetFromJSON(e)}return e.prototype.resetFromJSON=function(e){this.setType(kt()(e,"type",0)),this.setDirectionMode(kt()(e,"dir",4)),this.setOriginPosition(kt()(e,"x",0),kt()(e,"y",0)),this.setCellSize(kt()(e,"cellWidth",0),kt()(e,"cellHeight",0))},e.prototype.setType=function(e){return"string"==typeof e&&(e=Lt[e]),this.mode=e,this},e.prototype.setDirectionMode=function(e){return"string"==typeof e&&(e=Yt[e]),this.directions=e,this},e.prototype.setOriginPosition=function(e,t){return this.x=e,this.y=t,this},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this._halfWidth=e/2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this._halfHeight=e/2},enumerable:!0,configurable:!0}),e.prototype.setCellSize=function(e,t){return this.width=e,this.height=t,this},Object.defineProperty(e.prototype,"cellWidth",{get:function(){return this.width},set:function(e){this.width=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellHeight",{get:function(){return this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellHieght",{set:function(e){this.height=e},enumerable:!0,configurable:!0}),e}();Object.assign(Dt.prototype,{getWorldXY:function(e,t,n){var i,o;switch(void 0===n?n={}:!0===n&&(n=jt),this.mode){case 0:i=e*this.width,o=t*this.height;break;case 1:i=(e-t)*this._halfWidth,o=(e+t)*this._halfHeight}return o+=this.y,n.x=i+=this.x,n.y=o,n},getWorldX:function(e,t){return this.getWorldXY(e,t,!0).x},getWorldY:function(e,t){return this.getWorldXY(e,t,!0).y},getTileXY:function(e,t,n){void 0===n?n={}:!0===n&&(n=_t);var i=(e-=this.x)/this.width,o=(t-=this.y)/this.height;switch(this.mode){case 0:n.x=Math.round(i),n.y=Math.round(o);break;case 1:n.x=Math.round(+i+o),n.y=Math.round(-i+o)}return n},getTileX:function(e,t){return this.getTileXY(e,t,!0).x},getTileY:function(e,t){return this.getTileXY(e,t,!0).y}});var Lt={orthogonal:0,isometric:1,staggered:2},Yt={"4dir":4,"8dir":8},Rt=Phaser.Display.Align.In.QuickSet,Xt=Phaser.Utils.Objects.GetFastValue,Wt=new Dt,Ft=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Vt=function(e){function t(t){return e.call(this,t)||this}return Ft(t,e),t.prototype.start=function(){this.game.events.once("destroy",this.destroy,this)},t.prototype.hexagon=function(e,t){return function(e,t){void 0===t&&(t={});var n=Bt(t,"width",-1),i=Bt(t,"height",-1),o=Bt(t,"cellWidth",1),r=Bt(t,"cellHeight",o),a=Bt(t,"staggeraxis",1),s=Bt(t,"staggerindex",1),l=Bt(t,"position",Phaser.Display.Align.CENTER),c=Bt(t,"x",0),u=Bt(t,"y",0);zt.setOriginPosition(c,u).setCellSize(o,r).setType(a,s),Et.setSize(o,r);for(var h=i-1,d=n-1,p=0,f=0,g=0,m=e.length;g<m;g++)if(zt.getWorldXY(f,p,Et),Mt(e[g],Et,l),-1===n)p++;else if(-1===i)f++;else if(f===d){if(p===h)break;f=0,p++}else f++;return e}(e,t)},t.prototype.quad=function(e,t){return function(e,t){void 0===t&&(t={});var n=Xt(t,"width",-1),i=Xt(t,"height",-1),o=Xt(t,"cellWidth",1),r=Xt(t,"cellHeight",o),a=Xt(t,"type",0),s=Xt(t,"position",Phaser.Display.Align.CENTER),l=Xt(t,"x",0),c=Xt(t,"y",0);Wt.setOriginPosition(l,c).setCellSize(o,r).setType(a),Et.setSize(o,r);for(var u=i-1,h=n-1,d=0,p=0,f=0,g=e.length;f<g;f++)if(Wt.getWorldXY(p,d,Et),Rt(e[f],Et,s),-1===n)d++;else if(-1===i)p++;else if(p===h){if(d===u)break;p=0,d++}else p++;return e}(e,t)},t}(Phaser.Plugins.BasePlugin),Nt=function(e,t,n){for(var i,o=e.points,r=0,a=o.length;r<a;r++)(i=o[r]).x+=t,i.y+=n;return e},Gt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ht=Phaser.Geom.Polygon,Kt=Phaser.Utils.Objects.IsPlainObject,qt=Phaser.Utils.Objects.GetValue,Ut=Phaser.Geom.Line,Zt=function(e){function t(t,n,i,o){var r=e.call(this)||this;if(Kt(t)){var a=t;t=qt(a,"x",0),n=qt(a,"y",0),i=qt(a,"width",0),o=qt(a,"height",0)}for(var s=r.points,l=0;l<4;l++)s.push({});return r.setTo(t,n,i,o),r}return Gt(t,e),t.prototype.setTo=function(e,t,n,i){this._x=e,this._y=t,this._width=n,this._height=i;var o=this.points,r=this.centerX,a=this.centerY,s=n/2,l=i/2;return o[0].x=r+s,o[0].y=a,o[1].x=r,o[1].y=a+l,o[2].x=r-s,o[2].y=a,o[3].x=r,o[3].y=a-l,this.calculateArea(),this},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(e){var t=e-this.x;0!==t&&(Nt(this,t,0),this._x=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(e){var t=e-this.y;0!==t&&(Nt(this,0,t),this._y=e)},enumerable:!0,configurable:!0}),t.prototype.setPosition=function(e,t){var n=e-this.x,i=t-this.y;return 0===n&&0===i?this:(Nt(this,n,i),this._x=e,this._y=t,this)},Object.defineProperty(t.prototype,"left",{get:function(){return this.x},set:function(e){this.x+=e-this.left},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},set:function(e){this.x+=e-this.right},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},set:function(e){this.y+=e-this.top},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},set:function(e){this.y+=e-this.bottom},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"centerX",{get:function(){return this.x+this.width/2},set:function(e){this.x+=e-this.centerX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"centerY",{get:function(){return this.y+this.height/2},set:function(e){this.y+=e-this.centetY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this.setTo(this._x,this._y,e,this._height)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this.setTo(this._x,this._y,this._width,e)},enumerable:!0,configurable:!0}),t.prototype.setSize=function(e,t){return this.setTo(this._x,this._y,e,t),this},t.prototype.isEmpty=function(){return this.width<=0||this.height<=0},t.prototype.getEdge=function(e,t){void 0===t&&(t=new Ut);var n=this.points[e],i=this.points[(e+1)%4];return t.setTo(n.x,n.y,i.x,i.y),t},t.prototype.getLineA=function(e){return this.getEdge(0,e)},t.prototype.getLineB=function(e){return this.getEdge(1,e)},t.prototype.getLineC=function(e){return this.getEdge(2,e)},t.prototype.getLineD=function(e){return this.getEdge(3,e)},t}(Ht);Phaser.Geom.rexRhombus=Zt;var Jt=Zt,$t=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Qt=function(e){function t(t){return e.call(this,t)||this}return $t(t,e),t.prototype.start=function(){this.game.events.once("destroy",this.destroy,this)},t.prototype.add=function(e,t,n,i){return new Jt(e,t,n,i)},t}(Phaser.Plugins.BasePlugin),en={add:function(e){return Array.isArray(e)?this.addMultiple(e):this._add(e),this},addMultiple:function(e){return e.forEach(this._add,this),this},_add:function(e){return this.children.add(e),this.resetChildState(e).updateChildVisible(e).updateChildActive(e).updateChildScrollFactor(e).updateChildMask(e),this}},tn=Phaser.Math.RotateAround,nn={worldToLocal:function(e){return e.x-=this.x,e.y-=this.y,tn(e,0,0,-this.rotation),e.x/=this.scaleX,e.y/=this.scaleY,e.x*=this.flipX?-1:1,e.y*=this.flipY?-1:1,e},localToWorld:function(e){return e.x*=this.flipX?-1:1,e.y*=this.flipY?-1:1,e.x*=this.scaleX,e.y*=this.scaleY,tn(e,0,0,this.rotation),e.x+=this.x,e.y+=this.y,e}},on=function(e,t){return e===t?1:e/t},rn={updateChildPosition:function(e){e.isRexContainerLite&&(e.syncChildrenEnable=!1);var t=this.getLocalState(e);return e.x=t.x,e.y=t.y,this.localToWorld(e),e.scaleX=t.scaleX*this.scaleX,e.scaleY=t.scaleY*this.scaleY,void 0!==e.flipX&&(e.flipX=this.flipX?!t.flipX:t.flipX,e.flipY=this.flipY?!t.flipY:t.flipY),e.rotation=t.rotation+this.rotation,e.isRexContainerLite&&(e.syncChildrenEnable=!0,e.syncPosition()),this},syncPosition:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildPosition,this),this},resetChildPositionState:function(e){var t=this.getLocalState(e);return t.x=e.x,t.y=e.y,this.worldToLocal(t),t.scaleX=on(e.scaleX,this.scaleX),t.scaleY=on(e.scaleY,this.scaleY),void 0!==e.flipX&&(t.flipX=e.flipX,t.flipY=e.flipY),t.rotation=e.rotation-this.rotation,this},setChildPosition:function(e,t,n){return e.x=t,e.y=n,this.resetChildPositionState(e),this},setChildLocalPosition:function(e,t,n){var i=this.getLocalState(e);return i.x=t,i.y=n,this.updateChildPosition(e),this}},an={updateChildAlpha:function(e){return e.alpha=this.alpha*this.getLocalState(e).alpha,this},syncAlpha:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildAlpha,this),this},resetChildAlphaState:function(e){return this.getLocalState(e).alpha=on(e.alpha,this.alpha),this},setChildAlpha:function(e,t){return e.alpha=t,this.resetChildAlphaState(e),this._add},setChildLocalAlpha:function(e,t){return this.getLocalState(e).alpha=t,this.updateChildAlpha(e),this}},sn=Phaser.Utils.Array,ln={getChildren:function(){return this.children.getChildren()},getAllChildren:function(e){void 0===e&&(e=[]);for(var t,n=this.children.getChildren(),i=0,o=n.length;i<o;i++)e.push(t=n[i]),t.hasOwnProperty("isRexContainerLite")&&e.push.apply(e,t.getAllChildren());return e},contains:function(e){if(this.children.contains(e))return!0;for(var t,n=this.children.getChildren(),i=0,o=n.length;i<o;i++)if((t=n[i]).isRexContainerLite&&t.contains(e))return!0;return!1},getByName:function(e){return sn.GetFirst(this.list,"name",e)},getRandom:function(e,t){return sn.GetRandom(this.list,e,t)},getFirst:function(e,t,n,i){return sn.GetFirstElement(this.list,e,t,n,i)},getAll:function(e,t,n,i){return sn.GetAll(this.list,e,t,n,i)},count:function(e,t,n,i){return sn.CountAllMatching(this.list,e,t,n,i)},swap:function(e,t){return sn.Swap(this.list,e,t),this},moveTo:function(e,t){return sn.MoveTo(this.list,e,t),this},setAll:function(e,t,n,i){return sn.SetAll(this.list,e,t,n,i),this}},cn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),un=Phaser.GameObjects.Zone,hn=Phaser.GameObjects.Components,dn=function(e){function t(t,n,i,o,r,a){var s=this;return Array.isArray(o)&&(a=o,o=void 0),void 0===o&&(o=1),void 0===r&&(r=1),(s=e.call(this,t,n,i,o,r)||this).children=t.add.group(),s.type="rexContainerLite",s.isRexContainerLite=!0,s.syncChildrenEnable=!0,s._flipX=!1,s._flipY=!1,s._alpha=1,s._active=!0,s._mask=null,s._scrollFactorX=1,s._scrollFactorY=1,a&&s.add(a),s}return cn(t,e),t.prototype.destroy=function(t){this.scene&&(this.children.destroy(!t),this.children=void 0,e.prototype.destroy.call(this,t))},t.prototype.resize=function(e,t){return this.setSize(e,t),this},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.syncPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.syncPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return e.prototype.rotation},set:function(t){this.rotation!==t&&(e.prototype.rotation=t,this.syncPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleX",{get:function(){return e.prototype.scaleX},set:function(t){this.scaleX!==t&&(e.prototype.scaleX=t,this.syncPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleY",{get:function(){return e.prototype.scaleY},set:function(t){this.scaleY!==t&&(e.prototype.scaleY=t,this.syncPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"flipX",{get:function(){return this._flipX},set:function(e){this._flipX!==e&&(this._flipX=e,this.syncPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"flipY",{get:function(){return this._flipY},set:function(e){this._flipY!==e&&(this._flipY=e,this.syncPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return e.prototype.visible},set:function(t){this.visible!==t&&(e.prototype.visible=t,this.syncVisible())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha!==e&&(this._alpha=e,this.syncAlpha())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"active",{get:function(){return this._active},set:function(e){this._active!==e&&(this._active=e,this.syncActive())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},set:function(e){this._mask!==e&&(this._mask=e,this.syncMask())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollFactorX",{get:function(){return this._scrollFactorX},set:function(e){this._scrollFactorX!==e&&(this._scrollFactorX=e,this.syncScrollFactor())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollFactorY",{get:function(){return this._scrollFactorY},set:function(e){this._scrollFactorY!==e&&(this._scrollFactorY=e,this.syncScrollFactor())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"list",{get:function(){return this.children.getChildren()},enumerable:!0,configurable:!0}),t}(un);Object.assign(dn.prototype,en,{remove:function(e,t){return this.children.remove(e,!1,t),this},clear:function(e){return this.children.clear(!1,e),this}},{getLocalState:function(e){return e.hasOwnProperty("rexContainer")||(e.rexContainer={}),e.rexContainer},resetChildState:function(e){return this.resetChildPositionState(e).resetChildVisibleState(e).resetChildAlphaState(e).resetChildActiveState(e),this},resetChildrenState:function(e){for(var t=0,n=e.length;t<n;t++)this.resetChildState(e[t]);return this},syncProperties:function(){return this.syncPosition().syncVisible().syncAlpha().syncActive().syncScrollFactor().syncMask(),this}},nn,rn,{updateChildVisible:function(e){return e.visible=this.visible&&this.getLocalState(e).visible,this},syncVisible:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildVisible,this),this},resetChildVisibleState:function(e){return this.getLocalState(e).visible=e.visible,this},setChildVisible:function(e,t){return e.visible=t,this.resetChildVisibleState(e),this},setChildLocalVisible:function(e,t){return void 0===t&&(t=!0),this.getLocalState(e).visible=t,this.updateChildVisible(e),this}},an,{updateChildScrollFactor:function(e){return e.setScrollFactor(this.scrollFactorX,this.scrollFactorY),this},syncScrollFactor:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildScrollFactor,this),this}},{updateChildActive:function(e){return e.active=this.active&&this.getLocalState(e).active,this},syncActive:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildActive,this),this},resetChildActiveState:function(e){return this.getLocalState(e).active=e.active,this},setChildActive:function(e,t){return e.active=t,this.resetChildActiveState(e),this},setChildLocalActive:function(e,t){return void 0===t&&(t=!0),this.getLocalState(e).active=t,this.updateChildActive(e),this}},{updateChildMask:function(e){return null==this.mask?this:((this.mask.hasOwnProperty("geometryMask")?this.mask.geometryMask:this.mask.bitmapMask)!==e&&(e.mask=this.mask),this)},syncMask:function(){return this.children&&this.syncChildrenEnable&&this.children.getChildren().forEach(this.updateChildMask,this),this},setMask:function(e){return this.mask=e,this},clearMask:function(e){return void 0===e&&(e=!1),e&&this.mask&&this.mask.destroy(),this.mask=null,this}},{setDepth:function(e){if(this.depth=e,this.children)for(var t=this.getAllChildren(),n=0,i=t.length;n<i;n++)t[n].depth=e;return this},swapDepth:function(e){var t=this.depth;return this.setDepth(e.depth),e.setDepth(t),this},incDepth:function(e){if(this.depth+=e,this.children)for(var t=this.getAllChildren(),n=0,i=t.length;n<i;n++)t[n].depth+=e;return this}},ln,hn.Alpha,hn.Flip);var pn=dn,fn={enableData:function(){return void 0===this.data&&(this.data={}),this},getData:function(e,t){return this.enableData(),void 0===e?this.data:kt()(this.data,e,t)},setData:function(e,t){return this.enableData(),this.data[e]=t,this},incData:function(e,t,n){return void 0===n&&(n=0),this.enableData(),this.setData(e,this.getData(e,n)+t),this},mulData:function(e,t,n){return void 0===n&&(n=0),this.enableData(),this.setData(e,this.getData(e,n)*t),this},clearData:function(){return this.data&&function(e){if(Array.isArray(e))e.length=0;else for(var t in e)delete e[t]}(this.data),this}},gn=function(){function e(e,t){this.container=null,this.setParent(e),this._deltaHeight=0}return e.prototype.setParent=function(e){this.parent=e,this.parentContainer=e.getParentContainer()},e.prototype.destroy=function(e){void 0===e&&(e=!1),e||(0!==this.deltaHeight&&this.parent.nonZeroDeltaHeightCount--,this.destroyContainer()),this.data=void 0,this.container=null,this.parent=void 0,this.parentContainer=void 0},Object.defineProperty(e.prototype,"table",{get:function(){return this.parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scrollMode",{get:function(){return this.parentContainer.scrollMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colIndx",{get:function(){return this.parent.cellIndxeToColIndex(this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowIndx",{get:function(){return this.parent.cellIndxeToRowIndex(this.index)},enumerable:!0,configurable:!0}),e.prototype.getContainer=function(){return this.container},e.prototype.setContainer=function(e){return this.container&&this.container.destroy(),this.container=e,this.parentContainer.add(e),this},e.prototype.destroyContainer=function(){return this.container&&(this.container.destroy(),this.container=null),this},e.prototype.popContainer=function(){if(this.container){var e=this.container;return this.container=null,this.parentContainer.remove(e),e}return null},e.prototype.setXY=function(e,t){return this.container&&this.parentContainer.setChildLocalPosition(this.container,e,t),this},Object.defineProperty(e.prototype,"deltaHeight",{get:function(){return this._deltaHeight},set:function(e){null==e&&(e=0);var t=this.parent;0===this._deltaHeight&&0!==e?t.nonZeroDeltaHeightCount++:0!==this._deltaHeight&&0===e&&t.nonZeroDeltaHeightCount--,this._deltaHeight=e},enumerable:!0,configurable:!0}),e.prototype.setDeltaHeight=function(e){return this.deltaHeight=e,this},Object.defineProperty(e.prototype,"height",{get:function(){return 0===this.scrollMode?this.deltaHeight+this.parent.defaultCellHeight:this.parent.defaultCellWidth},set:function(e){1!==this.scrollMode&&this.setDeltaHeight(e-this.parent.defaultCellHeight)},enumerable:!0,configurable:!0}),e.prototype.setHeight=function(e){return this.height=e,this},Object.defineProperty(e.prototype,"width",{get:function(){return 0===this.scrollMode?this.parent.defaultCellWidth:this.deltaHeight+this.parent.defaultCellHeight},set:function(e){0!==this.scrollMode&&this.setDeltaHeight(e-this.parent.defaultCellHeight)},enumerable:!0,configurable:!0}),e.prototype.setWidth=function(e){return this.width=e,this},Object.defineProperty(e.prototype,"scene",{get:function(){return this.parentContainer.scene},enumerable:!0,configurable:!0}),e}();Object.assign(gn.prototype,fn);var mn=gn,yn=function(){function e(){this.items=[]}return e.prototype.destroy=function(){this.items.length=0,this.items=void 0},e.prototype.pop=function(){return this.items.length>0?this.items.pop():null},e.prototype.push=function(e){return this.items.push(e),this},e.prototype.pushMultiple=function(e){return this.items.push.apply(this.items,e),e.length=0,this},e}(),bn=Phaser.Utils.Objects.GetValue,vn=Phaser.Utils.Array.SpliceOne,wn=new yn,xn=function(){function e(e,t){this.parent=e,this.cells=[],this.resetFromJSON(t)}return e.prototype.resetFromJSON=function(e){return this.colCount=void 0,this._nonZeroDeltaHeightCount=0,this.resetTotalRowsHeight(),this.setDefaultCellHeight(bn(e,"cellHeight",30)),this.setDefaultCellWidth(bn(e,"cellWidth",30)),this.initCells(bn(e,"cellsCount",0)),this.setColumnCount(bn(e,"columns",1)),this},e.prototype.destroy=function(e){for(var t=0,n=this.cells.length;t<n;t++)this.freeCell(this.cells[t],e);this.cells=void 0,this.parent=void 0},Object.defineProperty(e.prototype,"nonZeroDeltaHeightCount",{get:function(){return this._nonZeroDeltaHeightCount},set:function(e){this._nonZeroDeltaHeightCount!==e&&(this._nonZeroDeltaHeightCount=e,this.resetTotalRowsHeight())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultCellHeightMode",{get:function(){return 0===this.nonZeroDeltaHeightCount},enumerable:!0,configurable:!0}),e.prototype.setDefaultCellHeight=function(e){return this.defaultCellHeight=e,this},e.prototype.setDefaultCellWidth=function(e){return this.defaultCellWidth=e,this},e.prototype.initCells=function(e){var t=this.cells;t.length=e;for(var n=0;n<e;n++)t[n]=null;return this},e.prototype.insertNewCell=function(e,t){var n,i=this.cells;if(e===i.length){var o=e+t;i.legth=o;for(var r=e;r<o;r++)i[r]=null}else{var a=[];for(a.length=t,r=0;r<t;r++)a[r]=null;(n=this.cells).splice.apply(n,[e,0].concat(a))}return this.resetTotalRowsHeight(),this},e.prototype.removeCell=function(e,t){for(var n=e+t,i=e;i<n;i++)this.freeCell(i);return n===this.cells.length?this.cells.length=e:(1===t?vn(this.cells,e):this.cells.splice(e,t),this.buildCellIndex(e)),this.resetTotalRowsHeight(),this},e.prototype.setColumnCount=function(e){return this.colCount=e,this.resetTotalRowsHeight(),this},Object.defineProperty(e.prototype,"rowCount",{get:function(){return Math.ceil(this.cells.length/this.colCount)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellsCount",{get:function(){return this.cells.length},enumerable:!0,configurable:!0}),e.prototype.isValidCellIdx=function(e){return e>=0&&e<this.cells.length},e.prototype.heightToRowIndex=function(e,t){if(this.defaultCellHeightMode){var n=e/this.defaultCellHeight;return t?Math.ceil(n):Math.floor(n)}var i,o=this.rowCount,r=e;for(n=0;;){if(i=n>=0&&n<o,!((r-=this.getRowHeight(n))>0&&i)){if(0===r)return n;if(t){var a=n;(i=(n+=1)>=0&&n<o)||(n=a)}return n}n+=1}},e.prototype.widthToColIndex=function(e,t){var n=e/this.defaultCellWidth;return t?Math.ceil(n):Math.floor(n)},e.prototype.colRowToCellIndex=function(e,t){return e>=this.colCount?null:t*this.colCount+e},e.prototype.rowIndexToHeight=function(e,t){if(this.defaultCellHeightMode)return(t-e+1)*this.defaultCellHeight;for(var n=0,i=e;i<=t;i++)n+=this.getRowHeight(i);return n},e.prototype.colIndexToWidth=function(e,t){return(t-e+1)*this.defaultCellWidth},e.prototype.getRowHeight=function(e){var t=this.colCount;if(t<=1)return this.getCellHeight(this.colRowToCellIndex(0,e));for(var n,i=0,o=0;o<t;o++)i<(n=this.getCellHeight(this.colRowToCellIndex(o,e)))&&(i=n);return i},e.prototype.getColWidth=function(e){return this.defaultCellWidth},e.prototype.getCellHeight=function(e){if(!this.isValidCellIdx(e))return 0;var t;if(this.defaultCellHeightMode)t=this.defaultCellHeight;else{var n=this.getCell(e,!1);t=this.defaultCellHeight+(n?n.deltaHeight:0)}return t},e.prototype.resetTotalRowsHeight=function(){this._totalRowsHeight=null},Object.defineProperty(e.prototype,"totalRowsHeight",{get:function(){return null===this._totalRowsHeight&&(this._totalRowsHeight=this.rowIndexToHeight(0,this.rowCount-1)),this._totalRowsHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalColumnWidth",{get:function(){return this.colCount*this.defaultCellWidth},enumerable:!0,configurable:!0}),e.prototype.cellIndxeToColIndex=function(e){return e%this.colCount},e.prototype.cellIndxeToRowIndex=function(e){return Math.floor(e/this.colCount)},e.prototype.getCell=function(e,t){if(!this.isValidCellIdx(e))return null;if(void 0===t&&(t=!0),null===this.cells[e]&&t){var n=this.newCell(e);this.cells[e]=n}return this.cells[e]},e.prototype.newCell=function(e){var t=wn.pop();return null===t?t=new mn(this):t.setParent(this),t.index=e,t},e.prototype.buildCellIndex=function(e){void 0===e&&(e=0);for(var t,n=this.cells,i=e,o=n.length;i<o;i++)(t=n[i])&&(t.index=i);return this},e.prototype.getParentContainer=function(){return this.parent},e.prototype.freeCell=function(e,t){return"number"==typeof e&&(e=this.cells[e]),e?(e.destroy(t),wn.push(e),this):this},e}(),Cn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),kn=function(e){function t(t,n,i){var o=this;return void 0===n&&(n=0),"string"==typeof n&&(shaep=Tn[n]),void 0===i&&(i=0),(o=e.call(this,t.scene)||this).parent=t,o.shape=n,o.padding=i,o.setPosition().resize(),o}return Cn(t,e),t.prototype.destroy=function(){return this.parent=void 0,e.prototype.destroy.call(this),this},t.prototype.setPosition=function(t,n){var i=this.parent;return void 0===t&&(t=i.x),void 0===n&&(n=i.y),e.prototype.setPosition.call(this,t,n),this},t.prototype.resize=function(e,t,n){var i=this.parent;if(void 0===e&&(e=i.width),void 0===t&&(t=i.height),void 0===n&&(n=this.padding),this.widthSave===e&&this.heightSave===t&&this.paddingSave===n)return this;switch(this.clear().fillStyle(16777215),this.shape){case 1:var o=Math.min(e,t)/2;this.fillCircle(0,0,o+n);break;default:this.fillRect(-e*i.originX-n,-t*i.originY-n,e+2*n,t+2*n)}return this.widthSave=e,this.heightSave=t,this.paddingSave=n,this},t}(Phaser.GameObjects.Graphics),Tn={rectangle:0,circle:1},Pn=kn,On=function(e,t,n){!e||void 0===t&&void 0===n||(e.resize?(void 0===t&&(t=e.width),void 0===n&&(n=e.height),e.resize(t,n)):(void 0!==t&&(e.displayWidth=t),void 0!==n&&(e.displayHeight=n)))},An=function(e){return e.hasOwnProperty("geometryMask")?e.geometryMask:e.bitmapMask},Sn=Phaser.Geom.Intersects.RectangleToRectangle,In=Phaser.Geom.Rectangle.Overlaps,En=function(e,t){e.setVisible(!0).clearMask()},Mn=function(e,t){e.setVisible(!0).setMask(t)},Bn=function(e,t){e.setVisible(!1).clearMask()},zn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),jn=Phaser.GameObjects.Components,_n=Phaser.Structs.Set,Dn=Phaser.Utils.Objects.GetValue,Ln=Phaser.Math.Clamp,Yn=function(e){function t(t,n,i,o,r,a){var s=this;void 0===a&&(a={}),(s=e.call(this,t,n,i,o,r)||this).type="rexGridTable",s._tableOX=0,s._tableOY=0,s.visibleCells=new _n,s.preVisibleCells=new _n,s.visibleStartX=null,s.visibleEndX=null,s.visibleStartY=null,s.visibleEndY=null,s.lastVisibleCellIdx=null,s.execeedTopState=!1,s.execeedBottomState=!1,s.execeedLeftState=!1,s.execeedRightState=!1;var l=Dn(a,"reuseCellContainer",!1);s.cellContainersPool=l?t.add.group():void 0;var c=Dn(a,"cellVisibleCallback",null);if(null!==c){var u=Dn(a,"cellVisibleCallbackScope",void 0);s.on("cellvisible",c,u)}if(null!==(c=Dn(a,"cellInvisibleCallback",null))&&(u=Dn(a,"cellInvisibleCallbackScope",void 0),s.on("cellinvisible",c,u)),s.cellsMask=void 0,s.setCellsMask(Dn(a,"mask",!0)),s.setScrollMode(Dn(a,"scrollMode",0)),s.setClampMode(Dn(a,"clamplTableOXY",!0)),0===s.scrollMode){var h=Dn(a,"cellWidth",void 0);if(s.expandCellSize=void 0===h,void 0===h){var d=Dn(a,"columns",1);a.cellWidth=s.width/d}}else{h=Dn(a,"cellHeight",void 0);var p=Dn(a,"cellWidth",void 0);s.expandCellSize=void 0===h,a.cellWidth=h,a.cellHeight=p}return s.table=new xn(s,a),s.updateTable(),s}return zn(t,e),t.prototype.destroy=function(t){this.scene&&(t||this.setCellsCount(0),this.table.destroy(t),this.table=void 0,this.cellContainersPool&&(this.cellContainersPool.destroy(!0),this.cellContainersPool=void 0),e.prototype.destroy.call(this,t))},t.prototype.setScrollMode=function(e){return"string"==typeof e&&(e=Rn[e.toLowerCase()]),this.scrollMode=e,this},t.prototype.setClampMode=function(e){return this.clampTableOXYMode=e,this},t.prototype.setCellsCount=function(e){var t=this.cellsCount;return t===e?this:(t>e?this.removeCell(e,t-e):this.insertNewCell(t,e-t),this)},t.prototype.setColumnCount=function(e){return this.table.colCount===e?this:(this.table.setColumnCount(e),this)},t.prototype.setGridSize=function(e,t){return this.setCellsCount(e*t),this.table.setColumnCount(e),this},t.prototype.insertNewCell=function(e,t){return"object"==typeof e&&(e=e.index),void 0===t&&(t=1),t<=0?this:(e=Ln(e,0,this.cellsCount),this.table.insertNewCell(e,t),this)},t.prototype.removeCell=function(e,t){if("object"==typeof e&&(e=e.index),void 0===t&&(t=1),e<0&&(t+=e,e=0),t<=0)return this;if(e>this.cellsCount)return this;if(e<=this.lastVisibleCellIdx)for(var n,i=this.preVisibleCells,o=this.visibleCells,r=e,a=e+t;r<a;r++)(n=this.getCell(r,!1))&&(o.contains(n)&&(this.hideCell(n),o.delete(n)),i.delete(n));return this.table.removeCell(e,t),this},Object.defineProperty(t.prototype,"tableOY",{get:function(){return this._tableOY},set:function(e){this.setTableOY(e).updateTable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tableOX",{get:function(){return this._tableOX},set:function(e){this.setTableOX(e).updateTable()},enumerable:!0,configurable:!0}),t.prototype.setTableOY=function(e){var t=this.table,n=this.topTableOY,i=this.bottomTableOY,o=this.tableOYExceedTop(e),r=this.tableOYExeceedBottom(e);return this.clampTableOXYMode&&(t.rowCount<t.heightToRowIndex(this.instHeight,!0)?e=0:o?e=n:r&&(e=i)),this._tableOY!==e&&(this._tableOY=e),o&&(this.execeedTopState||this.emit("execeedtop",this,e,n)),this.execeedTopState=o,r&&(this.execeedBottomState||this.emit("execeedbottom",this,e,i)),this.execeedBottomState=r,this},t.prototype.setTableOX=function(e){var t=this.table,n=this.leftTableOX,i=this.rightTableOX,o=this.tableOXExeceedLeft(e),r=this.tableOXExeceedRight(e);return this.clampTableOXYMode&&(t.colCount<t.widthToColIndex(this.instWidth,!0)?e=0:o?e=n:r&&(e=i)),this._tableOX!==e&&(this._tableOX=e),o&&(this.execeedLeftState||this.emit("execeedleft",this,e,n)),this.execeedLeftState=o,r&&(this.execeedRightState||this.emit("execeedright",this,e,i)),this.execeedRightState=r,this},t.prototype.setTableOXY=function(e,t){return this.setTableOY(t).setTableOX(e),this},t.prototype.addTableOY=function(e){return this.setTableOY(this.tableOY+e),this},t.prototype.addTableOX=function(e){return this.setTableOX(this.tableOX+e),this},t.prototype.addTableOXY=function(e,t){return this.addTableOY(t).addTableOX(e),this},t.prototype.setTableOYByPercentage=function(e){return this.setTableOY(-this.tableVisibleHeight*e),this},t.prototype.getTableOYPercentage=function(){var e=this.tableVisibleHeight;return 0===e?0:this.tableOY/-e},Object.defineProperty(t.prototype,"t",{get:function(){return this.getTableOYPercentage()},set:function(e){this.setTableOYByPercentage(e).updateTable()},enumerable:!0,configurable:!0}),t.prototype.updateTable=function(e){return void 0===e&&(e=!1),e&&(this.clearVisibleCellIndexes(),this.hideCells()),this.clearVisibleCellIndexes(),this.showCells(),this.hideCells(),this.maskCells(),this},t.prototype.getCell=function(e){return this.table.getCell(e,!0)},t.prototype.getCellContainer=function(e){var t,n=this.table.getCell(e,!1);return n&&(t=n.getContainer()),t},Object.defineProperty(t.prototype,"cellsCount",{get:function(){return this.table.cellsCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnCount",{get:function(){return this.table.colCount},enumerable:!0,configurable:!0}),t.prototype.setCellHeight=function(e,t){return("number"==typeof e?this.table.getCell(e,!0):e).height=t,this},t.prototype.setCellWidth=function(e,t){return("number"==typeof e?this.table.getCell(e,!0):e).width=t,this},t.prototype.pointerToCellIndex=function(e,t){t-=this.y+this.topLeftY,e-=this.x+this.topLeftX;var n=this.tableOX-(0===this.scrollMode?e:t),i=this.table,o=i.heightToRowIndex(-(this.tableOY-(0===this.scrollMode?t:e))),r=i.widthToColIndex(-n),a=i.colRowToCellIndex(r,o);return null===a?null:this.cellIsVisible(a)?a:null},t.prototype.pointerToCellContainer=function(e,t){var n=this.pointerToCellIndex(e,t);if(null!==n)return this.getCellContainer(n)},t.prototype.cellIsVisible=function(e){var t=this.table.getCell(e,!1);return t&&this.visibleCells.contains(t)},t.prototype.eachVisibleCell=function(e,t){return this.visibleCells.each(e,t),this},t.prototype.iterateVisibleCell=function(e,t){return this.visibleCells.iterate(e,t),this},t.prototype.setCellsMask=function(e){var t,n;if(!0===e?(t=!0,n=0):!1===e?t=!1:(t=Dn(e,"mask",!0),n=Dn(e,"padding",0)),t){var i=new Pn(this,0,n);this.cellsMask=i.createGeometryMask(),this.add(i)}return this},t.prototype.maskCells=function(){for(var e,t=[],n=this.visibleCells.entries,i=0,o=n.length;i<o;i++)(e=n[i].getContainer())&&(e.isRexContainerLite?e.getAllChildren(t):t.push(e));!function(e,t,n){if(t){void 0===n&&(n=e.getAllChildren());for(var i,o,r=e.getBounds(),a=An(t),s=0,l=n.length;s<l;s++)if(!(i=n[s]).hasOwnProperty("isRexContainerLite")&&i!==a){if(i.getBounds)switch(o=i.getBounds(o),c=r,u=o,h=void 0,d=void 0,p=void 0,f=void 0,g=void 0,h=0,d=u.top,p=u.bottom,f=u.left,g=u.right,h+=c.contains(f,d)?1:0,h+=c.contains(f,p)?1:0,(h+=c.contains(g,d)?1:0)+(c.contains(g,p)?1:0)){case 4:En(i);break;case 0:Sn(r,o)||In(r,o)?Mn(i,t):Bn(i);break;default:Mn(i,t)}else Mn(i,t);e.resetChildVisibleState(i).updateChildVisible(i)}}var c,u,h,d,p,f,g}(this,this.cellsMask,t)},t.prototype.resize=function(t,n){return this.width===t&&this.height===n?this:(e.prototype.resize.call(this,t,n),this.cellsMask&&On(An(this.cellsMask),t,n),this.expandCellSize&&this.table.setDefaultCellWidth(this.instWidth/this.table.colCount),this.updateTable(!0),this)},t.prototype.clearVisibleCellIndexes=function(){var e=this.preVisibleCells;this.preVisibleCells=this.visibleCells,this.visibleCells=e,this.visibleCells.clear()},t.prototype.showCells=function(){if(0!==this.cellsCount){var e=this.table,t=e.heightToRowIndex(-this.tableOY);t<0&&(t=0);var n=e.widthToColIndex(-this.tableOX);n<0&&(n=0);var i=e.colRowToCellIndex(n,t),o=this.bottomBound,r=this.rightBound,a=e.cellsCount-1,s=e.colCount-1,l=this.getTLX(n),c=l,u=this.getTLY(t);for(this.visibleStartY=null,this.visibleEndY=null,this.visibleStartX=null,this.visibleEndX=null,this.lastVisibleCellIdx=null;u<o&&i<=a;){if(this.table.isValidCellIdx(i)){null===this.visibleStartY&&(this.visibleStartY=t,this.visibleEndY=t),null===this.visibleStartX&&(this.visibleStartX=n,this.visibleEndX=n),null===this.lastVisibleCellIdx&&(this.lastVisibleCellIdx=i),this.visibleEndY<t&&(this.visibleEndY=t),this.visibleEndX<n&&(this.visibleEndX=n),this.lastVisibleCellIdx<i&&(this.lastVisibleCellIdx=i);var h=e.getCell(i,!0);this.visibleCells.set(h),this.preVisibleCells.contains(h)||this.showCell(h),0===this.scrollMode?h.setXY(c,u):h.setXY(u,c)}c<r&&n<s?(c+=e.getColWidth(n),n+=1):(c=l,u+=e.getRowHeight(t),n=this.visibleStartX,t+=1),i=e.colRowToCellIndex(n,t)}}},t.prototype.showCell=function(e){var t=null;if(this.cellContainersPool&&null!==(t=this.cellContainersPool.getFirstDead())&&t.setActive(!0).setVisible(!0),this.emit("cellvisible",e,t),this.cellContainersPool){var n=e.getContainer();n?null===t?this.cellContainersPool.add(n):t!==n&&(this.cellContainersPool.add(n),this.cellContainersPool.killAndHide(t)):null!==t&&this.cellContainersPool.killAndHide(t)}},t.prototype.hideCells=function(){var e=this.visibleCells;this.preVisibleCells.iterate(function(t){e.contains(t)||this.hideCell(t)},this)},t.prototype.hideCell=function(e){if(this.emit("cellinvisible",e),this.cellContainersPool){var t=e.popContainer();t&&this.cellContainersPool.killAndHide(t)}e.destroyContainer()},Object.defineProperty(t.prototype,"instHeight",{get:function(){return 0===this.scrollMode?this.height:this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"instWidth",{get:function(){return 0===this.scrollMode?this.width:this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tableHeight",{get:function(){return this.table.totalRowsHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tableWidth",{get:function(){return this.table.totalColumnWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topTableOY",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomTableOY",{get:function(){return-this.tableVisibleHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftTableOX",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightTableOX",{get:function(){return-this.tableVisibleWidth},enumerable:!0,configurable:!0}),t.prototype.tableOYExceedTop=function(e){return void 0===e&&(e=this.tableOY),e>this.topTableOY},t.prototype.tableOYExeceedBottom=function(e){return void 0===e&&(e=this.tableOY),e<this.bottomTableOY},t.prototype.tableOXExeceedLeft=function(e){return void 0===e&&(e=this.tableOX),e>this.leftTableOX},t.prototype.tableOXExeceedRight=function(e){return void 0===e&&(e=this.tableOX),e<this.rightTableOX},Object.defineProperty(t.prototype,"tableVisibleHeight",{get:function(){var e=this.tableHeight,t=this.instHeight;return e>t?e-t:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tableVisibleWidth",{get:function(){var e=this.tableWidth,t=this.instWidth;return e>t?e-t:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeftY",{get:function(){return-this.displayHeight*this.originY+this.displayHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRightX",{get:function(){return-this.displayWidth*this.originX+this.displayWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeftX",{get:function(){return-this.displayWidth*this.originX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeftY",{get:function(){return-this.displayHeight*this.originY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomBound",{get:function(){return 0===this.scrollMode?this.bottomLeftY:this.topRightX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightBound",{get:function(){return 0===this.scrollMode?this.topRightX:this.bottomLeftY},enumerable:!0,configurable:!0}),t.prototype.getTLX=function(e){var t=0===this.scrollMode?this.topLeftX:this.topLeftY;return this.tableOX+this.table.colIndexToWidth(0,e-1)+t},t.prototype.getTLY=function(e){var t=0===this.scrollMode?this.topLeftY:this.topLeftX;return this.tableOY+this.table.rowIndexToHeight(0,e-1)+t},t}(pn);Object.assign(Yn.prototype,jn.GetBounds);var Rn={v:0,vertical:0,h:1,horizontal:1},Xn=Yn,Wn=function(e,t,n,i,o){var r=new Xn(this.scene,e,t,n,i,o);return this.scene.add.existing(r),r},Fn=Phaser.Utils.Objects.GetValue,Vn=Phaser.GameObjects.BuildGameObject,Nn=function(e){var t=Fn(e,"width",256),n=Fn(e,"height",256),i=new Xn(this.scene,0,0,t,n,e);return i.syncChildrenEnable=!1,Vn(this.scene,i,e),i.syncChildrenEnable=!0,i.syncPosition().syncVisible().syncAlpha(),i},Gn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Hn=function(e){function t(t){var n=e.call(this,t)||this;return t.registerGameObject("rexGridTable",Wn,Nn),n}return Gn(t,e),t.prototype.start=function(){this.game.events.once("destroy",this.destroy,this)},t}(Phaser.Plugins.BasePlugin);ut(window,"RexPlugins.GameObjects.GridTable",Xn);var Kn=Hn,qn=function(){function e(e){this.scene=e}return e.register=function(t,n){e.prototype[t]=n},e}(),Un=Phaser.Utils.Objects.GetValue,Zn=function(){function e(e,t,n,i,o){this.cornerRadius={},this._width=0,this._height=0,this.setTo(e,t,n,i,o)}return e.prototype.setTo=function(e,t,n,i,o){return this.setPosition(e,t),this.setRadius(o),this.setSize(n,i),this},e.prototype.setPosition=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this.x=e,this.y=t,this},e.prototype.setRadius=function(e){var t,n;void 0===e&&(e=0),"number"==typeof e?(t=e,n=e):(t=Un(e,"x",0),n=Un(e,"y",0));var i=this.cornerRadius;return i.tl=Jn(Un(e,"tl",void 0),t,n),i.tr=Jn(Un(e,"tr",void 0),t,n),i.bl=Jn(Un(e,"bl",void 0),t,n),i.br=Jn(Un(e,"br",void 0),t,n),this},e.prototype.setSize=function(e,t){return this.width=e,this.height=t,this},Object.defineProperty(e.prototype,"minWidth",{get:function(){var e=this.cornerRadius;return Math.max(e.tl.x+e.tr.x,e.bl.x+e.br.x)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minHeight",{get:function(){var e=this.cornerRadius;return Math.max(e.tl.y+e.bl.y,e.tr.y+e.br.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(e){null==e&&(e=0),this._width=Math.max(e,this.minWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(e){null==e&&(e=0),this._height=Math.max(e,this.minHeight)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){var e=this.cornerRadius;return Math.max(e.tl.x,e.tl.y,e.tr.x,e.tr.y,e.bl.x,e.bl.y,e.br.x,e.br.y)},enumerable:!0,configurable:!0}),e}(),Jn=function(e,t,n){return void 0===e?{x:t,y:n}:"number"==typeof e?{x:e,y:e}:e},$n=Zn,Qn=function(e,t,n){var i=n.length;return i>=2&&e===n[i-2]&&t===n[i-1]?n:(n.push(e,t),n)},ei=n("Vlzo"),ti=n.n(ei),ni=Phaser.Utils.Objects.GetValue,ii=function(e,t,n,i,o,r,a,s){var l,c,u,h=ni(n,"x",n),d=ni(n,"y",n);r&&(o+=360),i=ti()(i);for(var p=((o=ti()(o))-i)/a,f=0;f<=a;f++)u=i+p*f,l=e+h*Math.cos(u),c=t+d*Math.sin(u),Qn(l,c,s);return s},oi=n("KOM0"),ri=n.n(oi),ai=n("3PW2"),si=n.n(ai),li=n("UD9A"),ci={renderWebGL:si.a,renderCanvas:n.n(li).a},ui=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),hi=Phaser.Utils.Objects.GetValue,di=function(e){function t(t,n,i,o,r,a,s,l){var c=this;void 0===n&&(n=0),void 0===i&&(i=0);var u=hi(a,"iteration",void 0);a=hi(a,"radius",a);var h=new $n(0,0,o,r,a);return(c=e.call(this,t,"RoundRectangle",h)||this).setIteration(u),c.setPosition(n,i),void 0!==s&&c.setFillStyle(s,l),c.updateDisplayOrigin(),c.updateData(),c}return ui(t,e),t.prototype.updateData=function(){var e=this.geom,t=this.pathData;t.length=0;var n,i=e.cornerRadius,o=this.iteration+1;return pi(n=i.br)?ii(e.width-n.x,e.height-n.y,n,0,90,!1,o,t):Qn(e.width,e.height,t),pi(n=i.bl)?ii(n.x,e.height-n.y,n,90,180,!1,o,t):Qn(0,e.height,t),pi(n=i.tl)?ii(n.x,n.y,n,180,270,!1,o,t):Qn(0,0,t),pi(n=i.tr)?ii(e.width-n.x,n.y,n,270,360,!1,o,t):Qn(e.width,0,t),t.push(t[0],t[1]),this.pathIndexes=ri()(t),this},Object.defineProperty(t.prototype,"width",{get:function(){return this.geom.width},set:function(e){this.width!==e&&(this.geom.width=e,this.updateDisplayOrigin(),this.updateData())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.geom.height},set:function(e){this.height!==e&&(this.geom.height=e,this.updateDisplayOrigin(),this.updateData())},enumerable:!0,configurable:!0}),t.prototype.resize=function(e,t){return void 0===t&&(t=e),this.geom.width===e&&this.geom.height===t?this:(this.geom.height=t,this.geom.width=e,this.updateDisplayOrigin(),this.updateData(),this)},Object.defineProperty(t.prototype,"iteration",{get:function(){return this._iteration},set:function(e){void 0!==this._iteration?this._iteration!==e&&(this._iteration=e,this.updateData()):this._iteration=e},enumerable:!0,configurable:!0}),t.prototype.setIteration=function(e){return void 0===e&&(e=6),this.iteration=e,this},Object.defineProperty(t.prototype,"radius",{get:function(){return this.geom.radius},set:function(e){this.geom.setRadius(e),this.updateDisplayOrigin(),this.updateData()},enumerable:!0,configurable:!0}),t.prototype.setRadius=function(e){return void 0===e&&(e=0),this.radius=e,this},Object.defineProperty(t.prototype,"cornerRadius",{get:function(){return this.geom.cornerRadius},set:function(e){this.radius=e},enumerable:!0,configurable:!0}),t.prototype.setCornerRadius=function(e){return this.setRadius(e)},t}(Phaser.GameObjects.Shape),pi=function(e){return 0!==e.x&&0!==e.y};Object.assign(di.prototype,ci);var fi=di;qn.register("roundRectangle",function(e,t,n,i,o,r,a){var s=new fi(this.scene,e,t,n,i,o,r,a);return this.scene.add.existing(s),s}),ut(window,"RexPlugins.UI.RoundRectangle",fi);var gi,mi=fi,yi=pn,bi=function(e){return e.hasOwnProperty("rexSizer")||(e.rexSizer={}),e.rexSizer},vi=new Phaser.Geom.Rectangle,wi=function(e,t){return void 0===this.childrenMap&&(this.childrenMap={}),this.childrenMap[e]=t,this},xi=function(e,t){var n;for(var i in void 0===t&&(t=[]),e)void 0!==(n=e[i]).name?t.push(n):xi(n,t);return t},Ci=/(\S+)\[(\d+)\]/i,ki=[],Ti=Phaser.Utils.Objects.GetValue,Pi=Phaser.Utils.Objects.GetAdvancedValue,Oi=function(){function e(e,t){this.gameObject=e,this.scene=Ge(e),this.scaleStart={},this.scaleEnd={},this.tween=void 0,this.resetFromJSON(t),this.boot()}return e.prototype.resetFromJSON=function(e){return this.setMode(Ti(e,"mode",0)),this.setScaleRange(Pi(e,"start",void 0),Pi(e,"end",0)),this.setDelay(Pi(e,"delay",0)),this.setDuration(Pi(e,"duration",1e3)),this.setEase(Ti(e,"ease",void 0)),this},e.prototype.toJSON=function(){return{mode:this.mode,start:this.scaleStart,end:this.scaleEnd,delay:this.delay,duration:this.duration}},e.prototype.boot=function(){this.gameObject.once&&this.gameObject.once("destroy",this.destroy,this)},e.prototype.shutdown=function(){return this.stop(),this.gameObject=void 0,this.scene=void 0,this},e.prototype.destroy=function(){return this.shutdown(),this},e.prototype.setMode=function(e){return"string"==typeof e&&(e=Ai[e]),this.mode=e,this},e.prototype.setScaleRange=function(e,t){return"number"==typeof e?(this.scaleStart.x=e,this.scaleStart.y=e):(this.scaleStart.x=Ti(e,"x",this.gameObject.scaleX),this.scaleStart.y=Ti(e,"y",this.gameObject.scaleY)),"number"==typeof t?(this.scaleEnd.x=t,this.scaleEnd.y=t):(this.scaleEnd.x=Ti(t,"x",this.scaleStart.x),this.scaleEnd.y=Ti(t,"y",this.scaleStart.y)),this},e.prototype.setDelay=function(e){return this.delay=e,this},e.prototype.setDuration=function(e){return this.duration=e,this},e.prototype.setEase=function(e){return void 0===e&&(e="Linear"),this.ease=e,this},e.prototype.start=function(){return this.tween?this:(this.tween=this.scene.tweens.add({targets:this.gameObject,scaleX:{from:this.scaleStart.x,to:this.scaleEnd.x},scaleY:{from:this.scaleStart.y,to:this.scaleEnd.y},duration:this.duration,ease:this.ease,yoyo:2==this.mode,repeat:2==this.mode?-1:0,onComplete:this.complete,onCompleteScope:this}),this)},e.prototype.restart=function(){return this.stop().start(),this},e.prototype.stop=function(){return this.tween?(this.tween.remove(),this.tween=void 0,this):this},e.prototype.complete=function(){return this.stop(),1===this.mode&&this.gameObject.destroy(),this},e}(),Ai={stop:0,destroy:1,yoyo:2},Si=Oi,Ii={},Ei=Phaser.Utils.Objects.IsPlainObject,Mi=Phaser.Utils.Objects.GetValue,Bi={},zi=Phaser.Utils.Objects.IsPlainObject,ji=Phaser.Utils.Objects.GetValue,_i=Phaser.Utils.Objects.GetValue,Di=Phaser.Utils.Objects.GetAdvancedValue,Li=function(){function e(e,t){this.gameObject=e,this.scene=Ge(e),this.alphaStart=void 0,this.alphaEnd=void 0,this.tween=void 0,this.resetFromJSON(t),this.boot()}return e.prototype.resetFromJSON=function(e){return this.setMode(_i(e,"mode",0)),this.setAlphaRange(Di(e,"start",this.gameObject.alpha),Di(e,"end",0)),this.setDelay(Di(e,"delay",0)),this.setDuration(Di(e,"duration",1e3)),this},e.prototype.toJSON=function(){return{mode:this.mode,start:this.alphaStart,end:this.alphaEnd,delay:this.delay,duration:this.duration}},e.prototype.boot=function(){this.gameObject.once&&this.gameObject.once("destroy",this.destroy,this)},e.prototype.shutdown=function(){return this.stop(),this.gameObject=void 0,this.scene=void 0,this},e.prototype.destroy=function(){return this.shutdown(),this},e.prototype.setMode=function(e){return"string"==typeof e&&(e=Yi[e]),this.mode=e,this},e.prototype.setAlphaRange=function(e,t){return this.alphaStart=e,this.alphaEnd=t,this},e.prototype.setDelay=function(e){return this.delay=e,this},e.prototype.setDuration=function(e){return this.duration=e,this},e.prototype.start=function(){return this.tween?this:0===this.duration?(this.gameObject.alpha=this.alphaEnd,this.stop(),this.complete(),this):(this.tween=this.scene.tweens.add({targets:this.gameObject,alpha:{from:this.alphaStart,to:this.alphaEnd},delay:this.delay,duration:this.duration,ease:"Linear",yoyo:2==this.mode,repeat:2==this.mode?-1:0,onComplete:this.complete,onCompleteScope:this}),this)},e.prototype.restart=function(){return this.stop().start(),this},e.prototype.stop=function(){return this.tween?(this.tween.remove(),this.tween=void 0,this):this},e.prototype.complete=function(){return this.stop(),1===this.mode&&this.gameObject.destroy(),this},e}(),Yi={stop:0,destroy:1,yoyo:2},Ri=Li,Xi={},Wi=Phaser.Utils.Objects.IsPlainObject,Fi=Phaser.Utils.Objects.GetValue,Vi={},Ni=Phaser.Utils.Objects.IsPlainObject,Gi=Phaser.Utils.Objects.GetValue,Hi=void 0,Ki=Phaser.Display.Align.In.QuickSet,qi=Phaser.Display.Align.CENTER,Ui=function(e,t,n){var i=this.getTopmostSizer();i.x+=t-this.x,i.y+=n-this.y},Zi={getSizerConfig:bi,pushIntoBounds:function(e){return void 0===e&&(e=function(e,t){void 0===t&&(void 0===gi&&(gi=new Phaser.Geom.Rectangle),t=gi);var n=e.game.config;return t.setTo(0,0,n.width,n.height),t}(this.scene)),this.left=Math.max(this.left,e.left),this.right=Math.min(this.right,e.right),this.top=Math.max(this.top,e.top),this.bottom=Math.min(this.bottom,e.bottom),this},drawBounds:function(e,t){void 0===t&&(t=16777215);for(var n,i=this.getAllChildren([this]),o=0,r=i.length;o<r;o++)(n=i[o]).getBounds&&e.lineStyle(1,t).strokeRectShape(n.getBounds(vi));return this},getChildrenWidth:function(){return 0},getChildrenHeight:function(){return 0},addChildrenMap:wi,addElement:wi,getElement:function(e){if(void 0!==this.childrenMap&&("string"==typeof e&&(e=e.split(".")),0!==e.length)){var t,n=e.shift();if("#"===n.charAt(0)){n=n.substring(1);for(var i=0,o=(r=xi(this.childrenMap,ki)).length;i<o;i++)if(r[i].name===n){t=r[i];break}ki.length=0}else if(-1===n.indexOf("["))t=this.childrenMap[n];else{var r,a=n.match(Ci);null!=a&&(r=this.childrenMap[a[1]])&&(t=r[a[2]])}return 0===e.length?t:t&&t.childrenMap?t.getElement(e):null}},getAllChildrenSizers:function(e){void 0===e&&(e=[]);for(var t=e.length,n=this.getChildrenSizers(e),i=e.length,o=t;o<i;o++)n[o].getAllChildrenSizers(e);return e},getChildrenSizers:function(e){return void 0===e&&(e=[]),e},layout:function(e,t,n){},layoutBackgrounds:function(){if(void 0!==this.backgroundChildren)for(var e,t=this.backgroundChildren,n=this.left,i=this.top,o=this.width,r=this.height,a=0,s=t.length;a<s;a++)(e=t[a]).rexSizer.hidden||(On(e,o,r),Et.setPosition(n,i).setSize(o,r),Ki(e,Et,qi),this.resetChildPositionState(e))},layoutInit:function(e){if(!e)for(var t,n=this.getAllChildrenSizers([this]),i=0,o=n.length;i<o;i++)(t=n[i]).rexSizer&&t._layoutInit()},_layoutInit:function(){},popUp:function(e,t,n){if(Ei(e)){var i=e;e=Mi(i,"duration",void 0),t=Mi(i,"orientation",void 0),n=Mi(i,"ease",void 0)}return this._scale=function(e,t,n,i,o){switch(Ii.mode=0,n){case"x":Ii.start={x:0};break;case"y":Ii.start={y:0};break;default:Ii.start=0}return Ii.end=1,Ii.duration=t,Ii.ease=void 0===i?"Cubic":i,void 0===o?o=new Si(e,Ii):o.resetFromJSON(Ii),o.restart(),o}(this,e,t,n,this._scale),this},scaleDownDestroy:function(e,t,n,i){if(zi(e)){var o=e;e=ji(o,"duration",void 0),t=ji(o,"orientation",void 0),n=ji(o,"ease",void 0),i=ji(o,"destroy",void 0)}return this._scale=function(e,t,n,i,o,r){switch(o instanceof Si&&(r=o,o=void 0),void 0===o&&(o=!0),Bi.mode=o?1:0,n){case"x":Bi.end={x:0};break;case"y":Bi.end={y:0};break;default:Bi.end=0}return Bi.duration=t,Bi.ease=void 0===i?"Linear":i,void 0===r?r=new Si(e,Bi):r.resetFromJSON(Bi),r.restart(),r}(this,e,t,n,i,this._scale),this},fadeIn:function(e){return Wi(e)&&(e=Fi(e,"duration",void 0)),this._fade=function(e,t,n,i){return void 0===n&&(n=e.alpha),Xi.mode=0,Xi.start=0,Xi.end=n,Xi.duration=t,void 0===i?i=new Ri(e,Xi):i.resetFromJSON(Xi),i.restart(),i}(this,e,this._fade),this},fadeOutDestroy:function(e,t){if(Ni(e)){var n=e;e=Gi(n,"duration",void 0),t=Gi(n,"destroy",void 0)}return this._fade=function(e,t,n,i){return n instanceof Ri&&(i=n,n=void 0),void 0===n&&(n=!0),Vi.mode=n?1:0,Vi.end=0,Vi.duration=t,void 0===i?i=new Ri(e,Vi):i.resetFromJSON(Vi),i.restart(),i}(this,e,t,this._fade),this},isInTouching:function(e){if(void 0===Hi&&(Hi=new Phaser.Geom.Rectangle),this.getBounds(Hi),void 0!==e)return Hi.contains(e.x,e.y);for(var t=this.scene.input.manager,n=t.pointersTotal,i=t.pointers,o=0;o<n;o++)if(Hi.contains((e=i[o]).x,e.y))return!0;return!1},getTopmostSizer:function(e){void 0===e&&(e=this);for(var t=bi(e).parent;t;)t=bi(e=t).parent;return e},setDraggable:function(e){return void 0===e&&(e=!0),this.input&&this.input.hasOwnProperty("draggable")?this.input.draggable=e:e&&(this.setInteractive(),this.scene.input.setDraggable(this),this.on("drag",Ui,this)),this}},Ji=Phaser.Geom.Rectangle,$i=Phaser.Utils.Objects.GetValue,Qi=Phaser.Geom.Rectangle,eo=function(){function e(e,t){this.gameObject=e,this.viewport=new Qi,this.resetFromJSON(t),this.boot()}return e.prototype.resetFromJSON=function(e){var t,n;if("string"==typeof e){var i=e.split(",");t=i[0],n=i[1]}else t=$i(e,"x","0%+0"),n=$i(e,"y","0%+0");t=t.replace("left","0%").replace("right","100%").replace("center","50%").split("%");var o=parseFloat(t[0])/100,r=""===t[1]?0:parseFloat(t[1]);n=n.replace("top","0%").replace("bottom","100%").replace("center","50%").split("%");var a=parseFloat(n[0])/100,s=""===n[1]?0:parseFloat(n[1]);return this.setPercentage(o,a),this.setOffset(r,s),this},e.prototype.boot=function(){this.scaleManamger.on("resize",this.onResize,this),this.gameObject.once("destroy",this.destroy,this),this.onResize()},e.prototype.shutdown=function(){this.scaleManamger.off("resize",this.onResize,this),this.gameObject=void 0},e.prototype.destroy=function(){this.shutdown()},e.prototype.setOffset=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this.offsetX=e,this.offsetY=t,this},e.prototype.setPercentage=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this.percentageX=e,this.percentageY=t,this},e.prototype.onResize=function(){(function(e,t){void 0===t&&(t=new Ji);var n=e.canvasBounds,i=e.displayScale,o=e.autoCenter;t.x=n.x>=0?0:-n.x*i.x,t.y=n.y>=0?0:-n.y*i.y,t.width=n.width*i.x-t.x,t.height=n.height*i.y-t.y,1!==o&&2!==o||(t.width-=t.x),1!==o&&3!==o||(t.height-=t.y)})(this.scaleManamger,this.viewport),this.updatePosition()},e.prototype.updatePosition=function(){return this.gameObject.setPosition(this.x,this.y),this},Object.defineProperty(e.prototype,"scaleManamger",{get:function(){return this.gameObject.scene.scale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.viewport.x+this.viewport.width*this.percentageX+this.offsetX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.viewport.y+this.viewport.height*this.percentageY+this.offsetY},enumerable:!0,configurable:!0}),e}(),to=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),no=Phaser.Utils.Objects.GetValue,io=function(e){function t(t,n,i,o,r,a){var s,l,c=this;return"string"==typeof n&&(s=n,l=i,n=0,i=0),(c=e.call(this,t,n,i,2,2)||this).isRexSizer=!0,c.setMinSize(o,r),c.setName(no(a,"name","")),c.rexSizer={},c.backgroundChildren=void 0,void 0!==s&&(c._anchor=new eo(c,{x:s,y:l})),c.setDraggable(no(a,"draggable",!1)),c}return to(t,e),t.prototype.destroy=function(t){this.scene&&(void 0!==this.backgroundChildren&&(this.backgroundChildren.length=0),e.prototype.destroy.call(this,t))},t.prototype.setMinSize=function(e,t){return this.setMinWidth(e).setMinHeight(t),this},t.prototype.setMinWidth=function(e){return null==e&&(e=0),this.minWidth=e,this},t.prototype.setMinHeight=function(e){return null==e&&(e=0),this.minHeight=e,this},Object.defineProperty(t.prototype,"childrenWidth",{get:function(){return void 0===this._childrenWidth&&(this._childrenWidth=this.getChildrenWidth()),this._childrenWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childrenHeight",{get:function(){return void 0===this._childrenHeight&&(this._childrenHeight=this.getChildrenHeight()),this._childrenHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x-this.displayWidth*this.originX},set:function(e){this.x+=e-this.left},enumerable:!0,configurable:!0}),t.prototype.alignLeft=function(e){return this.left=e,this},Object.defineProperty(t.prototype,"right",{get:function(){return this.x-this.displayWidth*this.originX+this.displayWidth},set:function(e){this.x+=e-this.right},enumerable:!0,configurable:!0}),t.prototype.alignRight=function(e){return this.right=e,this},Object.defineProperty(t.prototype,"centerX",{get:function(){return(this.left+this.right)/2},set:function(e){this.x+=e-this.centerX},enumerable:!0,configurable:!0}),t.prototype.alignCenterX=function(e){return this.centerX=e,this},Object.defineProperty(t.prototype,"top",{get:function(){return this.y-this.displayHeight*this.originY},set:function(e){this.y+=e-this.top},enumerable:!0,configurable:!0}),t.prototype.alignTop=function(e){return this.top=e,this},Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y-this.displayHeight*this.originY+this.displayHeight},set:function(e){this.y+=e-this.bottom},enumerable:!0,configurable:!0}),t.prototype.alignBottom=function(e){return this.bottom=e,this},Object.defineProperty(t.prototype,"centerY",{get:function(){return(this.top+this.bottom)/2},set:function(e){this.y+=e-this.centerY},enumerable:!0,configurable:!0}),t.prototype.alignCenterY=function(e){return this.centerY=e,this},t.prototype.pin=function(t){return e.prototype.add.call(this,t),this},t.prototype.addBackground=function(t){return void 0===this.backgroundChildren&&(this.backgroundChildren=[]),e.prototype.add.call(this,t),this.getSizerConfig(t).parent=this,this.backgroundChildren.push(t),this},t}(yi);Object.assign(io.prototype,Zi);var oo=io,ro=function(e,t){var n,i=t.rexSizer,o=i.padding;return 0===e.orientation?i.proportion>0&&e.proportionLength>0&&(n=i.proportion*e.proportionLength):i.expand&&(n=e.width-o.left-o.right),n},ao=function(e,t){var n,i=t.rexSizer,o=i.padding;return 0===e.orientation?i.expand&&(n=e.height-o.top-o.bottom):i.proportion>0&&e.proportionLength>0&&(n=i.proportion*e.proportionLength),n},so=Phaser.Display.Align.In.QuickSet,lo={getChildrenWidth:function(e){if(this.rexSizer.hidden)return 0;void 0===e&&(e=!0);var t,n,i,o=0,r=this.sizerChildren;if(0===this.orientation)for(var a=0,s=r.length;a<s;a++)(t=r[a]).rexSizer.hidden||(i=0===t.rexSizer.proportion||e&&t.rexSizer.proportion>0?t.isRexSizer?Math.max(t.minWidth,t.childrenWidth):t.width:0,o+=i+=(n=t.rexSizer.padding).left+n.right);else for(a=0,s=r.length;a<s;a++)(t=r[a]).hasOwnProperty("rexSizer")&&(t.rexSizer.hidden||(i=t.isRexSizer?Math.max(t.minWidth,t.childrenWidth):t.width,i+=(n=t.rexSizer.padding).left+n.right,o=Math.max(i,o)));return o},getChildrenHeight:function(e){if(this.rexSizer.hidden)return 0;void 0===e&&(e=!0);var t,n,i,o=0,r=this.sizerChildren;if(0===this.orientation)for(var a=0,s=r.length;a<s;a++)(t=r[a]).rexSizer.hidden||(i=t.isRexSizer?Math.max(t.minHeight,t.childrenHeight):t.height,i+=(n=t.rexSizer.padding).top+n.bottom,o=Math.max(i,o));else for(a=0,s=r.length;a<s;a++)(t=r[a]).hasOwnProperty("rexSizer")&&(t.rexSizer.hidden||(i=0===t.rexSizer.proportion||e&&t.rexSizer.proportion>0?t.isRexSizer?Math.max(t.minHeight,t.childrenHeight):t.height:0,o+=i+=(n=t.rexSizer.padding).top+n.bottom));return o},getChildrenProportion:function(){for(var e,t,n=0,i=this.sizerChildren,o=0,r=i.length;o<r;o++)(e=i[o]).rexSizer.hidden||(t=e.rexSizer.proportion)>0&&(n+=t);return n},getChildrenSizers:function(e){void 0===e&&(e=[]);for(var t,n=this.sizerChildren,i=0,o=n.length;i<o;i++)(t=n[i]).isRexSizer&&e.push(t);return e},layout:function(e,t,n){if(this.rexSizer.hidden)return this;var i;if(this.layoutInit(e),void 0===t&&(t=Math.max(this.childrenWidth,this.minWidth)),void 0===n&&(n=Math.max(this.childrenHeight,this.minHeight)),this.resize(t,n),this.childrenProportion>0){var o=0===this.orientation?this.width-this.childrenWidth:this.height-this.childrenHeight;i=o>0?(o=0===this.orientation?this.width-this.getChildrenWidth(!1):this.height-this.getChildrenHeight(!1))/this.childrenProportion:0}else i=0;this.proportionLength=i;for(var r,a,s,l,c,u,h,d,p,f=this.sizerChildren,g=this.left,m=this.top,y=0,b=f.length;y<b;y++)(r=f[y]).rexSizer.hidden||(s=(a=r.rexSizer).padding,d=ro(this,r),p=ao(this,r),r.isRexSizer?r.layout(this,d,p):On(r,d,p),void 0===d&&(d=r.width),void 0===p&&(p=r.height),0===this.orientation?(l=g+s.left,u=0===a.proportion||0===i?d:a.proportion*i,c=m+s.top,h=this.height-s.top-s.bottom):(l=g+s.left,u=this.width-s.left-s.right,c=m+s.top,h=0===a.proportion||0===i?p:a.proportion*i),Et.setPosition(l,c).setSize(u,h),so(r,Et,a.align),this.resetChildPositionState(r),0===this.orientation?g+=u+s.left+s.right:m+=h+s.top+s.bottom);return this.layoutBackgrounds(),this},_layoutInit:function(){this._childrenWidth=void 0,this._childrenHeight=void 0,this._childrenProportion=void 0}},co=Phaser.Utils.Objects.GetValue,uo={x:0,h:0,horizontal:0,"left-to-right":0,y:1,v:1,vertical:1,"top-to-bottom":1},ho=Phaser.Display.Align,po={center:ho.CENTER,left:ho.LEFT_CENTER,right:ho.RIGHT_CENTER,top:ho.TOP_CENTER,bottom:ho.BOTTOM_CENTER,"left-top":ho.TOP_LEFT,"left-center":ho.LEFT_CENTER,"left-bottom":ho.LEFT_BOTTOM,"center-top":ho.TOP_CENTER,"center-center":ho.CENTER,"center-bottom":ho.BOTTOM_CENTER,"right-top":ho.TOP_RIGHT,"right-center":ho.RIGHT_CENTER,"right-bottom":ho.RIGHT_BOTTOM},fo=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),go=Phaser.Utils.Objects.IsPlainObject,mo=Phaser.Utils.Objects.GetValue,yo=Phaser.Utils.Array.Remove,bo=Phaser.Display.Align.CENTER,vo=function(e){function t(t,n,i,o,r,a){var s,l=this;return go(n)?(n=mo(s=n,"x",0),i=mo(s,"y",0),o=mo(s,"width",void 0),r=mo(s,"height",void 0)):go(o)?(o=mo(s=o,"width",void 0),r=mo(s,"height",void 0)):go(a)&&(s=a),void 0!==s&&(a=mo(s,"orientation",0)),void 0===a&&(a=0),(l=e.call(this,t,n,i,o,r,s)||this).type="rexSizer",l.sizerChildren=[],l.setOrientation(a),l}return fo(t,e),t.prototype.destroy=function(t){this.scene&&(this.sizerChildren.length=0,e.prototype.destroy.call(this,t))},t.prototype.setOrientation=function(e){return"string"==typeof e&&(e=uo[e]),this.orientation=e,this},t.prototype.add=function(t,n,i,o,r){e.prototype.add.call(this,t);var a=typeof n;if(null===n)return this;if("number"===a);else if("string"===a)n=wo[n];else if(go(n)){var s;n=mo(s=n,"proportion",0),i=mo(s,"align",bo),o=mo(s,"padding",0),r=mo(s,"expand",!1)}return"string"==typeof i&&(i=po[i]),void 0===n&&(n=0),void 0===i&&(i=bo),void 0===o&&(o=0),void 0===r&&(r=!1),(s=this.getSizerConfig(t)).parent=this,s.proportion=n,s.align=i,s.padding=function(e,t){return void 0===t&&(t={}),"number"==typeof e?(t.left=e,t.right=e,t.top=e,t.bottom=e):(t.left=co(e,"left",0),t.right=co(e,"right",0),t.top=co(e,"top",0),t.bottom=co(e,"bottom",0)),t}(o),s.expand=r,this.sizerChildren.push(t),this},t.prototype.insert=function(e,t,n,i,o,r){return this.add(t,n,i,o,r),this.moveTo(t,e),this},t.prototype.remove=function(t){var n=this.getSizerConfig(t);return n.parent!==this?this:(n.parent=void 0,yo(this.sizerChildren,t),e.prototype.remove.call(this,t),this)},t.prototype.clear=function(t){for(var n=0,i=this.sizerChildren.length;n<i;n++)this.getSizerConfig(this.sizerChildren[n]).parent=void 0;return this.sizerChildren.length=0,e.prototype.clear.call(this,t),this},Object.defineProperty(t.prototype,"childrenProportion",{get:function(){return void 0===this._childrenProportion&&(this._childrenProportion=this.getChildrenProportion()),this._childrenProportion},enumerable:!0,configurable:!0}),t}(oo);Object.assign(vo.prototype,lo);var wo={min:0,full:-1},xo=vo,Co=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ko=Phaser.Utils.Objects.GetValue,To=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.type="rexLabel";var o=ko(n,"background",void 0),r=ko(n,"icon",void 0),a=ko(n,"iconMask",void 0),s=ko(n,"text",void 0),l=ko(n,"action",void 0),c=ko(n,"actionMask",void 0),u=ko(n,"space.left",0),h=ko(n,"space.right",0),d=ko(n,"space.top",0),p=ko(n,"space.bottom",0),f=ko(n,"space.icon",0),g=ko(n,"space.text",0);if(o&&i.addBackground(o),r&&(i.add(r,0,"center",y=0===i.orientation?{left:u,right:s||l?f:h,top:d,bottom:p}:{left:u,right:h,top:d,bottom:s||l?f:p}),a&&(a=new Pn(r,1),r.setMask(a.createGeometryMask()),i.add(a,null))),s){var m,y,b,v=ko(n,"expandTextWidth",!1),w=ko(n,"expandTextHeight",!1);0===i.orientation?(m=v?1:0,y={left:r?0:u,right:l?g:h,top:d,bottom:p},b=w):(m=w?1:0,y={left:u,right:h,top:r?0:d,bottom:l?g:p},b=v),i.add(s,m,"center",y,b)}return l&&(i.add(l,0,"center",y=0===i.orientation?{left:r||s?0:u,right:h,top:d,bottom:p}:{left:u,right:h,top:r||s?0:d,bottom:p}),c&&(c=new Pn(l,1),r.setMask(c.createGeometryMask()),i.add(c,null))),i.addChildrenMap("background",o),i.addChildrenMap("icon",r),i.addChildrenMap("iconMask",a),i.addChildrenMap("text",s),i.addChildrenMap("action",l),i.addChildrenMap("actionMask",c),i}return Co(t,e),Object.defineProperty(t.prototype,"text",{get:function(){var e=this.childrenMap.text;return void 0===e?"":e.text?e.text:e.getData("text")},set:function(e){var t=this.childrenMap.text;void 0!==t&&(t.setText?t.setText(e):t.setData("text",e))},enumerable:!0,configurable:!0}),t.prototype.setText=function(e){return this.text=e,this},t.prototype.appendText=function(e){this.text+=e},t.prototype.layout=function(t,n,i){e.prototype.layout.call(this,t,n,i);var o=this.childrenMap.iconMask;o&&(o.setPosition(),this.resetChildPositionState(o));var r=this.childrenMap.actionMask;return r&&(r.setPosition(),this.resetChildPositionState(r)),this},t.prototype.resize=function(t,n){e.prototype.resize.call(this,t,n);var i=this.childrenMap.iconMask;i&&i.resize();var o=this.childrenMap.actionMask;return o&&o.resize(),this},t}(xo);qn.register("label",function(e){var t=new To(this.scene,e);return this.scene.add.existing(t),t}),ut(window,"RexPlugins.UI.Label",To);var Po=To,Oo=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),e.add.zone(0,0,t,n)},Ao=function(e,t,n){var i;if("number"==typeof t){if(!(t=this.childrenMap.buttons[i=t]))return}else if(-1===(i=this.childrenMap.buttons.indexOf(t)))return;void 0!==this.groupName?this.eventEmitter.emit(e,t,this.groupName,i,n):this.eventEmitter.emit(e,t,i,n)},So=function(e){Mo(e,!1)},Io=function(e){Mo(e,!0)},Eo=function(e){return!!e&&!bi(e).hidden},Mo=function(e,t){e&&(bi(e).hidden=t,e.setVisible(!t))},Bo={getButton:function(e){var t;return"number"==typeof e?t=this.childrenMap.buttons[e]:-1===this.childrenMap.buttons.indexOf(t=e)&&(t=void 0),t},emitButtonClick:function(e){return Ao.call(this,"button.click",e),this},showButton:function(e){return So(this.getButton(e)),this},hideButton:function(e){return Io(this.getButton(e)),this},isButtonShown:function(e){return Eo(this.getButton(e)),this},forEachButtton:function(e,t){for(var n=this.childrenMap.buttons,i=0,o=n.length;i<o;i++)t?e.call(t,n[i],i,n):e(n[i],i,n);return this}},zo=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),jo=Phaser.Utils.Objects.GetValue,_o=function(e){function t(t,n){var i=this;void 0===n&&(n={}),(i=e.call(this,t,n)||this).type="rexButtons",i.eventEmitter=jo(n,"eventEmitter",i),i.groupName=jo(n,"groupName",void 0);var o=jo(n,"background",void 0),r=jo(n,"buttons",void 0);r&&0===r.length&&(r=void 0);var a=jo(n,"space",0);if(o&&i.addBackground(o),r){var s=jo(n,"align",void 0),l=jo(n,"click",void 0);"right"!==s&&"bottom"!==s&&"center"!==s||i.add(Oo(t),1,"center",0,!1);for(var c=0,u=r.length;c<u;c++)i.addButton(r[c],0,"center",0===i.orientation?{left:c>=1?a:0,right:0,top:0,bottom:0}:{left:0,right:0,top:c>=1?a:0,bottom:0},!0,l);"center"===s&&i.add(Oo(t),1,"center",0,!1)}return i.addChildrenMap("background",o),i.addChildrenMap("buttons",r||[]),i}return zo(t,e),t.prototype.addButton=function(e,t,n,i,o,r){return this.childrenMap&&(this.childrenMap.buttons.push(e),this.showButton(e)),this.add(e,t,n,i,o),(function(e,t){e._buttonBehavior=new Ze(e,t),e._buttonBehavior.on("click",function(t,n,i){Ao.call(this,"button.click",e,i)},this),e.on("pointerover",function(t){Ao.call(this,"button.over",e,t)},this).on("pointerout",function(t){Ao.call(this,"button.out",e,t)},this)}).call(this,e,r),this.layout(),this},t.prototype.removeButton=function(e){return this.hideButton(e),this.remove(e),this.childrenMap.buttons=this.childrenMap.buttons.filter(function(t){return t!==e}),e.destroy(),this.layout(),this},t}(xo);Object.assign(_o.prototype,Bo);var Do=_o;qn.register("buttons",function(e){var t=new Do(this.scene,e);return this.scene.add.existing(t),t}),ut(window,"RexPlugins.UI.Buttons",Do);var Lo=Do,Yo=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ro=Phaser.Utils.Objects.GetValue,Xo=function(e){function t(t,n){var i=this;void 0===n&&(n={}),n.orientation=1,(i=e.call(this,t,n)||this).type="rexDialog",i.eventEmitter=Ro(n,"eventEmitter",i);var o=Ro(n,"background",void 0),r=Ro(n,"title",void 0),a=Ro(n,"toolbar",void 0);a&&0===a.length&&(a=void 0);var s,l,c=Ro(n,"content",void 0),u=Ro(n,"description",void 0),h=Ro(n,"choices",void 0);h&&0===h.length&&(h=void 0);var d=Ro(n,"actions",void 0);d&&0===d.length&&(d=void 0);var p,f=Ro(n,"click",void 0),g=Ro(n,"space.left",0),m=Ro(n,"space.right",0),y=Ro(n,"space.top",0),b=Ro(n,"space.bottom",0);if(o&&i.addBackground(o),r&&!a){var v=Ro(n,"align.title","center"),w=Ro(n,"space.title",0),x={left:g,right:m,top:y,bottom:c||u||h||d?w:b},C=Ro(n,"expand.title",!0);i.add(r,0,v,x,C)}if(a&&(p=new Do(t,{groupName:"toolbar",buttons:a,orientation:0,space:Ro(n,"space.toolbarItem",0),click:f,eventEmitter:i.eventEmitter})),a&&!r&&(w=Ro(n,"space.title",0),x={left:g,right:m,top:y,bottom:c||u||h||d?w:b},C=Ro(n,"expand.toolbar",!0),i.add(p,0,"center",x,C)),r&&a){var k=new xo(t,{orientation:0});v=Ro(n,"align.title","left"),(C=Ro(n,"expand.title",!0))||"right"!==v&&"center"!==v||k.add(Oo(t),1,"center",0,!1),x={left:Ro(n,"space.titleLeft",0),right:Ro(n,"space.titleRight",0),top:0,bottom:0},k.add(r,C?1:0,"center",x,C),C||"left"!==v&&"center"!==v||k.add(Oo(t),1,"center",0,!1),k.add(p,0,"right",0,!1),w=Ro(n,"space.title",0),i.add(k,0,"center",x={left:g,right:m,top:y,bottom:c||u||h||d?w:b},!0)}if(c){v=Ro(n,"align.content","center");var T=Ro(n,"space.content",0);x={left:g+Ro(n,"space.contentLeft",0),right:m+Ro(n,"space.contentRight",0),top:r||a?0:y,bottom:u||h||d?T:b},C=Ro(n,"expand.content",!0),i.add(c,0,v,x,C)}if(u){v=Ro(n,"align.description","center");var P=Ro(n,"space.description",0);x={left:g+Ro(n,"space.descriptionLeft",0),right:m+Ro(n,"space.descriptionRight",0),top:r||a||c?0:y,bottom:h||d?P:b},C=Ro(n,"expand.description",!0),i.add(u,0,v,x,C)}if(h){v=Ro(n,"align.choices","center"),s=new Do(t,{groupName:"choices",buttons:h,orientation:1,space:Ro(n,"space.choice",0),click:f,eventEmitter:i.eventEmitter});var O=Ro(n,"space.choices",0);x={left:g+Ro(n,"space.choicesLeft",0),right:m+Ro(n,"space.choicesRight",0),top:r||a||c||u?0:y,bottom:d?O:b},C=Ro(n,"expand.choices",!0),i.add(s,0,v,x,C)}return d&&(l=new Do(t,{groupName:"actions",buttons:d,orientation:0,space:Ro(n,"space.action",0),align:Ro(n,"align.actions","center"),click:f,eventEmitter:i.eventEmitter}),x={left:g+Ro(n,"space.actionsLeft",0),right:m+Ro(n,"space.actionsRight",0),top:r||a||c||u||h?0:y,bottom:b},C=Ro(n,"expand.actions",!0),i.add(l,0,"center",x,C)),i.addChildrenMap("background",o),i.addChildrenMap("title",r),i.addChildrenMap("toolbar",a),i.addChildrenMap("content",c),i.addChildrenMap("choices",h),i.addChildrenMap("actions",d),i.addChildrenMap("choicesSizer",s),i.addChildrenMap("actionsSizer",l),i}return Yo(t,e),t}(xo);Object.assign(Xo.prototype,{getChoice:function(e){return this.childrenMap.choicesSizer.getButton(e)},getAction:function(e){return this.childrenMap.actionsSizer.getButton(e)},emitChoiceClick:function(e){return this.childrenMap.choicesSizer.emitButtonClick(e),this},emitActionClick:function(e){return this.childrenMap.actionsSizer.emitButtonClick(e),this},showChoice:function(e){return this.childrenMap.choicesSizer.showButton(e),this},showAction:function(e){return this.childrenMap.actionsSizer.showButton(e),this},hideChoice:function(e){return this.childrenMap.choicesSizer.hideButton(e),this},hideAction:function(e){return this.childrenMap.actionsSizer.hideButton(e),this},forEachChoice:function(e,t){return this.childrenMap.choicesSizer.forEachButtton(e,t),this},forEachChoice:function(e,t){return this.childrenMap.choicesSizer.forEachButtton(e,t),this},forEachAction:function(e,t){return this.childrenMap.actionsSizer.forEachButtton(e,t),this}});var Wo=Xo;qn.register("dialog",function(e){var t=new Wo(this.scene,e);return this.scene.add.existing(t),t}),ut(window,"RexPlugins.UI.Dialog",Wo);var Fo=Wo,Vo={v:0,vertical:0,h:1,horizontal:1},No=Phaser.Utils.Objects.GetValue,Go=function(e,t){void 0===t&&(t="scrollMode");var n=No(e,"scrollMode",0);return"string"==typeof n&&(n=Vo[n]),n},Ho=Phaser.Math.Percent,Ko=function(e,t,n){var i,o,r;return e.y===t.y?(i=Math.min(e.x,t.x),o=Math.max(e.x,t.x),r=Ho(n.x,i,o)):e.x===t.x&&(i=Math.min(e.y,t.y),o=Math.max(e.y,t.y),r=Ho(n.y,i,o)),r},qo={},Uo=function(e,t,n){this.enable&&(qo.x=t,qo.y=n,this.value=Ko(this.getStartPoint(),this.getEndPoint(),qo))},Zo={},Jo=function(e,t,n){this.enable&&e.isDown&&(Zo.x=e.worldX,Zo.y=e.worldY,this.value=Ko(this.getStartPoint(),this.getEndPoint(),Zo))},$o=Phaser.Display.Align.In.QuickSet,Qo={},er=function(e,t){void 0===t&&(t=Qo);var n=this.childrenMap.thumb,i=n.x,o=n.y;return $o(n,this,e),t.x=n.x,t.y=n.y,n.x=i,n.y=o,t},tr=Phaser.Display.Align.LEFT_CENTER,nr=Phaser.Display.Align.TOP_CENTER,ir={},or=Phaser.Display.Align.RIGHT_CENTER,rr=Phaser.Display.Align.BOTTOM_CENTER,ar={},sr=Phaser.Math.Linear,lr={},cr=Phaser.Display.Align.In.QuickSet,ur=Phaser.Display.Align.LEFT_CENTER,hr=Phaser.Display.Align.TOP_CENTER,dr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),pr=Phaser.Utils.Objects.GetValue,fr=Phaser.Math.Clamp,gr=Phaser.Math.Linear,mr=Phaser.Math.Percent,yr=Phaser.Math.Snap.To,br=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.type="rexSlider",i.eventEmitter=pr(n,"eventEmitter",i);var o=pr(n,"background",void 0),r=pr(n,"track",void 0),a=pr(n,"indicator",void 0),s=pr(n,"thumb",void 0),l=pr(n,"space.left",0),c=pr(n,"space.right",0),u=pr(n,"space.top",0),h=pr(n,"space.bottom",0);o&&i.addBackground(o),r&&i.add(r,0,void 0,{left:l,right:c,top:u,bottom:h},!0),a&&i.add(a,null),s&&i.add(s,null);var d=pr(n,"input",0);switch("string"==typeof d&&(d=vr[d]),d){case 0:s&&(s.setInteractive(),i.scene.input.setDraggable(s),s.on("drag",Uo,i));break;case 1:i.setInteractive().on("pointerdown",Jo,i).on("pointermove",Jo,i)}i.addChildrenMap("background",o),i.addChildrenMap("track",r),i.addChildrenMap("indicator",a),i.addChildrenMap("thumb",s);var p=pr(n,"valuechangeCallback",null);if(null!==p){var f=pr(n,"valuechangeCallbackScope",void 0);i.eventEmitter.on("valuechange",p,f)}return i.setEnable(pr(n,"enable",void 0)),i.setGap(pr(n,"gap",void 0)),i.setValue(pr(n,"value",0)),i}return dr(t,e),t.prototype.setEnable=function(e){return void 0===e&&(e=!0),this.enable=e,this},t.prototype.setGap=function(e){return this.gap=e,this},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){void 0!==this.gap&&(e=yr(e,this.gap));var t=this._value;this._value=fr(e,0,1),t!==this._value&&(this.updateThumb(this._value),this.updateIndicator(this._value),this.eventEmitter.emit("valuechange",this._value,t,this.eventEmitter))},enumerable:!0,configurable:!0}),t.prototype.setValue=function(e,t,n){return null==e?this:(void 0!==t&&(e=mr(e,t,n)),this.value=e,this)},t.prototype.addValue=function(e,t,n){return void 0!==t&&(e=mr(e,t,n)),this.value+=e,this},t.prototype.getValue=function(e,t){var n=this.value;return void 0!==e&&(n=gr(e,t,n)),n},t.prototype.layout=function(t,n,i){return e.prototype.layout.call(this,t,n,i),this.updateThumb(),this.updateIndicator(),this},t}(xo),vr={drag:0,click:1,none:-1};Object.assign(br.prototype,{getStartPoint:function(e){return void 0===e&&(e=ir),this.childrenMap.thumb?er.call(this,0===this.orientation?nr:tr,e):0===this.orientation?(e.x=this.centerX,e.y=this.top+1):(e.x=this.left+1,e.y=this.centerY),e},getEndPoint:function(e){return void 0===e&&(e=ar),this.childrenMap.thumb?er.call(this,1===this.orientation?or:rr,e):0===this.orientation?(e.x=this.centerX,e.y=this.bottom-1):(e.x=this.right-1,e.y=this.centerY),e},updateThumb:function(e){var t=this.childrenMap.thumb;return void 0===t?this:(void 0===e&&(e=this.value),function(e,t,n,i){void 0===i&&(i=lr),i.x=sr(t.x,n.x,e),i.y=sr(t.y,n.y,e)}(e,this.getStartPoint(),this.getEndPoint(),t),this.resetChildPositionState(t),this)},updateIndicator:function(e){var t,n,i=this.childrenMap.indicator;if(void 0===i)return this;void 0===e&&(e=this.value);var o=this.childrenMap.thumb;o?0===this.orientation?n=o.y-o.displayHeight*o.originY+o.displayHeight-this.top:t=o.x-o.displayWidth*o.originX+o.displayWidth-this.left:0===this.orientation?n=this.height*e:t=this.width*e,On(i,t,n),cr(i,this,1===this.orientation?ur:hr),this.resetChildPositionState(i)}});var wr=br,xr=function(){function e(e){var t=kt()(e,"states",void 0);t&&this.addStates(t);var n=kt()(e,"extend",void 0);if(n)for(var i in n)this.hasOwnProperty(i)&&void 0!==this[i]||(this[i]=n[i]);var o=kt()(e,"eventEmitter",void 0),r=kt()(e,"EventEmitterClass",void 0);this.setEventEmitter(o,r),this._stateLock=!1,this.resetFromJSON(e)}return e.prototype.shutdown=function(){this.destroyEventEmitter()},e.prototype.destroy=function(){this.shutdown()},e.prototype.resetFromJSON=function(e){this.setEnable(kt()(e,"enable",!0)),this.start(kt()(e,"start",void 0));var t=kt()(e,"init",void 0);return t&&t.call(this),this},e.prototype.toJSON=function(){return{curState:this.state,prevState:this.prevState,enable:this.enable,start:this._start}},e.prototype.setEnable=function(e){return void 0===e&&(e=!0),this.enable=e,this},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){if(this.enable&&!this._stateLock&&this._state!==e){if(this._prevState=this._state,this._state=e,this._stateLock=!0,this.emit("statechange",this),null!=this._prevState){var t="exit_"+this._prevState,n=this[t];n&&n.call(this),this.emit(t,this)}if(this._stateLock=!1,null!=this._state){var i="enter_"+this._state,o=this[i];o&&o.call(this),this.emit(i,this)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"prevState",{get:function(){return this._prevState},enumerable:!0,configurable:!0}),e.prototype.start=function(e){return this._start=e,this._prevState=void 0,this._state=e,this},e.prototype.goto=function(e){return null!=e&&(this.state=e),this},e.prototype.next=function(){var e,t=this["next_"+this.state];return t&&(e="string"==typeof t?t:t.call(this)),this.goto(e),this},e.prototype.addState=function(e,t){var n=kt()(t,"next",void 0);n&&(this["next_"+e]=n);var i=kt()(t,"exit",void 0);i&&(this["exit_"+e]=i);var o=kt()(t,"enter",void 0);return o&&(this["enter_"+e]=o),this},e.prototype.addStates=function(e){for(var t in e)this.addState(t,e[t]);return this},e.prototype.update=function(e,t,n){void 0===n&&(n="update");var i=this[n+"_"+this.state];i&&i.call(this,e,t)},e.prototype.preupdate=function(e,t){this.update(e,t,"preupdate")},e.prototype.postupdate=function(e,t){this.update(e,t,"postupdate")},e}();Object.assign(xr.prototype,Fe);var Cr=xr,kr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Tr=function(e){function t(t,n){var i=e.call(this,n)||this;return i.parent=t,i.init(),i}return kr(t,e),t.prototype.init=function(){this.start("IDLE")},t.prototype.next_IDLE=function(){var e,t=this.parent;return t.dragState.isDown&&(e=0===t.dragThreshold?"DRAG":"DRAGBEGIN"),e},t.prototype.update_IDLE=function(e,t){this.next()},t.prototype.next_DRAGBEGIN=function(){var e=this.parent,t=e.dragState;return t.isDown?t.pointer.getDistance()>=e.dragThreshold?"DRAG":"DRAGBEGIN":"IDLE"},t.prototype.update_DRAGBEGIN=function(e,t){this.next()},t.prototype.next_DRAG=function(){var e,t=this.parent;return t.dragState.isUp&&(e=t.outOfBounds?"BACK":t.slidingEnable?"SLIDE":"IDLE"),e},t.prototype.update_DRAG=function(e,t){var n=this.parent;n.dragState.justMoved&&n.dragging(),this.next()},t.prototype.next_SLIDE=function(){var e,t=this.parent;return t.dragState.isDown?e="DRAG":t.isSliding||(e="IDLE"),e},t.prototype.enter_SLIDE=function(){this.parent.onSliding()},t.prototype.exit_SLIDE=function(){this.parent.stop()},t.prototype.update_SLIDE=function(e,t){this.parent.sliding(e,t),this.next()},t.prototype.next_BACK=function(){var e,t=this.parent;return t.dragState.isDown?e="DRAG":t.isPullBack||(e="IDLE"),e},t.prototype.enter_BACK=function(){this.parent.onPullBack()},t.prototype.exit_BACK=function(){this.parent.stop()},t.prototype.update_BACK=function(e,t){this.parent.pullBack(e,t),this.next()},t}(Cr),Pr=Phaser.Utils.Objects.GetValue,Or=Phaser.Math.Distance.Between,Ar=function(){function e(e,t){this.gameObject=e,this.scene=Ge(e),this.setEventEmitter(Pr(t,"eventEmitter",void 0)),e.setInteractive(Pr(t,"inputConfig",void 0)),this.resetFromJSON(t),this.boot()}return e.prototype.resetFromJSON=function(e){return this.pointer=void 0,this.isInTouched=!1,this.holdStartTime=void 0,this.x=void 0,this.y=void 0,this.preX=void 0,this.preY=void 0,this.localX=void 0,this.localY=void 0,this.justMoved=!1,this.setEnable(Pr(e,"enable",!0)),this.holdThreshold=Pr(e,"holdThreshold",50),this},e.prototype.boot=function(){this.gameObject.on("pointerdown",this.onPointIn,this),this.gameObject.on("pointerover",this.onPointIn,this),this.gameObject.on("pointerup",this.onPointOut,this),this.gameObject.on("pointerout",this.onPointOut,this),this.gameObject.on("pointermove",this.onPointerMove,this),this.gameObject.once("destroy",this.destroy,this),this.scene.events.on("preupdate",this.preupdate,this)},e.prototype.shutdown=function(){this.scene&&this.scene.events.off("preupdate",this.preupdate,this),this.pointer=void 0,this.gameObject=void 0,this.scene=void 0,this.destroyEventEmitter()},e.prototype.destroy=function(){this.shutdown()},e.prototype.setEnable=function(e){return void 0===e&&(e=!0),this.enable===e?this:(e||(this.isInTouched=!1,this.pointer=void 0),this.enable=e,this.gameObject.input.enabled=e,this)},Object.defineProperty(e.prototype,"isDown",{get:function(){return this.pointer&&this.pointer.isDown},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUp",{get:function(){return!this.isDown},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dx",{get:function(){return this.x-this.preX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dy",{get:function(){return this.y-this.preY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dt",{get:function(){return this.scene.sys.game.loop.delta},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"speed",{get:function(){return this.x===this.preX&&this.y===this.preY?0:Or(this.preX,this.preY,this.x,this.y)/(.001*this.dt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"speedX",{get:function(){return this.dx/(.001*this.dt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"speedY",{get:function(){return this.dy/(.001*this.dt)},enumerable:!0,configurable:!0}),e.prototype.onPointIn=function(e,t,n){e.isDown&&void 0===this.pointer&&(this.pointer=e,this.localX=t,this.localY=n)},e.prototype.onPointOut=function(e){this.pointer===e&&(this.pointer=void 0)},e.prototype.onPointerMove=function(e,t,n){e.isDown&&this.pointer===e&&(this.localX=t,this.localY=n)},e.prototype.preupdate=function(e,t){var n=this.pointer;this.justMoved=!1,n&&!this.isInTouched?(this.x=n.x,this.y=n.y,this.preX=n.x,this.preY=n.y,this.isInTouched=!0,this.holdStartTime=void 0,this.emit("touchstart",n,this.localX,this.localY)):n&&this.isInTouched?this.x===n.x&&this.y===n.y?void 0===this.holdStartTime?this.holdStartTime=e:e-this.holdStartTime>this.holdThreshold&&(this.preX=this.x,this.preY=this.y):(this.preX=this.x,this.preY=this.y,this.x=n.x,this.y=n.y,this.holdStartTime=void 0,this.justMoved=!0,this.emit("touchmove",n,this.localX,this.localY)):!n&&this.isInTouched&&(this.isInTouched=!1,this.holdStartTime=void 0,this.emit("touchend",n))},e}();Object.assign(Ar.prototype,Fe);var Sr=Ar,Ir=Phaser.Utils.Objects.GetValue,Er=function(){function e(e){this.resetFromJSON(e)}return e.prototype.resetFromJSON=function(e){return this.setValue(Ir(e,"value",0)),this.setSpeed(Ir(e,"speed",0)),this.setAcceleration(Ir(e,"acceleration",0)),this},e.prototype.reset=function(){this.setValue(0),this.setSpeed(0),this.setAcceleration(0)},e.prototype.setValue=function(e){return this.value=e,this},e.prototype.setSpeed=function(e){return this.speed=e,this},e.prototype.setAcceleration=function(e){return this.acceleration=e,this},e.prototype.updateSpeed=function(e){return 0!==this.acceleration&&(this.speed+=this.acceleration*e,this.speed<0&&(this.speed=0)),this},e.prototype.getDeltaValue=function(e){return this.updateSpeed(e),this.speed<=0?0:this.speed*e},e.prototype.update=function(e){return this.updateSpeed(e),this.speed>0&&(this.value+=this.getDeltaValue(e)),this},Object.defineProperty(e.prototype,"isMoving",{get:function(){return this.speed>0},enumerable:!0,configurable:!0}),e}(),Mr=function(){function e(){this.movement=new Er}return e.prototype.init=function(e,t,n,i,o){return this.value=e,this.end=o,this.dir=void 0!==o?e<o:t,this.movement.setSpeed(n).setAcceleration(-i),this},e.prototype.stop=function(){this.movement.reset()},e.prototype.update=function(e){var t=this.movement.getDeltaValue(e);return this.dir||(t=-t),void 0===this.end?this.value+=t:0===t?this.value=this.end:(this.value+=t,this.dir?this.value>this.end&&(this.value=this.end):this.value<this.end&&(this.value=this.end)),this},Object.defineProperty(e.prototype,"isMoving",{get:function(){return this.movement.isMoving},enumerable:!0,configurable:!0}),e}(),Br=Phaser.Utils.Objects.GetValue,zr=function(){function e(e,t){this.gameObject=e,this.scene=Ge(e),this.setEventEmitter(Br(t,"eventEmitter",void 0));var n=Br(t,"enable",!0);this._state=new Tr(this,{enable:n,eventEmitter:!1});var i={inputConfig:Br(t,"inputConfig",void 0),enable:n,eventEmitter:!1};this.dragState=new Sr(e,i),this._value=void 0,this._slowDown=new Mr;var o=Br(t,"valuechangeCallback",null);if(null!==o){var r=Br(t,"valuechangeCallbackScope",void 0);this.on("valuechange",o,r)}null!==(o=Br(t,"overmaxCallback",null))&&(r=Br(t,"overmaxCallbackScope",void 0),this.on("overmax",o,r)),null!==(o=Br(t,"overminCallback",null))&&(r=Br(t,"overminCallbackScope",void 0),this.on("overmin",o,r)),this.resetFromJSON(t),this.boot()}return e.prototype.resetFromJSON=function(e){this.setOrientationMode(Br(e,"orientation",0)),this.setDragThreshold(Br(e,"threshold",10)),this.setSlidingDeceleration(Br(e,"slidingDeceleration",5e3)),this.setBackDeceleration(Br(e,"backDeceleration",2e3));var t=Br(e,"bounds",void 0);return t?this.setBounds(t):this.setBounds(Br(e,"max",0),Br(e,"min",0)),this.setValue(Br(e,"value",this.maxValue||0)),this.setEnable(Br(e,"enable",!0)),this},e.prototype.boot=function(){this.scene.events.on("update",this._state.update,this._state),this.gameObject.once("destroy",this.destroy,this)},e.prototype.shutdown=function(){this.destroyEventEmitter(),this.scene&&this.scene.events.off("update",this._state.update,this._state),this.gameObject=void 0,this.scene=void 0,this._state.destroy(),this.dragState.destroy()},e.prototype.destroy=function(){this.shutdown()},e.prototype.setOrientationMode=function(e){return"string"==typeof e&&(e=jr[e]),this.orientationMode=e,this},e.prototype.setDragThreshold=function(e){return this.dragThreshold=e,this},e.prototype.setSlidingDeceleration=function(e){return this.slidingDeceleration=e,this},e.prototype.setBackDeceleration=function(e){return this.backDeceleration=e,this},e.prototype.setBounds=function(e,t){if(Array.isArray(e)){var n=e;e=n[0],t=n[1]}return e<t?(this.minValue=e,this.maxValue=t):(this.minValue=t,this.maxValue=e),this},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){if(e!==this._value){var t=this._value,n=this.overMax(e),i=this.overMin(e);n&&this.emit("overmax",e,t),i&&this.emit("overmin",e,t),this.backEnable||(n&&(e=this.maxValue),i&&(e=this.minValue)),this._value=e,this.emit("valuechange",e,t)}},enumerable:!0,configurable:!0}),e.prototype.setValue=function(e){this.value=e},e.prototype.setEnable=function(e){return this._state.setEnable(e),this.dragState.setEnable(e),this},Object.defineProperty(e.prototype,"state",{get:function(){return this._state.state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDragging",{get:function(){return this.dragState.isInTouched},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outOfMaxBound",{get:function(){return this.overMax(this.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outOfMinBound",{get:function(){return this.overMin(this.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outOfBounds",{get:function(){return this.outOfMinBound||this.outOfMaxBound},enumerable:!0,configurable:!0}),e.prototype.overMax=function(e){return null!=this.maxValue&&e>this.maxValue},e.prototype.overMin=function(e){return null!=this.minValue&&e<this.minValue},Object.defineProperty(e.prototype,"backEnable",{get:function(){return"number"==typeof this.backDeceleration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPullBack",{get:function(){return this._slowDown.isMoving},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"slidingEnable",{get:function(){return"number"==typeof this.slidingDeceleration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSliding",{get:function(){return this._slowDown.isMoving},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragDelta",{get:function(){return 0===this.orientationMode?this.dragState.dy:1===this.orientationMode?this.dragState.dx:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragSpeed",{get:function(){return 0===this.orientationMode?this.dragState.speedY:1===this.orientationMode?this.dragState.speedX:0},enumerable:!0,configurable:!0}),e.prototype.dragging=function(){this.value+=this.dragDelta},e.prototype.onSliding=function(){var e=this.value,t=this.dragSpeed;if(0===t)return this._slowDown.stop(),void this._state.next();var n=this.slidingDeceleration;this._slowDown.init(e,t>0,Math.abs(t),n)},e.prototype.sliding=function(e,t){var n=this._slowDown.update(t*=.001).value;this.overMax(n)?(this.value=this.maxValue,this._slowDown.stop()):this.overMin(n)?(this.value=this.minValue,this._slowDown.stop()):this.value=n},e.prototype.onPullBack=function(){var e=this.value,t=this.outOfMinBound?this.minValue:this.maxValue,n=Math.abs(t-e),i=this.backDeceleration,o=Math.sqrt(2*i*n);this._slowDown.init(e,void 0,o,i,t)},e.prototype.pullBack=function(e,t){this.value=this._slowDown.update(t*=.001).value,this._slowDown.isMoving||this._state.next()},e.prototype.stop=function(){this._slowDown.stop()},e}();Object.assign(zr.prototype,Fe);var jr={y:0,v:0,vertical:0,x:1,h:1,horizontal:1},_r=zr,Dr=Phaser.Utils.Objects.GetValue,Lr=function(e){var t,n,i=this.scene,o=Go(e),r=new xo(i,{orientation:o}),a=Dr(e,"child.gameObject",void 0),s=Dr(e,"slider",void 0),l=Dr(e,"scroller",!0);if(a){var c=Dr(e,"space.child",0);if(this.childPadding={},"number"!=typeof c){var u=c;0===o?(c=Dr(u,"right",0),this.childPadding.top=Dr(u,"top",0),this.childPadding.bottom=Dr(u,"bottom",0)):(c=Dr(u,"bottom",0),this.childPadding.top=Dr(u,"left",0),this.childPadding.bottom=Dr(u,"right",0))}else this.childPadding.top=0,this.childPadding.bottom=0;var h=Dr(e,"child.proportion",1),d=Dr(e,"child.expand",!0);r.add(a,h,"center",0===o?{right:s?c:0}:{bottom:s?c:0},d),s&&(!0===s&&(s={}),s.orientation=r.orientation,t=new wr(i,s),r.add(t,0,"center",0,!0)),l&&(!0===l&&(l={}),l.orientation=o,n=new _r(a,l))}return t&&t.on("valuechange",function(e){this.t=e},this),n&&n.on("valuechange",function(e){this.childOY=e},this),this.addChildrenMap("child",a),this.addChildrenMap("slider",t),this.addChildrenMap("scroller",n),r},Yr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Rr=Phaser.Utils.Objects.GetValue,Xr=function(e){function t(t,n){var i=this;void 0===n&&(n={});var o=Go(n);n.orientation=0===o?1:0,(i=e.call(this,t,n)||this).type=Rr(n,"type","rexScrollable");var r=Rr(n,"background",void 0),a=Lr.call(i,n),s=Rr(n,"header",void 0),l=Rr(n,"footer",void 0),c=Rr(n,"space.left",0),u=Rr(n,"space.right",0),h=Rr(n,"space.top",0),d=Rr(n,"space.bottom",0);if(r&&i.addBackground(r),s){var p=Rr(n,"align.header","center"),f=Rr(n,"space.header",0);m=0===o?{left:c,right:u,top:h,bottom:f}:{left:c,right:f,top:h,bottom:d};var g=Rr(n,"expand.header",!0);i.add(s,0,p,m,g)}if(a&&i.add(a,1,"center",m=0===o?{left:c,right:u,top:s?0:h,bottom:l?0:d}:{left:s?0:c,right:l?0:u,top:h,bottom:d},!0),l){p=Rr(n,"align.footer","center");var m,y=Rr(n,"space.footer",0);m=0===o?{left:c,right:u,top:y,bottom:d}:{left:y,right:u,top:h,bottom:d},g=Rr(n,"expand.footer",!0),i.add(l,0,p,m,g)}return i.addChildrenMap("background",r),i.addChildrenMap("header",s),i.addChildrenMap("footer",l),i}return Yr(t,e),t.prototype.layout=function(t,n,i){return e.prototype.layout.call(this,t,n,i),this.resizeController(),this},t.prototype.resizeController=function(){var e=this.topChildOY,t=this.bottomChildOY,n=this.childrenMap.scroller,i=this.childrenMap.slider;return n&&n.setBounds(t,e),i&&i.setEnable(t!==e),this.updateController(),this},t.prototype.updateController=function(){var e=this.childrenMap.scroller,t=this.childrenMap.slider;e&&e.setValue(this.childOY),t&&t.setValue(this.t)},Object.defineProperty(t.prototype,"t",{get:function(){var e=this.childrenMap.child.t,t=this.childPadding;if(0!==t.top||0!==t.bottom){var n=this.childrenMap.child,i=n.topChildOY-n.bottomChildOY;e=(i*e+t.top)/(i+t.top+t.bottom)}return e},set:function(e){var t=this.childPadding;if(0!==t.top||0!==t.bottom){var n=this.childrenMap.child,i=n.topChildOY-n.bottomChildOY;e=((i+t.top+t.bottom)*e-t.top)/i}this.childrenMap.child.t=e,this.updateController()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childOY",{get:function(){return this.childrenMap.child.childOY},set:function(e){this.childrenMap.child.childOY=e,this.updateController()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topChildOY",{get:function(){return this.childrenMap.child.topChildOY+this.childPadding.top},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomChildOY",{get:function(){return this.childrenMap.child.bottomChildOY-this.childPadding.bottom},enumerable:!0,configurable:!0}),t.prototype.setChildOY=function(e){return this.childOY=e,this},t.prototype.setT=function(e){return this.t=e,this},t.prototype.scrollToTop=function(){return this.t=0,this},t.prototype.scrollToBottom=function(){return this.t=1,this},Object.defineProperty(t.prototype,"sliderEnable",{get:function(){var e=this.childrenMap.slider;if(e)return e.enable},set:function(e){var t=this.childrenMap.slider;t&&t.setEnable(e)},enumerable:!0,configurable:!0}),t.prototype.setSliderEnable=function(e){return void 0===e&&(e=!0),this.sliderEnable=e,this},Object.defineProperty(t.prototype,"scrollerEnable",{get:function(){var e=this.childrenMap.scroller;if(e)return e.enable},set:function(e){var t=this.childrenMap.scroller;t&&t.setEnable(e)},enumerable:!0,configurable:!0}),t.prototype.setScrollerEnable=function(e){return void 0===e&&(e=!0),this.scrollerEnable=e,this},t}(xo),Wr=function(e){Object.defineProperty(e,"childOY",{configurable:!0,get:function(){return e.tableOY},set:function(t){e.tableOY=t}}),Object.defineProperty(e,"topChildOY",{get:function(){return e.topTableOY}}),Object.defineProperty(e,"bottomChildOY",{get:function(){return e.bottomTableOY}})},Fr=function(e){e.on("cellvisible",function(e,t){var n,i=this.createCellContainerCallback,o=this.createCellContainerCallbackScope;e.item=this.items[e.index],(n=o?i.call(o,e,t):i(e,t)).setOrigin&&n.setOrigin(0),n.isRexSizer&&n.layout(),e.item=void 0,e.setContainer(n)},this)},Vr=function(e,t,n,i,o){var r;if(null!=(r=void 0===o?i:n.pointerToCellIndex(i,o))){var a=n.getCellContainer(r);e.emit(t,a,r)}},Nr=function(e){if(!e.isDown){var t=this.childrenMap.child,n=t.pointerToCellIndex(e.x,e.y);if(n!==this._lastOverCellIndex){var i=this._lastOverCellIndex;this._lastOverCellIndex=n,Vr(this.eventEmitter,"cell.out",t,i),Vr(this.eventEmitter,"cell.over",t,n)}}},Gr=function(){var e=this.childrenMap.child,t=this._lastOverCellIndex;this._lastOverCellIndex=void 0,Vr(this.eventEmitter,"cell.out",e,t)},Hr=Phaser.Utils.Objects.GetValue,Kr=function(){function e(e,t){this.parent=e,this._isRunning=!1,this.tickingState=!1,this.setEventEmitter(Hr(t,"eventEmitter",void 0)),this.setTickingMode(Hr(t,"tickingMode",1))}return e.prototype.boot=function(){2!==this.tickingMode||this.tickingState||this.startTicking()},e.prototype.shutdown=function(){this.destroyEventEmitter(),this.tickingState&&this.stopTicking()},e.prototype.setTickingMode=function(e){"string"==typeof e&&(e=qr[e]),this.tickingMode=e},e.prototype.startTicking=function(){this.tickingState=!0},e.prototype.stopTicking=function(){this.tickingState=!1},Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._isRunning},set:function(e){this._isRunning!==e&&(this._isRunning=e,1===this.tickingMode&&e!=this.tickingState&&(e?this.startTicking():this.stopTicking()))},enumerable:!0,configurable:!0}),e.prototype.start=function(){return this.isRunning=!0,this},e.prototype.pause=function(){return this.isRunning=!1,this},e.prototype.resume=function(){return this.isRunning=!0,this},e.prototype.stop=function(){return this.isRunning=!1,this},e.prototype.complete=function(){this.isRunning=!1,this.emit("complete",this.parent,this)},e}();Object.assign(Kr.prototype,Fe);var qr={no:0,lazy:1,always:2},Ur=Kr,Zr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Jr=Phaser.Utils.Objects.GetValue,$r=function(e){function t(t,n){var i=this,o=Ge(t);return o===t&&(t=void 0),(i=e.call(this,o,n)||this).scene=o,i.gameObject=t,t&&t.setInteractive(Jr(n,"inputConfig",void 0)),i.resetFromJSON(n),i.boot(),i}return Zr(t,e),t.prototype.resetFromJSON=function(e){return this.setEnable(Jr(e,"enable",!0)),this.bounds=void 0===this.gameObject?Jr(e,"bounds",void 0):void 0,this.tracerState=Qr,this.pointer=void 0,this.lastPointer=void 0,this.movedState=!1,this.isTouchingAnyObject=!1,this},t.prototype.boot=function(){e.prototype.boot.call(this),this.gameObject?this.gameObject.on("pointerdown",this.onPointerDown,this):this.scene.input.on("pointerdown",this.onPointerDown,this),this.scene.input.on("pointerup",this.onPointerUp,this),this.scene.input.on("pointermove",this.onPointerMove,this),this.scene.events.once("shutdown",this.destroy,this)},t.prototype.shutdown=function(){this.gameObject?this.gameObject.off("pointerdown",this.onPointerDown,this):this.scene&&this.scene.input.off("pointerdown",this.onPointerDown,this),this.scene&&(this.scene.input.off("pointerup",this.onPointerUp,this),this.scene.input.off("pointermove",this.onPointerMove,this),this.scene.events.off("destroy",this.destroy,this),this.scene=void 0),this.scene=void 0,this.gameObject=void 0,this.bounds=void 0,this.pointer=void 0,this.lastPointer=void 0,this.movedState=!1,e.prototype.shutdown.call(this)},t.prototype.destroy=function(){this.shutdown()},t.prototype.setEnable=function(e){return void 0===e&&(e=!0),this.enable===e?this:(e||this.dragCancel(),this.enable=e,this)},t.prototype.onPointerDown=function(e,t){this.enable&&void 0===this.pointer&&(!this.bounds||this.bounds.contains(e.x,e.y))&&this.pointer!==e&&(this.pointer=e,this.lastPointer=e,this.movedState=!1,this.tracerState=ea,void 0===this.gameObject&&(this.isTouchingAnyObject=t.length>0),this.onDragStart())},t.prototype.onPointerUp=function(e){this.enable&&(!this.bounds||this.bounds.contains(e.x,e.y))&&this.pointer===e&&(this.pointer=void 0,this.movedState=!1,this.tracerState=Qr,this.onDragEnd())},t.prototype.onPointerMove=function(e){if(this.enable&&e.isDown){var t=!this.bounds||this.bounds.contains(e.x,e.y),n=this.pointer===e;!n&&t||(n&&!t?this.onPointerUp(e):(this.movedState||(this.movedState=e.x!==e.downX||e.y!==e.downY),this.movedState&&this.onDrag()))}},t.prototype.dragCancel=function(){return this.tracerState===ea&&this.onDragEnd(),this.pointer=void 0,this.tracerState=Qr,this},t.prototype.onDragStart=function(){this.emit("dragstart",this)},t.prototype.onDragEnd=function(){this.emit("dragend",this)},t.prototype.onDrag=function(){this.emit("drag",this)},t.prototype.preUpdate=function(e,t){},t.prototype.postUpdate=function(e,t){},t.prototype.startTicking=function(){e.prototype.startTicking.call(this),this.scene.events.on("preupdate",this.preUpdate,this),this.scene.events.on("postupdate",this.postUpdate,this)},t.prototype.stopTicking=function(){e.prototype.stopTicking.call(this),this.scene&&(this.scene.events.off("preupdate",this.preUpdate,this),this.scene.events.off("postupdate",this.postUpdate,this))},t.prototype.setRecongizedStateObject=function(e){return this.recongizedState=e,this},Object.defineProperty(t.prototype,"state",{get:function(){return this.recongizedState.state},set:function(e){this.recongizedState.state=e},enumerable:!0,configurable:!0}),t.prototype.cancel=function(){return this.state=ta,this},t}(Ur),Qr=0,ea=1,ta="IDLE",na=$r,ia=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),oa=Phaser.Utils.Objects.GetValue,ra=Phaser.Math.Distance.Between,aa=function(e){function t(t,n){var i=e.call(this,t,n)||this,o=i;return i.setRecongizedStateObject(new Cr({states:{IDLE:{enter:function(){o.stop(),o.tapsCount=0,o.x=0,o.y=0,o.worldX=0,o.worldY=0},exit:function(){var e=o.lastPointer;o.x=e.x,o.y=e.y,o.worldX=e.worldX,o.worldY=e.worldY}},BEGIN:{enter:function(){o.start(),o.tapsCount=0,o.emit("tappingstart",o,o.gameObject,o.lastPointer)}},RECOGNIZED:{enter:function(){o.start(),o.emit("tap",o,o.gameObject,o.lastPointer),o.emit(o.tapsCount+"tap",o,o.gameObject,o.lastPointer)}}},init:function(){this.state=sa},eventEmitter:!1})),i}return ia(t,e),t.prototype.resetFromJSON=function(t){e.prototype.resetFromJSON.call(this,t),this.setMaxHoldTime(oa(t,"time",250)),this.setTapInterval(oa(t,"tapInterval",200)),this.setDragThreshold(oa(t,"threshold",9)),this.setTapOffset(oa(t,"tapOffset",10));var n=oa(t,"taps",void 0);return void 0!==n?this.setTaps(n):(this.setMaxTaps(oa(t,"maxTaps",void 0)),this.setMinTaps(oa(t,"minTaps",void 0))),this},t.prototype.onDragStart=function(){switch(this.state){case sa:this.state=la;break;case la:var e=this.lastPointer;ra(e.upX,e.upY,e.x,e.y)>this.tapOffset&&(this.state=ca,this.state=la);break;case ca:this.state=la}},t.prototype.onDragEnd=function(){this.state===la&&(this.tapsCount++,this.emit("tapping",this,this.gameObject,this.lastPointer),void 0!==this.maxTaps&&this.tapsCount===this.maxTaps&&(this.state=ca))},t.prototype.onDrag=function(){this.state!==sa&&this.pointer.getDistance()>this.dragThreshold&&(this.state=sa)},t.prototype.preUpdate=function(e,t){if(this.state===la){var n=this.lastPointer;n.isDown?e-n.downTime>this.holdTime&&(this.state=sa):e-n.upTime>this.tapInterval&&(this.state=void 0===this.minTaps||this.tapsCount>=this.minTaps?ca:sa)}},t.prototype.postUpdate=function(e,t){this.state===ca&&(this.state=sa)},Object.defineProperty(t.prototype,"isTapped",{get:function(){return this.state===ca},enumerable:!0,configurable:!0}),t.prototype.setMaxHoldTime=function(e){return this.holdTime=e,this},t.prototype.setTapInterval=function(e){return this.tapInterval=e,this},t.prototype.setDragThreshold=function(e){return this.dragThreshold=e,this},t.prototype.setTapOffset=function(e){return this.tapOffset=e,this},t.prototype.setMaxTaps=function(e){return this.maxTaps=e,this},t.prototype.setMinTaps=function(e){return this.minTaps=e,this},t.prototype.setTaps=function(e,t){return void 0===t&&(t=e),this.setMinTaps(e).setMaxTaps(t),this},t}(na),sa="IDLE",la="BEGIN",ca="RECOGNIZED",ua=aa,ha=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),da=Phaser.Utils.Objects.GetValue,pa=function(e){function t(t,n){var i=e.call(this,t,n)||this,o=i;return i.setRecongizedStateObject(new Cr({states:{IDLE:{enter:function(){o.x=0,o.y=0,o.worldX=0,o.worldY=0},exit:function(){var e=o.lastPointer;o.x=e.x,o.y=e.y,o.worldX=e.worldX,o.worldY=e.worldY}},BEGIN:{enter:function(){o.start()},exit:function(){o.stop()}},RECOGNIZED:{enter:function(){o.emit("pressstart",o,o.gameObject,o.lastPointer)},exit:function(){o.emit("pressend",o,o.gameObject,o.lastPointer)}}},init:function(){this.state=fa},eventEmitter:!1})),i}return ha(t,e),t.prototype.resetFromJSON=function(t){return e.prototype.resetFromJSON.call(this,t),this.setDragThreshold(da(t,"threshold",9)),this.setMinHoldTime(da(t,"time",251)),this},t.prototype.onDragStart=function(){this.state=0===this.holdTime?ma:ga},t.prototype.onDragEnd=function(){this.state=fa},t.prototype.onDrag=function(){this.state!==fa&&this.pointer.getDistance()>this.dragThreshold&&(this.state=fa)},t.prototype.preUpdate=function(e,t){this.state===ga&&e-this.pointer.downTime>=this.holdTime&&(this.state=ma)},Object.defineProperty(t.prototype,"isPressed",{get:function(){return this.state===ma},enumerable:!0,configurable:!0}),t.prototype.setDragThreshold=function(e){return this.dragThreshold=e,this},t.prototype.setMinHoldTime=function(e){return this.holdTime=e,this},t}(na),fa="IDLE",ga="BEGIN",ma="RECOGNIZED",ya=pa,ba=function(e){e.setInteractive(),(function(e){e._click=new Ze(e,{threshold:10}),e._click.on("click",function(e,t,n){Vr(this.eventEmitter,"cell.click",t,n.x,n.y)},this)}).call(this,e),(function(e){e.on("pointermove",Nr,this).on("pointerover",Nr,this).on("pointerup",Gr,this).on("pointerout",Gr,this)}).call(this,e),(function(e){e._tap=new ua(e),e._tap.on("tap",function(e){Vr(this.eventEmitter,"cell."+e.tapsCount+"tap",e.gameObject,e.x,e.y)},this)}).call(this,e),(function(e){e._press=new ya(e),e._press.on("pressstart",function(e){var t=e.gameObject,n=t.pointerToCellIndex(e.x,e.y);e._cellIndex=n,Vr(this.eventEmitter,"cell.pressstart",t,n)},this).on("pressend",function(e){var t=e.gameObject,n=e._cellIndex;e._cellIndex=void 0,Vr(this.eventEmitter,"cell.pressend",t,n)},this)}).call(this,e)},va=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),wa=Phaser.Utils.Objects.GetValue,xa=function(e){function t(t,n){var i=this;void 0===n&&(n={});var o=Go(n),r=wa(n,"table",void 0);void 0===r&&(r={}),r.scrollMode=o,r.clamplTableOXY=wa(n,"clamplChildOY",!1);var a,s,l=wa(r,"width",void 0),c=wa(r,"height",void 0),u=new Xn(t,0,0,l,c,r);0===o?(a=void 0===l?1:0,s=void 0===c):(a=void 0===c?1:0,s=void 0===l),Wr(u),n.type="rexGridTable",n.child={gameObject:u,proportion:a,expand:s};var h=wa(n,"space",void 0);h&&(h.child=h.table),(i=e.call(this,t,n)||this).addChildrenMap("table",u),i.eventEmitter=wa(n,"eventEmitter",i);var d=wa(n,"createCellContainerCallback",St),p=wa(n,"createCellContainerCallbackScope",void 0);return i.setCreateCellContainerCallback(d,p),Fr.call(i,u),wa(r,"interactive",!0)&&ba.call(i,u),i.setItems(wa(n,"items",[])),i}return va(t,e),t.prototype.setCreateCellContainerCallback=function(e,t){return this.createCellContainerCallback=e,this.createCellContainerCallbackScope=t,this},t.prototype.refresh=function(){return this.childrenMap.child.updateTable(!0),this},t}(Xr);Object.assign(xa.prototype,{setItems:function(e){void 0===e?this.items.length=0:this.items=e;var t=this.childrenMap.child;return t.setCellsCount(this.items.length),t.updateTable(!0),this.resizeController(),this}});var Ca=xa;qn.register("gridTable",function(e){var t=new Ca(this.scene,e);return this.scene.add.existing(t),t}),ut(window,"RexPlugins.UI.GridTable",Ca);var ka=Ca,Ta=function(e){e.stopPropagation()},Pa=function(e){e.addEventListener("touchstart",Ta,!1),e.addEventListener("touchmove",Ta,!1),e.addEventListener("touchend",Ta,!1),e.addEventListener("mousedown",Ta,!1),e.addEventListener("mouseup",Ta,!1),e.addEventListener("mousemove",Ta,!1)},Oa=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Aa=Phaser.GameObjects.DOMElement,Sa=Phaser.Utils.Objects.IsPlainObject,Ia=Phaser.Utils.Objects.GetValue,Ea=function(e){function t(t,n,i,o,r,a){var s=this;Sa(n)?(n=Ia(a=n,"x",0),i=Ia(a,"y",0),o=Ia(a,"width",void 0),r=Ia(a,"height",void 0)):Sa(o)&&(o=Ia(a=o,"width",void 0),r=Ia(a,"height",void 0)),void 0===a&&(a={});var l,c=t.scale.autoRound;void 0!==o&&(c&&(o=Math.floor(o)),a.width=o+"px"),void 0!==r&&(c&&(r=Math.floor(r)),a.height=r+"px");var u,h,d=Ia(a,"type","text");for(var p in"textarea"===d?(l=document.createElement("textarea")).style.resize="none":(l=document.createElement("input")).type=d,Ma)void 0!==(h=Ia(a,p,(u=Ma[p])[1]))&&(l[u[0]]=h);var f,g,m=Ia(a,"style",void 0);for(var p in void 0===m&&(m={}),Ba)void 0!==(g=Ia(a,p,(f=Ba[p])[1]))&&(m[f[0]]=g);var y=l.style;for(var p in a)p in Ma||p in Ba||p in y&&(m[p]=a[p]);m["box-sizing"]="border-box",(s=e.call(this,t,n,i,l,m)||this).type="rexInputText";var b=function(e){v.node[za[e]]=(function(){this.emit(e,this)}).bind(v)},v=this;for(var w in za)b(w);return Pa(s.node),s}return Oa(t,e),t.prototype.resize=function(e,t){var n=this.node.style;return n.width=e+"px",n.height=t+"px",this.updateSize(),this},Object.defineProperty(t.prototype,"text",{get:function(){return this.node.value},set:function(e){this.node.value=e},enumerable:!0,configurable:!0}),t.prototype.setText=function(e){return this.text=e,this},t.prototype.selectText=function(){return this.node.select(),this},Object.defineProperty(t.prototype,"placeholder",{get:function(){return this.node.placeholder},set:function(e){this.node.placeholder=e},enumerable:!0,configurable:!0}),t.prototype.setPlaceholder=function(e){return this.placeholder=e,this},Object.defineProperty(t.prototype,"tooltip",{get:function(){return this.node.title},set:function(e){this.node.title=e},enumerable:!0,configurable:!0}),t.prototype.setTooltip=function(e){return this.tooltip=e,this},t.prototype.setTextChangedCallback=function(e){return this.onTextChanged=e,this},Object.defineProperty(t.prototype,"readOnly",{get:function(){return this.node.readOnly},set:function(e){this.node.readOnly=e},enumerable:!0,configurable:!0}),t.prototype.setReadOnly=function(e){return void 0===e&&(e=!0),this.readOnly=e,this},Object.defineProperty(t.prototype,"spellCheck",{get:function(){return this.node.spellcheck},set:function(e){this.node.spellcheck=e},enumerable:!0,configurable:!0}),t.prototype.setSpellCheck=function(e){return this.spellCheck=e,this},t.prototype.setStyle=function(e,t){return this.node.style[e]=t,this},t.prototype.getStyle=function(e){return this.node.style[e]},t.prototype.scrollToBottom=function(){return this.node.scrollTop=this.node.scrollHeight,this},t.prototype.setEnabled=function(e){return void 0===e&&(e=!0),this.node.disabled=!e,this},t.prototype.setBlur=function(){return this.node.blur(),this},t.prototype.setFocus=function(){return this.node.focus(),this},t}(Aa),Ma={id:["id",void 0],text:["value",void 0],placeholder:["placeholder",void 0],tooltip:["title",void 0],readOnly:["readonly",!1],spellCheck:["spellcheck",!1],autoComplete:["autocomplete","off"]},Ba={align:["text-align",void 0],width:["width",void 0],height:["height",void 0],fontFamily:["font-family",void 0],fontSize:["font-size",void 0],color:["color","#ffffff"],backgroundColor:["backgroundColor","transparent"],borderColor:["borderColor","transparent"],outline:["outline","none"]},za={textchange:"oninput",click:"onclick",dblclick:"ondblclick",focus:"onfocus",blur:"onblur"},ja=Ea,_a=Phaser.Utils.Objects.GetValue,Da=Phaser.Utils.Objects.GetValue,La=function(){function e(e){this.gameObject=e,this.scene=Ge(e),this.inputText=void 0,this.onClose=void 0,this.delayCall=void 0,this.boot()}return e.prototype.boot=function(){return this.gameObject.once("destroy",this.destroy,this),this},e.prototype.shutdown=function(){return this.close(),this.gameObject=void 0,this.scene=void 0,Ya===this&&(Ya=void 0),this},e.prototype.destroy=function(){return this.shutdown(),this},e.prototype.open=function(e,t){var n;void 0!==Ya&&Ya.close(),Ya=this,(n=e)&&"function"==typeof n&&(t=e,e=void 0),void 0===t&&(t=Da(e,"onClose",void 0));var i=Da(e,"onTextChanged",void 0);return this.inputText=function(e,t){void 0===t&&(t={});var n=e.scene,i=e.style,o=_a(t,"backgroundColor",i.backgroundColor);null===o&&(o="transparent"),t.text=_a(t,"text",e.text),t.fontFamily=_a(t,"fontFamily",i.fontFamily),t.fontSize=_a(t,"fontSize",i.fontSize),t.color=_a(t,"color",i.color),t.backgroundColor=o;var r=new ja(n,e.x,e.y,_a(t,"width",e.width),_a(t,"height",e.height),t);return r.setOrigin(e.originX,e.originY),n.add.existing(r),r}(this.gameObject,e).on("textchange",function(e){var t=e.text;i?i(this.gameObject,t):this.gameObject.text=t},this).setFocus(),this.gameObject.setVisible(!1),this.onClose=t,this.scene.input.keyboard.once("keydown-ENTER",this.close,this),this.delayCall=this.scene.time.delayedCall(0,function(){this.scene.input.once("pointerdown",this.close,this)},[],this),this},e.prototype.close=function(){return Ya=void 0,this.inputText?(this.gameObject.setVisible(!0),this.inputText.destroy(),this.inputText=void 0,this.delayCall&&(this.delayCall.remove(),this.delayCall=void 0),this.scene.input.keyboard.off("keydown-ENTER",this.close,this),this.scene.input.off("pointerdown",this.close,this),this.onClose&&this.onClose(this.gameObject),this):this},Object.defineProperty(e.prototype,"isOpened",{get:function(){return void 0!==this.inputText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.isOpened?this.inputText.text:this.gameObject.text},enumerable:!0,configurable:!0}),e}(),Ya=void 0,Ra=La,Xa=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Wa=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.add=new qn(t),i}return Xa(t,e),t.prototype.buttons=function(e,t){return Lo(e,t)},t.prototype.label=function(e,t){return Po(e,t)},t.prototype.roundRectangle=function(e,t){return mi(e,t)},t.prototype.dialog=function(e,t){return Fo(e,t)},t.prototype.gridTable=function(e,t){return ka(e,t)},t}(Phaser.Plugins.ScenePlugin);Object.assign(Wa.prototype,{hide:Io,show:So,isShown:Eo,edit:function(e,t,n){return e._edit||(e._edit=new Ra(e)),e._edit.open(t,n),e._edit}});var Fa=Wa,Va=function(e,t,n,i,o){var r=new pn(this.scene,e,t,n,i,o);return this.scene.add.existing(r),r},Na=Phaser.Utils.Objects.GetAdvancedValue,Ga=Phaser.Utils.Objects.GetValue,Ha=Phaser.GameObjects.BuildGameObject,Ka=function(e){var t=Na(e,"width",1),n=Na(e,"height",t),i=Ga(e,"children",void 0),o=new pn(this.scene,0,0,t,n);return o.syncChildrenEnable=!1,Ha(this.scene,o,e),o.syncChildrenEnable=!0,o.add(i),o},qa=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ua=function(e){function t(t){var n=e.call(this,t)||this;return t.registerGameObject("rexContainerLite",Va,Ka),n}return qa(t,e),t.prototype.start=function(){this.game.events.once("destroy",this.destroy,this)},t}(Phaser.Plugins.BasePlugin);ut(window,"RexPlugins.GameObjects.ContainerLite",pn);var Za=Ua,Ja=n("dQ8B"),$a=n.n(Ja),Qa=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),es=Phaser.Loader.FILE_POPULATED,ts=function(e){function t(t,n){return e.call(this,t,n)||this}return Qa(t,e),t.prototype.load=function(){if(this.state===es)this.loader.nextFile(this,!0);else{var e=this.config;e.active=this.onLoad.bind(this),e.inactive=this.onError.bind(this),e.fontactive=this.onFontActive.bind(this),e.fontinactive=this.onFontInactive.bind(this),$a.a.load(e)}},t.prototype.onLoad=function(){this.loader.nextFile(this,!0)},t.prototype.onError=function(){this.loader.nextFile(this,!1)},t.prototype.onFontActive=function(e,t){this.loader.emit("webfontactive",this,e)},t.prototype.onFontInactive=function(e,t){this.loader.emit("webfontinactive",this,e)},t}(Phaser.Loader.File),ns=Phaser.Utils.Objects.IsPlainObject,is=function(e,t){return ns(e)?(t=e).hasOwnProperty("config")?(t.type="webfont",t.url=""):t={key:"webfont",type:"webfont",url:"",config:t}:t={type:"webfont",url:"",key:e,config:t},this.addFile(new ts(this,t)),this},os=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),rs=(function(e){function t(t){var n=e.call(this,t)||this;return t.registerFileType("rexWebFont",is),n}os(t,e),t.prototype.addToScene=function(e){e.sys.load.rexWebFont=is}}(Phaser.Plugins.BasePlugin),858294);function as(e,t){var n;switch(e){case"image":n=t.rexUI.add.roundRectangle(0,0,100,100,10,16777215);break;case"circle":n=t.rexUI.add.roundRectangle(0,0,20,20,10,16777215);break;default:n=void 0}return n}function ss(e,t,n,i,o,r,a,s,l,c,u){var h,d,p,f,g;return a&&(rs=a),n&&i?(h=n,d=i):(h=(p=e.add.text(0,0,t,{})).getBounds().width,d=p.getBounds().height),f=o||10,g=e.rexUI.add.label(r?{width:h+12,height:d+10,orientation:c,background:e.rexUI.add.roundRectangle(0,0,h,d,f,rs),icon:as(r,e),text:e.add.text(0,0,t,{fontSize:20,align:"center",fontFamily:'"Verdana"',color:"#858585",fontStyle:"bold"}),space:{icon:l||10,left:10,right:10,top:u||1},name:s}:{width:h+12,height:d+20,orientation:0,background:e.rexUI.add.roundRectangle(0,0,h,d,f,14671839),text:e.add.text(0,0,t,{fontSize:18,align:"right",fontFamily:'"Verdana"',color:"#858585"}),space:{left:10,right:10}}),p&&p.destroy(),g}function ls(e){if(Array.isArray(e))e.forEach(function(e){var t=e.getElement("background"),n=e.getElement("text"),i=e.getElement("icon");i&&(i.fillColor=16777215),t.fillColor=14671839,n.setFill("#858585"),n.setBackgroundColor("#dfdfdf")});else{var t=e.getElement("background"),n=e.getElement("text"),i=e.getElement("icon");i&&(i.fillColor=16777215),t.fillColor=14671839,n.setFill("#858585"),n.setBackgroundColor("#dfdfdf")}}function cs(e){var t=e.getElement("background"),n=e.getElement("text"),i=e.getElement("icon");i&&(i.fillColor=13398784),t.fillColor=16769568,n.setFill("#cc7300"),n.setBackgroundColor("#ffe220")}Phaser;var us,hs,ds=function(){function e(){}return e.prototype.confirmAnswer=function(e){return this.status=e.correct_answer===e.user_response||null===e.user_response&&null,this.status},e.prototype.getExplanation=function(){},e.prototype.getCorrection=function(){},e.prototype.sendScore=function(){},e.prototype.diagnosticFeedback=function(){},e}(),ps=function(){function e(e){this.scene=e,this.answerChecker=new ds,this.ask(),this.actionButtons=this.addActionButtons(),this.divider=this.addlines()}return e.prototype.ask=function(){},e.prototype.next=function(){this.scene.questionContainer.clear(!0),this.scene.questionContainer.visible=!0,this.scene.progressBar.count<this.scene.progressBar.barWidth?this.scene.question=this.scene.getQuestion():(this.scene.question=this.scene.getQuestion(),this.scene.scene.start("Finish"))},e.prototype.submitAnswer=function(){},e.prototype.addActionButtons=function(){var e=this,t=this.scene.plugins.get("rexButton"),n=this.scene.rexUI.add.roundRectangle(-250,230,125,50,20,8026746),i=this.scene.rexUI.add.roundRectangle(250,230,125,50,20,7401244),o=this.scene.add.text(250,230,"CHECK",{fill:"#ffffff",font:"bold 25px Gotham"}).setOrigin(.5,.5),r=this.scene.add.text(-250,230,"SKIP",{fill:"#ffffff",font:"bold 25px Gotham"}).setOrigin(.5,.5);return t.add(i,{}).on("click",function(t){e.submitAnswer()}),t.add(n,{}).on("click",function(t){e.next()}),[i,n,o,r]},e.prototype.addlines=function(){ft(this.scene,"dashed",1,.4,5530268);var e=new rt(this.scene,{start:{x:-350,y:200},end:{x:350,y:200},body:{key:"dashed",width:10}});return this.scene.add.existing(e),[e]},e}(),fs=["a man and a boy","a woman and a girl","I am a boy","I am a girl","he is a boy","she is a girl","a boy","a man","a girl","a woman","how are you","my name is Adam","my name is Mary","her name is Mary","his name is Adam"],gs=function(){return function(){this.level_1=fs.slice()}}(),ms=["man","boy","men","woman","girl","women","name","language","fine","play"],ys=function(){return function(){this.level_1=ms.slice()}}(),bs=Phaser.Utils.Array.Shuffle,vs=Phaser.Utils.Array.Remove,ws=Phaser.Utils.Array.GetRandom,xs=function(e){function t(t){var n=e.call(this,t)||this;return n.name="WriteInEnglish",n.scene.questionContainer.add(n.instruction),n.scene.questionContainer.add(n.soundButton),n.scene.questionContainer.add(n.testSentence),n.scene.questionContainer.add(n.actionButtons),n.scene.questionContainer.add(n.lines),n.scene.questionContainer.add(n.optionButtons),n.scene.questionContainer.add(n.answerbuttons),n}return Object(u.b)(t,e),t.prototype.ask=function(){this.addInstruction(),this.lines=this.addline(),this.addWordButtons()},t.prototype.addInstruction=function(){var e=!0;this.sentence=ws((new gs).level_1),this.correct_answer=this.scene.translateSentence(this.sentence);var t=this.sentence;this.instruction=this.scene.make.text({x:-50,y:-150,text:"Translate this sentence",style:{font:'bold 30px "Gotham"',fill:"#858585"}}),this.instruction.setOrigin(.5,.5),this.soundButton=this.scene.add.sprite(-225,-80,"Sprites",e?"IconSoundOn":"IconSoundOff"),this.soundButton.setOrigin(.5,.5),this.soundButton.setInteractive(),this.soundButton.on("pointerdown",function(){this.soundButton.setFrame((e=!e)?"IconSoundOn":"IconSoundOff")},this),this.testSentence=this.scene.make.text({x:-190,y:-92,text:t,style:{font:'25px "Gotham"',fill:"#858585",align:"left"}}),this.testSentence.setOrigin(0,0),console.log("Question: ",this.sentence),console.log("Answer: ",this.correct_answer)},t.prototype.getUserResponse=function(){var e="";return this.answerbuttons.forEachButtton(function(t,n){e=e+t.text+" "}),""===e&&(e=null),e},t.prototype.submitAnswer=function(){this.user_response=this.getUserResponse(),this.scene.isAnswerCorrect=this.answerChecker.confirmAnswer(this),console.log("User response: ",this.user_response),console.log("Correct answer: ",this.correct_answer),console.log(this.scene.isAnswerCorrect),this.scene.createDialog(),this.scene.setDialog(),this.scene.isAnswerCorrect&&this.scene.progressBar.increaseCount(),this.answerbuttons.forEachButtton(function(e){e.disableInteractive()}),this.optionButtons.forEachButtton(function(e){e.disableInteractive()})},t.prototype.addline=function(){ft(this.scene,"dashed2",1,.4,0);var e=new rt(this.scene,{start:{x:-250,y:40},end:{x:300,y:40},body:{key:"dashed2",width:8}});return this.scene.add.existing(e),[e]},t.prototype.addWordButtons=function(){var e=this,t=this,n=[],i=this.sentence.split(" ");i.forEach(function(i){var o=t.scene.translateWord(i);n.push(ss(e.scene,o))});var o=(new ys).level_1;function r(){var e=ws(o),n=t.scene.translateWord(e);return vs(o,e),ss(t.scene,n)}vs(o,i),n.push(r()),n.push(r()),n=bs(n),this.optionButtons=this.scene.rexUI.add.buttons({x:-250,y:55,orientation:"x",space:7,name:"Choices",buttons:n}).setOrigin(0,.5),this.optionButtons.layout(),this.answerbuttons=this.scene.rexUI.add.buttons({x:-250,y:0,orientation:"x",space:5,align:"left",name:"Answers",buttons:[]}).setOrigin(0,.5),this.answerbuttons.layout(),this.optionButtons.on("button.click",function(e,n){console.log("Clicked on ",""+e.text);var i=ss(this.scene,""+e.text);t.answerbuttons.addButton(i,0,"left",3),e.getElement("background").fillColor=8750469,console.log("Buttons: ",t.answerbuttons.childrenMap.buttons),console.log("Sizer children: ",t.answerbuttons.sizerChildren),e.disableInteractive()}),this.answerbuttons.on("button.click",function(e,n){t.answerbuttons.removeButton(e);var i=t.optionButtons.childrenMap.buttons.filter(function(t){return t.text===e.text}),o=i[0].getElement("background");i[0].setInteractive(),o.fillColor=14671839,console.log("Buttons: ",t.answerbuttons.childrenMap.buttons),console.log("Sizer children: ",t.answerbuttons.sizerChildren)})},t}(ps),Cs=Phaser.Utils.Array.Shuffle,ks=Phaser.Utils.Array.Remove,Ts=Phaser.Utils.Array.GetRandom,Ps=function(e){function t(t){var n=e.call(this,t)||this;return n.scene.questionContainer.add(n.instruction),n.scene.questionContainer.add(n.soundButton),n.scene.questionContainer.add(n.actionButtons),n.scene.questionContainer.add(n.optionButtons),n}return Object(u.b)(t,e),t.prototype.ask=function(){this.addInstruction(),this.optionButtons=this.createOptionButtons()},t.prototype.addInstruction=function(){var e=!0;this.instruction=this.scene.make.text({x:-80,y:-150,text:"What do you hear?",style:{font:'bold 30px "Gotham"',fill:"#858585"}}),this.instruction.setOrigin(.5,.5),this.soundButton=this.scene.add.sprite(-260,-150,"Sprites",e?"IconSoundOn":"IconSoundOff"),this.soundButton.setOrigin(.5,.5),this.soundButton.setInteractive(),this.soundButton.on("pointerdown",function(){this.soundButton.setFrame((e=!e)?"IconSoundOn":"IconSoundOff")},this),this.theWord=g((new ys).level_1),this.correct_answer=this.scene.translateWord(this.theWord),console.log(this.theWord,this.correct_answer)},t.prototype.createOptionButtons=function(){var e=this,t=this.scene.translateWord(this.theWord),n=(new ys).level_1,i=14671839;function o(){var t=Ts(n),o=e.scene.translateWord(t);return ks(n,t),ss(e.scene,o,200,50,20,"circle",i,"wrong")}function r(e){var t=e.getElement("background"),n=e.getElement("text");e.getElement("icon").fillColor=16777215,t.fillColor=i,n.setFill("#858585"),n.setBackgroundColor("#dfdfdf")}function a(e){var t=e.getElement("background"),n=e.getElement("text");e.getElement("icon").fillColor=13398784,t.fillColor=16769568,n.setFill("#cc7300"),n.setBackgroundColor("#ffe220")}ks(n,this.theWord);var s=[ss(this.scene,t,200,50,20,"circle",i,"correct"),o()],l=[o(),o()];l=Cs(l),s=Cs(s);var c=Cs([s,l]),u=this.scene.rexUI.add.buttons({x:-280,y:-60,orientation:"x",space:10,name:"Choices",buttons:c[0]}).setOrigin(0,.5),h=this.scene.rexUI.add.buttons({x:-280,y:20,orientation:"x",space:10,name:"Choices",buttons:c[1]}).setOrigin(0,.5);return u.layout(),h.layout(),u.on("button.click",function(t,n){console.log("Clicked on "+t.text+" "),e.user_response=t.text;var i=u.childrenMap.buttons.filter(function(e){return e.text!==t.text});a(t),r(i[0]),h.forEachButtton(function(e){r(e)})}),h.on("button.click",function(t,n){console.log("Clicked on "+t.text+" "),e.user_response=t.text;var i=h.childrenMap.buttons.filter(function(e){return e.text!==t.text});a(t),r(i[0]),u.forEachButtton(function(e){r(e)})}),this.optionRow1=u,this.optionRow2=h,[u,h]},t.prototype.submitAnswer=function(){this.scene.isAnswerCorrect=this.answerChecker.confirmAnswer(this),this.scene.createDialog(),this.scene.setDialog(),this.scene.isAnswerCorrect&&this.scene.progressBar.increaseCount(),this.optionRow1.forEachButtton(function(e){e.disableInteractive()}),this.optionRow2.forEachButtton(function(e){e.disableInteractive()})},t}(ps),Os=Phaser.Utils.Array.GetRandom,As=Phaser.Utils.Array.Remove,Ss=Phaser.Utils.Array.Shuffle,Is=function(e){function t(t){var n=e.call(this,t)||this;return n.type="translate a word",n.scene.questionContainer.add(n.instruction),n.scene.questionContainer.add(n.actionButtons),n.scene.questionContainer.add(n.optionButtons),n.scene.questionContainer.add(n.testSentence),n.container=n.scene.questionContainer,n}return Object(u.b)(t,e),t.prototype.ask=function(){this.addInstruction(),this.optionButtons=this.createOptionButtons()},t.prototype.createOptionButtons=function(){var e=this,t=300,n=40,i=20,o=this.scene.translateSentence(this.sentence),r=(new gs).level_1;function a(){var o=Os(r),a=e.scene.translateSentence(o);return As(r,o),ss(e.scene,a,t,n,i)}As(r,this.sentence);var s=[ss(this.scene,o,t,n,i),a(),a(),a()];s=Ss(s);var l=this.scene.rexUI.add.buttons({x:-180,y:15,orientation:"y",space:10,name:"Choices",align:"center",buttons:s}).setOrigin(0,.5);return l.forEachButtton(function(e,t){e.getElement("text").setPadding(20,0,0,0)}),l.layout(),l.on("button.click",function(t,n){console.log("Clicked on "+t.text),e.user_response=t.text,ls(l.childrenMap.buttons.filter(function(e){return e.text!==t.text})),cs(t)}),l},t.prototype.addInstruction=function(){this.sentence=Os((new gs).level_1),this.correct_answer=this.scene.translateSentence(this.sentence),this.instruction=this.scene.make.text({x:-50,y:-195,text:"Choose the correct translation",style:{font:'bold 30px "Gotham"',fill:"#858585"}}),this.instruction.setOrigin(.5,.5),this.testSentence=this.scene.make.text({x:-170,y:-155,text:""+this.sentence,style:{font:'25px "Gotham"',fill:"#858585"}}),this.testSentence.setOrigin(0,0)},t.prototype.submitAnswer=function(){this.scene.isAnswerCorrect=this.answerChecker.confirmAnswer(this),this.scene.createDialog(),this.scene.setDialog(),this.scene.isAnswerCorrect&&this.scene.progressBar.increaseCount(),this.optionButtons.forEachButtton(function(e){e.disableInteractive()}),console.log("Correct answer: ",this.correct_answer),console.log("User response: ",this.user_response)},t}(ps),Es=Phaser.Utils.Array.GetRandom,Ms=Phaser.Utils.Array.Remove,Bs=Phaser.Utils.Array.Shuffle,zs=function(e){function t(t){var n=e.call(this,t)||this;return n.scene.questionContainer.add(n.instruction),n.scene.questionContainer.add(n.actionButtons),n.scene.questionContainer.add(n.optionButtons),n}return Object(u.b)(t,e),t.prototype.ask=function(){this.addInstruction(),this.optionButtons=this.createOptionButtons()},t.prototype.createOptionButtons=function(){var e=this,t=250,n=40,i=20,o=this.scene.translateWord(this.testWord),r=(new ys).level_1;function a(){var o=Es(r),a=e.scene.translateWord(o);return Ms(r,o),ss(e.scene,a,t,n,i)}Ms(r,this.testWord);var s=[ss(this.scene,o,t,n,i),a(),a(),a()];s=Bs(s);var l=this.scene.rexUI.add.buttons({x:-180,y:15,orientation:"y",space:10,name:"Choices",align:"center",buttons:s}).setOrigin(0,.5);return l.forEachButtton(function(e,t){var n=e.getElement("text");n.setPadding(90,0,0,0),console.log(n)}),l.layout(),l.on("button.click",function(t,n){console.log("Clicked on "+t.text),e.user_response=t.text,ls(l.childrenMap.buttons.filter(function(e){return e.text!==t.text})),cs(t)}),l},t.prototype.addInstruction=function(){this.testWord=Es((new ys).level_1),this.correct_answer=this.scene.translateWord(this.testWord),this.instruction=this.scene.make.text({x:-50,y:-180,text:'How do you say "'+this.testWord+'"?',style:{font:'bold 30px "Gotham"',fill:"#858585"}}),this.instruction.setOrigin(.5,.5),console.log("Question: ",this.testWord),console.log("Answer: ",this.correct_answer)},t.prototype.submitAnswer=function(){this.scene.isAnswerCorrect=this.answerChecker.confirmAnswer(this),console.log(this.scene.isAnswerCorrect),this.scene.createDialog(),this.scene.setDialog(),this.scene.isAnswerCorrect&&this.scene.progressBar.increaseCount(),this.optionButtons.forEachButtton(function(e){e.disableInteractive()}),console.log("Correct answer: ",this.correct_answer),console.log("User response: ",this.user_response)},t}(ps),js=Phaser.Utils.Array.GetRandom,_s=Phaser.Utils.Array.Remove,Ds=Phaser.Utils.Array.Shuffle,Ls=function(e){function t(t){var n=e.call(this,t)||this;return n.scene.questionContainer.add(n.instruction),n.scene.questionContainer.add(n.actionButtons),n.scene.questionContainer.add(n.optionButtons),n}return Object(u.b)(t,e),t.prototype.ask=function(){this.addInstruction(),this.optionButtons=this.createOptionButtons()},t.prototype.addInstruction=function(){this.testWord=js((new ys).level_1),this.correct_answer=this.scene.translateWord(this.testWord),this.instruction=this.scene.make.text({x:-50,y:-190,text:'Which of these is "'+this.testWord+'"?',style:{font:"bold 30px Gotham",fill:"#858585"}}),this.instruction.setOrigin(.5,.5),console.log("Question: ",this.testWord),console.log("Answer: ",this.correct_answer)},t.prototype.createOptionButtons=function(){var e=this,t=this.scene.translateWord(this.testWord),n=(new ys).level_1;function i(){var t=js(n),i=e.scene.translateWord(t);return _s(n,t),ss(e.scene,i,130,150,15,"image",14671839,"mine",10,1,20)}_s(n,this.testWord);var o=[ss(this.scene,t,130,150,15,"image",14671839,"mine",10,1,20),i()],r=[i(),i()];r=Ds(r),o=Ds(o);var a=Ds([o,r]),s=this.scene.rexUI.add.buttons({x:-200,y:-80,orientation:"x",space:15,name:"Choices",buttons:a[0]}).setOrigin(0,.5),l=this.scene.rexUI.add.buttons({x:-200,y:90,orientation:"x",space:15,name:"Choices",buttons:a[1]}).setOrigin(0,.5);return s.forEachButtton(function(e,t){}),s.layout(),l.layout(),s.on("button.click",function(t,n){console.log("Clicked on "+t.text+" "),e.user_response=t.text;var i=s.childrenMap.buttons.filter(function(e){return e.text!==t.text});cs(t),ls(i),l.forEachButtton(function(e){ls(e)})}),l.on("button.click",function(t,n){console.log("Clicked on "+t.text+" "),e.user_response=t.text;var i=l.childrenMap.buttons.filter(function(e){return e.text!==t.text});cs(t),ls(i),s.forEachButtton(function(e){ls(e)})}),this.optionRow1=s,this.optionRow2=l,[s,l]},t.prototype.submitAnswer=function(){this.scene.isAnswerCorrect=this.answerChecker.confirmAnswer(this),this.scene.createDialog(),this.scene.setDialog(),this.scene.isAnswerCorrect&&this.scene.progressBar.increaseCount(),this.optionRow1.forEachButtton(function(e){e.disableInteractive()}),this.optionRow2.forEachButtton(function(e){e.disableInteractive()})},t}(ps),Ys=function(){function e(e){this.scene=e}return e.prototype.createAQuestion=function(e){switch(e){case"write-in-english":this.question=new xs(this.scene);break;case"what-do-you-hear":this.question=new Ps(this.scene);break;case"choose-a-translation":this.question=new Is(this.scene);break;case"how-do-you-say":this.question=new zs(this.scene);break;case"which-of-these":this.question=new Ls(this.scene);break;default:this.question=new zs(this.scene)}return this.question},e}(),Rs=function(){function e(e){this.scene=e,this.questions=[],this.questionFactory=new Ys(this.scene)}return e.prototype.generateQuestion=function(e){var t=this.questionFactory.createAQuestion(e);return this.questions.push(t),t},e.prototype.questionChanged=function(e){e.ask(),this.question=e},e}(),Xs=n("XS3J"),Ws=n.n(Xs),Fs=(Phaser,function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.name=t.Name,n.progressCount=0,n.dialog=void 0,n}return Object(u.b)(t,e),t.prototype.init=function(e){this.settingsRef=e.mySettings;var t=this.cache.json.get("Dictionary")[e.language];this.db=new Ws.a("dictionary.json"),this.dictionary=this.db.addCollection("basics"),this.dictionary.insert(t)},t.prototype.translateWord=function(e){return this.dictionary.find({english:e})[0].word},t.prototype.translateSentence=function(e){var t=this,n=e.split(" "),i="";return n.forEach(function(e){var n=t.dictionary.find({english:e})[0].word;i=i+n+" "}),i},t.prototype.create=function(){console.log("Play"),this.cameras.main.backgroundColor=Phaser.Display.Color.ValueToColor(16777215),this.progressBar=new We(this,{x:-300,y:-260},500,30,15),this.questionContainer=new pn(this,0,0),console.log(this.questionContainer),this.questionTypes=["write-in-english","what-do-you-hear","choose-a-translation","how-do-you-say","which-of-these"],this.questionManager=new Rs(this),this.question=this.getQuestion(),this.setView(),this.addControls()},t.prototype.createDialog=function(){var e,t,n,i,o=this;this.isAnswerCorrect?(e=65280,n=16777215,t=3381504,i="You got this!"):(e=16734560,n=16534090,t=12256517,i="Wrong answer");var r,a=this.gameWidth;this.dialog=this.rexUI.add.dialog({x:0,y:this.gameHeight/2.8,width:a,background:this.add.rectangle(0,0,a,50,e),title:this.rexUI.add.label({background:this.add.rectangle(0,0,100,40,n),text:this.add.text(0,0,i,{font:"bold 24px Gotham"}),space:{left:25,right:15,top:10,bottom:10}}),content:this.add.text(0,0,"Well done Keep Going!",{font:"24px Gotham"}),actions:[(r=t,this.rexUI.add.label({background:this.rexUI.add.roundRectangle(0,0,100,40,20,r),text:this.add.text(0,0,"Continue",{font:"bold 22px Gotham"}),space:{left:10,right:10,top:10,bottom:10}}))],space:{title:25,contentLeft:25,action:0,actionsRight:50,left:0,right:0,top:0,bottom:30},align:{actions:"right",title:"center",content:"left"},expand:{content:!1}}).layout().on("button.click",function(e,t,n){o.question.next()},this).on("button.over",function(e,t,n){e.getElement("background").setStrokeStyle(2,16777215)}).on("button.out",function(e,t,n){e.getElement("background").setStrokeStyle()}),this.questionContainer.add(this.dialog)},t.prototype.getQuestion=function(){var e=g(this.questionTypes);return this.questionManager.generateQuestion(e)},t.prototype.addControls=function(){var e=this.add.sprite(-this.gameWidth/2+50,-this.gameHeight/2+50,"Sprites","IconMenu");e.setInteractive(),e.on("pointerdown",function(){this.backToMenu()},this)},t.prototype.buildScene=function(){void 0===this.anims.get("pig")&&this.anims.create({key:"pig",frames:this.anims.generateFrameNames("Sprites",{frames:["pig01","pig02","pig03","pig04","pig05","pig06","pig07"]}),frameRate:3,repeat:-1}),this.add.sprite(0,0,"Sprites").anims.play("pig")},t.prototype.backToMenu=function(){var e=this;Ae.endGameSession({score:12345,level:10}).then(function(){e.scene.start("Menu")}),Se===De.EDGI&&Ae.someVerySpecificSponsorFunction()},t.prototype.getContainerSize=function(e){var t=this.gameHeight,n=0,i=this.gameWidth,o=0;e.iterate((function(e){var r=e.x,a=e.y,s=e.displayWidth,l=e.displayHeight,c=a-l*e.originY,u=a+l*(1-e.originY),h=r-s*e.originX,d=r+s*(1-e.originY);u>n&&(n=u),c<t&&(t=c),h<i&&(i=h),d>o&&(o=d)}).bind(this));var r=Math.abs(t-n),a=Math.abs(o-i);e.setSize(a,r)},t.prototype.setDialog=function(){var e,t,n,i,o;this.isAnswerCorrect?(e=65280,n=52275,t=3381504,i="You got this!",o="Well done, keep going!"):(e=16711680,n=13369344,t=16750848,i="Wrong answer",o="You learn from your mistakes"),this.dialog.getElement("title").text=i,this.dialog.getElement("title").backgroundChildren[0].fillColor=n,this.dialog.getElement("actions")[0].backgroundChildren[0].fillColor=t,this.dialog.getElement("background").fillColor=e,this.dialog.getElement("content").text=o},t.Name="Play",t}(Ee)),Vs=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.name=t.Name,n.XP=10,n.bonusXP=0,n}return Object(u.b)(t,e),t.prototype.init=function(e){this.router=e.router,this.course={name:e.language,episodes:[{name:e.episode,level:parseInt(e.level),lesson:parseInt(e.lesson)}]},"basics"===e.episode&&"1"===e.lesson&&"1"===e.level?this.saveNewUserRecords():(console.log("Episode: ",e.episode),console.log("Lesson: ",e.lesson),console.log("level: ",e.level))},t.prototype.create=function(){console.log("Finished!"),this.cameras.main.backgroundColor=Phaser.Display.Color.ValueToColor(8421504),this.setView(),this.addContinueButton(),this.addMessage(this)},t.prototype.saveNewUserRecords=function(){Be.e.saveInStorage("new_user_records",{XP:this.XP+this.bonusXP,course:this.course})},t.prototype.saveRecords=function(){},t.prototype.addPlayButton=function(){var e=this.add.sprite(0,0,"Sprites","IconPlay");e.setInteractive(),e.on("pointerdown",function(){this.router.navigateByUrl("/auth/register")},this)},t.prototype.addMessage=function(e){this.hailings=e.make.text({x:-10,y:-190,text:"Congratulations!",style:{font:"bold 40px Gotham",fill:"#ffffff"}}),this.message=e.make.text({x:-20,y:-100,text:"Create a profile to save your progress",style:{font:"22px Gotham",fill:"#ffffff"}}),this.message.setOrigin(.5,.5),this.hailings.setOrigin(.5,.5)},t.prototype.addContinueButton=function(){var e=this,t=this.plugins.get("rexButton"),n=this.rexUI.add.roundRectangle(-10,20,300,70,20,7401244),i=this.add.text(-10,20,"CONTINUE",{fill:"#ffffff",font:"bold 25px Gotham"}).setOrigin(.5,.5);return t.add(n,{}).on("click",function(t){e.router.navigateByUrl("/auth/register")}),[n,i]},t.Name="Finish",t}(Ee);(hs=us||(us={})).sponsor=De.EDGI,hs.settings=new je;var Ns,Gs=function(e){function t(t,n,i,o,r,a){var s=this,l=Phaser.AUTO;s=e.call(this,{type:l,parent:"parent_game",width:ze.GAME_WIDTH,height:ze.GAME_HEIGHT,title:"Nigerian Language Game",plugins:{global:[{key:"rexButton",plugin:Qe,start:!0},{key:"rexContainerLitePlugin",plugin:Za,start:!0},{key:"rexLine",plugin:pt,start:!0},{key:"rexGridAlign",plugin:Vt,start:!0},{key:"rexRhombus",plugin:Qt,start:!0},{key:"rexGridTable",plugin:Kn,start:!0}],scene:[{key:"rexUI",plugin:Fa,mapping:"rexUI"}]}})||this;var c={language:t,mySettings:i,router:n,episode:o,level:r,lesson:a};return console.log(c),s.scene.add("Boot",Me),s.scene.add("Preloader",_e,!1,c),s.scene.add("Menu",Xe,!1,c),s.scene.add("Play",Fs,!1,c),s.scene.add("Finish",Vs,!1,c),s.scene.start("Boot"),s}return Object(u.b)(t,e),t}(Phaser.Game),Hs=n("qheY"),Ks=function(e){function t(t){return e.call(this,t)||this}return Object(u.b)(t,e),t}(Re),qs=function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}l((i=i.apply(e,t||[])).next())})},Us=function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},Zs=function(e){function t(t){var n=e.call(this,t)||this;return Be.e.sponsorStorage=n,n}return Object(u.b)(t,e),t.prototype.startGameSession=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return qs(this,void 0,void 0,function(){return Us(this,function(t){switch(t.label){case 0:return console.log("Sponsor "+De[this.id]+": startGameSession() with parameters "+e),[4,new Promise(function(e){console.log("starting timeout - 3 secs"),setTimeout(function(){console.log("timeout over"),e()},3e3)})];case 1:return t.sent(),[2]}})})},t.prototype.endGameSession=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return qs(this,void 0,void 0,function(){return Us(this,function(t){switch(t.label){case 0:return console.log("Sponsor "+De[this.id]+": endGameSession() with parameters "+e),void 0!==e[0]&&console.log("paramaters = "+JSON.stringify(e[0])),[4,new Promise(function(e){console.log("starting timeout - 3 secs"),setTimeout(function(){console.log("timeout over"),e()},3e3)})];case 1:return t.sent(),[2]}})})},t.prototype.save=function(e,t){return qs(this,void 0,void 0,function(){var n;return Us(this,function(i){switch(i.label){case 0:return n=window.localStorage,[4,new Promise(function(i){console.log("saving somewhere into cloud - it will take 3 seconds"),setTimeout(function(){console.log("data saved: ",t),n.setItem(e,JSON.stringify(t)),i()},3e3)})];case 1:return i.sent(),[2]}})})},t.prototype.load=function(e){return qs(this,void 0,void 0,function(){var t;return Us(this,function(n){switch(n.label){case 0:return t=window.localStorage,[4,new Promise(function(n){console.log("loading from cloud - it will take 3 seconds"),setTimeout(function(){console.log("data loaded");var i=t.getItem(e);console.log("data  = "+i),n(null==i?null:JSON.parse(i))},3e3)})];case 1:return[2,n.sent()]}})})},t.prototype.fallbackToStandardStorage=function(){return!1},t.prototype.someVerySpecificSponsorFunction=function(){console.log("Very sponsor specific function for Edgi")},t}(Re),Js=function(e){function t(t){return e.call(this,t)||this}return Object(u.b)(t,e),t}(Re),$s=((Ns={})[De.NONE]={id:De.NONE,name:"none",hasConfig:!1,defaultLanguage:"cs",showFlags:!1},Ns[De.EDGI]={id:De.EDGI,name:"edgi",hasConfig:!0,defaultLanguage:"en",showFlags:!0},Ns[De.FACEBOOK]={id:De.FACEBOOK,name:"facebook",hasConfig:!0,defaultLanguage:"en",showFlags:!0},Ns),Qs=function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}l((i=i.apply(e,t||[])).next())})},el=function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},tl=function(){function e(e,t,n){this.elementRef=e,this.router=t,this.route=n,this.gameReady=new o.t,this.settings=new je}return e.prototype.loadDictionary=function(e){return Qs(this,void 0,void 0,function(){var t;return el(this,function(n){switch(n.label){case 0:return[4,Hs.a.loadJson("assets/words/"+e+"_words.json")];case 1:return t=n.sent(),JSON.stringify(t[e]),console.log(t),[2,t]}})})},e.prototype.loadGameConfig=function(){return Qs(this,void 0,void 0,function(){var e;return el(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Hs.a.loadJson("assets/config.json")];case 1:return e=t.sent(),console.log(e),Hs.a.loadValuesIntoObject(e,ze),[3,3];case 2:throw t.sent();case 3:return[2]}})})},e.prototype.loadSponsorConfig=function(){return Qs(this,void 0,void 0,function(){var e;return el(this,function(t){switch(t.label){case 0:if("boolean"!=typeof(n=Ae.features.hasConfig)||!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Hs.a.loadJson("assets/sponsors/"+Ae.features.name+".json")];case 2:return e=t.sent(),Hs.a.loadValuesIntoObject(e,ze),[3,4];case 3:throw t.sent();case 4:return[2]}var n})})},e.prototype.createSponsor=function(){var e=function(e){if(null==$s[e])throw new Error("Features for sponsor "+De[e]+" are not in SPONSOR_FEATURES list.");return $s[e]}(us.sponsor);switch(us.sponsor){case De.NONE:this.sponsor=new Ks(e);break;case De.EDGI:this.sponsor=new Zs(e);break;case De.FACEBOOK:this.sponsor=new Js(e)}},e.prototype.ngAfterViewInit=function(){var e=this;this.game.events.once("ready",function(){e.elementRef.nativeElement.appendChild(e.game.canvas),e.elementRef.nativeElement.style.overflow="hidden",e.gameReady.emit(e.game)})},e.prototype.ngOnDestroy=function(){this.game&&"function"==typeof this.game.destroy&&this.game.destroy(!0)},e.prototype.ngOnInit=function(){var e=this.router,t=this.settings,n=this.route.snapshot.paramMap.get("lang"),i=this.route.snapshot.paramMap.get("class"),o=this.route.snapshot.paramMap.get("level"),r=this.route.snapshot.paramMap.get("lesson");this.createSponsor(),this.loadSponsorConfig(),this.loadGameConfig(),this.game=new Gs(n,e,t,i,o,r),this.sponsor.game=this.game},e}(),nl=o.Ib({encapsulation:0,styles:[[""]],data:{}});function il(e){return o.gc(0,[],null,null)}function ol(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,1,"app-languages",[],null,null,null,il,nl)),o.Jb(1,4440064,null,0,tl,[o.q,E.l,E.a],null,null)],function(e,t){e(t,1,0)},null)}var rl=o.Gb("app-languages",tl,ol,{},{gameReady:"gameReady"},[]),al=o.Ib({encapsulation:2,styles:[],data:{}});function sl(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,1,"button",[["class","btn btn-md btn-success"]],null,[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.closeModal()&&i),i},null,null)),(e()(),o.ec(-1,null,["Continue"]))],null,null)}function ll(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),o.Kb(1,0,null,null,1,"button",[["class","btn btn-md btn-info"]],null,[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.closeModal()&&i),i},null,null)),(e()(),o.ec(-1,null,["Review your answer"])),(e()(),o.zb(16777216,null,null,1,null,sl)),o.Jb(4,16384,null,0,X.l,[o.gb,o.ab],{ngIf:[0,"ngIf"]},null)],function(e,t){e(t,4,0,!0===t.component.status)},null)}function cl(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),o.Kb(1,0,null,null,1,"button",[["class","btn btn-md btn-warning"]],null,[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.closeModal()&&i),i},null,null)),(e()(),o.ec(-1,null,["See the answer"])),(e()(),o.Kb(3,0,null,null,1,"button",[["class","btn btn-md btn-primary"]],null,[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.closeModal()&&i),i},null,null)),(e()(),o.ec(-1,null,["Continue"]))],null,null)}function ul(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),o.Kb(1,0,null,null,1,"button",[["class","btn btn-md btn-primary"]],null,[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.closeModal()&&i),i},null,null)),(e()(),o.ec(-1,null,["Continue"]))],null,null)}function hl(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,5,"div",[["class","modal-header"]],null,null,null,null,null)),(e()(),o.Kb(1,0,null,null,1,"h2",[],null,null,null,null,null)),(e()(),o.ec(2,null,["",""])),(e()(),o.Kb(3,0,null,null,2,"button",[["aria-label","Close"],["class","close"]],null,[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==e.component.closeModal()&&i),i},null,null)),(e()(),o.Kb(4,0,null,null,1,"span",[["aria-hidden","true"]],null,null,null,null,null)),(e()(),o.ec(-1,null,["\xd7"])),(e()(),o.Kb(6,0,null,null,1,"div",[["class","modal-body"]],null,null,null,null,null)),(e()(),o.ec(7,null,[" "," "])),(e()(),o.Kb(8,0,null,null,8,"div",[["class","modal-footer"]],null,null,null,null,null)),(e()(),o.Kb(9,0,null,null,7,"div",[["class","feedback_buttons"]],null,null,null,null,null)),o.Jb(10,16384,null,0,X.o,[],{ngSwitch:[0,"ngSwitch"]},null),(e()(),o.zb(16777216,null,null,1,null,ll)),o.Jb(12,278528,null,0,X.p,[o.gb,o.ab,X.o],{ngSwitchCase:[0,"ngSwitchCase"]},null),(e()(),o.zb(16777216,null,null,1,null,cl)),o.Jb(14,278528,null,0,X.p,[o.gb,o.ab,X.o],{ngSwitchCase:[0,"ngSwitchCase"]},null),(e()(),o.zb(16777216,null,null,1,null,ul)),o.Jb(16,16384,null,0,X.q,[o.gb,o.ab,X.o],null,null)],function(e,t){e(t,10,0,t.component.status),e(t,12,0,!0),e(t,14,0,!1)},function(e,t){var n=t.component;e(t,2,0,n.modalHeader),e(t,7,0,n.modalContent)})}function dl(e){return o.gc(0,[(e()(),o.Kb(0,0,null,null,1,"app-modal",[],null,null,null,hl,al)),o.Jb(1,114688,null,0,s,[ue],null,null)],function(e,t){e(t,1,0)},null)}var pl=o.Gb("app-modal",s,dl,{},{},[]),fl=n("eDkP"),gl=n("Fzqc"),ml=n("4c35"),yl=n("dWZg"),bl=n("qAlS"),vl=n("JwYR"),wl=n("tNr7"),xl=n("vTDv"),Cl=function(){return function(){}}(),kl=function(){return function(){}}();n.d(t,"SubjectsModuleNgFactory",function(){return Tl});var Tl=o.Hb(A,[],function(e){return o.Tb([o.Ub(512,o.m,o.sb,[[8,[S.a,I.k,I.h,j,R,ve,ke,Ie,rl,pl]],[3,o.m],o.J]),o.Ub(4608,X.n,X.m,[o.F,[2,X.G]]),o.Ub(4608,W.s,W.s,[]),o.Ub(4608,_.Zc,_.Zc,[E.l]),o.Ub(4608,fl.d,fl.d,[fl.i,fl.e,o.m,fl.h,fl.f,o.B,o.L,X.c,gl.b,[2,X.h]]),o.Ub(5120,fl.j,fl.k,[fl.d]),o.Ub(4608,_.id,_.id,[]),o.Ub(4608,P,P,[]),o.Ub(1073742336,X.b,X.b,[]),o.Ub(1073742336,W.r,W.r,[]),o.Ub(1073742336,W.e,W.e,[]),o.Ub(1073742336,E.p,E.p,[[2,E.u],[2,E.l]]),o.Ub(1073742336,_.qe,_.qe,[]),o.Ub(1073742336,_.pc,_.pc,[]),o.Ub(1073742336,_.fc,_.fc,[_.ec]),o.Ub(1073742336,_.yc,_.yc,[]),o.Ub(1073742336,_.K,_.K,[]),o.Ub(1073742336,_.fe,_.fe,[]),o.Ub(1073742336,_.G,_.G,[]),o.Ub(1073742336,gl.a,gl.a,[]),o.Ub(1073742336,ml.f,ml.f,[]),o.Ub(1073742336,yl.b,yl.b,[]),o.Ub(1073742336,bl.b,bl.b,[]),o.Ub(1073742336,fl.g,fl.g,[]),o.Ub(1073742336,_.tb,_.tb,[]),o.Ub(1073742336,_.sb,_.sb,[]),o.Ub(1073742336,_.Hc,_.Hc,[]),o.Ub(1073742336,_.Q,_.Q,[]),o.Ub(1073742336,_.hd,_.hd,[]),o.Ub(1073742336,_.pd,_.pd,[]),o.Ub(1073742336,_.Jb,_.Jb,[]),o.Ub(1073742336,vl.f,vl.f,[]),o.Ub(1073742336,_.hc,_.hc,[]),o.Ub(1073742336,_.rb,_.rb,[]),o.Ub(1073742336,_.Fb,_.Fb,[]),o.Ub(1073742336,_.ld,_.ld,[]),o.Ub(1073742336,wl.a,wl.a,[_.ec]),o.Ub(1073742336,xl.a,xl.a,[]),o.Ub(1073742336,Cl,Cl,[]),o.Ub(1073742336,_.Fd,_.Fd,[]),o.Ub(1073742336,kl,kl,[]),o.Ub(1073742336,A,A,[]),o.Ub(1024,E.j,function(){return[[{path:"",component:r,children:[{path:"science",component:a},{path:"science/solar",component:l},{path:"math",component:c},{path:"math/counting",component:O},{path:"languages/:lang/:class/:level/:lesson",component:tl}]}]]},[])])})},UD9A:function(e,t,n){var i=n("paQs"),o=n("t47D"),r=Phaser.Renderer.Canvas.SetTransform;e.exports=function(e,t,n,a,s){var l=e.currentContext;if(r(e,l,t,a,s)){var c=t._displayOriginX,u=t._displayOriginY,h=t.pathData,d=h.length-1,p=h[0]-c,f=h[1]-u;l.beginPath(),l.moveTo(p,f),t.closePath||(d-=2);for(var g=2;g<d;g+=2)l.lineTo(h[g]-c,h[g+1]-u);l.closePath(),t.isFilled&&(i(l,t),l.fill()),t.isStroked&&(o(l,t),l.stroke()),l.restore()}}},Vlzo:function(e,t){var n=Math.PI/180;e.exports=function(e){return e*n}},XS3J:function(e,t,n){var i,o;void 0===(o="function"==typeof(i=function(){return function(){"use strict";var e=Object.prototype.hasOwnProperty,t={copyProperties:function(e,t){var n;for(n in e)t[n]=e[n]},resolveTransformObject:function(e,n,i){var o,r;if("number"!=typeof i&&(i=0),++i>=10)return e;for(o in e)"string"==typeof e[o]&&0===e[o].indexOf("[%lktxp]")?(r=e[o].substring(8),n.hasOwnProperty(r)&&(e[o]=n[r])):"object"==typeof e[o]&&(e[o]=t.resolveTransformObject(e[o],n,i));return e},resolveTransformParams:function(e,n){var i,o,r=[];if(void 0===n)return e;for(i=0;i<e.length;i++)o=p(e[i],"shallow-recurse-objects"),r.push(t.resolveTransformObject(o,n));return r},getIn:function(e,t,n){if(null!=e){if(!n)return e[t];if("string"==typeof t&&(t=t.split(".")),!Array.isArray(t))throw new Error("path must be a string or array. Found "+typeof t);for(var i=0,o=t.length;null!=e&&i<o;)e=e[t[i++]];return i&&i==o?e:void 0}}},i={aeq:o,lt:r,gt:a};function o(e,t){var n,i,o,r;if(e===t)return!0;if(!e||!t||!0===e||!0===t||e!=e||t!=t){switch(e){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=e==e?9:0}switch(t){case void 0:case null:r=1;break;case!1:r=3;break;case!0:r=4;break;case"":r=5;break;default:r=t==t?9:0}if(9!==o||9!==r)return o===r}return n=Number(e),i=Number(t),n==n||i==i?n===i:(n=e.toString())==(i=t.toString())}function r(e,t,n){var i,o,r,a;if(!e||!t||!0===e||!0===t||e!=e||t!=t){switch(e){case void 0:case null:r=1;break;case!1:r=3;break;case!0:r=4;break;case"":r=5;break;default:r=e==e?9:0}switch(t){case void 0:case null:a=1;break;case!1:a=3;break;case!0:a=4;break;case"":a=5;break;default:a=t==t?9:0}if(9!==r||9!==a)return r===a?n:r<a}return i=Number(e),o=Number(t),i==i&&o==o?i<o||!(i>o)&&n:i==i&&o!=o||(o!=o||i==i)&&(e<t||!(e>t)&&(e==t?n:(i=e.toString())<(o=t.toString())||i==o&&n))}function a(e,t,n){var i,o,r,a;if(!e||!t||!0===e||!0===t||e!=e||t!=t){switch(e){case void 0:case null:r=1;break;case!1:r=3;break;case!0:r=4;break;case"":r=5;break;default:r=e==e?9:0}switch(t){case void 0:case null:a=1;break;case!1:a=3;break;case!0:a=4;break;case"":a=5;break;default:a=t==t?9:0}if(9!==r||9!==a)return r===a?n:r>a}return i=Number(e),o=Number(t),i==i&&o==o?i>o||!(i<o)&&n:(i!=i||o==o)&&(o==o&&i!=i||e>t||!(e<t)&&(e==t?n:(i=e.toString())>(o=t.toString())||i==o&&n))}function s(e,t,n){return i.aeq(e,t)?0:i.lt(e,t,!1)?n?1:-1:i.gt(e,t,!1)?n?-1:1:0}function l(e,t,n,i,o){var r,a=o||0,s=t[a],c=!1;if("object"==typeof e&&s in e&&(r=e[s]),a+1>=t.length)c=n(r,i);else if(Array.isArray(r))for(var u=0,h=r.length;u<h&&!0!==(c=l(r[u],t,n,i,a+1));u+=1);else c=l(r,t,n,i,a+1);return c}function c(t){return"string"==typeof t||Array.isArray(t)?function(e){return-1!==t.indexOf(e)}:"object"==typeof t&&null!==t?function(n){return e.call(t,n)}:null}function u(t,n){for(var i in n)if(e.call(n,i))return h[i](t,n[i]);return!1}var h={$eq:function(e,t){return e===t},$aeq:function(e,t){return e==t},$ne:function(e,t){return t!=t?e==e:e!==t},$dteq:function(e,t){return i.aeq(e,t)},$gt:function(e,t){return i.gt(e,t,!1)},$gte:function(e,t){return i.gt(e,t,!0)},$lt:function(e,t){return i.lt(e,t,!1)},$lte:function(e,t){return i.lt(e,t,!0)},$jgt:function(e,t){return e>t},$jgte:function(e,t){return e>=t},$jlt:function(e,t){return e<t},$jlte:function(e,t){return e<=t},$between:function(e,t){return null!=e&&i.gt(e,t[0],!0)&&i.lt(e,t[1],!0)},$jbetween:function(e,t){return null!=e&&e>=t[0]&&e<=t[1]},$in:function(e,t){return-1!==t.indexOf(e)},$nin:function(e,t){return-1===t.indexOf(e)},$keyin:function(e,t){return e in t},$nkeyin:function(e,t){return!(e in t)},$definedin:function(e,t){return void 0!==t[e]},$undefinedin:function(e,t){return void 0===t[e]},$regex:function(e,t){return t.test(e)},$containsString:function(e,t){return"string"==typeof e&&-1!==e.indexOf(t)},$containsNone:function(e,t){return!h.$containsAny(e,t)},$containsAny:function(e,t){var n=c(e);return null!==n&&(Array.isArray(t)?t.some(n):n(t))},$contains:function(e,t){var n=c(e);return null!==n&&(Array.isArray(t)?t.every(n):n(t))},$elemMatch:function(e,t){return!!Array.isArray(e)&&e.some(function(e){return Object.keys(t).every(function(n){var i=t[n];return"object"==typeof i&&i||(i={$eq:i}),-1!==n.indexOf(".")?l(e,n.split("."),u,t[n]):u(e[n],i)})})},$type:function(e,t){var n=typeof e;return"object"===n&&(Array.isArray(e)?n="array":e instanceof Date&&(n="date")),"object"!=typeof t?n===t:u(n,t)},$finite:function(e,t){return t===isFinite(e)},$size:function(e,t){return!!Array.isArray(e)&&("object"!=typeof t?e.length===t:u(e.length,t))},$len:function(e,t){return"string"==typeof e&&("object"!=typeof t?e.length===t:u(e.length,t))},$where:function(e,t){return!0===t(e)},$not:function(e,t){return!u(e,t)},$and:function(e,t){for(var n=0,i=t.length;n<i;n+=1)if(!u(e,t[n]))return!1;return!0},$or:function(e,t){for(var n=0,i=t.length;n<i;n+=1)if(u(e,t[n]))return!0;return!1},$exists:function(e,t){return t?void 0!==e:void 0===e}},d={$eq:h.$eq,$aeq:!0,$dteq:!0,$gt:!0,$gte:!0,$lt:!0,$lte:!0,$in:!0,$between:!0};function p(e,t){if(null==e)return null;var n;switch(t||"parse-stringify"){case"parse-stringify":n=JSON.parse(JSON.stringify(e));break;case"jquery-extend-deep":n=jQuery.extend(!0,{},e);break;case"shallow":n=Object.create(e.constructor.prototype),Object.keys(e).map(function(t){n[t]=e[t]});break;case"shallow-assign":n=Object.create(e.constructor.prototype),Object.assign(n,e);break;case"shallow-recurse-objects":n=p(e,"shallow"),Object.keys(e).forEach(function(t){"object"==typeof e[t]&&"Object"===e[t].constructor.name?n[t]=p(e[t],"shallow-recurse-objects"):Array.isArray(e[t])&&(n[t]=function(e,t){for(var n=[],i=0,o=e.length;i<o;i++)n[i]=p(e[i],"shallow-recurse-objects");return n}(e[t]))})}return n}function f(){try{return window&&void 0!==window.localStorage&&null!==window.localStorage}catch(e){return!1}}function g(){}function m(e,t){this.filename=e||"loki.db",this.collections=[],this.databaseVersion=1.5,this.engineVersion=1.5,this.autosave=!1,this.autosaveInterval=5e3,this.autosaveHandle=null,this.throttledSaves=!0,this.options={},this.persistenceMethod=null,this.persistenceAdapter=null,this.throttledSavePending=!1,this.throttledCallbacks=[],this.verbose=!(!t||!t.hasOwnProperty("verbose"))&&t.verbose,this.events={init:[],loaded:[],flushChanges:[],close:[],changes:[],warning:[]},this.ENV=t&&t.hasOwnProperty("env")?t.env:"undefined"!=typeof global&&(global.android||global.NSObject)?"NATIVESCRIPT":"undefined"==typeof window?"NODEJS":"undefined"!=typeof global&&global.window&&"undefined"!=typeof process?"NODEJS":"undefined"!=typeof document?-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?"CORDOVA":"BROWSER":"CORDOVA","undefined"===this.ENV&&(this.ENV="NODEJS"),this.configureOptions(t,!0),this.on("init",this.clearChanges)}function y(e){this.hashStore={},this.options=e||{},this.options.hasOwnProperty("asyncResponses")||(this.options.asyncResponses=!1),this.options.hasOwnProperty("asyncTimeout")||(this.options.asyncTimeout=50)}function b(e,t){if(this.mode="reference",this.adapter=null,this.options=t||{},this.dbref=null,this.dbname="",this.pageIterator={},!e)throw new Error("LokiPartitioningAdapter requires a (non-reference mode) adapter on construction");if("reference"===e.mode)throw new Error("LokiPartitioningAdapter cannot be instantiated with a reference mode adapter");this.adapter=e,this.options.hasOwnProperty("paging")||(this.options.paging=!1),this.options.hasOwnProperty("pageSize")||(this.options.pageSize=26214400),this.options.hasOwnProperty("delimiter")||(this.options.delimiter="$<\n")}function v(){try{this.fs=n(!function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}())}catch(e){this.fs=null}}function w(){}function x(e,t){return t=t||{},this.collection=e,this.filteredrows=[],this.filterInitialized=!1,this}function C(e,t,n){this.collection=e,this.name=t,this.rebuildPending=!1,this.options=n||{},this.options.hasOwnProperty("persistent")||(this.options.persistent=!1),this.options.hasOwnProperty("sortPriority")||(this.options.sortPriority="passive"),this.options.hasOwnProperty("minRebuildInterval")||(this.options.minRebuildInterval=1),this.resultset=new x(e),this.resultdata=[],this.resultsdirty=!1,this.cachedresultset=null,this.filterPipeline=[],this.sortFunction=null,this.sortCriteria=null,this.sortCriteriaSimple=null,this.sortDirty=!1,this.events={rebuild:[]}}function k(t,n){this.name=t,this.data=[],this.idIndex=[],this.binaryIndices={},this.constraints={unique:{},exact:{}},this.uniqueNames=[],this.transforms={},this.objType=t,this.dirty=!0,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedData=null;var i=this;(n=n||{}).hasOwnProperty("unique")&&(Array.isArray(n.unique)||(n.unique=[n.unique]),n.unique.forEach(function(e){i.uniqueNames.push(e),i.constraints.unique[e]=new z(e)})),n.hasOwnProperty("exact")&&n.exact.forEach(function(e){i.constraints.exact[e]=new j(e)}),this.adaptiveBinaryIndices=!n.hasOwnProperty("adaptiveBinaryIndices")||n.adaptiveBinaryIndices,this.transactional=!!n.hasOwnProperty("transactional")&&n.transactional,this.cloneObjects=!!n.hasOwnProperty("clone")&&n.clone,this.cloneMethod=n.hasOwnProperty("cloneMethod")?n.cloneMethod:"parse-stringify",this.asyncListeners=!!n.hasOwnProperty("asyncListeners")&&n.asyncListeners,this.disableMeta=!!n.hasOwnProperty("disableMeta")&&n.disableMeta,this.disableChangesApi=!n.hasOwnProperty("disableChangesApi")||n.disableChangesApi,this.disableDeltaChangesApi=!n.hasOwnProperty("disableDeltaChangesApi")||n.disableDeltaChangesApi,this.disableChangesApi&&(this.disableDeltaChangesApi=!0),this.autoupdate=!!n.hasOwnProperty("autoupdate")&&n.autoupdate,this.serializableIndices=!n.hasOwnProperty("serializableIndices")||n.serializableIndices,this.ttl={age:null,ttlInterval:null,daemon:null},this.setTTL(n.ttl||-1,n.ttlInterval),this.maxId=0,this.DynamicViews=[],this.events={insert:[],update:[],"pre-insert":[],"pre-update":[],close:[],flushbuffer:[],error:[],delete:[],warning:[]},this.changes=[],this.ensureId();var o=[];if(n&&n.indices)if("[object Array]"===Object.prototype.toString.call(n.indices))o=n.indices;else{if("string"!=typeof n.indices)throw new TypeError("Indices needs to be a string or an array of strings");o=[n.indices]}for(var r=0;r<o.length;r++)this.ensureIndex(o[r]);function a(e,t){var n=null!==t&&"object"==typeof t?Object.keys(t):null;if(n&&n.length&&["string","boolean","number"].indexOf(typeof t)<0){for(var o={},r=0;r<n.length;r++){var s=n[r];if(t.hasOwnProperty(s))if(!e.hasOwnProperty(s)||i.uniqueNames.indexOf(s)>=0||"$loki"==s||"meta"==s)o[s]=t[s];else{var l=a(e[s],t[s]);void 0!==l&&l!={}&&(o[s]=l)}}return 0===Object.keys(o).length?void 0:o}return e===t?void 0:t}function s(){i.changes=[]}this.observerCallback=function(t){var n="function"==typeof Set?new Set:[];n.add||(n.add=function(e){return-1===this.indexOf(e)&&this.push(e),this}),t.forEach(function(e){n.add(e.object)}),n.forEach(function(t){if(!e.call(t,"$loki"))return i.removeAutoUpdateObserver(t);try{i.update(t)}catch(n){}})},this.getChangeDelta=function(e,t){return t?a(t,e):JSON.parse(JSON.stringify(e))},this.getObjectDelta=a,this.getChanges=function(){return i.changes},this.flushChanges=s,this.setChangesApi=function(e){i.disableChangesApi=!e,e||(i.disableDeltaChangesApi=!1)},this.on("delete",function(e){i.disableChangesApi||i.createChange(i.name,"R",e)}),this.on("warning",function(e){i.lokiConsoleWrapper.warn(e)}),s()}function T(e){return-1!==e.indexOf(".")}function P(e){return parseFloat(e,10)}function O(e,t){return e+t}function A(e,t){return e-t}function S(e){return e.reduce(O,0)/e.length}function I(e,t,n){if(!1===n)return e[t];for(var i=t.split("."),o=e;i.length>0;)o=o[i.shift()];return o}function E(e,t,n){for(var i,o,r=0,a=e.length;r<a;){if(0===(i=n.apply(null,[t,e[o=r+a>>1]])))return{found:!0,index:o};i<0?a=o:r=o+1}return{found:!1,index:a}}function M(e){return function(t,n){return E(t,n,e)}}function B(){}function z(e){this.field=e,this.keyMap={},this.lokiMap={}}function j(e){this.index={},this.field=e}return g.prototype.events={},g.prototype.asyncListeners=!1,g.prototype.on=function(e,t){var n,i=this;return Array.isArray(e)?(e.forEach(function(e){i.on(e,t)}),t):((n=this.events[e])||(n=this.events[e]=[]),n.push(t),t)},g.prototype.emit=function(e){var t=this,n=Array.prototype.slice.call(arguments,1);if(!e||!this.events[e])throw new Error("No event "+e+" defined");this.events[e].forEach(function(e){t.asyncListeners?setTimeout(function(){e.apply(t,n)},1):e.apply(t,n)})},g.prototype.addListener=g.prototype.on,g.prototype.removeListener=function(e,t){var n=this;if(Array.isArray(e))e.forEach(function(e){n.removeListener(e,t)});else if(this.events[e]){var i=this.events[e];i.splice(i.indexOf(t),1)}},(m.prototype=new g).constructor=m,m.prototype.getIndexedAdapter=function(){return n("pnzC")},m.prototype.configureOptions=function(e,t){var n={fs:v,localStorage:w,memory:y};if(this.options={},this.persistenceMethod=null,this.persistenceAdapter=null,void 0!==e){if(this.options=e,this.options.hasOwnProperty("persistenceMethod")&&"function"==typeof n[e.persistenceMethod]&&(this.persistenceMethod=e.persistenceMethod,this.persistenceAdapter=new n[e.persistenceMethod]),this.options.hasOwnProperty("adapter")&&(this.persistenceMethod="adapter",this.persistenceAdapter=e.adapter,this.options.adapter=null),e.autoload&&t){var i=this;setTimeout(function(){i.loadDatabase(e,e.autoloadCallback)},1)}this.options.hasOwnProperty("autosaveInterval")&&(this.autosaveDisable(),this.autosaveInterval=parseInt(this.options.autosaveInterval,10)),this.options.hasOwnProperty("autosave")&&this.options.autosave&&(this.autosaveDisable(),this.autosave=!0,this.options.hasOwnProperty("autosaveCallback")?this.autosaveEnable(e,e.autosaveCallback):this.autosaveEnable()),this.options.hasOwnProperty("throttledSaves")&&(this.throttledSaves=this.options.throttledSaves)}this.options.hasOwnProperty("serializationMethod")||(this.options.serializationMethod="normal"),this.options.hasOwnProperty("destructureDelimiter")||(this.options.destructureDelimiter="$<\n"),null===this.persistenceAdapter&&(this.persistenceMethod={NODEJS:"fs",BROWSER:"localStorage",CORDOVA:"localStorage",MEMORY:"memory"}[this.ENV],this.persistenceMethod&&(this.persistenceAdapter=new n[this.persistenceMethod]))},m.prototype.copy=function(e){var t,n,i=new m(this.filename,{env:"NA"});if(e=e||{},i.loadJSONObject(this,{retainDirtyFlags:!0}),e.hasOwnProperty("removeNonSerializable")&&!0===e.removeNonSerializable)for(i.autosaveHandle=null,i.persistenceAdapter=null,t=i.collections.length,n=0;n<t;n++)i.collections[n].constraints=null,i.collections[n].ttl=null;return i},m.prototype.addCollection=function(e,t){var n,i=this.collections.length;if(t&&!0===t.disableMeta){if(!1===t.disableChangesApi)throw new Error("disableMeta option cannot be passed as true when disableChangesApi is passed as false");if(!1===t.disableDeltaChangesApi)throw new Error("disableMeta option cannot be passed as true when disableDeltaChangesApi is passed as false");if("number"==typeof t.ttl&&t.ttl>0)throw new Error("disableMeta option cannot be passed as true when ttl is enabled")}for(n=0;n<i;n+=1)if(this.collections[n].name===e)return this.collections[n];var o=new k(e,t);return this.collections.push(o),this.verbose&&(o.lokiConsoleWrapper=console),o},m.prototype.loadCollection=function(e){if(!e.name)throw new Error("Collection must have a name property to be loaded");this.collections.push(e)},m.prototype.getCollection=function(e){var t,n=this.collections.length;for(t=0;t<n;t+=1)if(this.collections[t].name===e)return this.collections[t];return this.emit("warning","collection "+e+" not found"),null},m.prototype.renameCollection=function(e,t){var n=this.getCollection(e);return n&&(n.name=t),n},m.prototype.listCollections=function(){for(var e=this.collections.length,t=[];e--;)t.push({name:this.collections[e].name,type:this.collections[e].objType,count:this.collections[e].data.length});return t},m.prototype.removeCollection=function(e){var t,n=this.collections.length;for(t=0;t<n;t+=1)if(this.collections[t].name===e){var i=new k(e,{}),o=this.collections[t];for(var r in o)o.hasOwnProperty(r)&&i.hasOwnProperty(r)&&(o[r]=i[r]);return void this.collections.splice(t,1)}},m.prototype.getName=function(){return this.name},m.prototype.serializeReplacer=function(e,t){switch(e){case"autosaveHandle":case"persistenceAdapter":case"constraints":case"ttl":return null;case"throttledSavePending":case"throttledCallbacks":return;case"lokiConsoleWrapper":return null;default:return t}},m.prototype.toJson=m.prototype.serialize=function(e){switch((e=e||{}).hasOwnProperty("serializationMethod")||(e.serializationMethod=this.options.serializationMethod),e.serializationMethod){case"normal":return JSON.stringify(this,this.serializeReplacer);case"pretty":return JSON.stringify(this,this.serializeReplacer,2);case"destructured":return this.serializeDestructured();default:return JSON.stringify(this,this.serializeReplacer)}},m.prototype.serializeDestructured=function(e){var t,n,i,o,r,a=[];if((e=e||{}).hasOwnProperty("partitioned")||(e.partitioned=!1),e.hasOwnProperty("delimited")||(e.delimited=!0),e.hasOwnProperty("delimiter")||(e.delimiter=this.options.destructureDelimiter),!0===e.partitioned&&e.hasOwnProperty("partition")&&e.partition>=0)return this.serializeCollection({delimited:e.delimited,delimiter:e.delimiter,collectionIndex:e.partition});for((r=new m(this.filename)).loadJSONObject(this),t=0;t<r.collections.length;t++)r.collections[t].data=[];if(!0===e.partitioned&&-1===e.partition)return r.serialize({serializationMethod:"normal"});for(a.push(r.serialize({serializationMethod:"normal"})),r=null,t=0;t<this.collections.length;t++)if(i=this.serializeCollection({delimited:e.delimited,delimiter:e.delimiter,collectionIndex:t}),!1===e.partitioned&&!1===e.delimited){if(!Array.isArray(i))throw new Error("a nondelimited, non partitioned collection serialization did not return an expected array");for(o=i.length,n=0;n<o;n++)a.push(i[n]),i[n]=null;a.push("")}else a.push(i);return e.partitioned?a:e.delimited?(a.push(""),a.join(e.delimiter)):(a.push(""),a)},m.prototype.serializeCollection=function(e){var t,n,i=[];if((e=e||{}).hasOwnProperty("delimited")||(e.delimited=!0),!e.hasOwnProperty("collectionIndex"))throw new Error("serializeCollection called without 'collectionIndex' option");for(t=this.collections[e.collectionIndex].data.length,i=[],n=0;n<t;n++)i.push(JSON.stringify(this.collections[e.collectionIndex].data[n]));return e.delimited?(i.push(""),i.join(e.delimiter)):i},m.prototype.deserializeDestructured=function(e,t){var n,i,o,r=[],a=0,s=1,l=!1;if((t=t||{}).hasOwnProperty("partitioned")||(t.partitioned=!1),t.hasOwnProperty("delimited")||(t.delimited=!0),t.hasOwnProperty("delimiter")||(t.delimiter=this.options.destructureDelimiter),t.partitioned){if(t.hasOwnProperty("partition"))return-1===t.partition?n=JSON.parse(e[0]):this.deserializeCollection(e[t.partition+1],t);for(i=(n=JSON.parse(e[0])).collections.length,a=0;a<i;a++)n.collections[a].data=this.deserializeCollection(e[a+1],t);return n}if(t.delimited){if(r=e.split(t.delimiter),e=null,0===r.length)return null}else r=e;for(i=(n=JSON.parse(r[0])).collections.length,r[0]=null;!l;)""===r[s]?++a>i&&(l=!0):(o=JSON.parse(r[s]),n.collections[a].data.push(o)),r[s++]=null;return n},m.prototype.deserializeCollection=function(e,t){var n,i,o=[];for((t=t||{}).hasOwnProperty("partitioned")||(t.partitioned=!1),t.hasOwnProperty("delimited")||(t.delimited=!0),t.hasOwnProperty("delimiter")||(t.delimiter=this.options.destructureDelimiter),t.delimited?(o=e.split(t.delimiter)).pop():o=e,i=o.length,n=0;n<i;n++)o[n]=JSON.parse(o[n]);return o},m.prototype.loadJSON=function(e,t){var n;if(0===e.length)n={};else switch(this.options.serializationMethod){case"normal":case"pretty":n=JSON.parse(e);break;case"destructured":n=this.deserializeDestructured(e);break;default:n=JSON.parse(e)}this.loadJSONObject(n,t)},m.prototype.loadJSONObject=function(e,n){var i,o,r,a,s,l,c=0,u=e.collections?e.collections.length:0;function h(e){var i,o=n[e.name];return o.proto?(i=o.inflate||t.copyProperties,function(e){var t=new o.proto;return i(e,t),t}):o.inflate}for(this.name=e.name,e.hasOwnProperty("throttledSaves")&&n&&!n.hasOwnProperty("throttledSaves")&&(this.throttledSaves=e.throttledSaves),this.collections=[];c<u;c+=1){if((o=this.addCollection((i=e.collections[c]).name,{disableChangesApi:i.disableChangesApi,disableDeltaChangesApi:i.disableDeltaChangesApi,disableMeta:i.disableMeta})).adaptiveBinaryIndices=!!i.hasOwnProperty("adaptiveBinaryIndices")&&!0===i.adaptiveBinaryIndices,o.transactional=i.transactional,o.asyncListeners=i.asyncListeners,o.cloneObjects=i.cloneObjects,o.cloneMethod=i.cloneMethod||"parse-stringify",o.autoupdate=i.autoupdate,o.changes=i.changes,o.dirty=!(!n||!0!==n.retainDirtyFlags)&&i.dirty,r=i.data.length,a=0,n&&n.hasOwnProperty(i.name))for(s=h(i);a<r;a++)l=s(i.data[a]),o.data[a]=l,o.addAutoUpdateObserver(l);else for(;a<r;a++)o.data[a]=i.data[a],o.addAutoUpdateObserver(o.data[a]);if(o.maxId=void 0===i.maxId?0:i.maxId,o.idIndex=i.idIndex,void 0!==i.binaryIndices&&(o.binaryIndices=i.binaryIndices),void 0!==i.transforms&&(o.transforms=i.transforms),o.ensureId(),o.uniqueNames=[],i.hasOwnProperty("uniqueNames"))for(o.uniqueNames=i.uniqueNames,a=0;a<o.uniqueNames.length;a++)o.ensureUniqueIndex(o.uniqueNames[a]);if(void 0!==i.DynamicViews){for(var d=0;d<i.DynamicViews.length;d++){var p=i.DynamicViews[d],f=o.addDynamicView(p.name,p.options);f.resultdata=p.resultdata,f.resultsdirty=p.resultsdirty,f.filterPipeline=p.filterPipeline,f.sortCriteria=p.sortCriteria,f.sortFunction=null,f.sortDirty=p.sortDirty,f.resultset.filteredrows=p.resultset.filteredrows,f.resultset.filterInitialized=p.resultset.filterInitialized,f.rematerialize({removeWhereFilters:!0})}e.databaseVersion<1.5&&(o.ensureAllIndexes(!0),o.dirty=!0)}}},m.prototype.close=function(e){this.autosave&&(this.autosaveDisable(),this.autosaveDirty()&&(this.saveDatabase(e),e=void 0)),e&&this.on("close",e),this.emit("close")},m.prototype.generateChangesNotification=function(e){function t(e){return e.name}var n=[],i=e||this.collections.map(t);return this.collections.forEach(function(e){-1!==i.indexOf(t(e))&&(n=n.concat(e.getChanges()))}),n},m.prototype.serializeChanges=function(e){return JSON.stringify(this.generateChangesNotification(e))},m.prototype.clearChanges=function(){this.collections.forEach(function(e){e.flushChanges&&e.flushChanges()})},y.prototype.loadDatabase=function(e,t){var n=this;this.options.asyncResponses?setTimeout(function(){n.hashStore.hasOwnProperty(e)?t(n.hashStore[e].value):t(null)},this.options.asyncTimeout):this.hashStore.hasOwnProperty(e)?t(this.hashStore[e].value):t(null)},y.prototype.saveDatabase=function(e,t,n){var i,o=this;this.options.asyncResponses?setTimeout(function(){i=o.hashStore.hasOwnProperty(e)?o.hashStore[e].savecount:0,o.hashStore[e]={savecount:i+1,lastsave:new Date,value:t},n()},this.options.asyncTimeout):(i=this.hashStore.hasOwnProperty(e)?this.hashStore[e].savecount:0,this.hashStore[e]={savecount:i+1,lastsave:new Date,value:t},n())},y.prototype.deleteDatabase=function(e,t){this.hashStore.hasOwnProperty(e)&&delete this.hashStore[e],"function"==typeof t&&t()},b.prototype.loadDatabase=function(e,t){var n=this;this.dbname=e,this.dbref=new m(e),this.adapter.loadDatabase(e,function(e){if(e){"string"!=typeof e&&t(new Error("LokiPartitioningAdapter received an unexpected response from inner adapter loadDatabase()"));var i=JSON.parse(e);n.dbref.loadJSONObject(i),i=null,0!==n.dbref.collections.length?(n.pageIterator={collection:0,pageIndex:0},n.loadNextPartition(0,function(){t(n.dbref)})):t(n.dbref)}else t(e)})},b.prototype.loadNextPartition=function(e,t){var n=this.dbname+"."+e,i=this;if(!0===this.options.paging)return this.pageIterator.pageIndex=0,void this.loadNextPage(t);this.adapter.loadDatabase(n,function(n){var o=i.dbref.deserializeCollection(n,{delimited:!0,collectionIndex:e});i.dbref.collections[e].data=o,++e<i.dbref.collections.length?i.loadNextPartition(e,t):t()})},b.prototype.loadNextPage=function(e){var t=this;this.adapter.loadDatabase(this.dbname+"."+this.pageIterator.collection+"."+this.pageIterator.pageIndex,function(n){var i=n.split(t.options.delimiter);n="";var o,r=i.length,a=""===i[r-1];for(a&&(i.pop(),""===i[(r=i.length)-1]&&1===r&&(i.pop(),r=i.length)),o=0;o<r;o++)t.dbref.collections[t.pageIterator.collection].data.push(JSON.parse(i[o])),i[o]=null;i=[],a?++t.pageIterator.collection<t.dbref.collections.length?t.loadNextPartition(t.pageIterator.collection,e):e():(t.pageIterator.pageIndex++,t.loadNextPage(e))})},b.prototype.exportDatabase=function(e,t,n){var i,o=t.collections.length;for(this.dbref=t,this.dbname=e,this.dirtyPartitions=[-1],i=0;i<o;i++)t.collections[i].dirty&&this.dirtyPartitions.push(i);this.saveNextPartition(function(e){n(e)})},b.prototype.saveNextPartition=function(e){var t=this,n=this.dirtyPartitions.shift(),i=this.dbname+(-1===n?"":"."+n);if(this.options.paging&&-1!==n)return this.pageIterator={collection:n,docIndex:0,pageIndex:0},void this.saveNextPage(function(n){0===t.dirtyPartitions.length?e(n):t.saveNextPartition(e)});var o=this.dbref.serializeDestructured({partitioned:!0,delimited:!0,partition:n});this.adapter.saveDatabase(i,o,function(n){n?e(n):0===t.dirtyPartitions.length?e(null):t.saveNextPartition(e)})},b.prototype.saveNextPage=function(e){var t=this,n=this.dbref.collections[this.pageIterator.collection],i=this.dbname+"."+this.pageIterator.collection+"."+this.pageIterator.pageIndex,o=0,r=n.data.length,a=this.options.delimiter.length,s="",l="",c=!1,u=!1,h=function(n){l="",n&&e(n),c?e(null):(t.pageIterator.pageIndex++,t.saveNextPage(e))};for(0===n.data.length&&(c=!0);;)if(c||(s=JSON.stringify(n.data[this.pageIterator.docIndex]),l+=s,o+=s.length,++this.pageIterator.docIndex>=r&&(c=!0)),o>=this.options.pageSize&&(u=!0),u&&!c||(l+=this.options.delimiter,o+=a),c||u)return void this.adapter.saveDatabase(i,l,h)},v.prototype.loadDatabase=function(e,t){var n=this;this.fs.stat(e,function(i,o){!i&&o.isFile()?n.fs.readFile(e,{encoding:"utf8"},function(e,n){t(e?new Error(e):n)}):t(null)})},v.prototype.saveDatabase=function(e,t,n){var i=this,o=e+"~";this.fs.writeFile(o,t,function(t){t?n(new Error(t)):i.fs.rename(o,e,n)})},v.prototype.deleteDatabase=function(e,t){this.fs.unlink(e,function(e){e?t(new Error(e)):t()})},w.prototype.loadDatabase=function(e,t){f()?t(localStorage.getItem(e)):t(new Error("localStorage is not available"))},w.prototype.saveDatabase=function(e,t,n){f()?(localStorage.setItem(e,t),n(null)):n(new Error("localStorage is not available"))},w.prototype.deleteDatabase=function(e,t){f()?(localStorage.removeItem(e),t(null)):t(new Error("localStorage is not available"))},m.prototype.throttledSaveDrain=function(e,t){var n=this,i=(new Date).getTime();if(this.throttledSaves||e(!0),(t=t||{}).hasOwnProperty("recursiveWait")||(t.recursiveWait=!0),t.hasOwnProperty("recursiveWaitLimit")||(t.recursiveWaitLimit=!1),t.hasOwnProperty("recursiveWaitLimitDuration")||(t.recursiveWaitLimitDuration=2e3),t.hasOwnProperty("started")||(t.started=(new Date).getTime()),this.throttledSaves&&this.throttledSavePending){if(!t.recursiveWait)return void this.throttledCallbacks.push(e);this.throttledCallbacks.push(function(){return n.throttledSavePending?t.recursiveWaitLimit&&i-t.started>t.recursiveWaitLimitDuration?void e(!1):void n.throttledSaveDrain(e,t):void e(!0)})}else e(!0)},m.prototype.loadDatabaseInternal=function(e,t){var n=t||function(e,t){if(e)throw e},i=this;null!==this.persistenceAdapter?this.persistenceAdapter.loadDatabase(this.filename,function(t){if("string"==typeof t){var o=!1;try{i.loadJSON(t,e||{}),o=!0}catch(r){n(r)}o&&(n(null),i.emit("loaded","database "+i.filename+" loaded"))}else{if(!t)return n(null),void i.emit("loaded","empty database "+i.filename+" loaded");if(t instanceof Error)return void n(t);if("object"==typeof t)return i.loadJSONObject(t,e||{}),n(null),void i.emit("loaded","database "+i.filename+" loaded");n("unexpected adapter response : "+t)}}):n(new Error("persistenceAdapter not configured"))},m.prototype.loadDatabase=function(e,t){var n=this;this.throttledSaves?this.throttledSaveDrain(function(i){if(i)return n.throttledSavePending=!0,void n.loadDatabaseInternal(e,function(e){0===n.throttledCallbacks.length?n.throttledSavePending=!1:n.saveDatabase(),"function"==typeof t&&t(e)});"function"==typeof t&&t(new Error("Unable to pause save throttling long enough to read database"))},e):this.loadDatabaseInternal(e,t)},m.prototype.saveDatabaseInternal=function(e){var t=e||function(e){if(e)throw e},n=this;null!==this.persistenceAdapter?"reference"===this.persistenceAdapter.mode&&"function"==typeof this.persistenceAdapter.exportDatabase?this.persistenceAdapter.exportDatabase(this.filename,this.copy({removeNonSerializable:!0}),function(e){n.autosaveClearFlags(),t(e)}):(n.autosaveClearFlags(),this.persistenceAdapter.saveDatabase(this.filename,n.serialize(),function(e){t(e)})):t(new Error("persistenceAdapter not configured"))},m.prototype.save=m.prototype.saveDatabase=function(e){if(this.throttledSaves)if(this.throttledSavePending)this.throttledCallbacks.push(e);else{var t=this.throttledCallbacks;this.throttledCallbacks=[],t.unshift(e),this.throttledSavePending=!0;var n=this;this.saveDatabaseInternal(function(e){n.throttledSavePending=!1,t.forEach(function(t){"function"==typeof t&&setTimeout(function(){t(e)},1)}),n.throttledCallbacks.length>0&&n.saveDatabase()})}else this.saveDatabaseInternal(e)},m.prototype.deleteDatabase=function(e,t){var n=t||function(e,t){if(e)throw e};"function"!=typeof e||t||(n=e),null!==this.persistenceAdapter?this.persistenceAdapter.deleteDatabase(this.filename,function(e){n(e)}):n(new Error("persistenceAdapter not configured"))},m.prototype.autosaveDirty=function(){for(var e=0;e<this.collections.length;e++)if(this.collections[e].dirty)return!0;return!1},m.prototype.autosaveClearFlags=function(){for(var e=0;e<this.collections.length;e++)this.collections[e].dirty=!1},m.prototype.autosaveEnable=function(e,t){this.autosave=!0;var n=5e3,i=this;null!=this.autosaveInterval&&(n=this.autosaveInterval),this.autosaveHandle=setInterval(function(){i.autosaveDirty()&&i.saveDatabase(t)},n)},m.prototype.autosaveDisable=function(){null!=this.autosaveHandle&&(clearInterval(this.autosaveHandle),this.autosaveHandle=null)},x.prototype.reset=function(){return this.filteredrows.length>0&&(this.filteredrows=[]),this.filterInitialized=!1,this},x.prototype.toJSON=function(){var e=this.copy();return e.collection=null,e},x.prototype.limit=function(e){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var t=new x(this.collection);return t.filteredrows=this.filteredrows.slice(0,e),t.filterInitialized=!0,t},x.prototype.offset=function(e){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var t=new x(this.collection);return t.filteredrows=this.filteredrows.slice(e),t.filterInitialized=!0,t},x.prototype.copy=function(){var e=new x(this.collection);return this.filteredrows.length>0&&(e.filteredrows=this.filteredrows.slice()),e.filterInitialized=this.filterInitialized,e},x.prototype.branch=x.prototype.copy,x.prototype.transform=function(e,n){var i,o,r=this;if("string"==typeof e&&this.collection.transforms.hasOwnProperty(e)&&(e=this.collection.transforms[e]),"object"!=typeof e||!Array.isArray(e))throw new Error("Invalid transform");for(void 0!==n&&(e=t.resolveTransformParams(e,n)),i=0;i<e.length;i++)switch((o=e[i]).type){case"find":r.find(o.value);break;case"where":r.where(o.value);break;case"simplesort":r.simplesort(o.property,o.desc||o.options);break;case"compoundsort":r.compoundsort(o.value);break;case"sort":r.sort(o.value);break;case"limit":r=r.limit(o.value);break;case"offset":r=r.offset(o.value);break;case"map":r=r.map(o.value,o.dataOptions);break;case"eqJoin":r=r.eqJoin(o.joinData,o.leftJoinKey,o.rightJoinKey,o.mapFun,o.dataOptions);break;case"mapReduce":r=r.mapReduce(o.mapFunction,o.reduceFunction);break;case"update":r.update(o.value);break;case"remove":r.remove()}return r},x.prototype.sort=function(e){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var t,n,i=(t=e,n=this.collection.data,function(e,i){return t(n[e],n[i])});return this.filteredrows.sort(i),this},x.prototype.simplesort=function(e,n){var i=10,o=this.collection.data.length,r=this.filteredrows.length,a=this.collection.binaryIndices.hasOwnProperty(e);if(void 0!==n&&!1!==n||(n={desc:!1}),!0===n&&(n={desc:!0}),0===r){if(this.filterInitialized)return this;if(this.collection.binaryIndices.hasOwnProperty(e))return this.collection.ensureIndex(e),this.filteredrows=this.collection.binaryIndices[e].values.slice(0),n.desc&&this.filteredrows.reverse(),this;this.filteredrows=this.collection.prepareFullDocIndex()}else if(!n.disableIndexIntersect&&a&&(n.useJavascriptSorting&&(i=6),o/r<=i||n.forceIndexIntersect)){var l,c=this.filteredrows,u={};for(l=0;l<r;l++)u[c[l]]=!0;return this.filteredrows=this.collection.binaryIndices[e].values.filter(function(e){return u[e]}),n.desc&&this.filteredrows.reverse(),this}if(n.useJavascriptSorting)return this.sort(function(t,n){return t[e]===n[e]?0:t[e]>n[e]?1:t[e]<n[e]?-1:void 0});var h,d,p,f,g,m,y=(h=e,d=n.desc,p=this.collection.data,function(e,n){return~h.indexOf(".")?(m=h.split("."),f=t.getIn(p[e],m,!0),g=t.getIn(p[n],m,!0)):(f=p[e][h],g=p[n][h]),s(f,g,d)});return this.filteredrows.sort(y),this},x.prototype.compoundsort=function(e){if(0===e.length)throw new Error("Invalid call to compoundsort, need at least one property");var n;if(1===e.length)return n=e[0],Array.isArray(n)?this.simplesort(n[0],n[1]):this.simplesort(n,!1);for(var i=0,o=e.length;i<o;i+=1)n=e[i],Array.isArray(n)||(e[i]=[n,!1]);this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var r,a,l=(r=e,a=this.collection.data,function(e,n){return function(e,n,i){for(var o,r,a,l,c,u=0,h=0,d=e.length;h<d;h++)if(~(r=(o=e[h])[0]).indexOf(".")?(c=r.split("."),a=t.getIn(n,c,!0),l=t.getIn(i,c,!0)):(a=n[r],l=i[r]),0!==(u=s(a,l,o[1])))return u;return 0}(r,a[e],a[n])});return this.filteredrows.sort(l),this},x.prototype.$or=x.prototype.findOr=function(e){for(var t=null,n=0,i=0,o=[],r=[],a=0,s=(this.count(),0),l=e.length;s<l;s++)for(i=(t=this.branch().find(e[s]).filteredrows).length,n=0;n<i;n++)void 0===r[a=t[n]]&&(r[a]=!0,o.push(a));return this.filteredrows=o,this.filterInitialized=!0,this},x.prototype.$and=x.prototype.findAnd=function(e){for(var t=0,n=e.length;t<n;t++){if(0===this.count())return this;this.find(e[t])}return this},x.prototype.find=function(n,i){if(0===this.collection.data.length)return this.filteredrows=[],this.filterInitialized=!0,this;var o,r,a,s,c,u,p,f=n||"getAll",g=!1,m=[],y=[],b=null;if(i=i||!1,"object"==typeof f){for(o in f)(s={})[o]=f[o],y.push(s),e.call(f,o)&&(r=o,a=f[o]);if(y.length>1)return this.find({$and:y},i)}if(!r||"getAll"===f)return i&&(this.filterInitialized?this.filteredrows=this.filteredrows.slice(0,1):(this.filteredrows=this.collection.data.length>0?[0]:[],this.filterInitialized=!0)),this;if("$and"===r||"$or"===r)return this[r](a),i&&this.filteredrows.length>1&&(this.filteredrows=this.filteredrows.slice(0,1)),this;if(null===a||"object"!=typeof a||a instanceof Date)c="$eq",u=a;else{if("object"!=typeof a)throw new Error("Do not know what you want to do.");for(p in a)if(e.call(a,p)){c=p,u=a[p];break}}"$regex"!==c&&"object"!=typeof u||(u=function e(t,n){if("$regex"===t)Array.isArray(n)?n=new RegExp(n[0],n[1]):n instanceof RegExp||(n=new RegExp(n));else if("object"==typeof n)for(var i in n)"$regex"!==i&&"object"!=typeof n[i]||(n[i]=e(i,n[i]));return n}(c,u));var v=-1!==r.indexOf(".");!this.filterInitialized&&this.collection.binaryIndices[r]&&d[c]&&(!0!==this.collection.adaptiveBinaryIndices&&this.collection.ensureIndex(r),g=!0,b=this.collection.binaryIndices[r]);var w,x=h[c],C=this.collection.data,k=0,T=0,P=0;if(this.filterInitialized){if(T=(w=this.filteredrows).length,v){for(r=r.split("."),k=0;k<T;k++)if(l(C[P=w[k]],r,x,u)&&(m.push(P),i))return this.filteredrows=m,this}else for(k=0;k<T;k++)if(x(C[P=w[k]][r],u)&&(m.push(P),i))return this.filteredrows=m,this}else if(g){var O=this.collection.calculateRange(c,r,u);if("$in"!==c){for(k=O[0];k<=O[1];k++)if(!0!==d[c]){if(d[c](t.getIn(C[b.values[k]],r,v),u)&&(m.push(b.values[k]),i))return this.filteredrows=m,this.filterInitialized=!0,this}else if(m.push(b.values[k]),i)return this.filteredrows=m,this.filterInitialized=!0,this}else for(k=0,T=O.length;k<T;k++)if(m.push(b.values[O[k]]),i)return this.filteredrows=m,this.filterInitialized=!0,this}else if(T=C.length,v){for(r=r.split("."),k=0;k<T;k++)if(l(C[k],r,x,u)&&(m.push(k),i))return this.filteredrows=m,this.filterInitialized=!0,this}else for(k=0;k<T;k++)if(x(C[k][r],u)&&(m.push(k),i))return this.filteredrows=m,this.filterInitialized=!0,this;return this.filteredrows=m,this.filterInitialized=!0,this},x.prototype.where=function(e){var t,n=[];if("function"!=typeof e)throw new TypeError("Argument is not a stored view or a function");t=e;try{if(this.filterInitialized){for(var i=this.filteredrows.length;i--;)!0===t(this.collection.data[this.filteredrows[i]])&&n.push(this.filteredrows[i]);return this.filteredrows=n,this}for(var o=this.collection.data.length;o--;)!0===t(this.collection.data[o])&&n.push(o);return this.filteredrows=n,this.filterInitialized=!0,this}catch(r){throw r}},x.prototype.count=function(){return this.filterInitialized?this.filteredrows.length:this.collection.count()},x.prototype.data=function(e){var t,n,i,o,r=[],a=this.collection.data;if((e=e||{}).removeMeta&&!e.forceClones&&(e.forceClones=!0,e.forceCloneMethod=e.forceCloneMethod||"shallow"),this.collection.disableDeltaChangesApi||(e.forceClones=!0,e.forceCloneMethod="parse-stringify"),!this.filterInitialized){if(0===this.filteredrows.length){if(this.collection.cloneObjects||e.forceClones){for(n=a.length,o=e.forceCloneMethod||this.collection.cloneMethod,i=0;i<n;i++)t=p(a[i],o),e.removeMeta&&(delete t.$loki,delete t.meta),r.push(t);return r}return a.slice()}this.filterInitialized=!0}var s=this.filteredrows;if(n=s.length,this.collection.cloneObjects||e.forceClones)for(o=e.forceCloneMethod||this.collection.cloneMethod,i=0;i<n;i++)t=p(a[s[i]],o),e.removeMeta&&(delete t.$loki,delete t.meta),r.push(t);else for(i=0;i<n;i++)r.push(a[s[i]]);return r},x.prototype.update=function(e){if("function"!=typeof e)throw new TypeError("Argument is not a function");this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());for(var t,n=this.filteredrows.length,i=this.collection.data,o=0;o<n;o++)this.collection.cloneObjects||!this.collection.disableDeltaChangesApi?(e(t=p(i[this.filteredrows[o]],this.collection.cloneMethod)),this.collection.update(t)):(e(i[this.filteredrows[o]]),this.collection.update(i[this.filteredrows[o]]));return this},x.prototype.remove=function(){return this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex()),this.collection.removeBatchByPositions(this.filteredrows),this.filteredrows=[],this},x.prototype.mapReduce=function(e,t){try{return t(this.data().map(e))}catch(n){throw n}},x.prototype.eqJoin=function(e,t,n,i,o){var r,a,s,l,c=[],u=[],h="function"==typeof t,d="function"==typeof n,p={};if(a=(r=this.data(o)).length,e instanceof k)c=e.chain().data(o);else if(e instanceof x)c=e.data(o);else{if(!Array.isArray(e))throw new TypeError("joinData needs to be an array or result set");c=e}s=c.length;for(var f=0;f<s;f++)p[l=d?n(c[f]):c[f][n]]=c[f];i||(i=function(e,t){return{left:e,right:t}});for(var g=0;g<a;g++)l=h?t(r[g]):r[g][t],u.push(i(r[g],p[l]||{}));return this.collection=new k("joinData"),this.collection.insert(u),this.filteredrows=[],this.filterInitialized=!1,this},x.prototype.map=function(e,t){var n=this.data(t).map(e);return this.collection=new k("mappedData"),this.collection.insert(n),this.filteredrows=[],this.filterInitialized=!1,this},(C.prototype=new g).rematerialize=function(e){var t,n,i;if(e=e||{},this.resultdata=[],this.resultsdirty=!0,this.resultset=new x(this.collection),(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple)&&(this.sortDirty=!0),e.hasOwnProperty("removeWhereFilters"))for(n=t=this.filterPipeline.length;n--;)"where"===this.filterPipeline[n].type&&(n!==this.filterPipeline.length-1&&(this.filterPipeline[n]=this.filterPipeline[this.filterPipeline.length-1]),this.filterPipeline.length--);var o=this.filterPipeline;for(this.filterPipeline=[],t=o.length,i=0;i<t;i++)this.applyFind(o[i].val);return this.data(),this.emit("rebuild",this),this},C.prototype.branchResultset=function(e,t){var n=this.resultset.branch();return void 0===e?n:n.transform(e,t)},C.prototype.toJSON=function(){var e=new C(this.collection,this.name,this.options);return e.resultset=this.resultset,e.resultdata=[],e.resultsdirty=!0,e.filterPipeline=this.filterPipeline,e.sortFunction=this.sortFunction,e.sortCriteria=this.sortCriteria,e.sortCriteriaSimple=this.sortCriteriaSimple||null,e.sortDirty=this.sortDirty,e.collection=null,e},C.prototype.removeFilters=function(e){e=e||{},this.rebuildPending=!1,this.resultset.reset(),this.resultdata=[],this.resultsdirty=!0,this.cachedresultset=null,this.filterPipeline=[],this.sortFunction=null,this.sortCriteria=null,this.sortCriteriaSimple=null,this.sortDirty=!1,!0===e.queueSortPhase&&this.queueSortPhase()},C.prototype.applySort=function(e){return this.sortFunction=e,this.sortCriteria=null,this.sortCriteriaSimple=null,this.queueSortPhase(),this},C.prototype.applySimpleSort=function(e,t){return this.sortCriteriaSimple={propname:e,options:t||!1},this.sortCriteria=null,this.sortFunction=null,this.queueSortPhase(),this},C.prototype.applySortCriteria=function(e){return this.sortCriteria=e,this.sortCriteriaSimple=null,this.sortFunction=null,this.queueSortPhase(),this},C.prototype.startTransaction=function(){return this.cachedresultset=this.resultset.copy(),this},C.prototype.commit=function(){return this.cachedresultset=null,this},C.prototype.rollback=function(){return this.resultset=this.cachedresultset,this.options.persistent&&(this.resultdata=this.resultset.data(),this.emit("rebuild",this)),this},C.prototype._indexOfFilterWithId=function(e){if("string"==typeof e||"number"==typeof e)for(var t=0,n=this.filterPipeline.length;t<n;t+=1)if(e===this.filterPipeline[t].uid)return t;return-1},C.prototype._addFilter=function(e){this.filterPipeline.push(e),this.resultset[e.type](e.val)},C.prototype.reapplyFilters=function(){this.resultset.reset(),this.cachedresultset=null,this.options.persistent&&(this.resultdata=[],this.resultsdirty=!0);var e=this.filterPipeline;this.filterPipeline=[];for(var t=0,n=e.length;t<n;t+=1)this._addFilter(e[t]);return this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent(),this},C.prototype.applyFilter=function(e){var t=this._indexOfFilterWithId(e.uid);return t>=0?(this.filterPipeline[t]=e,this.reapplyFilters()):(this.cachedresultset=null,this.options.persistent&&(this.resultdata=[],this.resultsdirty=!0),this._addFilter(e),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent(),this)},C.prototype.applyFind=function(e,t){return this.applyFilter({type:"find",val:e,uid:t}),this},C.prototype.applyWhere=function(e,t){return this.applyFilter({type:"where",val:e,uid:t}),this},C.prototype.removeFilter=function(e){var t=this._indexOfFilterWithId(e);if(t<0)throw new Error("Dynamic view does not contain a filter with ID: "+e);return this.filterPipeline.splice(t,1),this.reapplyFilters(),this},C.prototype.count=function(){return this.resultsdirty&&(this.resultdata=this.resultset.data()),this.resultset.count()},C.prototype.data=function(e){return(this.sortDirty||this.resultsdirty)&&this.performSortPhase({suppressRebuildEvent:!0}),this.options.persistent?this.resultdata:this.resultset.data(e)},C.prototype.queueRebuildEvent=function(){if(!this.rebuildPending){this.rebuildPending=!0;var e=this;setTimeout(function(){e.rebuildPending&&(e.rebuildPending=!1,e.emit("rebuild",e))},this.options.minRebuildInterval)}},C.prototype.queueSortPhase=function(){if(!this.sortDirty){this.sortDirty=!0;var e=this;"active"===this.options.sortPriority?setTimeout(function(){e.performSortPhase()},this.options.minRebuildInterval):this.queueRebuildEvent()}},C.prototype.performSortPhase=function(e){(this.sortDirty||this.resultsdirty)&&(e=e||{},this.sortDirty&&(this.sortFunction?this.resultset.sort(this.sortFunction):this.sortCriteria?this.resultset.compoundsort(this.sortCriteria):this.sortCriteriaSimple&&this.resultset.simplesort(this.sortCriteriaSimple.propname,this.sortCriteriaSimple.options),this.sortDirty=!1),this.options.persistent&&(this.resultdata=this.resultset.data(),this.resultsdirty=!1),e.suppressRebuildEvent||this.emit("rebuild",this))},C.prototype.evaluateDocument=function(e,t){if(!this.resultset.filterInitialized)return this.options.persistent&&(this.resultdata=this.resultset.data()),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());var n,i=this.resultset.filteredrows,o=t?-1:i.indexOf(+e),r=i.length,a=new x(this.collection);a.filteredrows=[e],a.filterInitialized=!0;for(var s=0,l=this.filterPipeline.length;s<l;s++)a[(n=this.filterPipeline[s]).type](n.val);var c=0===a.filteredrows.length?-1:0;return-1!==o||-1!==c?-1===o&&-1!==c?(i.push(e),this.options.persistent&&this.resultdata.push(this.collection.data[e]),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):-1!==o&&-1===c?(o<r-1?(i.splice(o,1),this.options.persistent&&this.resultdata.splice(o,1)):(i.length=r-1,this.options.persistent&&(this.resultdata.length=r-1)),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):-1!==o&&-1!==c?(this.options.persistent&&(this.resultdata[o]=this.collection.data[e]),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):void 0:void 0},C.prototype.removeDocument=function(e){var t,n,i,o={},r={},a=[],s=this.resultset,l=this.resultset.filteredrows,c=l.length;if(!this.resultset.filterInitialized)return this.options.persistent&&(this.resultdata=this.resultset.data()),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());for(Array.isArray(e)||(e=[e]),i=e.length,n=0;n<i;n++)o[e[n]]=!0;for(t=0;t<c;t++)o[l[t]]&&(r[t]=!0);Object.keys(r).length>0&&(this.resultset.filteredrows=this.resultset.filteredrows.filter(function(e,t){return!r[t]}),this.options.persistent&&(this.resultdata=this.resultdata.filter(function(e,t){return!r[t]})),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());var u=function(e){return function(t){return t<s.filteredrows[e]}};for(c=s.filteredrows.length,t=0;t<c;t++)a=e.filter(u(t)),s.filteredrows[t]-=a.length},C.prototype.mapReduce=function(e,t){try{return t(this.data().map(e))}catch(n){throw n}},(k.prototype=new g).createChange=function(e,t,n,i){this.changes.push({name:e,operation:t,obj:"U"!=t||this.disableDeltaChangesApi?JSON.parse(JSON.stringify(n)):this.getChangeDelta(n,i)})},k.prototype.insertMeta=function(e){var t,n;if(!this.disableMeta&&e)if(Array.isArray(e))for(t=e.length,n=0;n<t;n++)e[n].hasOwnProperty("meta")||(e[n].meta={}),e[n].meta.created=(new Date).getTime(),e[n].meta.revision=0;else e.meta||(e.meta={}),e.meta.created=(new Date).getTime(),e.meta.revision=0},k.prototype.updateMeta=function(e){!this.disableMeta&&e&&(e.meta.updated=(new Date).getTime(),e.meta.revision+=1)},k.prototype.createInsertChange=function(e){this.createChange(this.name,"I",e)},k.prototype.createUpdateChange=function(e,t){this.createChange(this.name,"U",e,t)},k.prototype.insertMetaWithChange=function(e){this.insertMeta(e),this.createInsertChange(e)},k.prototype.updateMetaWithChange=function(e,t){this.updateMeta(e),this.createUpdateChange(e,t)},k.prototype.lokiConsoleWrapper={log:function(){},warn:function(){},error:function(){}},k.prototype.addAutoUpdateObserver=function(e){this.autoupdate&&"function"==typeof Object.observe&&Object.observe(e,this.observerCallback,["add","update","delete","reconfigure","setPrototype"])},k.prototype.removeAutoUpdateObserver=function(e){this.autoupdate&&"function"==typeof Object.observe&&Object.unobserve(e,this.observerCallback)},k.prototype.addTransform=function(e,t){if(this.transforms.hasOwnProperty(e))throw new Error("a transform by that name already exists");this.transforms[e]=t},k.prototype.getTransform=function(e){return this.transforms[e]},k.prototype.setTransform=function(e,t){this.transforms[e]=t},k.prototype.removeTransform=function(e){delete this.transforms[e]},k.prototype.byExample=function(e){var t,n,i;for(t in i=[],e)e.hasOwnProperty(t)&&i.push(((n={})[t]=e[t],n));return{$and:i}},k.prototype.findObject=function(e){return this.findOne(this.byExample(e))},k.prototype.findObjects=function(e){return this.find(this.byExample(e))},k.prototype.ttlDaemonFuncGen=function(){var e=this,t=this.ttl.age;return function(){var n=Date.now();e.chain().where(function(e){return t<n-(e.meta.updated||e.meta.created)}).remove()}},k.prototype.setTTL=function(e,t){e<0?clearInterval(this.ttl.daemon):(this.ttl.age=e,this.ttl.ttlInterval=t,this.ttl.daemon=setInterval(this.ttlDaemonFuncGen(),t))},k.prototype.prepareFullDocIndex=function(){for(var e=this.data.length,t=new Array(e),n=0;n<e;n+=1)t[n]=n;return t},k.prototype.configureOptions=function(e){(e=e||{}).hasOwnProperty("adaptiveBinaryIndices")&&(this.adaptiveBinaryIndices=e.adaptiveBinaryIndices,this.adaptiveBinaryIndices&&this.ensureAllIndexes())},k.prototype.ensureIndex=function(e,n){if(void 0===n&&(n=!1),null==e)throw new Error("Attempting to set index without an associated property");if((!this.binaryIndices[e]||n||this.binaryIndices[e].dirty)&&(!0!==this.adaptiveBinaryIndices||!this.binaryIndices.hasOwnProperty(e)||n)){var o={name:e,dirty:!0,values:this.prepareFullDocIndex()};this.binaryIndices[e]=o;var r,a,s,l,c,u=(r=e,a=this.data,function(e,n){if(~r.indexOf(".")?(c=r.split("."),s=t.getIn(a[e],c,!0),l=t.getIn(a[n],c,!0)):(s=a[e][r],l=a[n][r]),s!==l){if(i.lt(s,l,!1))return-1;if(i.gt(s,l,!1))return 1}return 0});o.values.sort(u),o.dirty=!1,this.dirty=!0}},k.prototype.checkAllIndexes=function(t){var n,i=this.binaryIndices,o=[];for(n in i)e.call(i,n)&&(this.checkIndex(n,t)||o.push(n));return o},k.prototype.checkIndex=function(e,n){(n=n||{}).randomSamplingFactor&&!1!==n.randomSampling&&(n.randomSampling=!0),n.randomSamplingFactor=n.randomSamplingFactor||.1,(n.randomSamplingFactor<0||n.randomSamplingFactor>1)&&(n.randomSamplingFactor=.1);var i,o,r,a,s,l=!0;if(!this.binaryIndices.hasOwnProperty(e))throw new Error("called checkIndex on property without an index: "+e);if(this.adaptiveBinaryIndices||this.ensureIndex(e),(a=(s=this.binaryIndices[e].values).length)!==this.data.length)return n.repair&&this.ensureIndex(e,!0),!1;if(0===a)return!0;var c=-1!==e.indexOf(".");if(1===a)l=0===s[0];else if(n.randomSampling){if(h.$lte(t.getIn(this.data[s[0]],e,c),t.getIn(this.data[s[1]],e,c))||(l=!1),h.$lte(t.getIn(this.data[s[a-2]],e,c),t.getIn(this.data[s[a-1]],e,c))||(l=!1),l)for(o=Math.floor((a-1)*n.randomSamplingFactor),i=0;i<o-1;i++)if(r=Math.floor(Math.random()*(a-1)),!h.$lte(t.getIn(this.data[s[r]],e,c),t.getIn(this.data[s[r+1]],e,c))){l=!1;break}}else for(i=0;i<a-1;i++)if(!h.$lte(t.getIn(this.data[s[i]],e,c),t.getIn(this.data[s[i+1]],e,c))){l=!1;break}return!l&&n.repair&&this.ensureIndex(e,!0),l},k.prototype.getBinaryIndexValues=function(e){var n,i=this.binaryIndices[e].values,o=[];for(n=0;n<i.length;n++)o.push(t.getIn(this.data[i[n]],e,!0));return o},k.prototype.ensureUniqueIndex=function(e){var t=this.constraints.unique[e];return t||-1==this.uniqueNames.indexOf(e)&&this.uniqueNames.push(e),this.constraints.unique[e]=t=new z(e),this.data.forEach(function(e){t.set(e)}),t},k.prototype.ensureAllIndexes=function(t){var n,i=this.binaryIndices;for(n in i)e.call(i,n)&&this.ensureIndex(n,t)},k.prototype.flagBinaryIndexesDirty=function(){var t,n=this.binaryIndices;for(t in n)e.call(n,t)&&(n[t].dirty=!0)},k.prototype.flagBinaryIndexDirty=function(e){this.binaryIndices[e]&&(this.binaryIndices[e].dirty=!0)},k.prototype.count=function(e){return e?this.chain().find(e).filteredrows.length:this.data.length},k.prototype.ensureId=function(){var e=this.data.length,t=0;for(this.idIndex=[];t<e;t+=1)this.idIndex.push(this.data[t].$loki)},k.prototype.ensureIdAsync=function(e){this.async(function(){this.ensureId()},e)},k.prototype.addDynamicView=function(e,t){var n=new C(this,e,t);return this.DynamicViews.push(n),n},k.prototype.removeDynamicView=function(e){this.DynamicViews=this.DynamicViews.filter(function(t){return t.name!==e})},k.prototype.getDynamicView=function(e){for(var t=0;t<this.DynamicViews.length;t++)if(this.DynamicViews[t].name===e)return this.DynamicViews[t];return null},k.prototype.findAndUpdate=function(e,t){"function"==typeof e?this.updateWhere(e,t):this.chain().find(e).update(t)},k.prototype.findAndRemove=function(e){this.chain().find(e).remove()},k.prototype.insert=function(e){if(!Array.isArray(e))return this.insertOne(e);var t,n=[];this.emit("pre-insert",e);for(var i=0,o=e.length;i<o;i++){if(!(t=this.insertOne(e[i],!0)))return;n.push(t)}return this.emit("insert",n),1===(n=this.cloneObjects?p(n,this.cloneMethod):n).length?n[0]:n},k.prototype.insertOne=function(e,t){var n,i=null;if("object"!=typeof e?i=new TypeError("Document needs to be an object"):null===e&&(i=new TypeError("Object cannot be null")),null!==i)throw this.emit("error",i),i;var o=this.cloneObjects?p(e,this.cloneMethod):e;if(this.disableMeta||void 0!==o.meta||(o.meta={revision:0,created:0}),t||this.emit("pre-insert",o),this.add(o))return this.disableChangesApi?this.insertMeta(o):this.insertMetaWithChange(o),n=this.cloneObjects?p(o,this.cloneMethod):o,t||this.emit("insert",n),this.addAutoUpdateObserver(n),n},k.prototype.clear=function(e){var t=this;e=e||{},this.data=[],this.idIndex=[],this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedData=null,this.maxId=0,this.DynamicViews=[],this.dirty=!0,!0===e.removeIndices?(this.binaryIndices={},this.constraints={unique:{},exact:{}},this.uniqueNames=[]):(Object.keys(this.binaryIndices).forEach(function(e){t.binaryIndices[e].dirty=!1,t.binaryIndices[e].values=[]}),this.constraints={unique:{},exact:{}},this.uniqueNames.forEach(function(e){t.ensureUniqueIndex(e)}))},k.prototype.update=function(t){var n,i,o;if(Array.isArray(t)){o=t.length,(n=!this.cloneObjects&&this.adaptiveBinaryIndices&&Object.keys(this.binaryIndices).length>0)&&(this.adaptiveBinaryIndices=!1);try{for(i=0;i<o;i+=1)this.update(t[i])}finally{n&&(this.ensureAllIndexes(),this.adaptiveBinaryIndices=!0)}}else{if(!e.call(t,"$loki"))throw new Error("Trying to update unsynced document. Please save the document first by using insert() or addMany()");try{this.startTransaction();var r,a,s,l,c,u=this.get(t.$loki,!0),h=this;if(!u)throw new Error("Trying to update a document not in collection.");r=u[0],s=u[1],a=this.cloneObjects||!this.disableDeltaChangesApi?p(t,this.cloneMethod):t,this.emit("pre-update",t),Object.keys(this.constraints.unique).forEach(function(e){h.constraints.unique[e].update(r,a)}),this.data[s]=a,a!==t&&this.addAutoUpdateObserver(t);for(var d=0;d<this.DynamicViews.length;d++)this.DynamicViews[d].evaluateDocument(s,!1);if(this.adaptiveBinaryIndices){var f=this.binaryIndices;for(l in f)this.adaptiveBinaryIndexUpdate(s,l)}else this.flagBinaryIndexesDirty();return this.idIndex[s]=a.$loki,this.commit(),this.dirty=!0,this.disableChangesApi?this.updateMeta(a,null):this.updateMetaWithChange(a,r),c=this.cloneObjects?p(a,this.cloneMethod):a,this.emit("update",c,r),c}catch(g){throw this.rollback(),this.lokiConsoleWrapper.error(g.message),this.emit("error",g),g}}},k.prototype.add=function(t){if("object"!=typeof t)throw new TypeError("Object being added needs to be an object");if(void 0!==t.$loki)throw new Error("Document is already in collection, please use update()");try{this.startTransaction(),this.maxId++,isNaN(this.maxId)&&(this.maxId=this.data[this.data.length-1].$loki+1),t.$loki=this.maxId,this.disableMeta||(t.meta.version=0);var n,i=this.constraints.unique;for(n in i)e.call(i,n)&&i[n].set(t);this.idIndex.push(t.$loki),this.data.push(t);for(var o=this.data.length-1,r=this.DynamicViews.length,a=0;a<r;a++)this.DynamicViews[a].evaluateDocument(o,!0);if(this.adaptiveBinaryIndices){var s=this.binaryIndices;for(n in s)this.adaptiveBinaryIndexInsert(o,n)}else this.flagBinaryIndexesDirty();return this.commit(),this.dirty=!0,this.cloneObjects?p(t,this.cloneMethod):t}catch(l){throw this.rollback(),this.lokiConsoleWrapper.error(l.message),this.emit("error",l),l}},k.prototype.updateWhere=function(e,t){var n,i=this.where(e),o=0;try{for(;o<i.length;o++)n=t(i[o]),this.update(n)}catch(r){this.rollback(),this.lokiConsoleWrapper.error(r.message)}},k.prototype.removeWhere=function(e){var t;"function"==typeof e?(t=this.data.filter(e),this.remove(t)):this.chain().find(e).remove()},k.prototype.removeDataOnly=function(){this.remove(this.data.slice())},k.prototype.removeBatchByPositions=function(e){var t,n,i,o,r=e.length,a={},s=Object.keys(this.binaryIndices).length,l=Object.keys(this.constraints.unique).length,c=this.adaptiveBinaryIndices&&Object.keys(this.binaryIndices).length>0,u=this;try{for(this.startTransaction(),i=0;i<r;i++)a[this.idIndex[e[i]]]=!0;if((t=this.DynamicViews.length)>0||s>0||l>0){if(t>0)for(n=0;n<t;n++)this.DynamicViews[n].removeDocument(e);if(this.adaptiveBinaryIndices&&!c){var h,d=this.binaryIndices;for(h in d)this.adaptiveBinaryIndexRemove(e,h)}else this.flagBinaryIndexesDirty();l&&Object.keys(this.constraints.unique).forEach(function(t){for(i=0;i<r;i++)null!=(o=u.data[e[i]])[t]&&u.constraints.unique[t].remove(o[t])})}if(!this.disableChangesApi||this.events.delete.length>1)for(i=0;i<r;i++)this.emit("delete",this.data[e[i]]);this.data=this.data.filter(function(e){return!a[e.$loki]}),this.idIndex=this.idIndex.filter(function(e){return!a[e]}),this.adaptiveBinaryIndices&&c&&(this.adaptiveBinaryIndices=!1,this.ensureAllIndexes(!0),this.adaptiveBinaryIndices=!0),this.commit(),this.dirty=!0}catch(p){return this.rollback(),c&&(this.adaptiveBinaryIndices=!0),this.lokiConsoleWrapper.error(p.message),this.emit("error",p),null}},k.prototype.removeBatch=function(e){var t,n=e.length,i=this.data.length,o={},r=[];for(t=0;t<i;t++)o[this.data[t].$loki]=t;for(t=0;t<n;t++)r.push("object"==typeof e[t]?o[e[t].$loki]:o[e[t]]);this.removeBatchByPositions(r)},k.prototype.remove=function(t){if("number"==typeof t&&(t=this.get(t)),"object"!=typeof t)throw new Error("Parameter is not an object");if(Array.isArray(t))this.removeBatch(t);else{if(!e.call(t,"$loki"))throw new Error("Object is not a document stored in the collection");try{this.startTransaction();var n=this.get(t.$loki,!0),i=n[1],o=this;Object.keys(this.constraints.unique).forEach(function(e){null!=t[e]&&o.constraints.unique[e].remove(t[e])});for(var r=0;r<this.DynamicViews.length;r++)this.DynamicViews[r].removeDocument(i);if(this.adaptiveBinaryIndices){var a,s=this.binaryIndices;for(a in s)this.adaptiveBinaryIndexRemove(i,a)}else this.flagBinaryIndexesDirty();return this.data.splice(i,1),this.removeAutoUpdateObserver(t),this.idIndex.splice(i,1),this.commit(),this.dirty=!0,this.emit("delete",n[0]),delete t.$loki,delete t.meta,t}catch(l){return this.rollback(),this.lokiConsoleWrapper.error(l.message),this.emit("error",l),null}}},k.prototype.get=function(e,t){var n=t||!1,i=this.idIndex,o=i.length-1,r=0,a=r+o>>1;if(e="number"==typeof e?e:parseInt(e,10),isNaN(e))throw new TypeError("Passed id is not an integer");for(;i[r]<i[o];)i[a=r+o>>1]<e?r=a+1:o=a;return o===r&&i[r]===e?n?[this.data[r],r]:this.data[r]:null},k.prototype.getBinaryIndexPosition=function(e,n){var i=t.getIn(this.data[e],n,!0),o=this.binaryIndices[n].values,r=this.calculateRange("$eq",n,i);if(0===r[0]&&-1===r[1])return null;for(var a=r[1],s=r[0];s<=a;s++)if(o[s]===e)return s;return null},k.prototype.adaptiveBinaryIndexInsert=function(e,n){var i=-1!==n.indexOf("."),o=this.binaryIndices[n].values,r=t.getIn(this.data[e],n,i);!0===this.serializableIndices&&r instanceof Date&&(this.data[e][n]=r.getTime(),r=t.getIn(this.data[e],n));var a=0===o.length?0:this.calculateRangeStart(n,r,!0,i);this.binaryIndices[n].values.splice(a,0,e)},k.prototype.adaptiveBinaryIndexUpdate=function(e,t){var n,i=this.binaryIndices[t].values,o=i.length;for(n=0;n<o&&i[n]!==e;n++);this.binaryIndices[t].values.splice(n,1),this.adaptiveBinaryIndexInsert(e,t)},k.prototype.adaptiveBinaryIndexRemove=function(e,t,n){var i,o,r,a,s,l,c,u=this.binaryIndices[t],h={};if(Array.isArray(e)){if(1!==(a=e.length)){for(r=0;r<a;r++)h[e[r]]=!0;if(u.values=u.values.filter(function(e){return!h[e]}),!0===n)return;var d=e.slice();for(d.sort(function(e,t){return e-t}),i=u.values.length,o=0;o<i;o++){for(s=u.values[o],l=0,r=0;r<a&&s>d[r];r++)l++;u.values[o]-=l}return}e=e[0]}if(null===(c=this.getBinaryIndexPosition(e,t)))return null;if(u.values.splice(c,1),!0!==n)for(i=u.values.length,o=0;o<i;o++)u.values[o]>e&&u.values[o]--},k.prototype.calculateRangeStart=function(e,n,o,r){var a=this.data,s=this.binaryIndices[e].values,l=0,c=s.length-1,u=0;if(0===s.length)return-1;for(t.getIn(a[s[l]],e,r),t.getIn(a[s[c]],e,r);l<c;)i.lt(t.getIn(a[s[u=l+c>>1]],e,r),n,!1)?l=u+1:c=u;var h=l;return i.aeq(n,t.getIn(a[s[h]],e,r))?h:i.lt(n,t.getIn(a[s[h]],e,r),!1)?o?h:h-1:o?h+1:h},k.prototype.calculateRangeEnd=function(e,n,o){var r=this.data,a=this.binaryIndices[e].values,s=0,l=a.length-1,c=0;if(0===a.length)return-1;for(t.getIn(r[a[s]],e,o),t.getIn(r[a[l]],e,o);s<l;)i.lt(n,t.getIn(r[a[c=s+l>>1]],e,o),!1)?l=c:s=c+1;var u=l;return i.aeq(n,t.getIn(r[a[u]],e,o))?u:i.gt(n,t.getIn(r[a[u]],e,o),!1)?u+1:i.aeq(n,t.getIn(r[a[u-1]],e,o))?u-1:u},k.prototype.calculateRange=function(e,n,o){var r,a,s,l=this.data,c=this.binaryIndices[n].values,u=c.length-1;if(0===l.length)return[0,-1];var h=-1!==n.indexOf("."),d=t.getIn(l[c[0]],n,h),p=t.getIn(l[c[u]],n,h);switch(e){case"$eq":case"$aeq":case"$dteq":if(i.lt(o,d,!1)||i.gt(o,p,!1))return[0,-1];break;case"$gt":if(i.gt(o,p,!0))return[0,-1];if(i.gt(d,o,!1))return[0,u];break;case"$gte":if(i.gt(o,p,!1))return[0,-1];if(i.gt(d,o,!0))return[0,u];break;case"$lt":if(i.lt(o,d,!0))return[0,-1];if(i.lt(p,o,!1))return[0,u];break;case"$lte":if(i.lt(o,d,!1))return[0,-1];if(i.lt(p,o,!0))return[0,u];break;case"$between":return i.gt(o[0],p,!1)?[0,-1]:i.lt(o[1],d,!1)?[0,-1]:((r=this.calculateRangeStart(n,o[0],!1,h))<0&&r++,(s=this.calculateRangeEnd(n,o[1],h))>u&&s--,i.gt(t.getIn(l[c[r]],n,h),o[0],!0)||r++,i.lt(t.getIn(l[c[s]],n,h),o[1],!0)||s--,s<r?[0,-1]:[r,s]);case"$in":for(var f=[],g=[],m=0,y=o.length;m<y;m++)for(var b=this.calculateRange("$eq",n,o[m]),v=b[0];v<=b[1];v++)void 0===f[v]&&(f[v]=!0,g.push(v));return g}switch(e){case"$eq":case"$aeq":case"$dteq":case"$gte":case"$lt":r=this.calculateRangeStart(n,o,!1,h),a=t.getIn(l[c[r]],n,h)}switch(e){case"$eq":case"$aeq":case"$dteq":case"$lte":case"$gt":s=this.calculateRangeEnd(n,o,h),t.getIn(l[c[s]],n,h)}switch(e){case"$eq":case"$aeq":case"$dteq":return i.aeq(a,o)?[r,s]:[0,-1];case"$gt":return i.aeq(t.getIn(l[c[s]],n,h),o)?[s+1,u]:[s,u];case"$gte":return i.aeq(t.getIn(l[c[r]],n,h),o)?[r,u]:[r+1,u];case"$lt":return i.aeq(t.getIn(l[c[r]],n,h),o)?[0,r-1]:[0,r];case"$lte":return i.aeq(t.getIn(l[c[s]],n,h),o)?[0,s]:[0,s-1];default:return[0,l.length-1]}},k.prototype.by=function(e,t){var n;if(void 0===t)return n=this,function(t){return n.by(e,t)};var i=this.constraints.unique[e].get(t);return this.cloneObjects?p(i,this.cloneMethod):i},k.prototype.findOne=function(e){e=e||{};var t=this.chain().find(e,!0).data();return Array.isArray(t)&&0===t.length?null:this.cloneObjects?p(t[0],this.cloneMethod):t[0]},k.prototype.chain=function(e,t){var n=new x(this);return void 0===e?n:n.transform(e,t)},k.prototype.find=function(e){return this.chain().find(e).data()},k.prototype.findOneUnindexed=function(e,n){for(var i=this.data.length;i--;)if(t.getIn(this.data[i],e,!0)===n)return this.data[i];return null},k.prototype.startTransaction=function(){if(this.transactional){this.cachedData=p(this.data,this.cloneMethod),this.cachedIndex=this.idIndex,this.cachedBinaryIndex=this.binaryIndices;for(var e=0;e<this.DynamicViews.length;e++)this.DynamicViews[e].startTransaction()}},k.prototype.commit=function(){if(this.transactional){this.cachedData=null,this.cachedIndex=null,this.cachedBinaryIndex=null;for(var e=0;e<this.DynamicViews.length;e++)this.DynamicViews[e].commit()}},k.prototype.rollback=function(){if(this.transactional){null!==this.cachedData&&null!==this.cachedIndex&&(this.data=this.cachedData,this.idIndex=this.cachedIndex,this.binaryIndices=this.cachedBinaryIndex);for(var e=0;e<this.DynamicViews.length;e++)this.DynamicViews[e].rollback()}},k.prototype.async=function(e,t){setTimeout(function(){if("function"!=typeof e)throw new TypeError("Argument passed for async execution is not a function");e(),t()},0)},k.prototype.where=function(e){return this.chain().where(e).data()},k.prototype.mapReduce=function(e,t){try{return t(this.data.map(e))}catch(n){throw n}},k.prototype.eqJoin=function(e,t,n,i,o){return new x(this).eqJoin(e,t,n,i,o)},k.prototype.stages={},k.prototype.getStage=function(e){return this.stages[e]||(this.stages[e]={}),this.stages[e]},k.prototype.commitLog=[],k.prototype.stage=function(e,t){var n=JSON.parse(JSON.stringify(t));return this.getStage(e)[t.$loki]=n,n},k.prototype.commitStage=function(e,t){var n,i=this.getStage(e),o=(new Date).getTime();for(n in i)this.update(i[n]),this.commitLog.push({timestamp:o,message:t,data:JSON.parse(JSON.stringify(i[n]))});this.stages[e]={}},k.prototype.no_op=function(){},k.prototype.extract=function(e){for(var t=0,n=this.data.length,i=T(e),o=[];t<n;t+=1)o.push(I(this.data[t],e,i));return o},k.prototype.max=function(e){return Math.max.apply(null,this.extract(e))},k.prototype.min=function(e){return Math.min.apply(null,this.extract(e))},k.prototype.maxRecord=function(e){for(var t,n=0,i=this.data.length,o=T(e),r={index:0,value:void 0};n<i;n+=1)void 0!==t?t<I(this.data[n],e,o)&&(t=I(this.data[n],e,o),r.index=this.data[n].$loki):(t=I(this.data[n],e,o),r.index=this.data[n].$loki);return r.value=t,r},k.prototype.minRecord=function(e){for(var t,n=0,i=this.data.length,o=T(e),r={index:0,value:void 0};n<i;n+=1)void 0!==t?t>I(this.data[n],e,o)&&(t=I(this.data[n],e,o),r.index=this.data[n].$loki):(t=I(this.data[n],e,o),r.index=this.data[n].$loki);return r.value=t,r},k.prototype.extractNumerical=function(e){return this.extract(e).map(P).filter(Number).filter(function(e){return!isNaN(e)})},k.prototype.avg=function(e){return S(this.extractNumerical(e))},k.prototype.stdDev=function(e){return t=this.extractNumerical(e),n=S(t),i=S(t.map(function(e){var t=e-n;return t*t})),Math.sqrt(i);var t,n,i},k.prototype.mode=function(e){var t,n,i,o={},r=this.extract(e);for(n in r.forEach(function(e){o[e]?o[e]+=1:o[e]=1}),o)t?t<o[n]&&(i=n):(i=n,t=o[n]);return i},k.prototype.median=function(e){var t=this.extractNumerical(e);t.sort(A);var n=Math.floor(t.length/2);return t.length%2?t[n]:(t[n-1]+t[n])/2},B.prototype={keys:[],values:[],sort:function(e,t){return e<t?-1:e>t?1:0},setSort:function(e){this.bs=new M(e)},bs:function(){return new M(this.sort)},set:function(e,t){var n=this.bs(this.keys,e);n.found?this.values[n.index]=t:(this.keys.splice(n.index,0,e),this.values.splice(n.index,0,t))},get:function(e){return this.values[E(this.keys,e,this.sort).index]}},z.prototype.keyMap={},z.prototype.lokiMap={},z.prototype.set=function(e){var t=e[this.field];if(null!=t){if(this.keyMap[t])throw new Error("Duplicate key for property "+this.field+": "+t);this.keyMap[t]=e,this.lokiMap[e.$loki]=t}},z.prototype.get=function(e){return this.keyMap[e]},z.prototype.byId=function(e){return this.keyMap[this.lokiMap[e]]},z.prototype.update=function(e,t){if(this.lokiMap[e.$loki]!==t[this.field]){var n=this.lokiMap[e.$loki];this.set(t),this.keyMap[n]=void 0}else this.keyMap[e[this.field]]=t},z.prototype.remove=function(e){var t=this.keyMap[e];if(null==t)throw new Error("Key is not in unique index: "+this.field);this.keyMap[e]=void 0,this.lokiMap[t.$loki]=void 0},z.prototype.clear=function(){this.keyMap={},this.lokiMap={}},j.prototype={set:function(e,t){this.index[e]?this.index[e].push(t):this.index[e]=[t]},remove:function(e,t){var n=this.index[e];for(var i in n)n[i]==t&&n.splice(i,1);n.length<1&&(this.index[e]=void 0)},get:function(e){return this.index[e]},clear:function(e){this.index={}}},m.LokiOps=h,m.Collection=k,m.KeyValueStore=B,m.LokiMemoryAdapter=y,m.LokiPartitioningAdapter=b,m.LokiLocalStorageAdapter=w,m.LokiFsAdapter=v,m.persistenceAdapters={fs:v,localStorage:w},m.aeq=o,m.lt=r,m.gt=a,m.Comparators=i,m}()})?i.apply(t,[]):i)||(e.exports=o)},abzJ:function(e,t){e.exports=function(e,t,n){if(e&&"number"!=typeof e){if(e.hasOwnProperty(t))return e[t];if(-1!==t.indexOf(".")){for(var i=t.split("."),o=e,r=n,a=0;a<i.length;a++){if(!o.hasOwnProperty(i[a])){r=n;break}r=o[i[a]],o=o[i[a]]}return r}return n}return n}},dQ8B:function(e,t,n){var i;!function(){function o(e,t,n){return e.call.apply(e.bind,arguments)}function r(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function a(e,t,n){return(a=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:r).apply(null,arguments)}var s=Date.now||function(){return+new Date};function l(e,t){this.a=e,this.o=t||e,this.c=this.o.document}var c=!!window.FontFace;function u(e,t,n,i){if(t=e.c.createElement(t),n)for(var o in n)n.hasOwnProperty(o)&&("style"==o?t.style.cssText=n[o]:t.setAttribute(o,n[o]));return i&&t.appendChild(e.c.createTextNode(i)),t}function h(e,t,n){(e=e.c.getElementsByTagName(t)[0])||(e=document.documentElement),e.insertBefore(n,e.lastChild)}function d(e){e.parentNode&&e.parentNode.removeChild(e)}function p(e,t,n){t=t||[],n=n||[];for(var i=e.className.split(/\s+/),o=0;o<t.length;o+=1){for(var r=!1,a=0;a<i.length;a+=1)if(t[o]===i[a]){r=!0;break}r||i.push(t[o])}for(t=[],o=0;o<i.length;o+=1){for(r=!1,a=0;a<n.length;a+=1)if(i[o]===n[a]){r=!0;break}r||t.push(i[o])}e.className=t.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function f(e,t){for(var n=e.className.split(/\s+/),i=0,o=n.length;i<o;i++)if(n[i]==t)return!0;return!1}function g(e,t,n){function i(){s&&o&&r&&(s(a),s=null)}t=u(e,"link",{rel:"stylesheet",href:t,media:"all"});var o=!1,r=!0,a=null,s=n||null;c?(t.onload=function(){o=!0,i()},t.onerror=function(){o=!0,a=Error("Stylesheet failed to load"),i()}):setTimeout(function(){o=!0,i()},0),h(e,"head",t)}function m(e,t,n,i){var o=e.c.getElementsByTagName("head")[0];if(o){var r=u(e,"script",{src:t}),a=!1;return r.onload=r.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=!0,n&&n(null),r.onload=r.onreadystatechange=null,"HEAD"==r.parentNode.tagName&&o.removeChild(r))},o.appendChild(r),setTimeout(function(){a||(a=!0,n&&n(Error("Script load timeout")))},i||5e3),r}return null}function y(){this.a=0,this.c=null}function b(e){return e.a++,function(){e.a--,w(e)}}function v(e,t){e.c=t,w(e)}function w(e){0==e.a&&e.c&&(e.c(),e.c=null)}function x(e){this.a=e||"-"}function C(e,t){this.c=e,this.f=4,this.a="n";var n=(t||"n4").match(/^([nio])([1-9])$/i);n&&(this.a=n[1],this.f=parseInt(n[2],10))}function k(e){var t=[];e=e.split(/,\s*/);for(var n=0;n<e.length;n++){var i=e[n].replace(/['"]/g,"");-1!=i.indexOf(" ")||/^\d/.test(i)?t.push("'"+i+"'"):t.push(i)}return t.join(",")}function T(e){return e.a+e.f}function P(e){var t="normal";return"o"===e.a?t="oblique":"i"===e.a&&(t="italic"),t}function O(e){var t=4,n="n",i=null;return e&&((i=e.match(/(normal|oblique|italic)/i))&&i[1]&&(n=i[1].substr(0,1).toLowerCase()),(i=e.match(/([1-9]00|normal|bold)/i))&&i[1]&&(/bold/i.test(i[1])?t=7:/[1-9]00/.test(i[1])&&(t=parseInt(i[1].substr(0,1),10)))),n+t}function A(e,t){this.c=e,this.f=e.o.document.documentElement,this.h=t,this.a=new x("-"),this.j=!1!==t.events,this.g=!1!==t.classes}function S(e){if(e.g){var t=f(e.f,e.a.c("wf","active")),n=[],i=[e.a.c("wf","loading")];t||n.push(e.a.c("wf","inactive")),p(e.f,n,i)}I(e,"inactive")}function I(e,t,n){e.j&&e.h[t]&&(n?e.h[t](n.c,T(n)):e.h[t]())}function E(){this.c={}}function M(e,t){this.c=e,this.f=t,this.a=u(this.c,"span",{"aria-hidden":"true"},this.f)}function B(e){h(e.c,"body",e.a)}function z(e){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+k(e.c)+";font-style:"+P(e)+";font-weight:"+e.f+"00;"}function j(e,t,n,i,o,r){this.g=e,this.j=t,this.a=i,this.c=n,this.f=o||3e3,this.h=r||void 0}function _(e,t,n,i,o,r,a){this.v=e,this.B=t,this.c=n,this.a=i,this.s=a||"BESbswy",this.f={},this.w=o||3e3,this.u=r||null,this.m=this.j=this.h=this.g=null,this.g=new M(this.c,this.s),this.h=new M(this.c,this.s),this.j=new M(this.c,this.s),this.m=new M(this.c,this.s),e=z(e=new C(this.a.c+",serif",T(this.a))),this.g.a.style.cssText=e,e=z(e=new C(this.a.c+",sans-serif",T(this.a))),this.h.a.style.cssText=e,e=z(e=new C("serif",T(this.a))),this.j.a.style.cssText=e,e=z(e=new C("sans-serif",T(this.a))),this.m.a.style.cssText=e,B(this.g),B(this.h),B(this.j),B(this.m)}x.prototype.c=function(e){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n].replace(/[\W_]+/g,"").toLowerCase());return t.join(this.a)},j.prototype.start=function(){var e=this.c.o.document,t=this,n=s(),i=new Promise(function(i,o){!function r(){s()-n>=t.f?o():e.fonts.load(function(e){return P(e)+" "+e.f+"00 300px "+k(e.c)}(t.a),t.h).then(function(e){1<=e.length?i():setTimeout(r,25)},function(){o()})}()}),o=null,r=new Promise(function(e,n){o=setTimeout(n,t.f)});Promise.race([r,i]).then(function(){o&&(clearTimeout(o),o=null),t.g(t.a)},function(){t.j(t.a)})};var D={D:"serif",C:"sans-serif"},L=null;function Y(){if(null===L){var e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);L=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))}return L}function R(e,t,n){for(var i in D)if(D.hasOwnProperty(i)&&t===e.f[D[i]]&&n===e.f[D[i]])return!0;return!1}function X(e,t){setTimeout(a(function(){d(this.g.a),d(this.h.a),d(this.j.a),d(this.m.a),t(this.a)},e),0)}function W(e,t,n){this.c=e,this.a=t,this.f=0,this.m=this.j=!1,this.s=n}_.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=s(),function e(t){var n,i=t.g.a.offsetWidth,o=t.h.a.offsetWidth;(n=i===t.f.serif&&o===t.f["sans-serif"])||(n=Y()&&R(t,i,o)),n?s()-t.A>=t.w?Y()&&R(t,i,o)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?X(t,t.v):X(t,t.B):function(t){setTimeout(a(function(){e(this)},t),50)}(t):X(t,t.v)}(this)};var F=null;function V(e){0==--e.f&&e.j&&(e.m?((e=e.a).g&&p(e.f,[e.a.c("wf","active")],[e.a.c("wf","loading"),e.a.c("wf","inactive")]),I(e,"active")):S(e.a))}function N(e){this.j=e,this.a=new E,this.h=0,this.f=this.g=!0}function G(e,t,n,i,o){var r=0==--e.h;(e.f||e.g)&&setTimeout(function(){var e=o||null,s=i||{};if(0===n.length&&r)S(t.a);else{t.f+=n.length,r&&(t.j=r);var l,c=[];for(l=0;l<n.length;l++){var u=n[l],h=s[u.c],d=t.a,f=u;if(d.g&&p(d.f,[d.a.c("wf",f.c,T(f).toString(),"loading")]),I(d,"fontloading",f),d=null,null===F)if(window.FontFace){f=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var g=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);F=f?42<parseInt(f[1],10):!g}else F=!1;d=F?new j(a(t.g,t),a(t.h,t),t.c,u,t.s,h):new _(a(t.g,t),a(t.h,t),t.c,u,t.s,e,h),c.push(d)}for(l=0;l<c.length;l++)c[l].start()}},0)}function H(e,t){this.c=e,this.a=t}function K(e,t){this.c=e,this.a=t}function q(e,t){this.c=e||U,this.a=[],this.f=[],this.g=t||""}W.prototype.g=function(e){var t=this.a;t.g&&p(t.f,[t.a.c("wf",e.c,T(e).toString(),"active")],[t.a.c("wf",e.c,T(e).toString(),"loading"),t.a.c("wf",e.c,T(e).toString(),"inactive")]),I(t,"fontactive",e),this.m=!0,V(this)},W.prototype.h=function(e){var t=this.a;if(t.g){var n=f(t.f,t.a.c("wf",e.c,T(e).toString(),"active")),i=[],o=[t.a.c("wf",e.c,T(e).toString(),"loading")];n||i.push(t.a.c("wf",e.c,T(e).toString(),"inactive")),p(t.f,i,o)}I(t,"fontinactive",e),V(this)},N.prototype.load=function(e){this.c=new l(this.j,e.context||this.j),this.g=!1!==e.events,this.f=!1!==e.classes,function(e,t,n){var i=[],o=n.timeout;!function(e){e.g&&p(e.f,[e.a.c("wf","loading")]),I(e,"loading")}(t),i=function(e,t,n){var i,o=[];for(i in t)if(t.hasOwnProperty(i)){var r=e.c[i];r&&o.push(r(t[i],n))}return o}(e.a,n,e.c);var r=new W(e.c,t,o);for(e.h=i.length,t=0,n=i.length;t<n;t++)i[t].load(function(t,n,i){G(e,r,t,n,i)})}(this,new A(this.c,e),e)},H.prototype.load=function(e){var t=this,n=t.a.projectId,i=t.a.version;if(n){var o=t.c.o;m(this.c,(t.a.api||"https://fast.fonts.net/jsapi")+"/"+n+".js"+(i?"?v="+i:""),function(i){i?e([]):(o["__MonotypeConfiguration__"+n]=function(){return t.a},function t(){if(o["__mti_fntLst"+n]){var i=o["__mti_fntLst"+n](),r=[];if(i)for(var a=0;a<i.length;a++){var s=i[a].fontfamily;r.push(null!=i[a].fontStyle&&null!=i[a].fontWeight?new C(s,i[a].fontStyle+i[a].fontWeight):new C(s))}e(r)}else setTimeout(function(){t()},50)}())}).id="__MonotypeAPIScript__"+n}else e([])},K.prototype.load=function(e){var t,n,i=this.a.urls||[],o=this.a.families||[],r=this.a.testStrings||{},a=new y;for(t=0,n=i.length;t<n;t++)g(this.c,i[t],b(a));var s=[];for(t=0,n=o.length;t<n;t++)if((i=o[t].split(":"))[1])for(var l=i[1].split(","),c=0;c<l.length;c+=1)s.push(new C(i[0],l[c]));else s.push(new C(i[0]));v(a,function(){e(s,r)})};var U="https://fonts.googleapis.com/css";function Z(e){this.f=e,this.a=[],this.c={}}var J={latin:"BESbswy","latin-ext":"\xe7\xf6\xfc\u011f\u015f",cyrillic:"\u0439\u044f\u0416",greek:"\u03b1\u03b2\u03a3",khmer:"\u1780\u1781\u1782",Hanuman:"\u1780\u1781\u1782"},$={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},Q={i:"i",italic:"i",n:"n",normal:"n"},ee=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function te(e,t){this.c=e,this.a=t}var ne={Arimo:!0,Cousine:!0,Tinos:!0};function ie(e,t){this.c=e,this.a=t}function oe(e,t){this.c=e,this.f=t,this.a=[]}te.prototype.load=function(e){var t=new y,n=this.c,i=new q(this.a.api,this.a.text),o=this.a.families;!function(e,t){for(var n=t.length,i=0;i<n;i++){var o=t[i].split(":");3==o.length&&e.f.push(o.pop());var r="";2==o.length&&""!=o[1]&&(r=":"),e.a.push(o.join(r))}}(i,o);var r=new Z(o);!function(e){for(var t=e.f.length,n=0;n<t;n++){var i=e.f[n].split(":"),o=i[0].replace(/\+/g," "),r=["n4"];if(2<=i.length){var a;if(a=[],s=i[1])for(var s,l=(s=s.split(",")).length,c=0;c<l;c++){var u;if((u=s[c]).match(/^[\w-]+$/))if(null==(h=ee.exec(u.toLowerCase())))u="";else{if(u=null==(u=h[2])||""==u?"n":Q[u],null==(h=h[1])||""==h)h="4";else var h=$[h]||(isNaN(h)?"4":h.substr(0,1));u=[u,h].join("")}else u="";u&&a.push(u)}0<a.length&&(r=a),3==i.length&&(a=[],0<(i=(i=i[2])?i.split(","):a).length&&(i=J[i[0]])&&(e.c[o]=i))}for(e.c[o]||(i=J[o])&&(e.c[o]=i),i=0;i<r.length;i+=1)e.a.push(new C(o,r[i]))}}(r),g(n,function(e){if(0==e.a.length)throw Error("No fonts to load!");if(-1!=e.c.indexOf("kit="))return e.c;for(var t=e.a.length,n=[],i=0;i<t;i++)n.push(e.a[i].replace(/ /g,"+"));return t=e.c+"?family="+n.join("%7C"),0<e.f.length&&(t+="&subset="+e.f.join(",")),0<e.g.length&&(t+="&text="+encodeURIComponent(e.g)),t}(i),b(t)),v(t,function(){e(r.a,r.c,ne)})},ie.prototype.load=function(e){var t=this.a.id,n=this.c.o;t?m(this.c,(this.a.api||"https://use.typekit.net")+"/"+t+".js",function(t){if(t)e([]);else if(n.Typekit&&n.Typekit.config&&n.Typekit.config.fn){t=n.Typekit.config.fn;for(var i=[],o=0;o<t.length;o+=2)for(var r=t[o],a=t[o+1],s=0;s<a.length;s++)i.push(new C(r,a[s]));try{n.Typekit.load({events:!1,classes:!1,async:!0})}catch(l){}e(i)}},2e3):e([])},oe.prototype.load=function(e){var t=this.f.id,n=this.c.o,i=this;t?(n.__webfontfontdeckmodule__||(n.__webfontfontdeckmodule__={}),n.__webfontfontdeckmodule__[t]=function(t,n){for(var o=0,r=n.fonts.length;o<r;++o){var a=n.fonts[o];i.a.push(new C(a.name,O("font-weight:"+a.weight+";font-style:"+a.style)))}e(i.a)},m(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function(e){return e.o.location.hostname||e.a.location.hostname}(this.c)+"/"+t+".js",function(t){t&&e([])})):e([])};var re=new N(window);re.a.c.custom=function(e,t){return new K(t,e)},re.a.c.fontdeck=function(e,t){return new oe(t,e)},re.a.c.monotype=function(e,t){return new H(t,e)},re.a.c.typekit=function(e,t){return new ie(t,e)},re.a.c.google=function(e,t){return new te(t,e)};var ae={load:a(re.load,re)};void 0===(i=(function(){return ae}).call(t,n,t,e))||(e.exports=i)}()},ee4Z:function(e,t){var n=Phaser.Renderer.WebGL.Utils;e.exports=function(e,t,i,o,r){var a=e.strokeTint,s=n.getTintAppendFloatAlphaAndSwap(t.strokeColor,t.strokeAlpha*i);a.TL=s,a.TR=s,a.BL=s,a.BR=s;var l=t.pathData,c=l.length-1,u=t.lineWidth,h=u/2,d=l[0]-o,p=l[1]-r;t.closePath||(c-=2);for(var f=2;f<c;f+=2){var g=l[f]-o,m=l[f+1]-r;e.setTexture2D(),e.batchLine(d,p,g,m,h,h,u,f-2,!!t.closePath&&f===c-1),d=g,p=m}}},"liQ+":function(e,t){e.exports=function(e){var t;if(window.zns=e,void 0===n)var n=!0;void 0===e&&(e=!1);var i=n?console.log.bind(console):function(){};function r(e){return C("1"),document.getElementById(e)}function a(e){if(C("2"),document.getElementById(e))return document.getElementById(e).style;n&&i("zim wrap - zss(): id not found")}function s(e,t,n,i,o,r){if(C("3"),!(c(t)&&""!=t||"_self"==t)){var a="";return n&&(a+="width="+n+","),i&&(a+="height="+i+","),o&&(a+="fullscreen=yes,"),r&&(a+="modal=yes,alwaysRaised=yes"),window.open(e,t,a)}window.location.href=e}function l(e){if(C("4"),!c(e))return Number(String(e).replace(/[^\d\.\-]/g,""))}function c(e){return null==e}function u(e){C("5"),c(e)||(e.stopImmediatePropagation&&e.stopImmediatePropagation(),window.event&&(window.event.cancelBubble=!0))}function d(){function e(e){e||(e=event),e.keyCode&&32<=e.keyCode&&e.keyCode<=40&&e.preventDefault()}function t(e){e||(e=event),e.preventDefault()}C("6");var n=t;return window.addEventListener("keydown",e,{passive:!1}),window.addEventListener("wheel",t,{passive:!1}),window.addEventListener("DOMMouseScroll",n,{passive:!1}),[e,t,n]}function p(e){return C("6.1"),new function(){var t=this;this.on=function(n,i){if(!(c(e)||c(n)||c(i)))for(var o=t.tags,r=0;r<o.length;r++)o[r].addEventListener(n,i)},this.off=function(n,i){if(!(c(e)||c(n)||c(i)))for(var o=t.tags,r=0;r<o.length;r++)o[r].removeEventListener(n,i)},Object.defineProperty(t,"tags",{get:function(){return c(e)?[]:"string"==typeof e||e instanceof String?document.querySelectorAll(e):"string"==typeof e.innerHTML?[e]:[]},set:function(e){}}),this.css=function(e,n){for(var i=t.tags,o=0;o<i.length;o++)if(1==arguments.length&&e.constructor==={}.constructor)for(var r in e)i[o].style[r]=e[r];else{if(1==arguments.length)return t.tags[0].style[e];i[o].style[e]=n}},this.prop=function(e,n){if(!c(e)){for(var i=t.tags,o=[],r=0;r<i.length;r++)if(c(n))if(e.constructor==={}.constructor)for(var a in e)i[r][a]=e[a];else o.push(i[r][e]);else i[r][e]=n;return c(n)?o:void 0}}}}function f(e){return 1==e.length&&null!=e[0]&&e[0].constructor==={}.constructor}function m(e,t,o,r){var a=x&&(x.ZIMONON||window.ZIMONON);if(f(t)){C("7");var s,l,u,h=t[0],d=c(o)?e.toString().split(/\n/,1)[0].match(/\((.*)\)/)[1].replace(/\s+/g,"").split(","):o.replace(/\s+/g,"").split(","),p=[];for(s=0;s<d.length;s++)l=d[s].split("=")[0],d[s]=l,p.push(h[l]);for(s in h)d.indexOf(s)<0&&n&&i(e,"bad argument "+s);return!(u=e.prototype.isPrototypeOf(r)?new(e.bind.apply(e,[null].concat(p))):e.apply(null,p))||(a&&!u.arguments&&(u.arguments=[h]),u)}a&&r&&t&&c(r.arguments)&&(r.arguments=Array.prototype.slice.call(t))}function y(e){if(C("7.5"),C("17.6"),!c(e))return x.Pick.choose(e)}var b,v=console.table&&n?console.table.bind(console):function(){},x=function(a){function u(e,t,n,i,o){var r=e*e;return t+(3*-t+e*(3*t-t*e))*e+(3*n+e*(-6*n+3*n*e))*e+(3*i-3*i*e)*r+o*(r*e)}if(a.orange="#f58e25",a.green="#acd241",a.pink="#e472c4",a.blue="#50c4b7",a.brown="#d1a170",a.yellow="#ebcb35",a.purple="#993399",a.red="#fb4758",a.silver="#999999",a.tin="#777777",a.grey="#555555",a.gray="#555555",a.lighter="#eeeeee",a.moon="#dddddd",a.light="#cccccc",a.dark="#333333",a.darker="#111111",a.black="#000000",a.white="#ffffff",a.clear="rgba(0,0,0,0)",a.faint="rgba(0,0,0,.01)",a.shuffle=function(e){if(C("8"),!c(e)){var t,n,i=e.length;if(0==i)return e;for(;--i;)t=Math.floor(Math.random()*(i+1)),n=e[i],e[i]=e[t],e[t]=n;return e}},a.rand=function(e,t,n,i){return C("9"),c(e)&&c(t)?Math.random():((c(e)||isNaN(e))&&(e=0),(c(t)||isNaN(t))&&(t=0),e%1==0&&t%1==0||(n=!1),c(n)&&(n=!0),i&&.5<Math.random()&&(e*=-1,t*=-1),n&&(t<e?e++:e<t&&t++),0==e&&0==t?0:(o=0==t?Math.random()*e:Math.min(e,t)+Math.random()*(Math.max(e,t)-Math.min(e,t)),n?Math.floor(o):o));var o},a.series=function(){var e;if(C("13.61"),0==arguments.length)return function(){};function t(){return e[n++%e.length]}e=1==arguments.length&&Array.isArray(arguments[0])?arguments[0]:arguments;var n=0;return t.array=e,t.type="series",t},a.makeSeries=function(e){if(C("13.6"),c(e))return function(){};function t(){return e[n++%e.length]}var n=0;return t.array=e,t},a.loop=function(e,t,n,i,o,r){var s;if(s=m(a.loop,arguments,"obj, call, reverse, step, start, end"))return s;if(C("9.5"),!c(e)&&!c(t)){c(n)&&(n=!1),(c(i)||i<=0)&&(i=1);var l="number"==typeof e?"number":e.constructor===Array?"array":e.constructor==={}.constructor?"object":e instanceof NodeList?"nodelist":e instanceof HTMLCollection?"htmlcollection":"invalid";if("invalid"!=l)if("number"==l||"array"==l||"nodelist"==l||"htmlcollection"==l){if(0==(d=g((p="number"==l?e:e.length)-1)))return;if(n)for(var u=o;r<=u;u-=i){if("number"==l)var h=t(u,d,o,r,e);else h=t("array"==l?e[u]:e.item(u),u,d,o,r,e);if(void 0!==h)return h}else for(u=o;u<=r;u+=i)if(void 0!==(h="number"==l?t(u,d,o,r,e):t("array"==l?e[u]:e.item(u),u,d,o,r,e)))return h}else if("object"==l){var d,p=0,f=[];for(var u in e)p++,f.push(u);if(0==(d=g(p-1)))return;if(n){for(u=o;r<=u;u-=i)if(void 0!==(h=t(f[u],e[f[u]],u,d,o,r,e)))return h}else for(u=o;u<=r;u+=i)if(void 0!==(h=t(f[u],e[f[u]],u,d,o,r,e)))return h}}function g(e){return c(o)&&(o=n?e:0),c(r)&&(r=n?0:e),n&&o<r||!n&&r<o?0:(o<0&&r)<0||e<o&&e<r?0:(o=Math.max(0,Math.min(o,e)),r=Math.max(0,Math.min(r,e)),Math.floor((n?o-r:r-o)/i)+1)}},a.timeout=function(e,t){if(C("9.7"),!c(t)&&"function"==typeof t){c(e)&&(e=1e3),e=a.Pick.choose(e);var n={startTime:Date.now(),time:0,paused:!1,done:!1},i=n.startTime;return n.pause=function(e,t,r){c(e)&&(e=!0),e?cancelAnimationFrame(n.rid):(t?i=0:r?(i=Date.now(),n.time=0):i=Date.now(),o()),n.paused=e},n.clear=function(){for(var e in n&&cancelAnimationFrame(n.rid),n)delete n[e];n.pause=function(){},n.clear=function(){}},o(),n}function o(){var r=Date.now();if(n.time+=r-i,i=r,n.time>=e)return n.done=!0,t(n),void n.clear();n.rid=requestAnimationFrame(o)}},a.interval=function(e,t,n,i){if(C("9.8"),!c(t)&&"function"==typeof t&&(c(e)&&(e=1e3),c(i)&&(i=!1),c(n)||!(isNaN(n)||n<=0))){c(n)&&(n=-1);var o,r={count:0,total:n,paused:!1,time:e,active:!0};return i&&setTimeout(function(){t(r),l()},10),r.pause=function(e,n,i){c(e)&&(e=!0),e?(clearTimeout(o),clearTimeout(r.id),cancelAnimationFrame(r.rid),r.pauseTimeLeft=r.interval-(Date.now()-r.startTime)):(r.paused||r.pause(!0),o=setTimeout(function(){r.count++,t(r),s(),l()},n?0:i?r.interval:r.pauseTimeLeft),r.pauseTimeLeft=null),r.paused=e},r.clear=function(){r.active=!1,clearTimeout(o),cancelAnimationFrame(r.rid),clearTimeout(r.id);var e=r.count;for(var t in r)delete r[t];r.active=!1,r.count=e,r.pause=function(){},r.clear=function(){}},s(),r}function s(){r.startTime=Date.now(),r.interval=a.Pick.choose(r.time),r.id=setTimeout(function(){r.paused||r.active&&(r.rid=requestAnimationFrame(s),r.count++,t(r),l())},r.interval)}function l(){-1!=n&&r.count>=(i?r.total-1:r.total)&&r.clear()}},a.async=function(e,t){if(C("29"),!c(e)){var n,i=document.createElement("script");if(t){var o=t.toString().split(/\n/,1)[0].match(/^function\s?([^\s(]*)/)[1];a.async[o]=(n=i,function(e){n&&n.parentNode.removeChild(n),n=null,t(e)})}else a.async.z_s&&a.async.z_s.parentNode&&a.async.z_s.parentNode.removeChild(a.async.z_s),a.async.z_s=i;e.match(/\?/)||(e+="?"),i.setAttribute("src",e+"&r="+Math.random()),document.getElementsByTagName("head")[0].appendChild(i)}},a.convertColorCheck=!1,a.convertColor=function(e,t,n){if(a.convertColorCheck||(C("27.5"),a.convertColorCheck=!0),c(t)&&(t="hex"),!c(e)){var i,o,r,s=["black","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],l=["000000","f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"];if(i=e.match(/rgba\((.*)\)/)){if(!c(n))return(o=e.split(","))[3]=n+")",o.join(",");e="rgb("+i[1]+")"}if(c(n),i=e.match(/rgb\((.*)\)/))return"rgba"==t?(o=e.split(")"))[0]+","+n+o[1]:"hex"==t?"#"+(s=d(i[1]))[0]+s[1]+s[2]:"string"!=t?e:(e=d(i[1]).join("").toLowerCase(),-1==(r=l.indexOf(e))?"#"+e:s[r]);if("rgb"==t||"rgba"==t){function u(e){var i;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(e)?(3==(i=e.substring(1).split("")).length&&(i=[i[0],i[0],i[1],i[1],i[2],i[2]]),i="0x"+i.join(""),"rgb"==t?"rgb("+[i>>16&255,i>>8&255,255&i]+")":"rgba("+[i>>16&255,i>>8&255,255&i].join(",")+","+n+")"):"rgb"==t?"rgb(0,0,0)":"rgba(0,0,0,1)"}return"#"==e.charAt(0)?u(e):u(a.convertColor(e))}if("hex"==t){if("#"==e.charAt(0))return e}else"#"==e.charAt(0)&&3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2));return"string"!=t?"#"+l[-1!=s.indexOf(e.toLowerCase())?s.indexOf(e):0]:-1==(r=l.indexOf(e))?"#"+e:s[r]}function h(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t}function d(e){var t=e.split(",");return[h(t[0]),h(t[1]),h(t[2])]}},a.colorRangeCheck=!1,a.colorRange=function(e,t,n){n=Math.max(0,Math.min(1,n)),a.colorRangeCheck||(C("27.6"),a.colorRangeCheck=!0),c(e)&&(e="white"),c(t)&&(t="black");for(var i,o,r=a.convertColor(e,"rgb"),s=a.convertColor(t,"rgb"),l=(e=r.substring(4,r.length-1).split(","),t=s.substring(4,s.length-1).split(","),"#"),u=0;u<e.length;u++)i=t[u]-e[u],(o=Math.floor(parseInt(e[u],10)+i*n).toString(16)).length<2&&(o="0"+o),l+=o;return l},a.pointAlongCurve=function(e,t,n){if(C("27.7"),e&&e[0]&&e[1]&&e[2]&&e[3]){var i=u(t,e[0].x,e[1].x,e[2].x,e[3].x),o=u(t,e[0].y,e[1].y,e[2].y,e[3].y);if(n){var r=t+.05;if(1<r){r-=.05;var s=u(t-=.05,e[0].x,e[1].x,e[2].x,e[3].x),l=u(t,e[0].y,e[1].y,e[2].y,e[3].y)}else s=i,l=o;var c=u(r,e[0].x,e[1].x,e[2].x,e[3].x),h=u(r,e[0].y,e[1].y,e[2].y,e[3].y);return{x:i,y:o,angle:a.angle(s,l,c,h)}}return{x:i,y:o}}},a.distanceAlongCurve=function(e){return C("27.8"),(a.dist(e[0],e[3])+(a.dist(e[0],e[1])+a.dist(e[1],e[2])+a.dist(e[2],e[3])))/2},a.closestPointAlongCurve=function(e,t,n,i,o){C("27.9");var r,s=1e7,l=0,u=0;return c(n)&&(n=10),a.loop(t,function(t,i,o){a.loop(n,function(n,o){var c=a.pointAlongCurve(t,n/o),h=a.dist(e,c);h<s&&(s=h,r=c,l=i,u=n)})}),o?(l*n+u)/(t.length*n)*100:i?r:l},a.transformPoints=function(e,t,n,i,o){if(C("27.95"),!c(e)&&Array.isArray(e)){c(i)&&(i=0),c(o)&&(o=0),e=a.copy(e);var r,s=i,l=o;"rotation"==t&&(0!=i&&(e=a.transformPoints(e,"x",-s)),0!=o&&(e=a.transformPoints(e,"y",-l)));for(var u=0;u<e.length;u++)if(r=e[u],Array.isArray(r))if("x"==t)r[0]+=n;else if("y"==t)r[1]+=n;else if("scaleX"==t)r[0]=(r[0]-i)*n+i,r[4]=r[4]*n,r[6]=r[6]*n;else if("scaleY"==t)r[1]=(r[1]-o)*n+o,r[5]=r[5]*n,r[7]=r[7]*n;else if("scale"==t)r[0]=(r[0]-i)*n+i,r[4]=r[4]*n,r[6]=r[6]*n,r[1]=(r[1]-o)*n+o,r[5]=r[5]*n,r[7]=r[7]*n;else if("rotation"==t){var h=n*Math.PI/180,d=r[0],p=r[1];r[0]=d*Math.cos(h)-p*Math.sin(h),r[1]=p*Math.cos(h)+d*Math.sin(h),p=r[5],r[4]=(d=r[4])*Math.cos(h)-p*Math.sin(h),r[5]=p*Math.cos(h)+d*Math.sin(h),p=r[7],r[6]=(d=r[6])*Math.cos(h)-p*Math.sin(h),r[7]=p*Math.cos(h)+d*Math.sin(h)}return"rotation"==t&&(0!=i&&(e=a.transformPoints(e,"x",s)),0!=o&&(e=a.transformPoints(e,"y",l))),e}},a.makeID=function(e,t,n){var i;C("13.5"),c(e)&&(e="mixed"),c(t)&&(t=5),c(n)&&(n="uppercase");var o=[2,3,4,5,6,7,8,9],r="abcdefghjkmnpqrstuvwxyz".split("");i=e.constructor===Array?e:"numbers"==e?o:"letters"==e?r:o.concat(r);for(var a,s,l="",u=0;u<t;u++)a=i[Math.floor(Math.random()*i.length)],s=Math.random(),"uppercase"==n||"mixed"==n&&.5<s?a.toUpperCase&&(a=a.toUpperCase()):a.toLowerCase&&(a=a.toLowerCase()),l+=String(a);return l},a.swapProperties=function(e,t,n){if(C("17.1"),c(t)||c(n)||c(t[e])||c(n[e]))return!1;var i=n[e];return n[e]=t[e],t[e]=i,!0},a.mobile=function(e){return C("28"),c(e)&&(e=!0),/ip(hone|od|ad)/i.test(navigator.userAgent)?"ios":/android|nexus/i.test(navigator.userAgent)?"android":/blackberry/i.test(navigator.userAgent)?"blackberry":/nokia|phone|mobile/i.test(navigator.userAgent)?"windows":/opera mini|webos/i.test(navigator.userAgent)?"other":!(!e||void 0===window.orientation)},a.vee=function(e){return C("28.5"),!c(e)&&("Pick"==e.type||Array.isArray(e)||e.constructor=={}.constructor&&(!c(e.max)||!c(e.noPick))||"function"==typeof e)},a.extend=function(e,t,o,r,s){var l;if(l=m(a.extend,arguments,"subclass, superclass, override, prefix, prototype"))return l;if(!c(e)&&!c(t)){c(r)&&(r="super"),c(o)&&(o=[]),Array.isArray(o)||(o=[o]),c(s)&&(s=!0);var u={};for(var h in e.prototype)Object.defineProperty(u,h,Object.getOwnPropertyDescriptor(e.prototype,h));for(h in y.prototype=t.prototype,e.prototype=new y,u)Object.defineProperty(e.prototype,h,Object.getOwnPropertyDescriptor(u,h));var d=e.prototype,p=Object.getPrototypeOf&&Object.getPrototypeOf(d)||d.__proto__;if(p){var f;d[(r+="_")+"constructor"]=p.constructor;for(var g=0;g<o.length;g++)"function"==typeof p[f=o[g]]&&(d[r+f]=p[f]);if(s)for(f in p)d.hasOwnProperty(f)&&"function"==typeof p[f]&&(d[r+f]=p[f])}return e}function y(){this.constructor=e}n&&e!=a.StageGL&&i("zim.extend() - please supply a class and its superclass")},a.copyCheck=!1,a.copy=function(e,t,n){if(a.copyCheck||(C("10"),a.copyCheck=!0),c(t)&&(t=!1),c(n)&&(n=!0),null==e||!(e instanceof Array||e.constructor=={}.constructor))return t&&null!=e&&e.clone&&e.type&&("Container"!=e.type&&"Stage"!=e.type&&"StageGL"!=e.type||n)?e.clone():e;if(e instanceof Array){for(var i=[],o=0;o<e.length;o++)i[o]=a.copy(e[o],t,n);return i}if(e.constructor=={}.constructor){var r={};for(var s in e){var l=a.copy(e[s],t,n);e.hasOwnProperty(s)&&(r[s]=l)}return r}},a.mergeCheck=!1,a.merge=function(){a.mergeCheck||(C("12"),a.mergeCheck=!0);var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&(n[t]=arguments[e][t]);return n},a.arraysEqual=function(e,t,n){if(C("11"),c(e)||c(t))return!1;if(c(n)&&(n=!0),e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]instanceof Array&&t[i]instanceof Array){if(!a.arraysEqual(e[i],t[i],n))return!1}else{if(n&&e[i]!=t[i])return!1;if(!n)return a.arraysEqual(e.sort(),t.sort(),!0)}return!0},a.isEmpty=function(e){if(C("11.5"),!c(e)){var t=0;for(var n in e){t++;break}return 0==t}},a.isJSON=function(e){C("11.6");try{return JSON.parse(e).constructor=={}.constructor}catch(e){return!1}},a.zut=function(e){if(c(e)||"object"==typeof e)return!0},a.zimDecimalCheck=!1,a.decimals=function(e,t,n,i,o,r,s){if(a.zimDecimalCheck||C("13"),a.zimDecimalCheck=!0,c(e))return 0;c(t)&&(t=1),c(n)&&(n=0),c(i)&&(i=0),c(i)&&(i=0),c(o)&&(o=!0),c(r)&&(r=!1);var l=Math.round(e*Math.pow(10,t))/Math.pow(10,t);if(r){var u=l-Math.floor(l);l=a.decimals(Math.floor(l)+60*u/100,2)}var h=a.sign(l);if(0<n){var d=String(l).indexOf("."),p=String(l).length;d<0&&(d=p++,l+=".");for(var f=0;f<n-(p-d-1);f++)l+="0"}if(0<i){-1==h&&(l=l.substr(1,l.length-1)),d=String(l).indexOf("."),p=String(l).length;var g=d<0?p:d;for(f=0;f<i-g;f++)l="0"+l;-1==h&&(l="-"+l)}return 0<n+i&&!o&&0==Number(l)&&(l=0),r&&(l=String(l).replace(".",":")),a.zut(s)?l:null},a.zimSignCheck=!1,a.sign=function(e){return a.zimSignCheck||C("13.1"),a.zimSignCheck=!0,e?e<0?-1:1:0},a.constrain=function(e,t,n,i){if(C("13.2"),!c(e))return c(t)&&(t=0),c(n)&&(n=Number.MAX_VALUE),n<t&&(n=max2=t,t=max2),c(i)&&(i=!1),i&&e<0?Math.max(-n,Math.min(e,-t)):Math.max(t,Math.min(e,n))},a.zimDistCheck=!1,a.dist=function(e,t,n,i){if(a.zimDistCheck||C("13.3"),a.zimDistCheck=!0,!c(e)&&!c(t))return c(e.x)||c(t.x)?(c(n)&&(n=0),c(i)&&(i=0)):(i=t.y,n=t.x,t=e.y,e=e.x),Math.sqrt(Math.pow(n-e,2)+Math.pow(i-t,2))},a.zimRectIntersectCheck=!1,a.rectIntersect=function(e,t,n){return a.zimRectIntersectCheck||C("13.32"),a.zimRectIntersectCheck=!0,c(n)&&(n=0),!(e.x>=t.x+t.width+n||e.x+e.width+n<=t.x||e.y>=t.y+t.height+n||e.y+e.height+n<=t.y)},a.zimBoundsAroundPointsCheck=!1,a.boundsAroundPoints=function(e){a.zimBoundsAroundPointsCheck||C("13.34"),a.zimBoundsAroundPointsCheck=!0;for(var t=1e4,n=1e4,i=-1e4,o=-1e4,r=0;r<e.length;r++){var s=e[r];s.x<t&&(t=s.x),s.x>i&&(i=s.x),s.y<n&&(n=s.y),s.y>o&&(o=s.y)}return{x:t,y:n,width:i-t,height:o-n}},a.angle=function(e,t,n,i){if(C("13.4"),!c(e)&&!c(t))return c(n)&&(n=e,e=0),c(i)&&(i=t,t=0),(180*Math.atan2(i-t,n-e)/Math.PI+360)%360},a.smoothStep=function(e,t,n){C("13.7");var i=a.constrain((e-t)/(n-t),0,1);return i*i*i*(i*(6*i-15)+10)},a.Noise=function(e){"use strict";C("13.9"),c(e)&&(e=1e6*Math.random());var t=e;this.seed=e;var n=this,i={};function o(e){var t=new Uint32Array(1);return t[0]=1664525*e[0]+1013904223,t}function r(e,t,n){this.dx=-t-e*i.SQUISH_2D,this.dy=-n-e*i.SQUISH_2D,this.xsb=t,this.ysb=n}function a(e,t,n,o){this.dx=-t-e*i.SQUISH_3D,this.dy=-n-e*i.SQUISH_3D,this.dz=-o-e*i.SQUISH_3D,this.xsb=t,this.ysb=n,this.zsb=o}function s(e,t,n,o,r){this.dx=-t-e*i.SQUISH_4D,this.dy=-n-e*i.SQUISH_4D,this.dz=-o-e*i.SQUISH_4D,this.dw=-r-e*i.SQUISH_4D,this.xsb=t,this.ysb=n,this.zsb=o,this.wsb=r}i.NORM_2D=1/47,i.NORM_3D=1/103,i.NORM_4D=1/30,i.SQUISH_2D=(Math.sqrt(3)-1)/2,i.SQUISH_3D=(Math.sqrt(4)-1)/3,i.SQUISH_4D=(Math.sqrt(5)-1)/4,i.STRETCH_2D=(1/Math.sqrt(3)-1)/2,i.STRETCH_3D=(1/Math.sqrt(4)-1)/3,i.STRETCH_4D=(1/Math.sqrt(5)-1)/4,i.base2D=[[1,1,0,1,0,1,0,0,0],[1,1,0,1,0,1,2,1,1]],i.base3D=[[0,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1],[2,1,1,0,2,1,0,1,2,0,1,1,3,1,1,1],[1,1,0,0,1,0,1,0,1,0,0,1,2,1,1,0,2,1,0,1,2,0,1,1]],i.base4D=[[0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,4,1,1,1,1],[1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1]],i.gradients2D=[5,2,2,5,-5,2,-2,5,5,-2,2,-5,-5,-2,-2,-5],i.gradients3D=[-11,4,4,-4,11,4,-4,4,11,11,4,4,4,11,4,4,4,11,-11,-4,4,-4,-11,4,-4,-4,11,11,-4,4,4,-11,4,4,-4,11,-11,4,-4,-4,11,-4,-4,4,-11,11,4,-4,4,11,-4,4,4,-11,-11,-4,-4,-4,-11,-4,-4,-4,-11,11,-4,-4,4,-11,-4,4,-4,-11],i.gradients4D=[3,1,1,1,1,3,1,1,1,1,3,1,1,1,1,3,-3,1,1,1,-1,3,1,1,-1,1,3,1,-1,1,1,3,3,-1,1,1,1,-3,1,1,1,-1,3,1,1,-1,1,3,-3,-1,1,1,-1,-3,1,1,-1,-1,3,1,-1,-1,1,3,3,1,-1,1,1,3,-1,1,1,1,-3,1,1,1,-1,3,-3,1,-1,1,-1,3,-1,1,-1,1,-3,1,-1,1,-1,3,3,-1,-1,1,1,-3,-1,1,1,-1,-3,1,1,-1,-1,3,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,3,1,1,-1,1,3,1,-1,1,1,3,-1,1,1,1,-3,-3,1,1,-1,-1,3,1,-1,-1,1,3,-1,-1,1,1,-3,3,-1,1,-1,1,-3,1,-1,1,-1,3,-1,1,-1,1,-3,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,3,1,-1,-1,1,3,-1,-1,1,1,-3,-1,1,1,-1,-3,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3],i.lookupPairs2D=[0,1,1,0,4,1,17,0,20,2,21,2,22,5,23,5,26,4,39,3,42,4,43,3],i.lookupPairs3D=[0,2,1,1,2,2,5,1,6,0,7,0,32,2,34,2,129,1,133,1,160,5,161,5,518,0,519,0,546,4,550,4,645,3,647,3,672,5,673,5,674,4,677,3,678,4,679,3,680,13,681,13,682,12,685,14,686,12,687,14,712,20,714,18,809,21,813,23,840,20,841,21,1198,19,1199,22,1226,18,1230,19,1325,23,1327,22,1352,15,1353,17,1354,15,1357,17,1358,16,1359,16,1360,11,1361,10,1362,11,1365,10,1366,9,1367,9,1392,11,1394,11,1489,10,1493,10,1520,8,1521,8,1878,9,1879,9,1906,7,1910,7,2005,6,2007,6,2032,8,2033,8,2034,7,2037,6,2038,7,2039,6],i.lookupPairs4D=[0,3,1,2,2,3,5,2,6,1,7,1,8,3,9,2,10,3,13,2,16,3,18,3,22,1,23,1,24,3,26,3,33,2,37,2,38,1,39,1,41,2,45,2,54,1,55,1,56,0,57,0,58,0,59,0,60,0,61,0,62,0,63,0,256,3,258,3,264,3,266,3,272,3,274,3,280,3,282,3,2049,2,2053,2,2057,2,2061,2,2081,2,2085,2,2089,2,2093,2,2304,9,2305,9,2312,9,2313,9,16390,1,16391,1,16406,1,16407,1,16422,1,16423,1,16438,1,16439,1,16642,8,16646,8,16658,8,16662,8,18437,6,18439,6,18469,6,18471,6,18688,9,18689,9,18690,8,18693,6,18694,8,18695,6,18696,9,18697,9,18706,8,18710,8,18725,6,18727,6,131128,0,131129,0,131130,0,131131,0,131132,0,131133,0,131134,0,131135,0,131352,7,131354,7,131384,7,131386,7,133161,5,133165,5,133177,5,133181,5,133376,9,133377,9,133384,9,133385,9,133400,7,133402,7,133417,5,133421,5,133432,7,133433,5,133434,7,133437,5,147510,4,147511,4,147518,4,147519,4,147714,8,147718,8,147730,8,147734,8,147736,7,147738,7,147766,4,147767,4,147768,7,147770,7,147774,4,147775,4,149509,6,149511,6,149541,6,149543,6,149545,5,149549,5,149558,4,149559,4,149561,5,149565,5,149566,4,149567,4,149760,9,149761,9,149762,8,149765,6,149766,8,149767,6,149768,9,149769,9,149778,8,149782,8,149784,7,149786,7,149797,6,149799,6,149801,5,149805,5,149814,4,149815,4,149816,7,149817,5,149818,7,149821,5,149822,4,149823,4,149824,37,149825,37,149826,36,149829,34,149830,36,149831,34,149832,37,149833,37,149842,36,149846,36,149848,35,149850,35,149861,34,149863,34,149865,33,149869,33,149878,32,149879,32,149880,35,149881,33,149882,35,149885,33,149886,32,149887,32,150080,49,150082,48,150088,49,150098,48,150104,47,150106,47,151873,46,151877,45,151881,46,151909,45,151913,44,151917,44,152128,49,152129,46,152136,49,152137,46,166214,43,166215,42,166230,43,166247,42,166262,41,166263,41,166466,48,166470,43,166482,48,166486,43,168261,45,168263,42,168293,45,168295,42,168512,31,168513,28,168514,31,168517,28,168518,25,168519,25,280952,40,280953,39,280954,40,280957,39,280958,38,280959,38,281176,47,281178,47,281208,40,281210,40,282985,44,282989,44,283001,39,283005,39,283208,30,283209,27,283224,30,283241,27,283256,22,283257,22,297334,41,297335,41,297342,38,297343,38,297554,29,297558,24,297562,29,297590,24,297594,21,297598,21,299365,26,299367,23,299373,26,299383,23,299389,20,299391,20,299584,31,299585,28,299586,31,299589,28,299590,25,299591,25,299592,30,299593,27,299602,29,299606,24,299608,30,299610,29,299621,26,299623,23,299625,27,299629,26,299638,24,299639,23,299640,22,299641,22,299642,21,299645,20,299646,21,299647,20,299648,61,299649,60,299650,61,299653,60,299654,59,299655,59,299656,58,299657,57,299666,55,299670,54,299672,58,299674,55,299685,52,299687,51,299689,57,299693,52,299702,54,299703,51,299704,56,299705,56,299706,53,299709,50,299710,53,299711,50,299904,61,299906,61,299912,58,299922,55,299928,58,299930,55,301697,60,301701,60,301705,57,301733,52,301737,57,301741,52,301952,79,301953,79,301960,76,301961,76,316038,59,316039,59,316054,54,316071,51,316086,54,316087,51,316290,78,316294,78,316306,73,316310,73,318085,77,318087,77,318117,70,318119,70,318336,79,318337,79,318338,78,318341,77,318342,78,318343,77,430776,56,430777,56,430778,53,430781,50,430782,53,430783,50,431e3,75,431002,72,431032,75,431034,72,432809,74,432813,69,432825,74,432829,69,433032,76,433033,76,433048,75,433065,74,433080,75,433081,74,447158,71,447159,68,447166,71,447167,68,447378,73,447382,73,447386,72,447414,71,447418,72,447422,71,449189,70,449191,70,449197,69,449207,68,449213,69,449215,68,449408,67,449409,67,449410,66,449413,64,449414,66,449415,64,449416,67,449417,67,449426,66,449430,66,449432,65,449434,65,449445,64,449447,64,449449,63,449453,63,449462,62,449463,62,449464,65,449465,63,449466,65,449469,63,449470,62,449471,62,449472,19,449473,19,449474,18,449477,16,449478,18,449479,16,449480,19,449481,19,449490,18,449494,18,449496,17,449498,17,449509,16,449511,16,449513,15,449517,15,449526,14,449527,14,449528,17,449529,15,449530,17,449533,15,449534,14,449535,14,449728,19,449729,19,449730,18,449734,18,449736,19,449737,19,449746,18,449750,18,449752,17,449754,17,449784,17,449786,17,451520,19,451521,19,451525,16,451527,16,451528,19,451529,19,451557,16,451559,16,451561,15,451565,15,451577,15,451581,15,451776,19,451777,19,451784,19,451785,19,465858,18,465861,16,465862,18,465863,16,465874,18,465878,18,465893,16,465895,16,465910,14,465911,14,465918,14,465919,14,466114,18,466118,18,466130,18,466134,18,467909,16,467911,16,467941,16,467943,16,468160,13,468161,13,468162,13,468163,13,468164,13,468165,13,468166,13,468167,13,580568,17,580570,17,580585,15,580589,15,580598,14,580599,14,580600,17,580601,15,580602,17,580605,15,580606,14,580607,14,580824,17,580826,17,580856,17,580858,17,582633,15,582637,15,582649,15,582653,15,582856,12,582857,12,582872,12,582873,12,582888,12,582889,12,582904,12,582905,12,596982,14,596983,14,596990,14,596991,14,597202,11,597206,11,597210,11,597214,11,597234,11,597238,11,597242,11,597246,11,599013,10,599015,10,599021,10,599023,10,599029,10,599031,10,599037,10,599039,10,599232,13,599233,13,599234,13,599235,13,599236,13,599237,13,599238,13,599239,13,599240,12,599241,12,599250,11,599254,11,599256,12,599257,12,599258,11,599262,11,599269,10,599271,10,599272,12,599273,12,599277,10,599279,10,599282,11,599285,10,599286,11,599287,10,599288,12,599289,12,599290,11,599293,10,599294,11,599295,10],i.p2D=[0,0,1,-1,0,0,-1,1,0,2,1,1,1,2,2,0,1,2,0,2,1,0,0,0],i.p3D=[0,0,1,-1,0,0,1,0,-1,0,0,-1,1,0,0,0,1,-1,0,0,-1,0,1,0,0,-1,1,0,2,1,1,0,1,1,1,-1,0,2,1,0,1,1,1,-1,1,0,2,0,1,1,1,-1,1,1,1,3,2,1,0,3,1,2,0,1,3,2,0,1,3,1,0,2,1,3,0,2,1,3,0,1,2,1,1,1,0,0,2,2,0,0,1,1,0,1,0,2,0,2,0,1,1,0,0,1,2,0,0,2,2,0,0,0,0,1,1,-1,1,2,0,0,0,0,1,-1,1,1,2,0,0,0,0,1,1,1,-1,2,3,1,1,1,2,0,0,2,2,3,1,1,1,2,2,0,0,2,3,1,1,1,2,0,2,0,2,1,1,-1,1,2,0,0,2,2,1,1,-1,1,2,2,0,0,2,1,-1,1,1,2,0,0,2,2,1,-1,1,1,2,0,2,0,2,1,1,1,-1,2,2,0,0,2,1,1,1,-1,2,0,2,0],i.p4D=[0,0,1,-1,0,0,0,1,0,-1,0,0,1,0,0,-1,0,0,-1,1,0,0,0,0,1,-1,0,0,0,1,0,-1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,-1,0,0,-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,2,1,1,0,0,1,1,1,-1,0,1,1,1,0,-1,0,2,1,0,1,0,1,1,-1,1,0,1,1,0,1,-1,0,2,0,1,1,0,1,-1,1,1,0,1,0,1,1,-1,0,2,1,0,0,1,1,1,-1,0,1,1,1,0,-1,1,0,2,0,1,0,1,1,-1,1,0,1,1,0,1,-1,1,0,2,0,0,1,1,1,-1,0,1,1,1,0,-1,1,1,1,4,2,1,1,0,4,1,2,1,0,4,1,1,2,0,1,4,2,1,0,1,4,1,2,0,1,4,1,1,0,2,1,4,2,0,1,1,4,1,0,2,1,4,1,0,1,2,1,4,0,2,1,1,4,0,1,2,1,4,0,1,1,2,1,2,1,1,0,0,3,2,1,0,0,3,1,2,0,0,1,2,1,0,1,0,3,2,0,1,0,3,1,0,2,0,1,2,0,1,1,0,3,0,2,1,0,3,0,1,2,0,1,2,1,0,0,1,3,2,0,0,1,3,1,0,0,2,1,2,0,1,0,1,3,0,2,0,1,3,0,1,0,2,1,2,0,0,1,1,3,0,0,2,1,3,0,0,1,2,2,3,1,1,1,0,2,1,1,1,-1,2,2,0,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,2,0,0,0,2,3,1,0,1,1,2,1,-1,1,1,2,2,0,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,2,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,2,0,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,2,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,0,2,0,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,2,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,2,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,0,0,2,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,0,2,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,0,2,2,1,1,1,-1,0,1,1,1,0,-1,0,0,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,0,0,0,0,0,2,1,-1,1,1,0,1,0,1,1,-1,0,0,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,0,0,0,0,0,2,1,-1,1,0,1,1,0,1,-1,1,0,0,0,0,0,2,1,-1,0,1,1,1,0,-1,1,1,0,0,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,2,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,2,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,2,2,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,0,2,0,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,2,0,0,2,1,-1,1,0,1,1,0,1,-1,1,2,0,2,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,0,0,2,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,0,2,0,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,2,0,2,1,1,-1,0,1,1,1,0,-1,1,2,0,0,0,2,2,1,-1,1,0,1,1,0,1,-1,1,2,0,0,0,2,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,0,2,3,1,1,0,0,0,2,2,0,0,0,2,1,1,1,-1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,1,-1,3,1,0,0,1,0,2,0,0,2,0,2,1,1,1,-1,3,1,1,0,0,0,2,2,0,0,0,2,1,1,-1,1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,-1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,1,-1,1,3,1,1,0,0,0,2,2,0,0,0,2,1,-1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,1,-1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,-1,1,1,3,1,0,1,0,0,2,0,2,0,0,2,-1,1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,-1,1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,-1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,4,1,1,1,1,3,3,2,0,1,0,3,1,0,2,0,4,1,1,1,1,3,3,0,2,1,0,3,0,1,2,0,4,1,1,1,1,3,3,2,0,0,1,3,1,0,0,2,4,1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,4,1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,4,1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,1,-1,3,3,2,0,1,0,3,1,0,2,0,2,1,1,1,-1,3,3,0,2,1,0,3,0,1,2,0,2,1,1,1,-1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,-1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,1,-1,1,3,3,0,2,0,1,3,0,1,0,2,2,1,1,-1,1,3,3,2,0,1,0,3,1,0,2,0,2,1,-1,1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,-1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,1,-1,1,1,3,3,0,2,1,0,3,0,1,2,0,2,-1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,2,-1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,-1,1,1,1];for(var l=[],u=0;u<i.p2D.length;u+=4){for(var h=i.base2D[i.p2D[u]],d=null,p=null,f=0;f<h.length;f+=3)p=new r(h[f],h[f+1],h[f+2]),null===d?l[u/4]=p:d.next=p,d=p;p.next=new r(i.p2D[u+1],i.p2D[u+2],i.p2D[u+3])}for(this.lookup2D=[],u=0;u<i.lookupPairs2D.length;u+=2)this.lookup2D[i.lookupPairs2D[u]]=l[i.lookupPairs2D[u+1]];var g=[];for(u=0;u<i.p3D.length;u+=9){for(h=i.base3D[i.p3D[u]],d=null,p=null,f=0;f<h.length;f+=4)p=new a(h[f],h[f+1],h[f+2],h[f+3]),null===d?g[u/9]=p:d.next=p,d=p;p.next=new a(i.p3D[u+1],i.p3D[u+2],i.p3D[u+3],i.p3D[u+4]),p.next.next=new a(i.p3D[u+5],i.p3D[u+6],i.p3D[u+7],i.p3D[u+8])}for(this.lookup3D=[],u=0;u<i.lookupPairs3D.length;u+=2)this.lookup3D[i.lookupPairs3D[u]]=g[i.lookupPairs3D[u+1]];var m=[];for(u=0;u<i.p4D.length;u+=16){for(h=i.base4D[i.p4D[u]],d=null,p=null,f=0;f<h.length;f+=5)p=new s(h[f],h[f+1],h[f+2],h[f+3],h[f+4]),null===d?m[u/16]=p:d.next=p,d=p;p.next=new s(i.p4D[u+1],i.p4D[u+2],i.p4D[u+3],i.p4D[u+4],i.p4D[u+5]),p.next.next=new s(i.p4D[u+6],i.p4D[u+7],i.p4D[u+8],i.p4D[u+9],i.p4D[u+10]),p.next.next.next=new s(i.p4D[u+11],i.p4D[u+12],i.p4D[u+13],i.p4D[u+14],i.p4D[u+15])}for(this.lookup4D=[],u=0;u<i.lookupPairs4D.length;u+=2)this.lookup4D[i.lookupPairs4D[u]]=m[i.lookupPairs4D[u+1]];this.perm=new Uint8Array(256),this.perm2D=new Uint8Array(256),this.perm3D=new Uint8Array(256),this.perm4D=new Uint8Array(256);var y=new Uint8Array(256);for(u=0;u<256;u++)y[u]=u;for((e=new Uint32Array(1))[0]=t,e=o(o(o(e))),u=255;0<=u;u--){e=o(e);var b=new Uint32Array(1);b[0]=(e[0]+31)%(u+1),b[0]<0&&(b[0]+=u+1),this.perm[u]=y[b[0]],this.perm2D[u]=14&this.perm[u],this.perm3D[u]=this.perm[u]%24*3,this.perm4D[u]=252&this.perm[u],y[b[0]]=y[u]}this.simplex1D=function(e){return n.simplex2D(e,1)},this.simplex2D=function(e,t){var o=(e+t)*i.STRETCH_2D,r=[e+o,t+o],a=r[0],s=r[1],l=[Math.floor(a),Math.floor(s)],c=l[0],u=l[1],h=(c+u)*i.SQUISH_2D,d=[e-(c+h),t-(u+h)],p=d[0],f=d[1],g=[a-c,s-u],m=g[0],y=g[1],b=m+y,v=new Uint32Array(4);v[0]=m-y+1,v[1]=b,v[2]=b+y,v[3]=b+m;for(var w=n.lookup2D[v[0]|v[1]<<1|v[2]<<2|v[3]<<4],x=0;void 0!==w;){var C=[p+w.dx,f+w.dy],k=C[0],T=C[1],P=2-k*k-T*T;if(0<P){var O=[c+w.xsb,u+w.ysb],A=n.perm2D[n.perm[255&O[0]]+O[1]&255];x+=(P*=P)*P*(i.gradients2D[A]*k+i.gradients2D[A+1]*T)}w=w.next}return x*i.NORM_2D},this.simplex3D=function(e,t,o){var r=(e+t+o)*i.STRETCH_3D,a=[e+r,t+r,o+r],s=a[0],l=a[1],c=a[2],u=[Math.floor(s),Math.floor(l),Math.floor(c)],h=u[0],d=u[1],p=u[2],f=(h+d+p)*i.SQUISH_3D,g=[e-(h+f),t-(d+f),o-(p+f)],m=g[0],y=g[1],b=g[2],v=[s-h,l-d,c-p],w=v[0],x=v[1],C=v[2],k=w+x+C,T=new Uint32Array(7);T[0]=x-C+1,T[1]=w-x+1,T[2]=w-C+1,T[3]=k,T[4]=k+C,T[5]=k+x,T[6]=k+w;for(var P=n.lookup3D[T[0]|T[1]<<1|T[2]<<2|T[3]<<3|T[4]<<5|T[5]<<7|T[6]<<9],O=0;void 0!==P;){var A=[m+P.dx,y+P.dy,b+P.dz],S=A[0],I=A[1],E=A[2],M=2-S*S-I*I-E*E;if(0<M){var B=[h+P.xsb,d+P.ysb,p+P.zsb],z=n.perm3D[n.perm[n.perm[255&B[0]]+B[1]&255]+B[2]&255];O+=(M*=M)*M*(i.gradients3D[z]*S+i.gradients3D[z+1]*I+i.gradients3D[z+2]*E)}P=P.next}return O*i.NORM_3D},this.simplex4D=function(e,t,o,r){var a=(e+t+o+r)*i.STRETCH_4D,s=[e+a,t+a,o+a,r+a],l=s[0],c=s[1],u=s[2],h=s[3],d=[Math.floor(l),Math.floor(c),Math.floor(u),Math.floor(h)],p=d[0],f=d[1],g=d[2],m=d[3],y=(p+f+g+m)*i.SQUISH_4D,b=e-(p+y),v=t-(f+y),w=o-(g+y),x=r-(m+y),C=[l-p,c-f,u-g,h-m],k=C[0],T=C[1],P=C[2],O=C[3],A=k+T+P+O,S=new Uint32Array(11);S[0]=P-O+1,S[1]=T-P+1,S[2]=T-O+1,S[3]=k-T+1,S[4]=k-P+1,S[5]=k-O+1,S[6]=A<<6,S[7]=A+O,S[8]=A+P,S[9]=A+T,S[10]=A+k;for(var I=n.lookup4D[S[0]|S[1]<<1|S[2]<<2|S[3]<<3|S[4]<<4|S[5]<<5|S[6]<<6|S[7]<<8|S[8]<<11|S[9]<<14|S[10]<<17],E=0;void 0!==I;){var M=[b+I.dx,v+I.dy,w+I.dz,x+I.dw],B=M[0],z=M[1],j=M[2],_=M[3],D=2-B*B-z*z-j*j-_*_;if(0<D){var L=[p+I.xsb,f+I.ysb,g+I.zsb,m+I.wsb],Y=n.perm4D[n.perm[n.perm[n.perm[255&L[0]]+L[1]&255]+L[2]&255]+L[3]&255];E+=(D*=D)*D*(i.gradients4D[Y]*B+i.gradients4D[Y+1]*z+i.gradients4D[Y+2]*j+i.gradients4D[Y+3]*_)}I=I.next}return E*i.NORM_4D}},a.Point=function(e,t,n,i,o,r,a,s,l,u){C("13.45"),c(e)&&(e=0),c(t)&&(t=0),c(n)&&(n=0),c(i)&&(i=0),c(o)&&(o=0),c(r)&&(r=0),c(a)&&(a=0),c(s)&&(s=0),c(l)&&(l=0),c(u)&&(u=0),this.x=e,this.y=t,this.z=n,this.q=i,this.r=o,this.s=r,this.t=a,this.u=s,this.v=l,this.w=u},a.Boundary=function(e,t,n,i){C("13.46"),c(e)||c(t)||c(n)||c(i)||(this.x=e,this.y=t,this.width=n,this.height=i,this.contract=function(e,t,n,i){return c(e)||(c(t)&&(t=e),c(n)?n=2*e:n+=e,c(i)?i=2*t:i+=t,this.x+=e,this.y+=t,this.width-=n,this.height-=i),this})},a.Damp=function(e,t){var n;if(C("14"),n=m(a.Damp,arguments,"startValue, damp",this))return n;this.lastValue=c(e)?0:e,this.damp=c(t)?.1:t},a.Damp.prototype.convert=function(e){return this.lastValue=this.lastValue+(e-this.lastValue)*this.damp},a.Damp.prototype.immediate=function(e){return this.lastValue=e,this},a.Proportion=function(e,t,n,i,o,r,s){var l,u,h;if(l=m(a.Proportion,arguments,"baseMin, baseMax, targetMin, targetMax, factor, targetRound, clamp",this))return l;C("15"),c(n)&&(n=0),c(i)&&(i=1),c(o)&&(o=1),c(r)&&(r=!1),c(s)&&(s=!0),this.convert=function(a){if(!isNaN(a)&&t-e!=0)return s&&(a=Math.max(a,e),a=Math.min(a,t)),u=(a-e)/(t-e),h=0<o?n+(i-n)*u:i-(i-n)*u,r&&(h=Math.round(h)),h}},a.ProportionDamp=function(e,t,n,i,o,r,s,l){var u;if(u=m(a.ProportionDamp,arguments,"baseMin, baseMax, targetMin, targetMax, damp, factor, targetRound, clamp",this))return u;C("16"),c(n)&&(n=0),c(i)&&(i=1),c(o)&&(o=.1),c(r)&&(r=1),c(s)&&(s=!1),c(l)&&(l=!0),this.damp=o;var h,d,p,f,g=this,y=0;h=e,y=n;var b=setInterval(v,20);function v(){isNaN(h)||t-e==0||(l&&(h=Math.max(h,e),h=Math.min(h,t)),d=(h-e)/(t-e),p=i-n,y+=((f=0<r?n+p*d:i-p*d)-y)*g.damp)}this.immediate=function(e){return g.convert(e),v(),y=f,s&&(y=Math.round(y)),g},this.convert=function(e){return h=e,s?Math.round(y):y},this.dispose=function(){return clearInterval(b),!0}},a.Dictionary=function(e){C("17"),this.length=0,this.unique=e;var t=this.objects=[],n=this.values=[];this.add=function(e,i){c(e)||(c(i)&&(i=!0),this.unique&&this.remove(e),t.push(e),n.push(i),this.length++)},this.at=function(e){if(!c(e)){var i=t.indexOf(e);return-1<i?n[i]:null}},this.remove=function(e){if(c(e))return!1;var i=t.indexOf(e);return-1<i&&(t.splice(i,1),n.splice(i,1),this.length--,!0)},this.clear=function(){return t=this.objects=[],n=this.values=[],this.length=null,this},this.dispose=function(){return n=t=null,!(this.length=null)}},a.Hierarchy=function(e,t){C("17.5");var o,r=this;function a(e){var t=[],n=[];return function e(i,o){loop(i,function(i,r){t.push(r.obj),n.push(i),r.open&&e(r.list,o+1)})}(e,0),[t,n]}c(e)||(c(t)&&(t=!1),r.processSimple=function(n){var i=0,r={};return function e(n,o,r){n.constructor=={}.constructor?loop(n,function(n,a){var s={};o["id"+i]={obj:n,level:r,open:t,opened:!1,list:s},i++,e(a,s,r+1)}):Array.isArray(n)&&loop(n,function(e){o["id"+i]={obj:e},i++})}(e,r,0),o=i,r},r.processComplex=function(e){var n=0;return function e(i,o){loop(i,function(i,r){r.level=o,c(r.open)&&(r.open=t),c(r.opened)&&(r.opened=!1),r.list&&e(r.list,o+1),n++})}(e,0),o=n,e},r.data=c(e.id0)?r.processSimple(e):r.processComplex(e),r.getLinearList=function(e){return c(e)&&(e=r.data),a(e)[0]},r.getLinearIDs=function(e){return c(e)&&(e=r.data),a(e)[1]},r.getData=function(e){var t;return function n(i){loop(i,function(i,o){if(i==e)return t=o;n(o.list)})}(r.data),t},r.getNextSibling=function(e){var t,n;return function i(o){loop(o,function(o,r){if(!n&&t)return n=o;o==e?t=r:i(r.list)})}(r.data),n},r.getPrevSibling=function(e){var t=[];return function n(i,o){loop(i,function(i,r){if(i==e)return t[o]||t[o-1];t[o]=i,n(r.list,o+1)})}(r.data,0),answer},Object.defineProperty(r,"length",{get:function(){return o},set:function(e){n&&i("Hierarchy.length is read only")}}))},a.pickCheck=!1,a.Pick=function(e){a.pickCheck||(C("17.6"),a.pickCheck=!0),this.choices=e,this.num=function(e){for(var t=[],n=0;n<e;n++)t.push(a.Pick.choose(this));return this.choices=a.Pick.series(t),this};var t=this;this.loop=function(e,n){for(var i,o=0;o<e;o++)if(void 0!==(i=n(a.Pick.choose(t),o,e)))return i}},a.Pick.prototype.type="Pick",a.Pick.series=function(){return a.pickCheck||(C("17.6"),a.pickCheck=!0),a.series.apply(null,arguments)},a.Pick.rand=function(e,t,n,i){return a.pickCheck||(C("17.6"),a.pickCheck=!0),a.rand(e,t,n,i)},a.Pick.choose=function(e,t){if(a.pickCheck||(C("17.6"),a.pickCheck=!0),null==t&&(t=!0),null==e)return e;if("Pick"==e.type||t){var n=e.choices||e;if(Array.isArray(n)){var i=n[Math.floor(Math.random()*n.length)];return a.Pick.choose(i)}return n.constructor==={}.constructor?c(n.noPick)?c(n.max)?n:(c(n.integer)&&(n.integer=!1),i=a.Pick.rand(n.min,n.max,n.integer,n.negative)):n.noPick:"function"==typeof n?a.Pick.choose(n()):e}return e},a.scrollX=function(e,t){return C("18"),a.abstractScroll("X","Left",e,t)},a.scrollY=function(e,t){return C("19"),a.abstractScroll("Y","Top",e,t)},a.abstractScroll=function(e,t,n,i){C("20");var o="X"==e?"Y":"X";if(c(n))return navigator,navigator.userAgent.indexOf("Safari"),document.documentElement&&document.documentElement["scroll"+t]||document.body["scroll"+t];if(c(i))window.scrollTo(a["scroll"+o](),n);else{i<50&&(i=50);var r=i/50,s=a["scroll"+e](),l=(n-s)/r,u=0,h=setInterval(function(){u++,s+=l,window.scrollTo(a["scroll"+o](),s),r<=u&&(window.scrollTo(a["scroll"+o](),n),clearInterval(h))},50)}return n},a.windowWidth=function(){C("21");var e=isNaN(window.innerWidth)?window.clientWidth:window.innerWidth,n=isNaN(window.innerHeight)?window.clientHeight:window.innerHeight;if(a.mobile()&&!c(window.orientation)&&(n<e&&90!=Math.abs(window.orientation)||e<n&&90==Math.abs(window.orientation))){var i=e;e=n,n=i}return void 0!==t&&t.swapRotation?n:e},a.windowHeight=function(){C("22");var e=isNaN(window.innerWidth)?window.clientWidth:window.innerWidth,n=isNaN(window.innerHeight)?window.clientHeight:window.innerHeight;if(a.mobile()&&!c(window.orientation)&&(n<e&&90!=Math.abs(window.orientation)||e<n&&90==Math.abs(window.orientation))){var i=e;e=n,n=i}return void 0!==t&&t.swapRotation?e:n},a.getQueryString=function(e){if(C("22.5"),c(e)&&(e=location.search.replace("?","")),""!=e){for(var t=e.split("&"),n={},i=0;i<t.length;i++){var o=t[i].split("=");void 0===n[o[0]]?n[o[0]]=decodeURIComponent((o[1]+"").replace(/\+/g,"%20")):"string"==typeof n[o[0]]?n[o[0]]=[n[o[0]],decodeURIComponent((o[1]+"").replace(/\+/g,"%20"))]:n[o[0]].push(decodeURIComponent((o[1]+"").replace(/\+/g,"%20")))}return n}},a.swapHTML=function(e,t){return C("17.2"),a.swapProperties("innerHTML",r(e),r(t))},a.urlEncode=function(e){return C("23"),e=(e+"").toString(),encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},a.urlDecode=function(e){return C("24"),decodeURIComponent((e+"").replace(/\+/g,"%20"))},a.setCookie=function(e,t,n){if(C("25"),!c(e)&&!c(t)){if(n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var o="; expires="+i.toGMTString()}else o="";return document.cookie=e+"="+escape(t)+o+"; path=/",!0}},a.getCookie=function(e){C("26");var t,n=document.cookie.split(/;\s*/),i=new Array;for(A=0;A<n.length;A++)i[(t=n[A].split("="))[0]]=t[1];if(void 0!==i[e])return unescape(i[e])},a.deleteCookie=function(e){return C("27"),!c(a.getCookie(e))&&(a.setCookie(e,"",-1),!0)},"undefined"==typeof createjs)return n&&i("ZIM >= 4.3.0 requires createjs namespace to be loaded (import createjs before zim)"),a;function f(e,n,i,o){if(a.coordinatesCheck||(C("50.43"),a.coordinatesCheck=!0),null!=e&&null!=n){var r=o.call(i,e,n),s=i.stage;if(void 0===t){if(!s)return r;t={stage:s,canvas:s.canvas}}return s||(s=t.stage),r.x/=s&&s.scaleX?s.scaleX:1,r.y/=s&&s.scaleY?s.scaleY:1,r}}function b(e,n,i,o){if(a.coordinatesCheck||(C("50.43"),a.coordinatesCheck=!0),null!=e&&null!=n){var r=i.stage;if(void 0===t){if(!r)return o.call(i,e,n);t={stage:r,canvas:r.canvas}}return r||(r=t.stage),o.call(i,e*=r.scaleX,n*=r.scaleY)}}function v(e,n,i,o){if(a.coordinatesCheck||(C("50.43"),a.coordinatesCheck=!0),null!=e&&null!=n&&null!=i){var r=o.localToGlobal(e,n),s=o.stage;if(void 0===t){if(!s)return i.globalToLocal(r.x,r.y);t={stage:s,canvas:s.canvas}}return s||(s=t.stage),i==s?r:r?i.globalToLocal(r.x,r.y):void 0}}function x(e,t){t?(e.mouseChildren=!0,e.mouseEnabled=!0,e._enabled=!0):(e.mouseChildren=!1,e.mouseEnabled=!1,e._enabled=!1)}a.coordinatesCheck=!1,a.Stage=function(e){if(C("50.44"),!c(e)){var t="CANVAS"==e.tagName?e:r(e);c(t)||(this.cjsStage_constructor(e),this.setBounds(0,0,t.width,t.height),this.type="Stage",this.cache=function(e,t,n,i,o,r){if(c(n))if(c(e)){var a=this.getBounds();if(!c(a)){var s=0<this.borderWidth?this.borderWidth/2:0;e=a.x-s,t=a.y-s,n=a.width+2*s,i=a.height+2*s}}else n=e,i=t,t=e=0;return this.cjsStage_cache(e,t,n,i,o,r),this},this.loop=function(e,t,n,i,o){return a.loop(this,e,t,n,i,o)},this.hitTestGrid=function(e,t,n,i,o,r,s,l,c,u,h,d){return a.hitTestGrid(this,e,t,n,i,o,r,s,l,c,u,h,d)},this.localToGlobal=function(e,t){return f(e,t,this,this.cjsStage_localToGlobal)},this.globalToLocal=function(e,t){return b(e,t,this,this.cjsStage_globalToLocal)},this.localToLocal=function(e,t,n){return v(e,t,n,this)})}},a.extend(a.Stage,createjs.Stage,["cache","localToLocal","localToGlobal","globalToLocal"],"cjsStage",!1),a.StageGL=function(e,t){if(C("50.45"),!c(e)){var n="CANVAS"==e.tagName?e:r(e);c(n)||(this.cjsStageGL_constructor(e,t),this.setBounds(0,0,n.width,n.height),this.type="StageGL",this.cache=function(e,t,n,i,o,r){if(c(n))if(c(e)){var a=this.getBounds();if(!c(a)){var s=0<this.borderWidth?this.borderWidth/2:0;e=a.x-s,t=a.y-s,n=a.width+2*s,i=a.height+2*s}}else n=e,i=t,t=e=0;return this.cjsStageGL_cache(e,t,n,i,o,r),this},this.loop=function(e,t,n,i,o){return a.loop(this,e,t,n,i,o)},this.hitTestGrid=function(e,t,n,i,o,r,s,l,c,u,h,d){return a.hitTestGrid(this,e,t,n,i,o,r,s,l,c,u,h,d)},this.localToGlobal=function(e,t){return f(e,t,this,this.cjsStageGL_localToGlobal)},this.globalToLocal=function(e,t){return b(e,t,this,this.cjsStageGL_globalToLocal)},this.localToLocal=function(e,t,n){return v(e,t,n,this)})}},a.extend(a.StageGL,createjs.StageGL,["cache","localToLocal","localToGlobal","globalToLocal"],"cjsStageGL",!1),a.containerCheck=!1,a.Container=function(e,t,n,i,o,r,s){var l;if(l=m(a.Container,arguments,"a, b, c, d, style, group, inherit",this))return l;a.containerCheck||(C("50.5"),a.containerCheck=!0),this.cjsContainer_constructor(),this.type="Container",this.group=r;var u=!1===o?{}:a.getStyle(this.type,this.group,s);c(e)&&(e=null!=u.a?u.a:null),c(t)&&(t=null!=u.b?u.b:null),c(n)&&(n=null!=u.c?u.c:null),c(i)&&(i=null!=u.d?u.d:null);var h=d(e,t,n,i);function d(e,t,n,i){var o=[];return c(e)?o=[e,t,n,i]:c(n)?(o[0]=0,o[2]=e,o[1]=0,o[3]=t):(o[0]=e,o[2]=n,o[1]=t,o[3]=i),c(o[3])&&(o[3]=o[2]),o}c(e)||this.setBounds(h[0],h[1],h[2],h[3]),this.cache=function(e,t,n,i,o,r){var a=this.getBounds();if(c(n))if(c(e)){if(!c(a)){var s=0<this.borderWidth?this.borderWidth/2:0;e=a.x-s,t=a.y-s,n=a.width+2*s,i=a.height+2*s}}else n=e,i=t,t=e=0;return"Triangle"==this.type&&(e-=this.borderWidth?this.borderWidth:0,n+=this.borderWidth?2*this.borderWidth:0,t-=this.borderWidth?this.borderWidth:0,i+=this.borderWidth?2*this.borderWidth:0),this.cjsContainer_cache(e,t,n,i,o,r),a&&this.setBounds(a.x,a.y,a.width,a.height),this},this.localToGlobal=function(e,t){return f(e,t,this,this.cjsContainer_localToGlobal)},this.globalToLocal=function(e,t){return b(e,t,this,this.cjsContainer_globalToLocal)},this.localToLocal=function(e,t,n){return v(e,t,n,this)},!(this.setBounds=function(e,t,n,i){var o=d(e,t,n,i);return this.cjsContainer_setBounds(o[0],o[1],o[2],o[3]),this})!==o&&P(this,u),this.clone=function(){var e=this.getBounds();return c(e)&&(e={x:null,y:null,width:null,height:null}),this.cloneChildren(this.cloneProps(new a.Container(e.x,e.y,e.width,e.height,o,this.group,s)))},this.hasProp=function(e){return!c(this[e])||this.hasOwnProperty(e)}},a.Container.prototype.dispose=function(){return function e(t){if(t.removeAllEventListeners(),t.numChildren)for(var n=t.numChildren-1;0<=n;n--)e(t.getChildAt(n));t.parent&&t.parent.removeChild(t)}(this),!0},k(a.Container.prototype),a.extend(a.Container,createjs.Container,["cache","setBounds","clone","localToLocal","localToGlobal","globalToLocal"],"cjsContainer",!1),a.Shape=function(e,t,n,i,o,r,s,l){var u;if(u=m(a.Shape,arguments,"a, b, c, d, graphics, style, group, inherit",this))return u;C("50.6"),this.cjsShape_constructor(o),this.type="Shape",this.group=s;var h=!1===r?{}:a.getStyle(this.type,this.group,l),d=this;c(e)&&(e=null!=h.a?h.a:null),c(t)&&(t=null!=h.b?h.b:null),c(n)&&(n=null!=h.c?h.c:null),c(i)&&(i=null!=h.d?h.d:null);var p=g(e,t,n,i);function g(e,t,n,i){var o=[];return c(n)?(o[0]=0,o[2]=e,o[1]=0,o[3]=t):(o[0]=e,o[2]=n,o[1]=t,o[3]=i),c(o[3])&&(o[3]=o[2]),o}c(e)||this.setBounds(p[0],p[1],p[2],p[3]),this.cache=function(e,t,n,i,o,r){if(c(n))if(c(e)){var a=this.getBounds();if(!c(a)){var s=0<this.borderWidth?this.borderWidth/2:0;e=a.x-s,t=a.y-s,n=a.width+2*s,i=a.height+2*s}}else n=e,i=t,t=e=0;return this.cjsShape_cache(e,t,n,i,o,r),this},!(this.setBounds=function(e,t,n,i){var o=g(e,t,n,i);return this.cjsShape_setBounds(o[0],o[1],o[2],o[3]),this})!==r&&P(this,h),this.clone=function(e){c(e)&&(e=!0);var t=this.getBounds();c(t)&&(t={x:null,y:null,width:null,height:null});var n=d.cloneProps(new a.Shape(t.x,t.y,t.width,t.height,o,r,s,l));return n.graphics=e?d.graphics.clone():d.graphics,n},this.localToGlobal=function(e,t){return f(e,t,this,this.cjsShape_localToGlobal)},this.globalToLocal=function(e,t){return b(e,t,this,this.cjsShape_globalToLocal)},this.localToLocal=function(e,t,n){return v(e,t,n,this)},this.hasProp=function(e){return!c(this[e])||this.hasOwnProperty(e)},this.dispose=function(){this.graphics.c(),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},a.extend(a.Shape,createjs.Shape,["cache","clone","setBounds","localToLocal","localToGlobal","globalToLocal"],"cjsShape",!1),k(a.Shape.prototype),a.Bitmap=function(e,n,i,o,r,s,l){var u;if(u=m(a.Bitmap,arguments,"image, width, height, id, style, group, inherit",this))return u;C("50.7"),this.cjsBitmap_constructor(e);var h=this;this.type="Bitmap",this.group=s;var d,p=!1===r?{}:a.getStyle(this.type,this.group,l);this.id=h.fileID=null!=p.id?p.id:o,c(n)&&(n=null!=p.width?p.width:null),c(i)&&(i=null!=p.height?p.height:null),c(n)||c(i)||h.setBounds(0,0,n,i),c(n)&&(n=100),c(i)&&(i=100),t&&(this.imageData=t.canvas.getContext("2d")?t.canvas.getContext("2d").createImageData(n,i):document.createElement("canvas").getContext("2d").createImageData(n,i),this.drawImageData=function(t,o,r,a,s,l){if(c(t)&&(t=0),c(o)&&(o=0),c(r)&&(r=0),c(a)&&(a=0),c(s)&&(s=n),c(l)&&(l=i),!h.proxyCanvas){var u=h.proxyCanvas=document.createElement("canvas");u.setAttribute("width",n),u.setAttribute("height",i),h.proxyContext=u.getContext("2d"),e=h.image=u}h.proxyContext&&h.proxyContext.putImageData(h.imageData,t,o,r,a,s,l)},c(e)&&h.drawImageData(),e.match&&e.match(/data:image/i)&&setTimeout(function(){h.stage&&h.stage.update(),setTimeout(function(){h.stage&&h.stage.update()},50)},50)),!(this.cache=function(e,t,n,i,o,r){if(c(n))if(c(e)){if(!c(s=this.getBounds())){var a=0<this.borderWidth?this.borderWidth/2:0;e=s.x-a,t=s.y-a,n=s.width+2*a,i=s.height+2*a}}else n=e,i=t,t=e=0;var s=this.getBounds();return this.cjsBitmap_cache(e,t,n,i,o,r),this.setBounds(s.x,s.y,s.width,s.height),this})!==r&&P(this,p),this.clone=function(){return this.cloneProps(new a.Bitmap(e,null,null,h.fileID,r,this.group,l))},this.localToGlobal=function(e,t){return f(e,t,this,this.cjsBitmap_localToGlobal)},this.globalToLocal=function(e,t){return b(e,t,this,this.cjsBitmap_globalToLocal)},this.localToLocal=function(e,t,n){return v(e,t,n,this)},this.hasProp=function(e){return!c(this[e])||this.hasOwnProperty(e)},this.getColorAt=function(e,t){d||(h.cache(),d=h.cacheCanvas.getContext("2d"),h.uncache());var n=d.getImageData(e,t,1,1).data;return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},this.dispose=function(){this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},a.Bitmap.fromData=function(e,t){var n=new a.Bitmap(e);setTimeout(function(){t(n)},50)},a.extend(a.Bitmap,createjs.Bitmap,["cache","clone","localToLocal","localToGlobal","globalToLocal"],"cjsBitmap",!1),k(a.Bitmap.prototype),a.Sprite=function(e,t,n,o,r,s,l,u,h,d,p,g,y,w,x,k,T,O,A){var S;if(S=m(a.Sprite,arguments,"image, cols, rows, count, offsetX, offsetY, spacingX, spacingY, width, height, animations, json, id, globalControl, spriteSheet, label, style, group, inherit",this))return S;C("50.8"),this.type="Sprite",this.group=O;var I,E=!1===T?{}:a.getStyle(this.type,this.group,A),M=this;if(c(g)&&!c(e)){c(t)&&(t=null!=E.cols?E.cols:1),c(n)&&(n=null!=E.rows?E.rows:1),c(o)&&(o=null!=E.count?E.count:t*n),c(r)&&(r=null!=E.offsetX?E.offsetX:0),c(s)&&(s=null!=E.offsetY?E.offsetY:0),c(l)&&(l=null!=E.spacingX?E.spacingX:0),c(u)&&(u=null!=E.spacingY?E.spacingY:0),c(h)&&(h=null!=E.width?E.width:e.width),c(d)&&(d=null!=E.height?E.height:e.height);var B=(h-r+l)/t-l,z=(d-s+u)/n-u,j=[],_=0;e:for(var D=0;D<n;D++)for(var L=0;L<t;L++){if(++_>o)break e;j.push([r+L*(B+l),s+D*(z+u),B,z])}X(e,j,p)}else if(x)p=(I=x).animations;else{if(!g)return;if(j=g.frames,p=g.animations,c(e)){var Y=g.images?g.images[0]:null;if(Y.split){var R=Y.split("/").pop();"EmptyAsset"!=frame.asset(R).type?X(frame.asset(R),j,p):"EmptyAsset"!=frame.asset(Y).type?(frame.asset(Y),X(frame.asset(Y),j,p)):I=new createjs.SpriteSheet(g)}else I=new createjs.SpriteSheet(g)}else X(e,j,p)}function X(e,t,n){I=new createjs.SpriteSheet({images:[e.image],frames:t,animations:n||[]})}this.animations=p,this.cjsSprite_constructor(I,k),c(k)||this.stop(),c(y)&&(y=a.makeID()),this.id=y,c(w)&&(w=!0),M.globalControl=w;var W,F=0;this.parseFrames=function(e,t,n,i){var o=[],r=Number.MAX_VALUE,s=0;if(c(e))c(t)&&(t=0),c(n)&&(n=M.totalFrames-1),l(t,n);else{if(c(M.animations)||c(M.animations[e]))return[];!function e(t){Array.isArray(t)?function(t){l(t[0],t[1],t[3]),t[2]&&!c(M.animations[t[2]])&&e(M.animations[t[2]])}(t):t.constructor=={}.constructor?function(t){if(!c(t.frames)){c(t.speed)&&(t.speed=1);for(var n=0;n<t.frames.length;n++)t.speed<r&&(r=t.speed),t.speed>s&&(s=t.speed),o.push({f:t.frames[n],s:t.speed});t.next&&!c(M.animations[t.next])&&e(M.animations[t.next])}}(t):isNaN(t)||o.push({f:Math.floor(t),s:1})}(M.animations[e])}function l(e,t,n){if(c(n)&&(n=1),e<t)for(var i=e;i<=t;i++)a(i);else for(i=t;i<=e;i++)a(e-(i-t));function a(e){n<r&&(r=n),s<n&&(s=n),o.push({f:e,s:n})}}if(i)return o;r=a.constrain(a.decimals(r),.1),s=a.constrain(a.decimals(s),.1);for(var u,h=[],d=r!=s,p=0;p<o.length;p++)if(u=o[p],d)for(var f=0;f<a.constrain(Math.round(r<1?u.s/r:u.s),.1);f++)h.push(u.f);else h.push(u.f);return h},this.run=function(e,t,n,i,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,C,k,T,P,O,A){var S,I;if(S=m(this.run,arguments,"time, label, call, params, wait, waitedCall, waitedParams, loop, loopCount, loopWait, loopCall, loopParams, loopWaitCall, loopWaitParams, rewind, rewindWait, rewindCall, rewindParams, rewindWaitCall, rewindWaitParams, startFrame, endFrame, tweek, id, globalControl"))return S;if(c(P)&&(P=1),c(O)||(M.id=O),c(A)||(M.globalControl=A),Array.isArray(t)){var E,B;I=[];for(var z,j=0,_=0;_<t.length;_++){(E=t[_]).lookup=M.parseFrames(E.label,E.startFrame,E.endFrame),0==_&&(z=E.lookup[0]),delete E.startFrame,delete E.endFrame,E.obj=a.merge(E.obj,{normalizedFrame:E.lookup.length-1}),E.set=a.merge(E.set,{normalizedFrames:{noPick:E.lookup},normalizedFrame:0}),c(E.wait)&&(E.wait=j*P),B=E.label,delete E.label,I.push(E),j=0;var D=c(E.time)?e:E.time;0<T-k&&(j=D/(T-k)/2)}if(0==I.length)return this;1==I.length?(e=I[0].time,t=B,L()):M.gotoAndStop(z)}else L();function L(){W=M.parseFrames(t,k,T),M.gotoAndStop(W[F=0]),k=T=null,I={normalizedFrame:W.length-1}}return c(e)&&(e=1e3),M.running&&M.stopAnimate(M.id),M.running=!0,Array.isArray(I)||(j=0,0<T-k&&(j=e/Math.abs(T-k)/2),W&&0<W.length&&(j=e/W.length/2),c(h)&&(h=j*P),c(b)&&(b=j*P)),a.animate({target:M,obj:I,time:e,ease:"linear",call:function(){n&&"function"==typeof n&&n(i||M),M.running=!1,M.stop()},params:i,wait:o,waitedCall:r,waitedParams:s,loop:l,loopCount:u,loopWait:h,loopCall:d,loopParams:p,loopWaitCall:f,loopWaitParams:g,rewind:y,rewindWait:b,rewindCall:v,rewindParams:w,rewindWaitCall:x,rewindWaitParams:C,override:!1,id:M.id}),M.runPaused=!1,M},this.runPaused=!0,this.pauseRun=function(e){return c(e)&&(e=!0),M.runPaused=e,M.globalControl?a.pauseAnimate(e,M.id):M.pauseAnimate(e,M.id),M},this.stopRun=function(){return M.runPaused=!0,M.running=!1,M.globalControl?a.stopAnimate(M.id):M.stopAnimate(M.id),M},Object.defineProperty(this,"frame",{get:function(){return this.currentFrame},set:function(e){e=Math.round(e),this.paused?this.gotoAndStop(e):this.gotoAndPlay(e)}}),Object.defineProperty(this,"normalizedFrame",{get:function(){return F},set:function(e){F=Math.round(e),this.gotoAndStop(W[F])}}),Object.defineProperty(this,"normalizedFrames",{get:function(){return W},set:function(e){W=e}}),Object.defineProperty(this,"totalFrames",{get:function(){return I.getNumFrames()},set:function(e){i("zim.Sprite - totalFrames is read only")}}),!1!==T&&P(this,E),this.clone=function(){return this.cloneProps(new a.Sprite(e,t,n,o,r,s,l,u,h,d,p,g,null,w,x,T,this.group,A))},this.localToGlobal=function(e,t){return f(e,t,this,this.cjsSprite_localToGlobal)},this.globalToLocal=function(e,t){return b(e,t,this,this.cjsSprite_globalToLocal)},this.localToLocal=function(e,t,n){return v(e,t,n,this)},this.hasProp=function(e){return!c(this[e])||this.hasOwnProperty(e)},this.dispose=function(){this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},a.extend(a.Sprite,createjs.Sprite,["clone","localToLocal","localToGlobal","globalToLocal"],"cjsSprite",!1),k(a.Sprite.prototype),a.MovieClip=function(e,t,n,i,o,r,s){var l;if(l=m(a.MovieClip,arguments,"mode, startPosition, loop, labels, style, group, inherit",this))return l;C("50.9"),this.type="MovieClip",this.group=r;var u=!1===o?{}:a.getStyle(this.type,this.group,s);c(e)&&(e=null!=u.mode?u.mode:null),c(t)&&(t=null!=u.startPosition?u.startPosition:null),c(n)&&(n=null!=u.loop?u.loop:null),c(i)&&(i=null!=u.labels?u.labels:null),this.cjsMovieClip_constructor(e,t,n,i),!1!==o&&P(this,u),this.clone=function(){return this.cloneProps(new a.MovieClip(e,t,n,i,o,this.group,s))},this.hasProp=function(e){return!c(this[e])||this.hasOwnProperty(e)},this.localToGlobal=function(e,t){return f(e,t,this,this.cjsMovieClip_localToGlobal)},this.globalToLocal=function(e,t){return b(e,t,this,this.cjsMovieClip_globalToLocal)},this.localToLocal=function(e,t,n){return v(e,t,n,this)},this.dispose=function(){this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},a.extend(a.MovieClip,createjs.MovieClip,["clone","localToLocal","localToGlobal","globalToLocal"],"cjsMovieClip",!1),k(a.MovieClip.prototype),a.SVGContainer=function(e,t,n,i,o,r,s,l){var u;if(u=m(a.SVGContainer,arguments,"svg, splitTypes, geometric, showControls, interactive, style, group, inherit",this))return u;C("50.95"),this.group=s;var h=!1===r?{}:a.getStyle("SVGContainer",this.group,l),d=this,p=new a.Point(0,0);if(c(t)&&(t=!1),c(n)&&(n=!0),!c(e)){if(c(e.draggable))e.getAttribute||(f=new DOMParser,e=f.parseFromString(e,"image/svg+xml").documentElement),y=this.svg=e;else var f=new DOMParser,g=(e=e.innerHTML?f.parseFromString(e.innerHTML,"text/xml"):e).getElementsByTagName("svg"),y=this.svg=g?e.getElementsByTagName("svg")[0]:null;if(!c(y))var b=y.getAttribute("width"),v=y.getAttribute("height");if(b&&(b=Number(b.trim())),v&&(v=Number(v.trim())),this.zimContainer_constructor(b,v),this.type="SVGContainer",c(y))return;var w,x=a.black,k=a.black,T=a.black,O=a.black,A=2,S=2,I=1,E=1,M=1,B=1,z=e.getElementsByTagName("svg");function j(e){var t,n,i,o,r,a=e.split(";");return loop(a,function(e){var a=(e=e.replace(/,/g,"")).split(":"),s=a[0].trim().toLowerCase(),l=a[1].trim().toLowerCase().replace("px","");"fill"==s&&(t=l),"stroke"==s&&(n=l),"stroke-width"==s&&(i=l),"opacity"==s&&(r=o=l),"fill-opacity"==s&&(o=l),"stroke-opacity"==s&&(r=l)}),[t,n,i,o,r]}function _(e,t){var r,s=L(t),l=s[0],c=s[1],u=s[2],h=s[5],p=s[6];if("circle"==e){var f=Number(t.getAttribute("r").trim()),g=.5523*f;r=n?new a.Circle(Number(t.getAttribute("r")),l,c,u):new a.Blob(l,c,u,4,f,g,"mirror",null,i,null,null,null,null,null,null,null,null,null,null,o)}else if("rect"==e)if(n)r=new a.Rectangle(Number(t.getAttribute("width")),Number(t.getAttribute("height")),l,c,u,Number(t.getAttribute("rx")));else{var m=Number(t.getAttribute("width")),y=Number(t.getAttribute("height")),b=Number(t.getAttribute("rx")),v=Number(t.getAttribute("ry"));if(b&&v){var x=.5523*b,C=.5523*v;r=new a.Blob(l,c,u,[[b,0,0,0,-x,0,0,0,"free"],[m-b,0,0,0,0,0,x,0,"free"],[m,v,0,0,0,-C,0,0,"free"],[m,y-v,0,0,0,0,0,C,"free"],[m-b,y,0,0,x,0,0,0,"free"],[b,y,0,0,0,0,-x,0,"free"],[0,y-v,0,0,0,C,0,0,"free"],[0,v,0,0,0,0,0,-C,"free"]],null,null,null,null,i,null,null,null,null,null,null,null,null,null,null,o)}else r=new a.Blob(l,c,u,[[0,0],[m,0],[m,y],[0,y]],null,null,null,null,i,null,null,null,null,null,null,null,null,null,null,o)}else if("line"==e)r=new a.Squiggle(c,u,[[Number(t.getAttribute("x1")),Number(t.getAttribute("y1"))],[Number(t.getAttribute("x2")),Number(t.getAttribute("y2"))]],null,null,null,null,i,null,null,null,null,null,null,null,null,null,null,o);else if("polygon"==e||"polyline"==e){var k=t.getAttribute("points");k=(k=k.replace(/-/g," -")).replace(/\s+/g," ");var T=[];loop(k.split(" "),function(e){var t=e.split(",");T.push([Number(t[0].trim()),Number(t[1].trim())])}),r="polygon"==e?new Blob(l,c,u,T):new a.Squiggle(c,u,T,null,null,null,null,i,null,null,null,null,null,null,null,null,null,null,o)}else"ellipse"==e&&(r=new a.Blob(l,c,u,function(e,t,n,i){var o=.5522848*n,r=.5522848*i,a=0+n,s=0+i;return[[0-n,0,0,0,0,s+r-i,0,0-r,"mirror"],[0,0-i,0,0,0-o,0,a+o-n,0,"mirror"],[a,0,0,0,0,0-r,0+o-o,s+r-i,"mirror"],[0,s,0,0,a-n+o,0,0-o,0,"mirror"]]}(0,0,Number(t.getAttribute("rx")),Number(t.getAttribute("ry"))),null,null,null,null,i,null,null,null,null,null,null,null,null,null,null,o));r.loc(h,p,d);var P=t.getAttribute("transform");(P||w)&&D(r,P||w),!o||"Rectangle"!=r.type&&"Circle"!=r.type||r.transform({showReg:!1,visible:i})}function D(e,t){var n=t.split(")");loop(n,function(t){if(""!=t){var n=t.trim().split("("),i=n[0].trim().toLowerCase(),o=n[1].trim().toLowerCase().replace("px","").replace("deg","");if("translate"==i){var r=o.split(",");e.mov(Number(r[0].trim()),r[1]?Number(r[1].trim()):0)}if("scale"==i){var a=o.split(",");"Blob"==e.type||"Squiggle"==e.type?1==a.length?e.transformPoints("scale",Number(a[0].trim())):2==a.length&&(e.transformPoints("scaleX",Number(a[0].trim())),e.transformPoints("scaleY",Number(a[1].trim()))):1==a.length?e.sca(Number(a[0].trim())):2==a.length&&e.sca(Number(a[0].trim()),Number(a[1].trim()))}if("rotate"==i){var s=o.split(",");1==s.length?s.push(0,0):2==s.length&&s.push(0),e.rot(Number(s[0].trim()),Number(s[1].trim()),Number(s[2].trim()))}"skewX"==i&&(e.skewX=o),"skewY"==i&&(e.skewY=o)}})}0==z.length&&(z=[e]),function e(t){a.loop(t,function(t){var n=t.tagName.toLowerCase();if("path"==n&&Y(t),"circle"==n&&_("circle",t),"rect"==n&&_("rect",t),"ellipse"==n&&_("ellipse",t),"line"==n&&_("line",t),"polygon"==n&&_("polygon",t),"polyline"==n&&_("polyline",t),"g"==n){var i,o,r,a,s,l=t.getAttribute("style");if(l){var u=j(l);i=u[0],o=u[1],r=u[2],a=u[3],s=u[4]}w=t.getAttribute("transform"),k=t.getAttribute("fill")?t.getAttribute("fill"):c(i)?x:i,O=t.getAttribute("stroke")?t.getAttribute("stroke"):c(o)?T:o,S=t.getAttribute("stroke-width")?t.getAttribute("stroke-width"):c(r)?A:r,E=t.getAttribute("fill-opacity")?t.getAttribute("fill-opacity"):c(a)?I:a,B=t.getAttribute("stroke-opacity")?t.getAttribute("stroke-opacity"):c(s)?M:s}e(t.children),"g"==t.tagName.toLowerCase()&&(k=x,O=T,S=A,E=I,B=M,w=null)})}(z)}function L(e){var t,n,i,o,r,s=e.getAttribute("style");if(s){var l=j(s);t=l[0],n=l[1],i=l[2],o=l[3],r=l[4]}t=e.getAttribute("fill")?e.getAttribute("fill"):c(t)?k:t,n=e.getAttribute("stroke")?e.getAttribute("stroke"):c(n)?O:n,i=e.getAttribute("stroke-width")?e.getAttribute("stroke-width"):c(i)?S:i,o=e.getAttribute("fill-opacity")?e.getAttribute("fill-opacity"):c(o)?E:o,r=e.getAttribute("stroke-opacity")?e.getAttribute("stroke-opacity"):c(r)?B:r;var u=e.getAttribute("x")?e.getAttribute("x"):0;u=e.getAttribute("cx")?e.getAttribute("cx"):u;var h=e.getAttribute("y")?e.getAttribute("y"):0;return h=e.getAttribute("cy")?e.getAttribute("cy"):h,c(o)||c(t)||(t=a.convertColor(t,"rgba",Number(o))),c(r)||c(n)||(n=a.convertColor(n,"rgba",Number(r))),[t,n,Number(i),Number(o),Number(r),Number(u),Number(h)]}function Y(e,n){c(n)&&(n=!0);var r,s,l=["M","m","L","l","H","h","V","v","C","c","S","s","Q","q","T","t","A","a","z","Z"],u=["m","l","h","v","c","s","q","t","a","z"],h=new a.Point(0,0);if(c(e.getAttribute))var f=e;else e.getAttribute("id"),f=e.getAttribute("d");if(f=(f=(f=(f=f.replace(/,/g," ")).replace(/([a-zA-Z])/g," $1 ")).replace(/-/g," -")).replace(/\s+/g," "),n)var g=L(e),m=g[0],y=g[1],b=g[2];var v,x=[],C=[0,0],k=new a.Point(0,0),T=new a.Point(0,0,0,0),P=new a.Point(0,0,0,0,0,0),O=(new a.Point(0,0,0,0,0,0,0),f.split(" ")),A=O.slice(1,O.length),S=[],I=!1,E="",M=!1,B="squiggle",z=null;function j(){E=S[S.length-1],2<=x.length&&("z"!=E&&"Z"!=E||(B="blob")),(r="squiggle"==B?new a.Squiggle(y,b,x,null,null,null,null,i,null,null,null,null,null,null,null,null,null,null,o):new a.Blob(m,y,b,x,null,null,null,null,i,null,null,null,null,null,null,null,null,null,null,o)).loc(0,0,d),0<=u.indexOf(E=S[S.length-1])?(C[0]=x[x.length-1][0],C[1]=x[x.length-1][1],p.x=x[x.length-1][0],p.y=x[x.length-1][1],(x=[]).push([C[0],C[1]])):(C=[0,0],x=[[0,0]]),S=[],"z"!=E&&"Z"!=E&&S.push(E),h.x=0,h.y=0;var t=e.getAttribute("transform");(t||w)&&D(r,t||w)}return a.loop(A,function(e,n){if(0==n&&(p.x=0,p.y=0,C=[0,0],E=""),-1==l.indexOf(e)){if("lxo"==v&&(v="lx",S.push("l"),I=!0),"lyo"==v&&(v="ly",I=!0),"Lxo"==v&&(v="Lx",S.push("L"),I=!0),"Lyo"==v&&(v="Ly",I=!0),s=Number(e),s=Math.round(100*s)/100,"X"==v?(p.x=s,v="Y"):"Y"==v?(p.y=s,v="Lxo",x.push([p.x,p.y])):"x"==v?(p.x=p.x+s,v="y"):"y"==v&&(p.y=p.y+s,v="lxo",x.push([p.x,p.y])),"H"==v||"h"==v?(h.x=x[x.length-1][0],h.y=x[x.length-1][1],h.x=h.x+("h"==v?s:s-p.x),x.push([h.x,h.y]),v="Lx"):"V"!=v&&"v"!=v||(h.x=x[x.length-1][0],h.y=x[x.length-1][1],h.y=h.y+("v"==v?s:s-p.y),x.push([h.x,h.y]),v="lx"),"Lx"==v?(k.x=s,v="Ly"):"Ly"==v?(k.y=s,h.x=k.x,h.y=k.y,x.push([h.x,h.y]),v="Lx"):"lx"==v?(0<S.length&&(0!=h.x&&0!=h.y?(p.x=h.x,p.y=h.y):(p.x=h.x+p.x,p.y=h.y+p.y)),k.x=p.x+s,v=I?"lyo":"ly"):"ly"==v&&(k.y=p.y+s,h.x=k.x,h.y=k.y,x.push([h.x,h.y]),v="lx"),"qx"==v||"Qx"==v)0<x.length?(p.x=x[x.length-1][0],p.y=x[x.length-1][1]):(p.x=0,p.y=0),T.x="qx"==v?p.x+s:s,v="qx"==v?"qy":"Qy";else if("qy"==v||"Qy"==v)T.y="qy"==v?p.y+s:s,v="qy"==v?"qz":"Qz",M&&(M=!1,(i=x[x.length-1])[6]=-i[4],i[7]=-i[5],i[8]="mirror",h.x=T.x,h.y=T.y,x[x.length]=[h.x,h.y,0,0,-i[6],i[7],0,0,"free"],v="qy"==v?"qx":"Qx");else if("qz"==v||"Qz"==v)T.z="qz"==v?p.x+s:s,v="qz"==v?"qq":"Qq";else if("qq"==v||"Qq"==v){T.w="qq"==v?p.y+s:s;var i=x[x.length-1];h.x=i[0],h.y=i[1],1==x.length?(i[2]=0,i[3]=0,i[4]=0,i[5]=0,i[6]=2/3*(T.x-h.x),i[7]=2/3*(T.y-h.y),i[8]="free"):x[x.length]=[h.x,h.y,0,0,0,0,2/3*(T.x-h.x),2/3*(T.y-h.y),"free"],h.x=T.z,h.y=T.w,x[x.length]=[h.x,h.y,0,0,2/3*(T.x-h.x),2/3*(T.y-h.y),0,0,"free"],v="qq"==v?"qx":"Qx"}"cx"==v||"Cx"==v?(0<x.length?(p.x=x[x.length-1][0],p.y=x[x.length-1][1]):(p.x=0,p.y=0),P.x="cx"==v?p.x+s:s,v="cx"==v?"cy":"Cy"):"cy"==v||"Cy"==v?(P.y="cy"==v?p.y+s:s,v="cy"==v?"cz":"Cz"):"cz"==v||"Cz"==v?(P.z="cz"==v?p.x+s:s,v="cz"==v?"cq":"Cq"):"cq"==v||"Cq"==v?(P.q="cq"==v?p.y+s:s,v="cq"==v?"cr":"Cr",M&&((i=x[x.length-1])[2]=0,i[3]=0,c(i[4])&&(i[4]=0),c(i[5])&&(i[5]=0),i[6]=-i[4],i[7]=-i[5],i[8]="mirror",h.x=P.z,h.y=P.q,x[x.length]=[h.x,h.y,0,0,P.x-h.x,P.y-h.y,0,0,"free"],v="cr"==v?"cx":"Cx")):"cr"==v||"Cr"==v?(P.r="cr"==v?p.x+s:s,v="cr"==v?"cs":"Cs"):"cs"!=v&&"Cs"!=v||(P.s="cs"==v?p.y+s:s,i=x[x.length-1],1==x.length&&(i[2]=0,i[3]=0,i[4]=0,i[5]=0),i[6]=P.x-i[0],i[7]=P.y-i[1],i[8]="free",h.x=P.r,h.y=P.s,x[x.length]=[h.x,h.y,0,0,P.z-h.x,P.q-h.y,0,0,"free"],v="cs"==v?"cx":"Cx")}else S.push(e),"s"!=e&&(M=!1),1<S.length&&("M"!=e&&"m"!=e||(j(),"M"==e?(p.x=0,p.y=0):(p.x=x[x.length-1][0],p.y=x[x.length-1][1]),x=[],(S=[]).push(e))),"M"==e?v="X":"m"==e?v="x":"L"==e?(v="Lx",t&&z&&"l"!=z&&j(),z="l"):"l"==e?(v="lx",t&&z&&"l"!=z&&j(),z="l"):"H"==e?(v="H",t&&z&&"l"!=z&&j(),z="l"):"h"==e?(v="h",t&&z&&"l"!=z&&j(),z="l"):"V"==e?(v="V",t&&z&&"l"!=z&&j(),z="l"):"v"==e?(v="v",t&&z&&"l"!=z&&j(),z="l"):"C"==e?(v="Cx",t&&z&&"c"!=z&&j(),z="c"):"c"==e?(v="cx",t&&z&&"c"!=z&&j(),z="c"):"S"==e?(M=!0,v="Cx",t&&z&&"c"!=z&&j(),z="c"):"s"==e?(M=!0,v="cx",t&&z&&"c"!=z&&j(),z="c"):"Q"==e?(v="Qx",t&&z&&"q"!=z&&j(),z="q"):"q"==e?(v="qx",t&&z&&"q"!=z&&j(),z="q"):"T"==e?(M=!0,v="Qx",t&&z&&"q"!=z&&j(),z="q"):"t"==e?(M=!0,v="qx",t&&z&&"q"!=z&&j(),z="q"):"A"==e?B=null:"z"!=e&&"Z"!=e||(B="blob")}),n&&j(),x}!(d.processPath=function(e){return Y(e,!1)})!==r&&P(this,h),this.clone=function(){return d.cloneProps(new a.SVGContainer(e,t,n,i,o,r,this.group,l))}},a.extend(a.SVGContainer,a.Container,"clone","zimContainer",!1),a.Circle=function(e,t,n,i,o,r,s,l,u,h){var d;if(d=m(a.Circle,arguments,"radius, color, borderColor, borderWidth, dashed, percent, strokeObj, style, group, inherit",this))return d;C("51"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Circle",this.group=u;var p=!1===l?{}:a.getStyle(this.type,this.group,h);c(e)&&(e=null!=p.radius?p.radius:50),c(o)&&(o=null!=p.dashed&&p.dashed),c(n)&&(n=null!=p.borderColor?p.borderColor:null),c(i)&&(i=null!=p.borderWidth?p.borderWidth:null),n<0||i<0?n=i=null:null!=n&&null==i&&(i=1),c(t)&&(t=null!=p.color?p.color:0<i?"rgba(0,0,0,0)":"black"),c(r)&&(r=null!=p.percent?p.percent:100),c(s)&&(s=null!=p.strokeObj?p.strokeObj:{});var f=function(){return arguments}(e,t,n,i,r);e=a.Pick.choose(e),t=a.Pick.choose(t),n=a.Pick.choose(n),i=a.Pick.choose(i),r=a.Pick.choose(r);var g=this,y=e,b=t,v=n,w=i;this.mouseChildren=!1;var x=this.shape=new createjs.Shape;this.addChild(x);var k,T,O,A,S,I,E=x.graphics;function M(){E.c(),g.colorCommand=k=E.f(b).command,(c(w)||0<w)&&(c(v)&&c(w)||(c(v)&&(v="black"),g.borderColorCommand=T=E.s(v).command,g.borderWidthCommand=O=E.ss(w,s.caps,s.joints,s.miterLimit,s.ignoreScale).command,o&&(g.borderDashedCommand=A=E.sd([10,10],5).command)));var e=2*y;if("number"==typeof r&&0<=r&&r<100){var t=360*r/100/2;E.arc(0,0,y,(-t-90)*Math.PI/180,(t-90)*Math.PI/180,!1).cp(),e=y-Math.cos(t*Math.PI/180)*y}else E.dc(0,0,y);g.setBounds(-y,-y,2*y,e)}M(),Object.defineProperty(g,"color",{get:function(){return b},set:function(e){c(e)&&(e="black"),k.style=b=e}}),this.setColorRange=function(e,t){return I=c(t)?(S=g.color,e):(S=c(e)?g.color:e,t),g};var B=0;Object.defineProperty(g,"colorRange",{get:function(){return B},set:function(e){B=e,c(S)||c(I)||(g.color=a.colorRange(S,I,e))}}),Object.defineProperty(g,"borderColor",{get:function(){return v},set:function(e){v=e,T?T.style=v:M()}}),Object.defineProperty(g,"borderWidth",{get:function(){return w},set:function(e){0<e||(e=0),w=e,O&&0!=w?(O.width=w,o&&(A.segments=[20,10],A.offset=5)):M()}}),Object.defineProperty(g,"radius",{get:function(){return y},set:function(e){y=e,M()}}),!1!==l&&P(this,p),this.linearGradient=function(e,t,n,i,o,r){return this.linearGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.linearGradient(e,t,n,i,o,r),this},this.radialGradient=function(e,t,n,i,o,r,a,s){return this.radialGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.radialGradient(e,t,n,i,o,r,a,s),this},this.clone=function(e){var t=g.cloneProps(e?new a.Circle(g.radius,g.color,g.borderColor,g.borderWidth,o,r,s,l,this.group,h):new a.Circle(f[0],f[1],f[2],f[3],o,f[4],l,this.group,h));return g.linearGradientParams&&t.linearGradient.apply(t,g.linearGradientParams),g.radialGradientParams&&t.radialGradient.apply(t,g.linearGradientParams),t}},a.extend(a.Circle,a.Container,"clone","zimContainer",!1),a.Rectangle=function(e,t,n,i,o,r,s,l,u,h,d){var p;if(p=m(a.Rectangle,arguments,"width, height, color, borderColor, borderWidth, corner, dashed, strokeObj, style, group, inherit",this))return p;C("52"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Rectangle",this.group=h;var f=!1===u?{}:a.getStyle(this.type,this.group,d);c(e)&&(e=null!=f.width?f.width:null),c(t)&&(t=null!=f.height?f.height:c(e)?100:e),c(e)&&(e=t),c(r)&&(r=null!=f.corner?f.corner:0),c(s)&&(s=null!=f.dashed&&f.dashed),c(i)&&(i=null!=f.borderColor?f.borderColor:null),c(o)&&(o=null!=f.borderWidth?f.borderWidth:null),i<0||o<0?i=o=null:null!=i&&null==o&&(o=1),c(n)&&(n=null!=f.color?f.color:0<o?"rgba(0,0,0,0)":"black"),c(l)&&(l=null!=f.strokeObj?f.strokeObj:{});var g=function(){return arguments}(e,t,n,i,o);e=a.Pick.choose(e),t=a.Pick.choose(t),n=a.Pick.choose(n),i=a.Pick.choose(i),o=a.Pick.choose(o);var y=this,b=n,v=i,w=o;this.mouseChildren=!1;var x=this.shape=new createjs.Shape;this.addChild(x);var k,T,O,A,S,I=x.graphics;function E(){I.c(),y.colorCommand=k=I.f(b).command,(c(w)||0<w)&&(c(v)&&c(w)||(c(v)&&(v="black"),y.borderColorCommand=T=I.s(v).command,y.borderWidthCommand=O=I.ss(w,l.caps,l.joints,l.miterLimit,l.ignoreScale).command,s&&(y.borderDashedCommand=borderDashedObj=I.sd([10,10],5).command))),Array.isArray(r)?I.rc(0,0,e,t,r[0],r[1],r[2],r[3]):0<r?I.rr(0,0,e,t,r):I.r(0,0,e,t),y.setBounds(0,0,e,t)}E(),Object.defineProperty(y,"color",{get:function(){return b},set:function(e){c(e)&&(e="black"),k.style=b=e}}),this.setColorRange=function(e,t){return S=c(t)?(A=y.color,e):(A=c(e)?y.color:e,t),y};var M=0;Object.defineProperty(y,"colorRange",{get:function(){return M},set:function(e){M=e,c(A)||c(S)||(y.color=a.colorRange(A,S,e))}}),Object.defineProperty(y,"borderColor",{get:function(){return v},set:function(e){v=e,T?T.style=v:E()}}),Object.defineProperty(y,"borderWidth",{get:function(){return w},set:function(e){0<e||(e=0),w=e,O&&0!=w?(O.width=w,s&&(borderDashedObj.segments=[20,10],borderDashedObj.offset=5)):E()}}),this.linearGradient=function(e,t,n,i,o,r){return this.linearGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.linearGradient(e,t,n,i,o,r),this},!(this.radialGradient=function(e,t,n,i,o,r,a,s){return this.radialGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.radialGradient(e,t,n,i,o,r,a,s),this})!==u&&P(this,f),this.clone=function(n){var i=y.cloneProps(n?new a.Rectangle(e,t,y.color,y.borderColor,y.borderWidth,r,s,l,u,this.group,d):new a.Rectangle(g[0],g[1],g[2],g[3],g[4],r,s,l,u,this.group,d));return y.linearGradientParams&&i.linearGradient.apply(i,y.linearGradientParams),y.radialGradientParams&&i.radialGradient.apply(i,y.linearGradientParams),i}},a.extend(a.Rectangle,a.Container,"clone","zimContainer",!1),a.Triangle=function(e,t,n,o,r,s,l,u,h,d,p,f,g){var y;if(y=m(a.Triangle,arguments,"a, b, c, color, borderColor, borderWidth, center, adjust, dashed, strokeObj, style, group, inherit",this))return y;C("53"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Triangle",this.group=f;var b=!1===p?{}:a.getStyle(this.type,this.group,g);c(e)&&(e=null!=b.a?b.a:100),c(t)&&(t=null!=b.b?b.b:e),c(n)&&(n=null!=b.c?b.c:t),-1==n&&(n=Math.sqrt(Math.pow(e,2)+Math.pow(t,2))),c(l)&&(l=null==b.center||b.center),c(u)&&(u=null!=b.adjust?b.adjust:0),c(r)&&(r=null!=b.borderColor?b.borderColor:null),c(s)&&(s=null!=b.borderWidth?b.borderWidth:null),r<0||s<0?r=s=null:null!=r&&null==s&&(s=1),c(o)&&(o=null!=b.color?b.color:0<s?"rgba(0,0,0,0)":"black"),c(u)&&(u=null!=b.adjust?b.adjust:0),c(d)&&(d=null!=b.strokeObj?b.strokeObj:{});var v=function(){return arguments}(e,t,n,o,r,s);e=a.Pick.choose(e),t=a.Pick.choose(t),n=a.Pick.choose(n),this.a=e,this.b=t,this.c=n,o=a.Pick.choose(o),r=a.Pick.choose(r),s=a.Pick.choose(s);var w=this,x=o,k=r,T=s;this.mouseChildren=!1;var O=[e,t,n];O.sort(function(e,t){return t-e});var A=O[0],S=O[1],I=O[2],E=[O.indexOf(e),O.indexOf(t),O.indexOf(n)];if(S+I<A)i("zim display - Triangle(): invalid triangle lengths");else{var M=this.shape=new createjs.Shape;this.adjusted=u,this.addChild(M);var B,z,j,_,D,L=M.graphics;R(),Object.defineProperty(w,"color",{get:function(){return x},set:function(e){c(e)&&(e="black"),B.style=x=e}}),this.setColorRange=function(e,t){return D=c(t)?(_=w.color,e):(_=c(e)?w.color:e,t),w};var Y=0;Object.defineProperty(w,"colorRange",{get:function(){return Y},set:function(e){Y=e,c(_)||c(D)||(w.color=a.colorRange(_,D,e))}}),Object.defineProperty(w,"borderColor",{get:function(){return k},set:function(e){k=e,z?z.style=k:R()}}),Object.defineProperty(w,"borderWidth",{get:function(){return T},set:function(e){0<e||(e=0),T=e,j&&0!=T?(j.width=T,h&&(borderDashedObj.segments=[20,10],borderDashedObj.offset=5)):R()}}),this.linearGradient=function(e,t,n,i,o,r){return this.linearGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.linearGradient(e,t,n,i,o,r),this},!(this.radialGradient=function(e,t,n,i,o,r,a,s){return this.radialGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.radialGradient(e,t,n,i,o,r,a,s),this})!==p&&P(this,b),this.clone=function(i){var o=w.cloneProps(i?new a.Triangle(e,t,n,w.color,w.borderColor,w.borderWidth,l,u,h,d,p,this.group,g):new a.Triangle(v[0],v[1],v[2],v[3],v[4],v[5],l,u,h,d,p,this.group,g));return w.linearGradientParams&&o.linearGradient.apply(o,w.linearGradientParams),w.radialGradientParams&&o.radialGradient.apply(o,w.linearGradientParams),o}}function R(){L.c(),w.colorCommand=B=L.f(x).command,(c(T)||0<T)&&(c(k)&&c(T)||(c(k)&&(k="black"),w.borderColorCommand=z=L.s(k).command,w.borderWidthCommand=j=L.ss(T,d.caps,d.joints,d.miterLimit,d.ignoreScale).command,h&&(w.borderDashedCommand=borderDashedObj=L.sd([10,10],5).command))),L.mt(0,0),w.one={x:0,y:0},L.lt(e,0),w.two={x:e,y:0};var n=180*Math.acos((Math.pow(S,2)+Math.pow(I,2)-Math.pow(A,2))/(2*S*I))/Math.PI,i=180*Math.asin(S*Math.sin(n*Math.PI/180)/A)/Math.PI,o=[n,i,180-n-i];w.angles=[o[E[1]],o[E[2]],o[E[0]]];var r=w.angles[1],a=Math.cos(r*Math.PI/180)*t,s=Math.sin(r*Math.PI/180)*t,p=Math.max(e,e-a),f=s;w.setBounds(0,u,p,f),M.y=f,L.lt(e-a,0-s),w.three={x:e-a,y:0-s},L.cp(),l&&(w.regX=p/2,w.regY=f/2),u&&(w.shape.y+=u)}},a.extend(a.Triangle,a.Container,"clone","zimContainer"),a.Squiggle=function(e,t,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I){var E;if(E=m(a.Squiggle,arguments,"color, thickness, points, length, controlLength, controlType, lockControlType, showControls, lockControls, handleSize, allowToggle, move, dashed, onTop, stickColor, selectColor, selectPoints, editPoints, interactive, strokeObj, style, group, inherit",this))return E;C("53.2"),this.group=S;var M=!1===A?{}:a.getStyle("Squiggle",this.group,I);if(c(t)&&(t=null!=M.thickness?M.thickness:6),c(r)&&(r=null!=M.length?M.length:300),c(o)&&(o=null!=M.points?M.points:5),"string"==typeof o){var B=new a.SVGContainer;o=B.processPath(o)}var z="number"==typeof o?o:o.length;if(0!=z){c(s)&&(s=null!=M.controlLength?M.controlLength:r/z),this.zimContainer_constructor(r,s,null,null,!1),this.type="Squiggle",c(y)&&(y=null!=M.dashed&&M.dashed),c(e)&&(e=null!=M.color?M.color:a.blue),e.style&&(this.colorCommand=e,e="black"),c(l)&&(l=null!=M.controlType?M.controlType:null);var j=l;c(l)&&(l="mirror"),c(u)&&(u=null!=M.lockControlType&&M.lockControlType),c(T)&&(T=null==M.interactive||M.interactive),c(h)&&(h=null!=M.showControls?M.showControls:T);var _=h;c(d)&&(d=null!=M.lockControls?M.lockControls:!T),c(p)&&(p=null!=M.handleSize?M.handleSize:a.mobile()?20:10),c(f)&&(f=null!=M.allowToggle?M.allowToggle:T),c(g)&&(g=null!=M.move?M.move:T),c(v)&&(v=null!=M.stickColor?M.stickColor:"#111"),c(w)&&(w=null!=M.selectColor?M.selectColor:"#fff"),c(x)&&(x=null!=M.selectPoints?M.selectPoints:T),this.stickColor=v,c(b)&&(b=null==M.onTop||M.onTop),c(k)&&(k=null!=M.editPoints?M.editPoints:T),c(O)&&(O=null!=M.strokeObj?M.strokeObj:{});var D,L,Y,R=this;this.types=["mirror","straight","free","none"],this.interactive=T,this.num=z,this.onTop=b,this.move=g,this.editPoints=k,this.allowToggle=f,this.lockControlType=u,this.selectPoints=x,this.lockControls=d;var X,W,F,V,N,G,H,K,q,U,Z,J=e,$=t,Q=R.move,ee=2;j&&"number"!=typeof o&&loop(o,function(e){"none"==(e[8]=j)&&(e[4]=e[5]=e[6]=e[7]=0)}),re(),R.selectionManager.on("keydown",function(e){if(R.selectPoints&&R.keyFocus&&37<=e.keyCode&&e.keyCode<=40){var t=ae();if(0<t.length){for(var n=0;n<t.length;n++){var i=t[n];37==e.keyCode?i.x-=R.selectionManager.shiftKey?10:1:39==e.keyCode?i.x+=R.selectionManager.shiftKey?10:1:38==e.keyCode?i.y-=R.selectionManager.shiftKey?10:1:40==e.keyCode&&(i.y+=R.selectionManager.shiftKey?10:1),q(i)}U(),R.stage&&R.stage.update()}}}),R.selectionManager.on("keyup",function(e){if(R.selectPoints&&R.keyFocus&&37<=e.keyCode&&e.keyCode<=40){var t=ae();if(0<t.length)for(var n=0;n<t.length;n++)se(t[n])}}),R.selectionManager.on("undo",function(){if(R.selectPoints&&R.keyFocus&&R.lastPoints){var e=a.copy(R.lastPoints);R.lastPoints=a.copy(R.points),R.points=e,R.stage&&R.stage.update()}}),q=function(e){if(!R.lockControls)if(e.rect1){var t=(i=e).x-i.startX,n=i.y-i.startY;i.rect1.x=i.rect1.startX+t,i.rect1.y=i.rect1.startY+n,i.rect2.x=i.rect2.startX+t,i.rect2.y=i.rect2.startY+n}else{var i,o=e,r=o.other,a=(i=o.ball).index,s=l;if(c(D[a][4])||(s=D[a][4]),"straight"==s||"mirror"==s){var u=o.x-i.x,h=o.y-i.y;if("mirror"==s)r.x=i.x-u,r.y=i.y-h;else{var d=Math.atan2(h,u),p=-r.stickLength*Math.cos(d+Math.PI),f=-r.stickLength*Math.sin(d+Math.PI);r.x=i.x-p,r.y=i.y-f}}}},Object.defineProperty(R,"move",{get:function(){return g},set:function(e){g!=e&&((g=e)?le():ce())}}),Object.defineProperty(R,"interactive",{get:function(){return T},set:function(e){R.showControls=T=e,R.allowToggle=T,R.editPoints=T,R.lockControls=!T,R.selectPoints=T,R.move=T,R.points=R.points}}),Object.defineProperty(R,"allowToggle",{get:function(){return f},set:function(e){f!=e&&((f=e)?R.move&&le():!_&&R.move&&ce())}});var te,ne,ie=d;Object.defineProperty(R,"lockControls",{get:function(){return ie},set:function(e){(ie=e)?(R.controls.mouseChildren=!1,R.controls.mouseEnabled=!1):(R.controls.mouseChildren=!0,R.controls.mouseEnabled=!0)}}),R.lockControls=ie,Object.defineProperty(R,"controlsVisible",{get:function(){return _},set:function(e){(_=e)?R.showControls():R.hideControls()}}),Object.defineProperty(R,"color",{get:function(){return J},set:function(e){c(e)&&(e="black"),X.style=J=e}}),this.setColorRange=function(e,t){return ne=c(t)?(te=R.color,e):(te=c(e)?R.color:e,t),R};var oe=0;Object.defineProperty(R,"colorRange",{get:function(){return oe},set:function(e){oe=e,c(te)||c(ne)||(R.color=a.colorRange(te,ne,e))}}),Object.defineProperty(R,"thickness",{get:function(){return $},set:function(e){0<e||(e=0),$=e,W&&0!=$?(W.width=$,y&&(F.segments=[20,10],F.offset=5)):U()}}),"undefined"!=typeof KEYFOCUS&&(a.KEYFOCUS=KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return a.KEYFOCUS==R},set:function(e){a.KEYFOCUS=R}}),a.KEYFOCUS||function(){if(R.selectPoints){R.keyFocus=!0;var e=document.activeElement;e&&e.blur()}}(),Object.defineProperty(R,"points",{get:function(){for(var e,t,n=[],i=0;i<D.length;i++)e=[a.decimals((t=D[i])[0].x),a.decimals(t[0].y),a.decimals(t[1].x),a.decimals(t[1].y),a.decimals(t[2].x),a.decimals(t[2].y),a.decimals(t[3].x),a.decimals(t[3].y)],t[4]&&"mirror"!==t[4]&&e.push(t[4]),n.push(e);return n},set:function(e){R.dispose(!0),o=e,R.shape&&(R.shape.graphics.clear(),R.sticks.graphics.clear(),R.controls.noDrag(),R.removeAllChildren(),delete R.shape,delete R.sticks,delete R.controls),re(),R.lockControls=ie}}),Object.defineProperty(R,"pointsAdjusted",{get:function(){var e,t,n=[],i=R.pointObjects;return a.loop(i.length,function(o,r){if(po=i[o],t=D[o],0==po[0].rotation&&0==po[0].scaleX&&0==po[0].scaleY)e=[a.decimals(t[0].x),a.decimals(t[0].y),a.decimals(t[1].x),a.decimals(t[1].y),a.decimals(t[2].x),a.decimals(t[2].y),a.decimals(t[3].x),a.decimals(t[3].y)];else{var s=po[0].localToLocal(po[2].x,po[2].y,po[0].parent),l=po[0].localToLocal(po[3].x,po[3].y,po[0].parent);e=[a.decimals(t[0].x),a.decimals(t[0].y),a.decimals(t[1].x),a.decimals(t[1].y),a.decimals(s.x-t[0].x),a.decimals(s.y-t[0].y),a.decimals(l.x-t[0].x),a.decimals(l.y-t[0].y)]}t[4]&&"mirror"!==t[4]&&e.push(t[4]),n.push(e)}),n},set:function(e){n&&i("Squiggle() - pointsAdjusted is read only")}}),Object.defineProperty(R,"pointObjects",{get:function(){return D},set:function(e){n&&i("Squiggle() - pointObjects is read only - but its contents can be manipulated - use squiggle.update() after changes")}}),Object.defineProperty(R,"pointControls",{get:function(){return Y},set:function(e){n&&i("Squiggle() - pointControls is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(R,"pointCircles",{get:function(){return L},set:function(e){n&&i("Squiggle() - pointCircles is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(R,"segmentPoints",{get:function(){var e=[],t=R.pointsAdjusted;return a.loop(t.length-1,function(n,i){var o=R.getSegmentPoint(t[n],t[n+1]);e.push(o)}),e},set:function(e){n&&i("Squiggle() - segmentPoints is read only")}}),Object.defineProperty(R,"segmentRatios",{get:function(){var e=[],t=0;a.loop(R.segmentPoints,function(n){var i=a.distanceAlongCurve(n);e.push(i),t+=i});var n=[],i=0;return a.loop(e,function(e){n.push(i+=e/t)}),n},set:function(e){n&&i("Squiggle() - segmentRatios is read only")}}),R.getPointAngle=function(e){var t=R.pointObjects[e][0],n=R.pointObjects[e][2],i=R.pointObjects[e][3];if(t==R.stage)var o=new a.Point(n.x,n.y),r=new a.Point(i.x,i.y);else o=t.localToGlobal(n.x,n.y),r=t.localToGlobal(i.x,i.y);return a.angle(o.x,o.y,r.x,r.y)},R.getSegmentPoint=function(e,t){if(!c(e)&&!c(t)){0==e[2]&&0==e[3]||(e[4]-=e[2],e[5]-=e[3],e[6]-=e[2],e[7]-=e[3],e[0]+=e[2],e[1]+=e[3],e[2]=0,e[3]=0),0==t[2]&&0==t[3]||(t[4]-=t[2],t[5]-=t[3],t[6]-=t[2],t[7]-=t[3],t[0]+=t[2],t[1]+=t[3],t[2]=0,t[3]=0);var n={x:e[0],y:e[1]},i={x:e[0]+e[6],y:e[1]+e[7]},o={x:t[0]+t[4],y:t[1]+t[5]},r={x:t[0],y:t[1]};return 0==Z.x&&0==Z.y||(n.x+=Z.x,i.x+=Z.x,o.x+=Z.x,r.x+=Z.x,n.y+=Z.y,i.y+=Z.y,o.y+=Z.y,r.y+=Z.y),[n,i,o,r]}},R.getAdjacentSegmentData=function(e){c(e)&&(e=0);var t=R.pointsAdjusted;return 2==R.num?[[R.getSegmentPoint(t[0],t[1])],[0]]:0==e?[[R.getSegmentPoint(t[0],t[1]),R.getSegmentPoint(t[1],t[2])],[0,1]]:e>=R.num-2?[[R.getSegmentPoint(t[R.num-3],t[R.num-2]),R.getSegmentPoint(t[R.num-2],t[R.num-1])],[R.num-3,R.num-2]]:[[R.getSegmentPoint(t[e-1],t[e]),R.getSegmentPoint(t[e],t[e+1]),R.getSegmentPoint(t[e+1],t[e+2])],[e-1,e,e+1]]},R.getCurvePoint=function(e,t,n,i){(c(e)||isNaN(e))&&(e=0),c(t)&&(t=R.segmentRatios),c(n)&&(n=R.segmentPoints),c(i)&&(i=!1);var o=t,r=n,s=a.loop(o,function(t,n){if(e<=t)return n}),l=0<s?o[s]-o[s-1]:o[s];if(l){var u=a.pointAlongCurve(r[s],(e-(0<s?o[s-1]:0))/l,i),h=R.localToGlobal(u.x,u.y);return h.angle=u.angle,h.z=s,c(h)?void 0:h}},this.addPoint=function(e,t){c(e)&&(e=100);var n=R.points;return he(n,R.pointControls,R.segmentRatios,e,t),R.points=n,R.num=n.length,R},this.addPoints=function(e,t,n,i,o,r){c(r)&&(r=a.copy(R.points));var s=a.copy(R.segmentRatios),l=0;if(o&&(R.interpolatedPoints=[]),i)var u=s.length*e;return a.loop(s,function(s,h){o&&he(r,R.pointControls,R.segmentRatios,100*l,t,!c(n)&&h!=n,o);var d=i?Math.round(u*(s-l)):e,p=1/(d+1);a.loop(d,function(i){he(r,R.pointControls,R.segmentRatios,100*(l+(s-l)*p*(i+1)),t,!c(n)&&h!=n,o),!o&&0<e&&(R.points=r)}),l=s}),o&&"Squiggle"==R.type&&he(r,R.pointControls,R.segmentRatios,100,t,null,o),R.stage&&R.stage.update(),R.num=r.length,R},this.interpolate=function(e,t,n,i){return c(e)&&(e=1),R.addPoints(e,"none",t,n,!0,i),R.interpolatedPoints},this.linearGradient=function(e,t,n,i,o,r){return this.linearGradientParams=Array.prototype.slice.call(arguments),this.thicknessCommand.linearGradient(e,t,n,i,o,r),this},this.radialGradient=function(e,t,n,i,o,r,a,s){return this.radialGradientParams=Array.prototype.slice.call(arguments),this.thicknessCommand.radialGradient(e,t,n,i,o,r,a,s),this},this.dispose=function(e){if(R.shape){R.shape.cursor="default";for(var t=0;t<R.points.length;t++)R.pointObjects[t][1].removeAllEventListeners();for(t=0;t<L.length;t++)L[t].removeAllEventListeners();R.sticks.removeFrom(R),R.controls.removeFrom(R),R.shape.removeAllEventListeners(),R.controls.removeAllEventListeners(),R.off("mousedown",R.toggleEvent),R.off("click",R.clickEvent),R.toggleStageEvent&&R.stage.off("stagemousedown",R.toggleStageEvent),!e&&R.selectPoints&&R.selectionManager.removeAllEventListeners()}}}function re(){Z&&Z.removeAllEventListeners(),R.num=z="number"==typeof o?o:o.length,z=Math.max(2,z),s=r/z,V=R.shape=new a.Shape({style:!1}).addTo(R);var e=R.sticks=new a.Shape({style:!1}).addTo(R);p<=0&&e.removeFrom();var n=V.graphics;n.c();var i=e.graphics;i.c();var f=p/10*8,C=p;R.selectPoints?(R.selectedBalls=new a.SelectionSet,R.selectedRect1s=new a.SelectionSet,R.selectedRect2s=new a.SelectionSet,R.selectionManager=new a.SelectionManager([R.selectedBalls,R.selectedRect1s,R.selectedRect2s],"ctrl",!1)):R.selectionManager=new a.SelectionManager(null,"ctrl");var k,S,E,B,j,Q,te,ne=a.mobile();Z=R.controls=new a.Container({style:!1}).addTo(R),R.interactive&&Z.drag({onTop:!ne}),D=[],Y=[],L=[];for(var ie=0;ie<z;ie++){if((S=new a.Container({style:!1}).addTo(Z)).num=ie,"number"==typeof o){var oe=a.Pick.choose(s);k=new a.Container(oe,t,null,null,!1).addTo(R).loc({x:ie*r/(z-1)-oe/2,y:ie%2*oe}),j=new a.Circle(f,R.selectPoints&&R.selectedBalls.isSelected(ie)?w:a.light,a.dark,2,null,null,null,!1).centerReg(k).loc({x:oe/2,y:0}),E=new a.Rectangle(C,C,R.selectPoints&&R.selectedRect1s.isSelected(ie)?w:me(l),0==p?null:a.dark,0==p?null:2,null,null,null,!1).centerReg(k).loc({x:0,y:0}),B=new a.Rectangle(C,C,R.selectPoints&&R.selectedRect2s.isSelected(ie)?w:me(l),0==p?null:a.dark,0==p?null:2,null,null,null,!1).centerReg(k).loc({x:oe,y:0});var re=k.localToLocal(j.x,j.y,Z);j.x=re.x,j.y=re.y,j.addTo(S,null,!1);var ue=k.localToLocal(E.x,E.y,Z);E.x="none"==l?0:ue.x-j.x,E.y="none"==l?0:ue.y-j.y,E.addTo(S,null,!1);var he=k.localToLocal(B.x,B.y,Z);B.x="none"==l?0:he.x-j.x,B.y="none"==l?0:he.y-j.y,B.addTo(S,null,!1),S.x=j.x,S.y=j.y,j.x=0,j.y=0,"none"==l&&j.addTo(S,null,!1)}else Q=(te=o[ie])[8]?te[8]:l,S.loc({x:te[0],y:te[1]}),j=new a.Circle(f,a.light,a.dark,2,null,null,null,!1).centerReg({add:!1}).addTo(S).loc({x:te[2],y:te[3]}),E=new a.Rectangle(C,C,me(Q),0==p?null:a.dark,0==p?null:2,null,null,null,!1).centerReg({add:!1}).addTo(S,0).loc({x:te[4],y:te[5]}),B=new a.Rectangle(C,C,me(Q),0==p?null:a.dark,0==p?null:2,null,null,null,!1).centerReg({add:!1}).addTo(S,0).loc({x:te[6],y:te[7]});j.mySet=S,j.rect1=E,j.rect2=B,j.index=ie,ne?j.on("mousedown",fe):j.on("dblclick",ge),E.ball=j,(E.other=B).ball=j,B.other=E,0==p&&(j.expand(10),E.expand(10),B.expand(10)),ne&&(j.expand(),E.expand(),B.expand()),D.push([S,j,E,B,te?te[8]:l]),L.push(j),Y.push(S)}var de,pe=!1;function fe(e){pe?(e.preventDefault(),ge(e)):(pe=!0,setTimeout(function(){pe=!1},300))}function ge(e){if(!R.lockControlType){var t=e.target,n=D[t.index][4]?D[t.index][4]:l;Math.abs(t.rect1.x)<=2&&Math.abs(t.rect1.y)<=2&&Math.abs(t.rect2.x)<=2&&Math.abs(t.rect2.y)<=2&&(n="none"),"none"==n&&t.parent.addChildAt(t,0),"none"==(n=R.types[(R.types.indexOf(n)+(R.shiftKey?-1:1)+R.types.length)%R.types.length])&&(t.rect1.x=t.rect1.y=t.rect2.x=t.rect2.y=0,t.parent.addChild(t),e.stopImmediatePropagation()),D[t.index][4]=n,t.rect1.color=me(n),t.rect2.color=me(n),U();var i=new createjs.Event("change");i.controlType="bezierSwitch",R.dispatchEvent(i),t.stage.update()}}function me(e){var t={straight:a.pink,free:a.yellow,none:a.blue};return t[e]?t[e]:a.purple}(U=function(){n.c();var e=a.mobile()?10:6;if(t<e){n.s("rgba(0,0,0,.01)").ss(e);var o=(c=D[0][0]).localToLocal(D[0][1].x,D[0][1].y,V);n.mt(o.x,o.y);for(var r=0;r<D.length;r++){var s=r,l=(r+1)%D.length,c=D[s][0],u=D[s][1],h=D[s][2],d=D[s][3],p=D[l][0],f=D[l][1],g=D[l][2],m=c.localToLocal(d.x,d.y,V),b=p.localToLocal(g.x,g.y,V),v=p.localToLocal(f.x,f.y,V);r!=D.length-1&&n.bt(m.x,m.y,b.x,b.y,v.x,v.y)}}for(R.colorCommand||(R.colorCommand=X=n.s(J).command),R.thicknessCommand||(R.thicknessCommand=W=n.ss($,O.caps,O.joints,O.miterLimit,O.ignoreScale).command),y&&(R.dashedCommand||(R.dashedCommand=F=n.sd([10,10],5).command)),o=(c=D[0][0]).localToLocal(D[0][1].x,D[0][1].y,V),n.mt(o.x,o.y),i.c().s(R.stickColor).ss(1),r=0;r<D.length;r++){u=D[s=r][1],h=D[s][2],p=D[l=(r+1)%D.length][0],f=D[l][1],g=D[l][2],m=(c=D[s][0]).localToLocal((d=D[s][3]).x,d.y,V),b=p.localToLocal(g.x,g.y,V),v=p.localToLocal(f.x,f.y,V),r!=D.length-1&&n.bt(m.x,m.y,b.x,b.y,v.x,v.y),o=c.localToLocal(u.x,u.y,V);var w=c.localToLocal(h.x,h.y,V);0==r&&(h.visible=0),0!=r&&i.mt(o.x,o.y).lt(w.x,w.y),r!=D.length-1&&i.mt(o.x,o.y).lt(m.x,m.y),r==D.length-1&&(d.visible=0)}y&&n.append(R.dashedCommand),n.append(R.thicknessCommand),n.append(R.colorCommand)})(),Z.on("mousedown",function(e){if(K=e.target.stage,!R.lockControls){if(R.selectPoints&&(R.keyFocus=!0),de={x:e.target.x,y:e.target.y},e.target.rect1)(n=e.target).startX=n.x,n.startY=n.y,n.rect1.startX=n.rect1.x,n.rect1.startY=n.rect1.y,n.rect2.startX=n.rect2.x,n.rect2.startY=n.rect2.y;else{var t=e.target;t.startX=t.x,t.startY=t.y;var n,i=(n=t.ball).index,o=l;if(c(D[i][4])||(o=D[i][4]),"straight"==o){var r=t.other,a=r.y-n.y;r.stickLength=Math.sqrt(Math.pow(r.x-n.x,2)+Math.pow(a,2))}}if(R.selectPoints){var s=R.selectionManager.currentSet;if(s&&s.selections&&0<s.selections.length)for(var u=0;u<s.selections.length;u++){var h=R.pointObjects[s.selections[u]];h[1].startX=h[1].x,h[1].startY=h[1].y,h[2].startX=h[2].x,h[2].startY=h[2].y,h[3].startX=h[3].x,h[3].startY=h[3].y}}}}),R.selectPoints&&Z.tap(function(e){if(e.target.rect1){var t=e.target;R.selectedBalls.toggle(t.parent.num)}else{var n=e.target;n.color="white",(t=n.ball).rect1==n?R.selectedRect1s.toggle(t.parent.num):R.selectedRect2s.toggle(t.parent.num)}for(var i=0;i<R.pointObjects.length;i++){var o=R.pointObjects[i];o[1].color=R.selectedBalls.isSelected(i)?a.white:a.light,o[2].color=R.selectedRect1s.isSelected(i)?a.white:me(o[4]),o[3].color=R.selectedRect2s.isSelected(i)?a.white:me(o[4])}K.update()}),Z.on("pressmove",function(e){if(!R.lockControls)if(R.selectPoints){var t=ae();if(-1==t.indexOf(e.target))q(e.target),U();else if(0<t.length){diffX=e.target.x-e.target.startX,diffY=e.target.y-e.target.startY;for(var n=0;n<t.length;n++){var i=t[n];i.x=i.startX+diffX,i.y=i.startY+diffY,q(i)}U()}}else q(e.target),U()}),Z.on("pressup",function(e){if(!R.lockControls){var t=e.target.x!=de.x||e.target.y!=de.y,n=new createjs.Event("change");e.target.rect1?(n.controlType="bezierPoint",function(e){if(R.selectPoints){var t=ae();if(t&&-1==t.indexOf(e))se(e);else if(t&&0<t.length)for(var n=0;n<t.length;n++)se(t[n]);else se(e)}else se(e)}(e.target)):n.controlType="bezierHandle",t&&R.dispatchEvent(n)}}),R.changeControl=function(e,t,n,i,o,r,a,s,l){var u;if(u=m(R.changeControl,arguments,"index, type, rect1X, rect1Y, rect2X, rect2Y, circleX, circleY, update"))return u;if(c(e))for(var h=0;h<D.length;h++)R.changeControl(h,t,n,i,o,r,a,s);else{var d=D[e];"none"==(d[4]=t)?(c(a)||(d[2].x=a),c(s)||(d[2].y=s),d[2].x=d[1].x,d[2].y=d[1].y,d[3].x=d[1].x,d[3].y=d[1].y,d[1].parent.addChild(d[1])):(c(n)||(d[2].x=n),c(i)||(d[2].y=i),c(o)||(d[3].x=o),c(r)||(d[3].y=r),c(a)||(d[1].x=a),c(s)||(d[1].y=s),d[1].parent.addChildAt(d[1],0)),l&&(R.update(),R.stage&&R.stage.update())}},R.transformPoints=function(e,t,n,i){return R.points=a.transformPoints(R.points,e,t,n,i),R},R.traverse=function(e,t,n,i){var o=a.copy(R.segmentRatios);o.unshift(0),c(n)&&(n=t+1);var r=t<n;if(r)var s=100*o[t],l=100*o[n];else s=50+(100-100*o[t])/2,l=50+(100-100*o[n])/2;return e.percentComplete=s,e.animate({ease:"linear",props:{path:R},rewind:!r,time:i,events:!0}),e.on("animation",function(t){if(e.percentComplete>l||0==e.percentComplete){e.stopAnimate(),t.remove();var n=new createjs.Event("traversed");n.obj=e,R.dispatchEvent(n)}}),R},R.update=function(e){return e?R.points=R.pointsAdjusted:U(),R},R.interactive&&(g&&V.drag({onTop:!1}),N=V.on("mousedown",function(e){K=e.target.stage,de={x:V.x,y:V.y},R.selectPoints&&(R.keyFocus=!0),function(){if(R.onTop){var e=R.parent.numChildren-1;"Keyboard"==R.parent.getChildAt(e).type&&e--,R.parent.setChildIndex(R,e)}}()}),G=V.on("pressmove",function(){Z.x=V.x,Z.y=V.y,e.x=V.x,e.y=V.y}),H=V.on("pressup",function(){var t=V.x!=de.x||V.y!=de.y,n=V.localToLocal(0,0,R.parent);if(R.x=n.x,R.y=n.y,Z.x=Z.y=e.x=e.y=V.x=V.y=0,t){var i=new createjs.Event("change");i.controlType="move",R.dispatchEvent(i)}K.update()}),R.move||ce(!0)),R.toggleEvent=R.on("mousedown",function(){R.allowToggle&&(_||(R.showControls(),R.dispatchEvent("controlsshow")))}),R.added(function(){R.toggleStageEvent=R.stage.on("stagemousedown",function(e){R.allowToggle&&R.stage&&_&&!R.hitTestPoint(e.stageX/e.target.stage.scaleX,e.stageY/e.target.stage.scaleY,!1)&&(R.hideControls(),R.dispatchEvent("controlshide"))})}),R.clickEvent=R.on("click",function(){R.ctrlKey&&setTimeout(function(){R.clone(!0).addTo(R.stage).mov(0,100),R.allowToggle&&(R.hideControls(),R.dispatchEvent("controlshide"));var e=new createjs.Event("change");e.controlType="move",R.dispatchEvent(e),R.stage.update()},50)}),R.hideControls=function(){return R.toggled=!1,Z.visible=!1,e.visible=!1,_=!1,R.stage&&R.stage.update(),!R.allowToggle&&R.move&&ce(),R},h||R.hideControls(),R.showControls=function(){return R.toggled=!0,Z.visible=!0,e.visible=!0,_=!0,Z.x=V.x,Z.y=V.y,e.x=V.x,e.y=V.y,R.addChildAt(V,0),R.move&&!R.allowToggle&&le(),R.stage&&R.stage.update(),R},R.toggle=function(e){return!0===e?R.showControls():!1===e?R.hideControls():_?R.hideControls():R.showControls(),R},R.recordData=function(e){c(e)&&(e=!1);var t={type:"Blob",index:R.parent?R.parent.getChildIndex(R):-1,x:R.x,y:R.y,points:R.recordPoints(),color:R.color,thickness:R.thickness,move:R.move,toggle:R.allowToggle,controlsVisible:_};return e?JSON.stringify(t):t},R.setData=function(e,t){if(!c(e)){if(t)try{e=JSON.parse(e)}catch(e){return}var n=e.index;c(n)&&(n=-1),delete e.index;var i=e.points;for(var o in c(i)||R.setPoints(i),delete e.points,R.num=i.length,e)R[o]=e[o];return R.parent&&R.parent.setChildIndex(R,n),R.update(),R}},R.recordPoints=function(e){c(e)&&(e=!1);var t=R.points;if(e){if(!R.pane){var n=R.pane=new a.Pane({container:R.stage,width:Math.min(500,R.stage.width-20),height:Math.min(500,R.stage.height-20),draggable:!0});(R.textArea=new a.TextArea(Math.min(400,R.stage.width-70),Math.min(400,R.stage.height-70))).centerReg(n)}R.textArea.text=JSON.stringify(t),R.pane.show()}return t},!(R.setPoints=function(e){for(var t,n,i=0;i<e.length;i++)n=e[i],c(t=D[i])||(t[0].x=n[0],t[0].y=n[1],t[1].x=n[2],t[1].y=n[3],t[2].x=n[4],t[2].y=n[5],t[3].x=n[6],t[3].y=n[7],t[4]=n[8]);return R.update(),R})!==A&&P(R,M),R.clone=function(e){var t=R.cloneProps(new a.Squiggle(e?R.colorCommand:R.color,R.thickness,R.recordPoints(),r,s,l,u,Z.visible,d,p,R.allowToggle,R.move,y,b,v,w,x,R.editPoints,T,O,A,R.group,I));return R.linearGradientParams&&t.linearGradient.apply(t,R.linearGradientParams),R.radialGradientParams&&t.radialGradient.apply(t,R.linearGradientParams),t},R.shape.on("mousedown",function(e){K=e.target.stage,R.editPoints&&(R.controlsVisible?(R.pressX=e.stageX/K.scaleX,R.pressY=e.stageY/K.scaleX):(R.pressX=null,R.pressY=null))}),R.addPointFactor=20,R.addMinDistance=15,R.shape.on("pressup",function(e){if(R.editPoints&&R.pressX&&Math.abs(R.pressX-e.stageX/K.scaleX)<ee&&Math.abs(R.pressY-e.stageY/K.scaleY)<ee){R.selectPoints&&(R.lastPoints=a.copy(R.points));var t=R.points,n=R.globalToLocal(e.stageX/K.scaleX,e.stageY/K.scaleY),i=a.closestPointAlongCurve(n,R.segmentPoints);if("anywhere"==R.editPoints)t.splice(i+1,0,[n.x,n.y,0,0,0,0,0,0]),R.points=t,R.changeControl({index:i+1,type:"mirror",update:!0});else{var o,r=R.pointsAdjusted,s=R.getSegmentPoint(r[i],r[(i+1)%r.length]),l=a.distanceAlongCurve(s),c=Math.round(l/R.addPointFactor),u=R.interpolate(c,i,t),h=1e4;if(a.loop(u,function(e,t){if(0!=t){var i=a.dist(e,n);i<h&&(h=i,o=t)}}),h<R.addMinDistance){var d=R.segmentRatios,p=0<i?d[i-1]:0;R.addPoint(100*(p+o/c*(d[i]-p)))}}R.lastSelectedIndex=i+1,R.lastSelected=R.controls.getChildAt(R.lastSelectedIndex),R.stage.update()}}),R.controls.on("click",function(e){R.lastSelected=e.target.parent;var t=R.lastSelectedIndex=R.controls.getChildIndex(e.target.parent);if(R.editPoints&&R.selectionManager.shiftKey&&"Circle"==e.target.type){if(R.controls.numChildren<=2)return;var n=R.points;R.selectPoints&&(R.lastPoints=a.copy(n)),n.splice(t,1),R.points=n,R.stage.update(),R.lastSelected=R.lastSelectedIndex=null}}),_||R.hideControls(),R.dispatchEvent("update")}function ae(){var e=[],t=R.selectionManager.currentSet;if(t&&t.selections&&0<t.selections.length)for(var n=0;n<t.selections.length;n++){var i=R.pointObjects[t.selections[n]];if(t==R.selectedBalls)e.push(i[1]);else if(t==R.selectedRect1s)e.push(i[2]);else{if(t!=R.selectedRect2s)continue;e.push(i[3])}}return e}function se(e){if("Circle"==e.type){var t=e,n=t.mySet,i=t.rect1,o=t.rect2;i.x-=t.x,i.y-=t.y,o.x-=t.x,o.y-=t.y,n.x+=t.x,n.y+=t.y,t.x=0,t.y=0}}function le(){"always"!=R.move&&(Q||(Q=!0,V.drag({onTop:!1}),N=V.on("mousedown",N),G=V.on("pressmove",G),H=V.on("pressup",H)))}function ce(e){"always"!=R.move&&(e||Q)&&(Q=!1,V.noDrag(),V.off("mousedown",N),V.off("pressmove",G),V.off("pressup",H))}function ue(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}}function he(e,t,n,i,o,r,s){var l=e.length-1,c=0,u=0;100==i&&"Squiggle"==R.type&&(i=99.99),i=(i+1e5)%100,a.loop(n,function(e,t){if(i/100<e)return l=t,u=e,!0;c=e});var h=R.segmentPoints[l],d=0<u?(i/100-c)/(u-c):0,p=a.pointAlongCurve(h,d),f=[p.x,p.y,0,0];if(!r)if(s)R.interpolatedPoints.push({x:p.x,y:p.y,r:i/100});else{if("none"!=o){var g=ue(h[0],h[1],d),m=ue(h[1],h[2],d),y=ue(h[2],h[3],d),b=ue(g,m,d),v=ue(m,y,d);f[4]=b.x-p.x,f[5]=b.y-p.y,f[6]=v.x-p.x,f[7]=v.y-p.y;var w=R.localToLocal(g.x,g.y,t[l]);e[l][6]=w.x,e[l][7]=w.y;var x=R.localToLocal(y.x,y.y,t[(l+1)%e.length]);e[(l+1)%e.length][4]=x.x,e[(l+1)%e.length][5]=x.y}o&&(f[8]=o),e.splice(l+1,0,f)}}},a.extend(a.Squiggle,a.Container,["clone","dispose"],"zimContainer",!1),a.Blob=function(e,t,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I,E){var M;if(M=m(a.Blob,arguments,"color, borderColor, borderWidth, points, radius, controlLength, controlType, lockControlType, showControls, lockControls, handleSize, allowToggle, move, dashed, onTop, stickColor, selectColor, selectPoints, editPoints, interactive, strokeObj, style, group, inherit",this))return M;C("53.5"),this.group=I;var B=!1===S?{}:a.getStyle("Blob",this.group,E);c(s)&&(s=null!=B.radius?B.radius:100),this.zimContainer_constructor(-s,-s,2*s,2*s,!1),this.type="Blob",c(b)&&(b=null!=B.dashed&&B.dashed),c(t)&&(t=null!=B.borderColor?B.borderColor:null),c(o)&&(o=null!=B.borderWidth?B.borderWidth:null),t<0||o<0?t=o=null:null!=t&&null==o&&(o=1),c(e)&&(e=null!=B.color?B.color:0<o?"rgba(0,0,0,0)":a.green),e.style&&(this.colorCommand=e,e="black"),t&&t.style&&(this.borderColorCommand=t,t="black"),c(r)&&(r=null!=B.points?B.points:4);var z="number"==typeof r?r:r.length,j=l;c(l)&&(l=null!=B.controlLength?B.controlLength:4*s/z),c(u)&&(u=null!=B.controlType?B.controlType:null);var _=u;c(u)&&(u="straight"),c(h)&&(h=null!=B.lockControlType&&B.lockControlType),c(O)&&(O=null==B.interactive||B.interactive),c(d)&&(d=null!=B.showControls?B.showControls:O);var D=d;c(p)&&(p=null!=B.lockControls?B.lockControls:!O),c(f)&&(f=null!=B.handleSize?B.handleSize:a.mobile()?20:10),c(g)&&(g=null!=B.allowToggle?B.allowToggle:O),c(y)&&(y=null!=B.move?B.move:O),c(w)&&(w=null!=B.stickColor?B.stickColor:"#111"),c(x)&&(x=null!=B.selectColor?B.selectColor:"#fff"),c(k)&&(k=null!=B.selectPoints?B.selectPoints:O),this.stickColor=w,c(v)&&(v=null==B.onTop||B.onTop),c(T)&&(T=null!=B.editPoints?B.editPoints:O),c(A)&&(A=null!=B.strokeObj?B.strokeObj:{});var L=this;this.interactive=O,this.num=z,this.editPoints=T,this.selectPoints=k,this.lockControls=p,this.onTop=v,this.move=y,this.allowToggle=g,this.lockControlType=h,this.types=["mirror","straight","free","none"];var Y,R,X,W,F,V,N,G,H,K,q,U,Z,J,$,Q=e,ee=t,te=o,ne=L.move,ie=2;function oe(e){var t;if("circle"!=e&&"rectangle"!=e&&"triangle"!=e||("circle"==e&&(e=new Circle(s)),"rectangle"==e&&(e=new Rectangle(2*s,2*s).centerReg({add:!1})),"triangle"==e&&(e=new Triangle(2*s,2*s,2*s))),"Circle"!=e.type&&"Rectangle"!=e.type&&"Triangle"!=e.type)return e;var n=e.getBounds();return"Circle"==e.type?(t=4,j=l=2*s*.5523):"Rectangle"==e.type?(e.centerReg({add:!1}),t=[[n.x-n.width/2,n.y-n.height/2],[n.x+n.width/2,n.y-n.height/2],[n.x+n.width/2,n.y+n.height/2],[n.x-n.width/2,n.y+n.height/2]],L.setBounds(n.x-n.width/2,n.y-n.height/2,n.width,n.height),L.regX=e.regX-n.width/2,L.regY=e.regY-n.height/2):"Triangle"==e.type&&(t=[[e.three.x-e.width/2,e.three.y+e.height/2+e.adjusted],[e.two.x-e.width/2,e.two.y+e.height/2+e.adjusted],[e.one.x-e.width/2,e.one.y+e.height/2+e.adjusted]],L.setBounds(n.x-n.width/2,n.y-n.height/2,n.width,n.height)),t}if("string"==typeof(r=oe(r))){var re=new a.SVGContainer;r=re.processPath(r)}function ae(){if($&&$.removeAllEventListeners(),L.selectPoints?(L.selectedBalls=new a.SelectionSet,L.selectedRect1s=new a.SelectionSet,L.selectedRect2s=new a.SelectionSet,L.selectionManager=new a.SelectionManager([L.selectedBalls,L.selectedRect1s,L.selectedRect2s],"ctrl",!1)):L.selectionManager=new a.SelectionManager(null,"ctrl"),!((z="number"==typeof r?r:r.length)<=0)){c(j)&&(l=4*s/z),G=L.shape=new a.Shape({style:!1}).addTo(L);var e=L.sticks=new a.Shape({style:!1}).addTo(L);f<=0&&e.removeFrom();var t=G.graphics;t.c();var n=e.graphics;n.c();var i,o,d,g,C,T,I,M=f/10*8,_=f,ne=a.mobile();$=L.controls=new a.Container({style:!1}).addTo(L),L.interactive&&$.drag({onTop:!ne}),Y=[],X=[],R=[];for(var oe=0;oe<z;oe++){if((o=new a.Container({style:!1}).addTo($)).num=oe,"number"==typeof r){var re=a.Pick.choose(l);(i=new a.Container(re,s,null,null,!1).reg(re/2,s).addTo(L)).rotation=oe/z*360,C=new a.Circle(M,L.selectPoints&&L.selectedBalls.isSelected(oe)?x:a.light,a.dark,2,null,null,null,!1).centerReg(i).loc({x:re/2,y:0}),d=new a.Rectangle(_,_,L.selectPoints&&L.selectedRect1s.isSelected(oe)?x:ye(u),0==f?null:a.dark,0==f?null:2,null,null,null,!1).centerReg(i).loc({x:0,y:0}),g=new a.Rectangle(_,_,L.selectPoints&&L.selectedRect2s.isSelected(oe)?x:ye(u),0==f?null:a.dark,0==f?null:2,null,null,null,!1).centerReg(i).loc({x:re,y:0});var ae=i.localToLocal(C.x,C.y,$);C.x=ae.x,C.y=ae.y,C.addTo(o,null,!1);var he=i.localToLocal(d.x,d.y,$);d.x="none"==u?0:he.x-C.x,d.y="none"==u?0:he.y-C.y,d.addTo(o,null,!1);var de=i.localToLocal(g.x,g.y,$);g.x="none"==u?0:de.x-C.x,g.y="none"==u?0:de.y-C.y,g.addTo(o,null,!1),o.x=C.x,o.y=C.y,C.x=0,C.y=0,"none"==u&&C.addTo(o,null,!1)}else T=(I=r[oe])[8]?I[8]:u,o.loc({x:I[0],y:I[1]}),C=new a.Circle(M,a.light,a.dark,2,null,null,null,!1).centerReg({add:!1}).addTo(o).loc({x:I[2],y:I[3]}),d=new a.Rectangle(_,_,ye(T),0==f?null:a.dark,0==f?null:2,null,null,null,!1).centerReg({add:!1}).addTo(o,0).loc({x:I[4],y:I[5]}),g=new a.Rectangle(_,_,ye(T),0==f?null:a.dark,0==f?null:2,null,null,null,!1).centerReg({add:!1}).addTo(o,0).loc({x:I[6],y:I[7]});C.mySet=o,C.rect1=d,C.rect2=g,C.index=oe,0==f&&(C.expand(10),d.expand(10),g.expand(10)),ne?C.on("mousedown",ge):C.on("dblclick",me),d.ball=C,(d.other=g).ball=C,g.other=d,ne&&(C.expand(),d.expand(),g.expand()),Y.push([o,C,d,g,I?I[8]:u]),R.push(C),X.push(o)}var pe,fe=!1;(J=function(){t.c(),L.colorCommand||(L.colorCommand=W=t.f(Q).command),(c(te)||0<te)&&(c(ee)&&c(te)||(c(ee)&&(ee="black"),L.borderColorCommand||(L.borderColorCommand=F=t.s(ee).command),L.borderWidthCommand||(L.borderWidthCommand=V=t.ss(te,A.caps,A.joints,A.miterLimit,A.ignoreScale).command),b&&(L.borderDashedCommand||(L.borderDashedCommand=N=t.sd([10,10],5).command))));var e=(r=Y[0][0]).localToLocal(Y[0][1].x,Y[0][1].y,G);t.mt(e.x,e.y),n.c().s(L.stickColor).ss(1);for(var i=0;i<Y.length;i++){var o=(i+1)%Y.length,r=Y[i][0],a=Y[i][1],s=Y[i][2],l=Y[i][3],u=Y[o][0],h=Y[o][1],d=Y[o][2],p=r.localToLocal(l.x,l.y,G),f=u.localToLocal(d.x,d.y,G),g=u.localToLocal(h.x,h.y,G);t.bt(p.x,p.y,f.x,f.y,g.x,g.y),e=r.localToLocal(a.x,a.y,G);var m=r.localToLocal(s.x,s.y,G);n.mt(e.x,e.y).lt(m.x,m.y),n.mt(e.x,e.y).lt(p.x,p.y)}t.cp(),t.append(L.colorCommand),b&&t.append(L.borderDashedCommand),L.borderWidthCommand&&t.append(L.borderWidthCommand),L.borderColorCommand&&t.append(L.borderColorCommand)})(),$.on("mousedown",function(e){if(!L.lockControls){if(L.selectPoints&&(L.keyFocus=!0),pe={x:e.target.x,y:e.target.y},e.target.rect1)(n=e.target).startX=n.x,n.startY=n.y,n.rect1.startX=n.rect1.x,n.rect1.startY=n.rect1.y,n.rect2.startX=n.rect2.x,n.rect2.startY=n.rect2.y;else{var t=e.target;t.startX=t.x,t.startY=t.y;var n,i=(n=t.ball).index,o=u;if(c(Y[i][4])||(o=Y[i][4]),"straight"==o){var r=t.other,a=r.y-n.y;r.stickLength=Math.sqrt(Math.pow(r.x-n.x,2)+Math.pow(a,2))}}if(L.selectPoints){var s=L.selectionManager.currentSet;if(s&&s.selections&&0<s.selections.length)for(var l=0;l<s.selections.length;l++){var h=L.pointObjects[s.selections[l]];h[1].startX=h[1].x,h[1].startY=h[1].y,h[2].startX=h[2].x,h[2].startY=h[2].y,h[3].startX=h[3].x,h[3].startY=h[3].y}}}}),L.selectPoints&&$.tap(function(e){if(e.target.rect1){var t=e.target;L.selectedBalls.toggle(t.parent.num)}else{var n=e.target;n.color="white",(t=n.ball).rect1==n?L.selectedRect1s.toggle(t.parent.num):L.selectedRect2s.toggle(t.parent.num)}for(var i=0;i<L.pointObjects.length;i++){var o=L.pointObjects[i];o[1].color=L.selectedBalls.isSelected(i)?a.white:a.light,o[2].color=L.selectedRect1s.isSelected(i)?a.white:ye(o[4]),o[3].color=L.selectedRect2s.isSelected(i)?a.white:ye(o[4])}e.target.stage.update()}),$.on("pressmove",function(e){if(!L.lockControls)if(L.selectPoints){var t=se();if(-1==t.indexOf(e.target))Z(e.target),J();else if(0<t.length){diffX=e.target.x-e.target.startX,diffY=e.target.y-e.target.startY;for(var n=0;n<t.length;n++){var i=t[n];i.x=i.startX+diffX,i.y=i.startY+diffY,Z(i)}J()}}else Z(e.target),J()}),$.on("pressup",function(e){if(!L.lockControls){var t=e.target.x!=pe.x||e.target.y!=pe.y,n=new createjs.Event("change");e.target.rect1?(n.controlType="bezierPoint",function(e){if(L.selectPoints){var t=se();if(t&&-1==t.indexOf(e))le(e);else if(t&&0<t.length)for(var n=0;n<t.length;n++)le(t[n]);else le(e)}else le(e)}(e.target)):n.controlType="bezierHandle",t&&L.dispatchEvent(n)}}),L.changeControl=function(e,t,n,i,o,r,a,s,l){var u;if(u=m(L.changeControl,arguments,"index, type, rect1X, rect1Y, rect2X, rect2Y, circleX, circleY, update"))return u;if(c(e)){for(var h=0;h<Y.length;h++)L.changeControl(h,t,n,i,o,r,a,s);return L}var d=Y[e];return"none"==(d[4]=t)?(c(a)||(d[1].x=a),c(s)||(d[1].y=s),d[2].x=d[1].x,d[2].y=d[1].y,d[3].x=d[1].x,d[3].y=d[1].y,d[1].parent.addChild(d[1])):(c(a)||(d[1].x=a),c(s)||(d[1].y=s),c(n)||(d[2].x=n),c(i)||(d[2].y=i),c(o)||(d[3].x=o),c(r)||(d[3].y=r),d[1].parent.addChildAt(d[1],0)),d[2].color=ye(t),d[3].color=ye(t),l&&(L.update(),L.stage&&L.stage.update()),L},L.transformPoints=function(e,t,n,i){return L.points=a.transformPoints(L.points,e,t,n,i),L},L.traverse=function(e,t,n,i){var o=a.copy(L.segmentRatios);o.unshift(0),c(n)&&(n=t+1);var r=t<n;if(r)var s=100*o[t],l=100*o[n];else s=50+(100-100*o[t])/2,l=50+(100-100*o[n])/2;return e.percentComplete=s,e.animate({ease:"linear",props:{path:L},rewind:!r,time:i,events:!0}),e.on("animation",function(t){if(e.percentComplete>l||0==e.percentComplete){e.stopAnimate(),t.remove();var n=new createjs.Event("traversed");n.obj=e,L.dispatchEvent(n)}}),L},L.update=function(e){return e?L.points=L.pointsAdjusted:J(),L},L.move&&L.interactive&&G.drag({onTop:!1}),H=G.on("mousedown",function(){pe={x:G.x,y:G.y},L.selectPoints&&(L.keyFocus=!0),function(){if(L.onTop){var e=L.parent.numChildren-1;"Keyboard"==L.parent.getChildAt(e).type&&e--,L.parent.setChildIndex(L,e)}}()}),K=G.on("pressmove",function(){$.x=G.x,$.y=G.y,e.x=G.x,e.y=G.y}),q=G.on("pressup",function(){var t=G.x!=pe.x||G.y!=pe.y,n=G.localToLocal(0,0,L.parent);if(L.x=n.x,L.y=n.y,$.x=$.y=e.x=e.y=G.x=G.y=0,t){var i=new createjs.Event("change");i.controlType="move",L.dispatchEvent(i)}L.stage.update()}),y||ue(!0),L.toggleEvent=L.on("mousedown",function(){L.allowToggle&&(D||(L.showControls(),L.dispatchEvent("controlsshow")))}),L.added(function(){L.toggleStageEvent=L.stage.on("stagemousedown",function(e){L.allowToggle&&L.stage&&D&&!L.hitTestPoint(e.stageX/e.target.stage.scaleX,e.stageY/e.target.stage.scaleY,!1)&&(L.hideControls(),L.dispatchEvent("controlshide"))})}),L.clickEvent=L.on("click",function(){L.ctrlKey&&setTimeout(function(){L.clone(!0).addTo(L.stage).mov(100),L.allowToggle&&(L.hideControls(),L.dispatchEvent("controlshide"));var e=new createjs.Event("change");e.controlType="move",L.dispatchEvent(e),L.stage.update()},50)}),L.hideControls=function(){return L.toggled=!1,$.visible=!1,e.visible=!1,D=!1,L.stage&&L.stage.update(),!L.allowToggle&&L.move&&ue(),L},D||L.hideControls(),L.showControls=function(){return L.toggled=!0,$.visible=!0,e.visible=!0,D=!0,$.x=G.x,$.y=G.y,e.x=G.x,e.y=G.y,L.addChildAt(G,0),L.move&&!L.allowToggle&&ce(),L.stage&&L.stage.update(),L},L.toggle=function(e){return!0===e?L.showControls():!1===e?L.hideControls():D?L.hideControls():L.showControls(),L},L.recordData=function(e){c(e)&&(e=!1);var t={type:"Blob",index:L.parent?L.parent.getChildIndex(L):-1,x:L.x,y:L.y,points:L.recordPoints(),color:L.color,borderColor:L.borderColor,borderWidth:L.borderWidth,move:L.move,toggle:L.allowToggle,controlsVisible:D};return e?JSON.stringify(t):t},L.setData=function(e,t){if(!c(e)){if(t)try{e=JSON.parse(e)}catch(e){return}var n=e.index;c(n)&&(n=-1),delete e.index;var i=e.points;for(var o in c(i)||L.setPoints(i),delete e.points,this.num=i.length,e)L[o]=e[o];return L.parent&&L.parent.setChildIndex(L,n),L}},L.recordPoints=function(e){c(e)&&(e=!1);var t=L.points;if(e){if(!n){var n=L.pane=new a.Pane({displayClose:!1,container:L.stage,width:Math.min(500,L.stage.width-20),height:Math.min(500,L.stage.height-20),draggable:!0}),i=L.textArea=new a.TextArea(Math.min(400,L.stage.width-70),Math.min(400,L.stage.height-70));i.centerReg(n)}i.text=JSON.stringify(t),n.show()}return t},!(L.setPoints=function(e){for(var t,n,i=0;i<e.length;i++)n=e[i],c(t=Y[i])||(t[0].x=n[0],t[0].y=n[1],t[1].x=n[2],t[1].y=n[3],t[2].x=n[4],t[2].y=n[5],t[3].x=n[6],t[3].y=n[7],t[4]=n[8],t[2].color=ye(t[4]),t[3].color=ye(t[4]));return L.update(),L})!==S&&P(L,B),L.clone=function(e){var t=L.cloneProps(new a.Blob(e?L.colorCommand:L.color,e?L.borderColorCommand:L.borderColor,L.borderWidth,L.recordPoints(),s,l,u,h,$.visible,p,f,L.allowToggle,L.move,b,v,w,x,k,L.editPoints,O,A,S,L.group,E));return L.linearGradientParams&&t.linearGradient.apply(t,L.linearGradientParams),L.radialGradientParams&&t.radialGradient.apply(t,L.linearGradientParams),t},L.shapeMousedownEvent=L.shape.on("mousedown",function(e){U=e.target.stage,L.editPoints&&(L.controlsVisible?(L.pressX=e.stageX/U.scaleX,L.pressY=e.stageY/U.scaleY):(L.pressX=null,L.pressY=null))}),L.addPointFactor=20,L.addMinDistance=15,L.shapePressupEvent=L.shape.on("pressup",function(e){if(L.editPoints&&L.pressX&&Math.abs(L.pressX-e.stageX/U.scaleX)<ie&&Math.abs(L.pressY-e.stageY/U.scaleY)<ie){L.selectPoints&&(L.lastPoints=a.copy(L.points));var t=L.points,n=L.globalToLocal(e.stageX/U.scaleX,e.stageY/U.scaleY),i=a.closestPointAlongCurve(n,L.segmentPoints);if("anywhere"==L.editPoints)t.splice(i+1,0,[n.x,n.y,0,0,0,0,0,0]),L.points=t,L.changeControl({index:i+1,type:"mirror",update:!0});else{var o,r=L.pointsAdjusted,s=L.getSegmentPoint(r[i],r[(i+1)%r.length]),l=a.distanceAlongCurve(s),c=Math.round(l/L.addPointFactor),u=L.interpolate(c,i,!1,t),h=1e4;if(a.loop(u,function(e,t){if(0!=t){var i=a.dist(e,n);i<h&&(h=i,o=t)}}),h<L.addMinDistance){var d=L.segmentRatios,p=0<i?d[i-1]:0;L.addPoint(100*(p+o/c*(d[i]-p)))}}L.lastSelectedIndex=i+1,L.lastSelected=L.controls.getChildAt(L.lastSelectedIndex),L.stage.update()}}),L.controlsClickEvent=L.controls.on("click",function(e){L.lastSelected=e.target.parent;var t=L.lastSelectedIndex=L.controls.getChildIndex(e.target.parent);if(L.editPoints&&L.selectionManager.shiftKey&&"Circle"==e.target.type){if(L.controls.numChildren<=2)return;var n=L.points;L.selectPoints&&(L.lastPoints=a.copy(n)),n.splice(t,1),L.points=n,L.stage.update()}}),D||L.hideControls(),L.dispatchEvent("update")}function ge(e){fe?(e.preventDefault(),me(e)):(fe=!0,setTimeout(function(){fe=!1},300))}function me(e){if(!L.lockControlType){var t=e.target,n=Y[t.index][4]?Y[t.index][4]:u;Math.abs(t.rect1.x)<=2&&Math.abs(t.rect1.y)<=2&&Math.abs(t.rect2.x)<=2&&Math.abs(t.rect2.y)<=2&&(n="none"),"none"==n&&t.parent.addChildAt(t,0),"none"==(n=L.types[(L.types.indexOf(n)+(L.shiftKey?-1:1)+L.types.length)%L.types.length])&&(t.rect1.x=t.rect1.y=t.rect2.x=t.rect2.y=0,t.parent.addChild(t),e.stopImmediatePropagation()),Y[t.index][4]=n,t.rect1.color=ye(n),t.rect2.color=ye(n),J();var i=new createjs.Event("change");i.controlType="bezierSwitch",L.dispatchEvent(i),t.stage.update()}}function ye(e){var t={mirror:a.purple,free:a.yellow,none:a.blue};return t[e]?t[e]:a.pink}}function se(){var e=[],t=L.selectionManager.currentSet;if(t&&t.selections&&0<t.selections.length)for(var n=0;n<t.selections.length;n++){var i=L.pointObjects[t.selections[n]];if(t==L.selectedBalls)e.push(i[1]);else if(t==L.selectedRect1s)e.push(i[2]);else{if(t!=L.selectedRect2s)continue;e.push(i[3])}}return e}function le(e){if(L.selectPoints&&"Circle"==e.type){var t=e,n=t.mySet,i=t.rect1,o=t.rect2;i.x-=t.x,i.y-=t.y,o.x-=t.x,o.y-=t.y,n.x+=t.x,n.y+=t.y,t.x=0,t.y=0}}function ce(){"always"!=L.move&&(ne||(ne=!0,G.drag({onTop:!1}),H=G.on("mousedown",H),K=G.on("pressmove",K),q=G.on("pressup",q)))}function ue(e){"always"!=L.move&&(e||ne)&&(ne=!1,G.noDrag(),G.off("mousedown",H),G.off("pressmove",K),G.off("pressup",q))}_&&"number"!=typeof r&&loop(r,function(e){"none"==(e[8]=_)&&(e[4]=e[5]=e[6]=e[7]=0)}),ae(),L.selectionManager.on("keydown",function(e){if(L.selectPoints&&L.keyFocus&&37<=e.keyCode&&e.keyCode<=40){var t=se();if(0<t.length){for(var n=0;n<t.length;n++){var i=t[n];37==e.keyCode?i.x-=L.selectionManager.shiftKey?10:1:39==e.keyCode?i.x+=L.selectionManager.shiftKey?10:1:38==e.keyCode?i.y-=L.selectionManager.shiftKey?10:1:40==e.keyCode&&(i.y+=L.selectionManager.shiftKey?10:1),Z(i)}J(),L.stage&&L.stage.update()}}}),L.selectionManager.on("keyup",function(e){if(L.selectPoints&&L.keyFocus&&37<=e.keyCode&&e.keyCode<=40){var t=se();if(0<t.length)for(var n=0;n<t.length;n++)le(t[n])}}),L.selectionManager.on("undo",function(){if(L.selectPoints&&L.keyFocus&&L.lastPoints){var e=a.copy(L.lastPoints);L.lastPoints=a.copy(L.points),L.points=e,L.stage&&L.stage.update()}}),Z=function(e){if(!L.lockControls)if(e.rect1){var t=(i=e).x-i.startX,n=i.y-i.startY;i.rect1.x=i.rect1.startX+t,i.rect1.y=i.rect1.startY+n,i.rect2.x=i.rect2.startX+t,i.rect2.y=i.rect2.startY+n}else{var i,o=e,r=o.other,a=(i=o.ball).index,s=u;if(c(Y[a][4])||(s=Y[a][4]),"straight"==s||"mirror"==s){var l=o.x-i.x,h=o.y-i.y;if("mirror"==s)r.x=i.x-l,r.y=i.y-h;else{var d=Math.atan2(h,l),p=-r.stickLength*Math.cos(d+Math.PI),f=-r.stickLength*Math.sin(d+Math.PI);r.x=i.x-p,r.y=i.y-f}}}},Object.defineProperty(L,"move",{get:function(){return y},set:function(e){y!=e&&((y=e)?ce():ue())}}),Object.defineProperty(L,"interactive",{get:function(){return O},set:function(e){L.showControls=O=e,L.allowToggle=O,L.editPoints=O,L.lockControls=!O,L.selectPoints=O,L.move=O,L.points=L.points}}),Object.defineProperty(L,"allowToggle",{get:function(){return g},set:function(e){g!=e&&((g=e)?L.move&&ce():!D&&L.move&&ue())}}),Object.defineProperty(L,"controlsVisible",{get:function(){return D},set:function(e){(D=e)?L.showControls():L.hideControls()}});var he,de,pe=p;Object.defineProperty(L,"lockControls",{get:function(){return pe},set:function(e){(pe=e)?(L.controls.mouseChildren=!1,L.controls.mouseEnabled=!1):(L.controls.mouseChildren=!0,L.controls.mouseEnabled=!0)}}),L.lockControls=pe,Object.defineProperty(L,"color",{get:function(){return Q},set:function(e){c(e)&&(e="black"),W.style=Q=e}}),this.setColorRange=function(e,t){return de=c(t)?(he=L.color,e):(he=c(e)?L.color:e,t),L};var fe=0;function ge(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}}function me(e,t,n,i,o,r,s){var l=e.length-1,c=0,u=0;100==i&&"Squiggle"==L.type&&(i=99.99),i=(i+1e5)%100,a.loop(n,function(e,t){if(i/100<e)return l=t,u=e,!0;c=e});var h=L.segmentPoints[l],d=0<u?(i/100-c)/(u-c):0,p=a.pointAlongCurve(h,d),f=[p.x,p.y,0,0];if(!r)if(s)L.interpolatedPoints.push({x:p.x,y:p.y,r:i/100});else{if("none"!=o){var g=ge(h[0],h[1],d),m=ge(h[1],h[2],d),y=ge(h[2],h[3],d),b=ge(g,m,d),v=ge(m,y,d);f[4]=b.x-p.x,f[5]=b.y-p.y,f[6]=v.x-p.x,f[7]=v.y-p.y;var w=L.localToLocal(g.x,g.y,t[l]);e[l][6]=w.x,e[l][7]=w.y;var x=L.localToLocal(y.x,y.y,t[(l+1)%e.length]);e[(l+1)%e.length][4]=x.x,e[(l+1)%e.length][5]=x.y}o&&(f[8]=o),e.splice(l+1,0,f)}}Object.defineProperty(L,"colorRange",{get:function(){return fe},set:function(e){fe=e,c(he)||c(de)||(L.color=a.colorRange(he,de,e))}}),Object.defineProperty(L,"borderColor",{get:function(){return ee},set:function(e){c(e)||(ee=e,F?F.style=ee:J())}}),Object.defineProperty(L,"borderWidth",{get:function(){return te},set:function(e){c(e)||(0<e||(e=0),te=e,V&&0!=te?(V.width=te,b&&(N.segments=[20,10],N.offset=5)):J())}}),"undefined"!=typeof KEYFOCUS&&(a.KEYFOCUS=KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return a.KEYFOCUS==L},set:function(e){a.KEYFOCUS=L}}),L.selectPoints&&!a.KEYFOCUS&&function(){L.keyFocus=!0;var e=document.activeElement;e&&e.blur()}(),Object.defineProperty(L,"points",{get:function(){for(var e,t,n=[],i=0;i<Y.length;i++)e=[a.decimals((t=Y[i])[0].x),a.decimals(t[0].y),a.decimals(t[1].x),a.decimals(t[1].y),a.decimals(t[2].x),a.decimals(t[2].y),a.decimals(t[3].x),a.decimals(t[3].y)],t[4]&&"straight"!==t[4]&&e.push(t[4]),n.push(e);return n},set:function(e){L.dispose(!0),r=oe(e),L.shape&&(L.shape.graphics.clear(),L.sticks.graphics.clear(),L.controls.noDrag(),L.removeAllChildren(),delete L.shape,delete L.sticks,delete L.controls),ae(),L.lockControls=pe}}),Object.defineProperty(L,"pointsAdjusted",{get:function(){var e,t,n=[],i=L.pointObjects;return a.loop(i.length,function(o,r){if(po=i[o],t=Y[o],0==po[0].rotation&&0==po[0].scaleX&&0==po[0].scaleY)e=[a.decimals(t[0].x),a.decimals(t[0].y),a.decimals(t[1].x),a.decimals(t[1].y),a.decimals(t[2].x),a.decimals(t[2].y),a.decimals(t[3].x),a.decimals(t[3].y)];else{var s=po[0].localToLocal(po[2].x,po[2].y,po[0].parent),l=po[0].localToLocal(po[3].x,po[3].y,po[0].parent);e=[a.decimals(t[0].x),a.decimals(t[0].y),a.decimals(t[1].x),a.decimals(t[1].y),a.decimals(s.x-t[0].x),a.decimals(s.y-t[0].y),a.decimals(l.x-t[0].x),a.decimals(l.y-t[0].y)]}t[4]&&"mirror"!==t[4]&&e.push(t[4]),n.push(e)}),n},set:function(e){n&&i("Blob() - pointsAdjusted is read only")}}),Object.defineProperty(L,"pointObjects",{get:function(){return Y},set:function(e){n&&i("Blob() - pointObjects is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(L,"pointControls",{get:function(){return X},set:function(e){n&&i("Blob() - pointControls is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(L,"pointCircles",{get:function(){return R},set:function(e){n&&i("Blob() - pointCircles is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(L,"segmentPoints",{get:function(){var e=L.pointsAdjusted,t=[];return a.loop(e.length,function(n,i){var o=L.getSegmentPoint(e[n],e[n<i-1?n+1:0]);t.push(o)}),t},set:function(e){n&&i("Blob() - segmentPoints is read only")}}),Object.defineProperty(L,"segmentRatios",{get:function(){var e=[],t=0;a.loop(L.segmentPoints,function(n){var i=a.distanceAlongCurve(n);e.push(i),t+=i});var n=[],i=0;return a.loop(e,function(e){n.push(i+=e/t)}),n},set:function(e){n&&i("Blob() - segmentRatios is read only")}}),L.getPointAngle=function(e){var t=L.pointObjects[e][0],n=L.pointObjects[e][2],i=L.pointObjects[e][3];if(t==L.stage)var o=new a.Point(n.x,n.y),r=new a.Point(i.x,i.y);else o=t.localToGlobal(n.x,n.y),r=t.localToGlobal(i.x,i.y);return a.angle(o.x,o.y,r.x,r.y)},L.getSegmentPoint=function(e,t){if(!c(e)&&!c(t)){0==e[2]&&0==e[3]||(e[4]-=e[2],e[5]-=e[3],e[6]-=e[2],e[7]-=e[3],e[0]+=e[2],e[1]+=e[3],e[2]=0,e[3]=0),0==t[2]&&0==t[3]||(t[4]-=t[2],t[5]-=t[3],t[6]-=t[2],t[7]-=t[3],t[0]+=t[2],t[1]+=t[3],t[2]=0,t[3]=0);var n={x:e[0],y:e[1]},i={x:e[0]+e[6],y:e[1]+e[7]},o={x:t[0]+t[4],y:t[1]+t[5]},r={x:t[0],y:t[1]};return 0==$.x&&0==$.y||(n.x+=$.x,i.x+=$.x,o.x+=$.x,r.x+=$.x,n.y+=$.y,i.y+=$.y,o.y+=$.y,r.y+=$.y),[n,i,o,r]}},L.getAdjacentSegmentData=function(e){c(e)&&(e=0);var t=L.pointsAdjusted;if(2==L.num)return[[L.getSegmentPoint(t[0],t[1]),L.getSegmentPoint(t[1],t[0])],[0,1]];if(0==e)return[[L.getSegmentPoint(t[L.num-1],t[0]),L.getSegmentPoint(t[0],t[1]),L.getSegmentPoint(t[1],t[2])],[L.num-1,0,1]];if(e>=L.num-1)return[[L.getSegmentPoint(t[L.num-2],t[L.num-1]),L.getSegmentPoint(t[L.num-1],t[0]),L.getSegmentPoint(t[0],t[1])],[L.num-2,L.num-1,0]];var n=e+2>=L.num?0:e+2;return[[L.getSegmentPoint(t[e-1],t[e]),L.getSegmentPoint(t[e],t[e+1]),L.getSegmentPoint(t[e+1],t[n])],[e-1,e,e+1]]},L.getCurvePoint=function(e,t,n,i){c(t)&&(t=L.segmentRatios),c(n)&&(n=L.segmentPoints),c(i)&&(i=!1);var o=t,r=n,s=a.loop(o,function(t,n){if(e<=t)return n}),l=a.pointAlongCurve(r[s],(e-(0<s?o[s-1]:0))/(0<s?o[s]-o[s-1]:o[s]),i);if(!c(l)){var u=L.localToGlobal(l.x,l.y);return u.angle=l.angle,u.z=s,c(u)?void 0:u}},this.addPoint=function(e,t){c(e)&&(e=100);var n=L.points;return me(n,L.pointControls,L.segmentRatios,e,t),L.points=n,L.num=n.length,L},this.addPoints=function(e,t,n,i,o,r){c(r)&&(r=a.copy(L.points));var s=a.copy(L.segmentRatios),l=0;if(o&&(L.interpolatedPoints=[]),i)var u=s.length*e;return a.loop(s,function(s,h){o&&me(r,L.pointControls,L.segmentRatios,100*l,t,!c(n)&&h!=n,o);var d=i?Math.round(u*(s-l)):e,p=1/(d+1);a.loop(d,function(i){me(r,L.pointControls,L.segmentRatios,100*(l+(s-l)*p*(i+1)),t,!c(n)&&h!=n,o),!o&&0<e&&(L.points=r)}),l=s}),o&&"Squiggle"==L.type&&me(r,L.pointControls,L.segmentRatios,100,t,null,o),L.stage&&L.stage.update(),L.num=r.length,L},this.interpolate=function(e,t,n,i){return c(e)&&(e=1),L.addPoints(e,"none",t,n,!0,i),L.interpolatedPoints},this.linearGradient=function(e,t,n,i,o,r){return this.linearGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.linearGradient(e,t,n,i,o,r),this},this.radialGradient=function(e,t,n,i,o,r,a,s){return this.radialGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.radialGradient(e,t,n,i,o,r,a,s),this},this.dispose=function(e){if(L.shape){L.shape.cursor="default";for(var t=0;t<L.pointObjects.length;t++)L.pointObjects[t][1].removeAllEventListeners();for(t=0;t<R.length;t++)R[t].removeAllEventListeners();return L.sticks.removeFrom(L),L.controls.removeFrom(L),L.shape.removeAllEventListeners(),L.controls.removeAllEventListeners(),L.off("mousedown",L.toggleEvent),L.off("click",L.clickEvent),L.toggleStageEvent&&L.stage.off("stagemousedown",L.toggleStageEvent),!e&&L.selectPoints&&L.selectionManager.removeAllEventListeners(),!0}}},a.extend(a.Blob,a.Container,["clone","dispose"],"zimContainer",!1),a.Label=function(n,i,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R){var X;if(X=m(a.Label,arguments,"text, size, font, color, rollColor, shadowColor, shadowBlur, align, valign, lineWidth, lineHeight, fontOptions, backing, outlineColor, outlineWidth, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backgroundDashed, padding, paddingHorizontal, paddingVertical, shiftHorizontal, shiftVertical, rollPersist, labelWidth, labelHeight, maxSize, style, group, inherit",this))return X;C("54"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Label",this.group=Y;var W=!1===L?{}:a.getStyle(this.type,this.group,R);c(n)&&(n=null!=W.text?W.text:"LABEL");var F=n;n=a.Pick.choose(n);var V=!1;""===n&&(n=" ",V=!0),c(i)&&(i=null!=W.size?W.size:36),c(o)&&(o=null!=W.font?W.font:"arial"),c(r)&&(r=null!=W.color?W.color:"black"),c(s)&&(s=null!=W.rollColor?W.rollColor:r),!c(l)&&"ignore"!=l||(l=null!=W.shadowColor&&"ignore"!=l?W.shadowColor:-1),!c(u)&&"ignore"!=u||(u=null!=W.shadowBlur&&"ignore"!=u?W.shadowBlur:14),c(h)&&(h=null!=W.align?W.align:"left"),c(d)&&(d=null!=W.valign?W.valign:"top"),c(g)&&(g=null!=W.fontOptions?W.fontOptions:""),c(b)&&c(W.outlineColor)||!c(v)||(v=null!=W.outlineWidth?W.outlineWidth:Math.round(.2*i)),c(v)&&c(W.outlineWidth)||!c(b)||(b=null!=W.outlineColor?W.outlineColor:"#000000"),c(v)&&(v=null!=W.outlineWidth?W.outlineWidth:0),!c(w)&&"ignore"!=w||(w=null!=W.backgroundColor&&"ignore"!=w?W.backgroundColor:null),!c(S)&&"ignore"!=S||(S=null!=W.padding&&"ignore"!=S?W.padding:10),c(I)&&(I=null!=W.paddingHorizontal?W.paddingHorizontal:S),c(E)&&(E=null!=W.paddingVertical?W.paddingVertical:S),c(M)&&(M=null!=W.shiftHorizontal?W.shiftHorizontal:0),c(B)&&(B=null!=W.shiftVertical?W.shiftVertical:0),c(p)&&(p=null!=W.lineWidth?W.lineWidth:null),c(f)&&(f=null!=W.lineHeight?W.lineHeight:null),!c(y)&&"ignore"!=y||(y=null!=W.backing&&"ignore"!=y?W.backing.clone():null),c(z),null!=W.labelWidth&&(p=W.labelWidth),c(j)||(p=j),"middle"==h&&(h="center"),c(D),i=D?Math.min(i,D):i;var N=void 0!==t&&t.retina,G=this;this.mouseChildren=!1,this.paddingVertical=E,this.paddingHorizontal=I;var H=this.label=new createjs.Text(String(n),g+" "+i+"px "+o,r);if(H.textAlign=h,H.lineWidth=p,H.lineHeight=f,H.textBaseline="alphabetic",0<v){var K=this.outlineLabel=H.clone();K.color=b,K.outline=v}-1!=l&&0<u&&(H.shadow=new createjs.Shadow(l,3,3,u)),this.addChild(H);var q,U,Z=!1;if(c(y)&&c(w)){var J=new createjs.Shape;G.hitArea=J}function $(){var e,t=H.getBounds();"baseline"==d?e=t.y:"top"==d?(H.y=i-i/6,!N&&K&&(K.y=i-i/6),e=0):"center"==d||"middle"==d?(e=-t.height/2,H.y=.3*i,!N&&K&&(K.y=.3*i)):e=-t.height,G.setBounds(t.x,e,t.width,t.height),G.hitArea&&G.hitArea.graphics.c().f("black").r(G.getBounds().x,G.getBounds().y,G.getBounds().width,G.getBounds().height),"center"!=d&&"middle"!=d||(a.pos(H,null,0),a.mov(H,0,1)),y?Z&&ee():c(w)||(G.removeChild(G.background),G.background=new a.Rectangle(G.getBounds().width+2*I,G.getBounds().height+2*E,w,k,T,O,A,null,!1),a.center(G.background,G,0),G.setBounds(G.background.x,G.background.y,G.background.width,G.background.height)),"baseline"==d||N||(H.y+=i/32),K&&(N?G.added(function(e){var t=K.getBounds();K.visible=!0;var n=new a.Container(t.x,t.y,t.width,t.height);n.addTo(G),n.addChild(K),n.center(G,G.numChildren-2),"baseline"!=d&&(n.y+=i/16),n.x+=M,n.y+=B,e.update()}):(G.addChild(K),a.center(K,G,G.numChildren-2),"baseline"!=d&&(K.y+=i/32),K.x+=M,K.y+=B,K.visible=!0)),te()}if($(),!c(y)){if("Pattern"==y.type){G.backing=new a.Container(G.width,G.height,null,null,!1).centerReg(null,null,!1),-1!=l&&0<u&&(new a.Rectangle(G.width-2,G.height-2,"#666",null,null,O,null,null,!1).center(G.backing).shadow=new createjs.Shadow(l,3,3,u));var Q=new a.Rectangle(G.width,G.height,w,null,null,O,null,null,!1).addTo(G.backing);y.centerReg(Q),y.setMask(Q),G.backing.pattern=y}else G.backing=y;G.backing.center(G,0),y=G.backing,ee(),Z=!0}function ee(){var e=y.boundsToGlobal(),t=G.boundsToGlobal(e,!0);G.setBounds(t.x,t.y,t.width,t.height)}function te(){a.pos(H,"left"==h||"right"==h?y||G.background?I:0:null,"top"==d||"baseline"==d||"bottom"==d?y||G.background?E:0:null,"right"==h,"bottom"==d),H.x+=M,H.y+=B}te(),Object.defineProperty(G,"text",{get:function(){return" "==H.text&&V?"":H.text},set:function(e){V=!1,""===e&&(e=" ",V=!0),H.text=String(e),K&&(K.text=String(e)),$(),c(p)||c(_)||ie()}}),Object.defineProperty(G,"size",{get:function(){return i},set:function(e){i=D?Math.min(e,D):e;var t=this.label.font.match(/^(.*\s)(\d*\.?\d*)+px(.*)$/i);t&&(this.label.font=t[1]+e+"px"+t[3],K&&(K.font=t[1]+e+"px"+t[3]),$())}}),Object.defineProperty(G,"color",{get:function(){return r},set:function(t){s==r&&(s=t),H.color=r=t,a.OPTIMIZE||!e&&OPTIMIZE||!G.stage||G.stage.update()}}),this.setColorRange=function(e,t){return U=c(t)?(q=G.color,e):(q=c(e)?G.color:e,t),G};var ne=0;function ie(){for(G.size=200;G.height>_||G.width>p;)G.size=G.size/2;for(var e=0;G.height<=_&&G.width<=p&&(e++,G.size=Math.ceil(G.size+1),!(50<e)););G.size=G.size-1}Object.defineProperty(G,"colorRange",{get:function(){return ne},set:function(e){ne=e,c(q)||c(U)||(G.color=a.colorRange(q,U,e))}}),Object.defineProperty(G,"outlineColor",{get:function(){return b},set:function(t){b=t,K&&(K.color=b),a.OPTIMIZE||!e&&OPTIMIZE||!G.stage||G.stage.update()}}),Object.defineProperty(G,"rollColor",{get:function(){return s},set:function(e){s=e}}),this._enabled=!0,Object.defineProperty(G,"enabled",{get:function(){return G._enabled},set:function(t){x(G,t),H.color=r,G.mouseChildren=!1,a.OPTIMIZE||!e&&OPTIMIZE||!G.stage||G.stage.update()}}),this.showRollColor=function(e){return c(e)&&(e=!0),H.color=e?s:r,G.stage&&G.stage.update(),G},this.mouseoverEvent=this.on("mouseover",function(e){G.showRollColor&&G.showRollColor()}),this.mouseoutEvent=this.on("mouseout",function(e){G.rollPersist||G.showRollColor(!1)}),this.pressupEvent=this.on("pressup",function(e){G.rollPersist&&G.showRollColor(!1)}),Object.defineProperty(G,"labelWidth",{get:function(){return p},set:function(t){0<t&&(p=t,G.label.lineWidth=t),_&&ie(),a.OPTIMIZE||!e&&OPTIMIZE||!G.stage||G.stage.update()}}),Object.defineProperty(G,"labelHeight",{get:function(){return _},set:function(t){0<t&&(_=t),p&&ie(),a.OPTIMIZE||!e&&OPTIMIZE||!G.stage||G.stage.update()}}),c(p)||c(_)||ie(),P(this,W),this.clone=function(e){return G.cloneProps(new a.Label(e?G.text:F,i,o,r,s,l,u,h,d,p,f,g,c(y)?null:y.clone(),b,v,w,k,T,O,A,S,I,E,M,B,z,j,_,D,L,this.group,R))}},a.extend(a.Label,a.Container,"clone","zimContainer"),a.LabelOnPath=function(e,t,n,i,o,r,s,l,u,h,d){var p;if(p=m(a.LabelOnPath,arguments,"label, path, percentAngle, percents, showPath, allowToggle, interactive, onTop, style, group, inherit",this))return p;C("54.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="LabelOnPath",this.group=h;var f=!1===u?{}:a.getStyle(this.type,this.group,d);c(e)&&(e=null!=f.label?f.label:new a.Label("Label on Path")),c(t)&&(t=null!=f.path?f.path:new a.Squiggle({points:[[0,0,0,0,-86,57,86,-57],[300,150,0,0,-133,21,133,-21]]})),c(n)&&(n=null!=f.percentAngle?f.percentAngle:100),c(i)&&(i=null!=f.percents?f.percents:null),c(o)&&(o=null==f.showPath||f.showPath),c(r)&&(r=null==f.allowToggle||f.allowToggle),c(s)&&(s=null==f.interactive||f.interactive),c(l)&&(l=null!=f.onTop&&f.onTop),t.addTo(this);var g=this;this.path=t,this.allowToggle=r,t.interactive=s,"string"==typeof e&&(e=new a.Label(e));var y=t.alpha;o||t.alp(0),t.onTop=l;var b=this.letters=(new a.Container).addTo(this);if(!i){i=[];for(var v=0;v<e.text.length;v++)i.push(a.decimals(1/(e.text.length-("Blob"==t.type?0:1))*100*v))}function w(){for(var t=b.numChildren-1;0<=t;t--)b.getChildAt(t).dispose();for(g.numLetters=e.text.length,t=0;t<g.numLetters;t++){var n=e.clone();n.text=e.text[t],n.centerReg(b).reg(null,n.height),""!=n.text&&" "!=n.text&&n.expand(0),g.allowToggle&&(n.cursor="pointer"),n.on("mousedown",function(){g.allowToggle&&g.toggle()})}g.resize()}this.percents=i,this.resize=function(){for(var e=t.segmentRatios,o=t.segmentPoints,r=0;r<this.numLetters;r++){var a=t.getCurvePoint(i[r]/100,e,o,!0);if(a){var s=this.globalToLocal(a.x,a.y);s&&b.getChildAt(r).loc(s).rot((180<a.angle?a.angle-360:a.angle)*n/100)}}return this},w(),this.showPath=function(e){return this.toggle(!0),t.toggle(e),this},this.hidePath=function(){return this.toggle(!1),this},Object.defineProperty(g,"text",{get:function(){return e.text},set:function(n){e.text=n,i=[];for(var o=0;o<e.text.length;o++)i.push(a.decimals(1/(e.text.length-("Blob"==t.type?0:1))*100*o));w()}}),Object.defineProperty(g,"interactive",{get:function(){return s},set:function(e){s=e,t.interactive=e,this.ticker&&a.Ticker.remove(this.ticker),s&&(this.ticker=a.Ticker.add(function(){g.resize()}))}}),this.interactive&&(this.ticker=a.Ticker.add(function(){g.resize()}));var x=g.toggled=o;this.toggle=function(e){if(this.allowToggle)return(x=c(e)?!x:!!e)?(t.alp(y),this.interactive&&(t.showControls(),b.mouseEnabled=!1,b.mouseChildren=!1,b.cursor="default",this.controlHideEvent&&t.off("controlshide",this.controlHideEvent),this.controlHideEvent=t.on("controlshide",function(){b.mouseEnabled=!0,b.mouseChildren=!0,b.cursor="pointer",y=t.alpha,t.alp(0),g.toggled=x=!1},null,!0))):(y=t.alpha,t.alp(0),b.mouseEnabled=!0,b.mouseChildren=!0,b.cursor="pointer"),g.toggled=x,g.stage.update(),g},P(this,f),this.clone=function(){return g.cloneProps(new a.LabelOnPath(g.label.clone(),g.path.clone(),n,a.copy(i),o,r,s,l,u,this.group,d))},this.dispose=function(){return this.ticker&&a.Ticker.remove(this.ticker),this.zimContainer_dispose(),!0}},a.extend(a.LabelOnPath,a.Container,["clone","dispose"],"zimContainer",!1),a.Button=function(t,o,r,s,l,u,h,d,p,f,g,b,v,w,k,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,X,W,F,V,N,G,H,K,q,U,Z,J,$,Q,ee,te,ne,ie){var oe;if(oe=m(a.Button,arguments,"width, height, label, backgroundColor, rollBackgroundColor, color, rollColor, borderColor, borderRollColor, borderWidth, corner, shadowColor, shadowBlur, hitPadding, gradient, gloss, dashed, backing, rollBacking, rollPersist, icon, rollIcon, toggle, toggleBacking, rollToggleBacking, toggleIcon, rollToggleIcon, toggleEvent, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, waitColor, rollWaitColor, waitModal, waitEnabled, waitBacking, rollWaitBacking, waitIcon, rollWaitIcon, align, valign, indent, indentHorizontal, indentVertical, style, group, inherit",this))return oe;C("55"),this.group=ne;var re=!1===te?{}:a.getStyle("Button",ne,ie);c(t)&&(t=null!=re.width?re.width:200),c(o)&&(o=null!=re.height?re.height:60),this.zimContainer_constructor(t,o,null,null,!1),this.type="Button",c(s)&&(s=null!=re.backgroundColor?re.backgroundColor:"#C60"),s=y(s),c(l)&&(l=null!=re.rollBackgroundColor?re.rollBackgroundColor:"#F93"),l=y(l),c(u)&&(u=null!=re.color?re.color:"white"),y(u),c(h)&&(h=null!=re.rollColor?re.rollColor:"white"),y(h),c(X)&&(X=null!=re.waitBackgroundColor?re.waitBackgroundColor:s),c(W)&&(W=null!=re.rollWaitBackgroundColor?re.rollWaitBackgroundColor:l);var ae=d,se=f;c(d)&&(d=null!=re.borderColor?re.borderColor:null),c(f)&&(f=null!=re.borderWidth?re.borderWidth:null),d<0||f<0?d=f=null:null!=d&&null==f&&(f=1),c(p)&&(p=null!=re.borderRollColor?re.borderRollColor:d),c(g)&&(g=null!=re.corner?re.corner:20),c(b)&&(b=null!=re.shadowColor?re.shadowColor:"rgba(0,0,0,.3)"),c(v)&&(v=null!=re.shadowBlur?re.shadowBlur:14),c(w)&&(w=null!=re.hitPadding?re.hitPadding:0),c(Z)&&(Z=null!=re.align?re.align:"center"),c(J)&&(J=null!=re.valign?re.valign:"center"),c($)&&($=null!=re.indent?re.indent:10),c(Q)&&(Q=null!=re.indentHorizontal?re.indentHorizontal:$),c(ee)&&(ee=null!=re.indentVertical?re.indentVertical:$),c(k)&&(k=null!=re.gradient?re.gradient:0),c(T)&&(T=null!=re.gloss?re.gloss:0),c(r)&&(r=c(E)?null!=re.label?re.label:"PRESS":"");var le=(!c(B)||!c(z)||!c(j)||!c(_)||!c(D))&&c(Y)&&c(H)&&c(K);le&&c(L)&&(L=a.mobile()?"mousedown":"click"),"string"!=typeof r&&"number"!=typeof r||(r=new a.Label({text:r,size:null!=re.size?re.size:36,font:null!=re.font?re.font:"arial",color:null!=re.color?re.color:u,rollColor:null!=re.rollColor?re.rollColor:h,align:Z,valign:J,rollPersist:null!=re.rollPersist&&re.rollPersist,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",shiftVertical:null!=re.shiftVertical?re.shiftVertical:0,shiftHorizontal:null!=re.shiftHorizontal?re.shiftHorizontal:0,style:!1,group:this.group})),c(I)&&(I=null!=re.rollPersist&&re.rollPersist),this.rollPersist=I,c(O)&&(O=null!=re.dashed&&re.dashed),c(B)||"Label"!=B.type||n&&i("ZIM Button() - do not pass Label to toggle parameter - just pass a String");var ce=this;this.mouseChildren=!1,this.cursor="pointer",ce.focus=!1,ce.rolled=!1,c(A)&&(A=null!=re.backing?re.backing.clone():null),ce.backing=c(A)?new a.Rectangle(t,o,s,null,null,g,O,null,!1).centerReg(null,null,!1):A,ce.rollBacking=c(S)?null!=re.rollBacking?re.rollBacking.clone():null:S,ce.waitBacking=c(H)?null!=re.waitBacking?re.waitBacking.clone():null:H,ce.rollWaitBacking=c(K)?null!=re.rollWaitBacking?re.rollWaitBacking.clone():null:K,ce.toggleBacking=c(z)?null!=re.toggleBacking?re.toggleBacking.clone():null:z,ce.rollToggleBacking=c(j)?null!=re.rollToggleBacking?re.rollToggleBacking.clone():null:j;for(var ue,he,de=["backing","rollBacking","toggleBacking","rollToggleBacking","waitBacking","rollWaitBacking"],pe=0;pe<de.length;pe++)(he=ce[ue=de[pe]])&&("Pattern"==he.type?he=fe(ue,he):-1!=b&&0<v&&(he.shadow=new createjs.Shadow(b,3,3,v)),he.x=t/2,he.y=o/2);function fe(e,n){ce[e]=new a.Container(t,o,null,null,!1).centerReg(null,null,!1),-1!=b&&0<v&&(new a.Rectangle(t-2,o-2,"#666",null,null,g,null,null,!1).center(ce[e]).shadow=new createjs.Shadow(b,3,3,v));var i=ce[e].mask=new a.Rectangle(t,o,0<=e.indexOf("roll")?l:s,null,null,g,null,null,!1).addTo(ce[e]);return n.centerReg(i),n.setMask(i.shape),ce[e].pattern=n,ce[e]}ce.addChild(ce.backing),f&&(ce.border=new a.Rectangle(t,o,"rgba(0,0,0,0)",d,f,g,O,null,!1),ce.addChild(ce.border)),ce.icon=c(E)?null!=re.icon?re.icon.clone():null:E,ce.rollIcon=c(M)?null!=re.rollIcon?re.rollIcon.clone():null:M,ce.waitIcon=c(q)?null!=re.waitIcon?re.waitIcon.clone():null:q,ce.rollWaitIcon=c(U)?null!=re.rollWaitIcon?re.rollWaitIcon.clone():null:U,ce.toggleIcon=c(_)?null!=re.toggleIcon?re.toggleIcon.clone():null:_,ce.rollToggleIcon=c(D)?null!=re.rollToggleIcon?re.rollToggleIcon.clone():null:D;var ge,me,ye=["icon","rollIcon","toggleIcon","rollToggleIcon","waitIcon","rollWaitIcon"];for(pe=0;pe<ye.length;pe++){var be=ye[pe],ve=ce[be];ve&&(ve.x=t/2,ve.y=o/2)}if(ce.icon&&ce.addChild(ce.icon),Array.isArray(g)||(g=[g,g,g,g]),0<k){var we=new createjs.Shape;we.graphics.lf(["rgba(255,255,255,"+k+")","rgba(0,0,0,"+k+")"],[0,1],0,0,0,o-f),we.graphics.rc(f/2,f/2,t-f,o-f,g[0],g[1],g[2],g[3]),this.addChild(we)}if(0<T){var xe=new createjs.Shape;xe.graphics.f("rgba(255,255,255,"+T+")"),xe.graphics.rc(f/2,f/2,t-f,(o-f)/2,g[0],g[1],0,0),xe.graphics.f("rgba(0,0,0,"+T+")"),xe.graphics.rc(f/2,o/2,t-f,(o-f)/2,0,0,g[2],g[3]),this.addChild(xe)}function Ce(){(me=new createjs.Shape).graphics.f("#000").r(-w,-w,t+2*w,o+2*w),ce.hitArea=ge=me}if(0<w&&Ce(),this.addChild(r),r.center(this),r.y+=1,this.label=r,a.pos(r,"left"==Z||"right"==Z?Q:null,"top"==J||"bottom"==J?ee:null,"right"==Z,"bottom"==J),this.toggled=!1,le){var ke=r.text;this.on(L,function(){ce.toggled=!ce.toggled,Te()})}function Te(){ce.toggled?(c(B)||(ce.text=B),ce.rolled?(ce.rollToggleBacking?De("rollToggleBacking"):ce.toggleBacking&&De("toggleBacking"),ce.rollToggleIcon?De("rollToggleIcon"):ce.toggleIcon&&De("toggleIcon")):(ce.toggleBacking&&De("toggleBacking"),ce.toggleIcon&&De("toggleIcon"))):(ce.text=ke,Pe()),ce.stage&&ce.stage.update()}function Pe(){ce.rolled?(c(A)&&!ce.rollBacking&&(ce.backing.color=l),ce.rollBacking?De("rollBacking"):ce.backing&&De("backing"),De(ce.rollIcon?"rollIcon":"icon")):(c(A)&&(ce.backing.color=s),ce.backing&&De("backing"),De("icon"))}var Oe,Ae,Se,Ie,Ee=!(this.toggle=function(e){return le?(ce.toggled=c(e)?!ce.toggled:e,Te()):n&&i("zim.Button() - can't toggle with wait parameters provided"),ce}),Me=ce.waiting=!1,Be=ce.label.color,ze=ce.label.rollColor,je=this.on("mousedown",function(){Ee=!0,_e()});function _e(){c(Y)&&c(H)&&c(K)||ce.waiting||(Me=!0,c(G)&&(G=!0),N&&(Ie=ce.stage.on("stagemousedown",function(e){ce.hitTestPoint(e.stageX/e.target.stage.scaleX,e.stageY/e.target.stage.scaleY)||ce.clearWait()},null,!0)),setTimeout(function(){ce.waiting=!0},50),Ae=r.text,c(F)||(ce.label.color=F),c(V)||(ce.label.rollColor=V),Se=ce.enabled,!G&&ce.enabled&&(ce.enabled=!1),c(Y)||(ce.text=Y),ce.rolled?(c(A)&&!ce.rollWaitBacking&&(ce.backing.color=W),ce.rollWaitBacking?De("rollWaitBacking"):ce.waitBacking&&De("waitBacking"),ce.rollWaitIcon?De("rollWaitIcon"):ce.waitIcon&&De("waitIcon")):(c(A)&&!ce.waitBacking&&(ce.backing.color=X),ce.waitBacking&&De("waitBacking"),ce.waitIcon&&De("waitIcon")),c(R)&&(R=3e4),Oe&&Oe.clear(),Oe=a.timeout(R,function(){ce.enabled||(ce.enabled=Se),ce.clearWait(),ce.dispatchEvent("waited")}),ce.stage&&ce.stage.update())}function De(e){if(0<=e.indexOf("con")){for(var t=0;t<ye.length;t++)ce.removeChild(ce[ye[t]]);ce[e]&&ce.addChildAt(ce[e],1)}else{if(!ce[e])return;for(t=0;t<de.length;t++)ce.removeChild(ce[de[t]]);ce[e]&&ce.addChildAt(ce[e],0)}}this.wait=function(){_e()},this.clearWait=function(){return Oe&&(Ie&&ce.stage.off("stagemousedown",Ie),Oe.clear(),ce.text=Ae,Pe(),ce.label.color=Be,ce.label.rollColor=ze,setTimeout(function(){ce.waiting=!1},55),Me=!1,ce.stage&&ce.stage.update()),ce},this.removeWait=function(){return ce.clearWait(),Y=null,ce.waitBacking=null,ce.rollWaitBacking=null,ce.off("mousedown",je),ce},this.on("pressup",function(){Ee=!1,ce.rollPersist&&!Le&&Ye()});var Le=!1;function Ye(){ce.rolled=!1,Me||ce.waiting?(c(A)&&c(ce.waitBacking)&&(ce.backing.color=c(X)?s:X),De(ce.waitBacking?"waitBacking":"backing"),De(ce.waitIcon?"waitIcon":"icon")):ce.toggled&&le?(c(A)&&c(ce.toggleBacking)&&(ce.backing.color=s),De(ce.toggleBacking?"toggleBacking":"backing"),De(ce.toggleIcon?"toggleIcon":"icon")):(c(A)?ce.backing.color=s:c(A.mask)||(ce.backing.mask.color=s),De("backing"),De("icon")),ce.border&&(ce.border.borderColor=d),ce.label.showRollColor&&ce.label.showRollColor(!1),ce.stage&&ce.stage.update()}function Re(e,n){return c(e)||(ce.contains(ce[e])&&(ce.removeChild(ce[e]),n&&ce.addChildAt(n,0<=e.indexOf("con")?ce.numChildren-1:0),ce.stage&&ce.stage.update()),n?(c(A)&&"backing"==e&&(A=n),"Pattern"==n.type&&(n=fe(e,n)),ce[e]=n,ce[e].x=t/2,ce[e].y=o/2):ce[e]=null),ce}this.on("mouseover",function(e){ce.rolled=!0,Le=!0,Me?(c(A)&&c(ce.rollWaitBacking)&&(ce.backing.color=c(W)?l:W),De("rollWaitBacking"),ce.rollWaitIcon&&De("rollWaitIcon")):le&&ce.toggled?(c(A)&&c(ce.rollToggleBacking)&&(ce.backing.color=l),De("rollToggleBacking"),ce.rollToggleIcon&&De("rollToggleIcon")):(c(A)?ce.backing.color=l:c(A.mask)||(ce.backing.mask.color=l),De("rollBacking"),ce.rollIcon&&De("rollIcon")),ce.border&&(ce.border.borderColor=p),ce.label.showRollColor&&ce.label.showRollColor(),ce.stage&&ce.stage.update()}),this.on("mouseout",function e(t){Le=!1,ce.off("mouseout",e),ce.rollPersist&&Ee||Ye()}),Object.defineProperty(ce,"text",{get:function(){return" "==r.text?"":r.text},set:function(e){r.text=e,r.center(this),r.y+=1}}),Object.defineProperty(ce,"color",{get:function(){return u},set:function(t){u=t,ce.label&&!c(ce.label.color)&&(ce.label.color=u),a.OPTIMIZE||!e&&OPTIMIZE||!ce.stage||ce.stage.update()}}),Object.defineProperty(ce,"rollColor",{get:function(){return h},set:function(e){h=e,ce.label&&(ce.label.rollColor=h)}}),Object.defineProperty(ce,"backgroundColor",{get:function(){return s},set:function(t){s=t,ce.backing.color?ce.backing.color=s:ce.backing.mask&&(ce.backing.mask.color=s),a.OPTIMIZE||!e&&OPTIMIZE||!ce.stage||ce.stage.update()}}),Object.defineProperty(ce,"rollBackgroundColor",{get:function(){return l},set:function(e){l=e,ce.rollBacking&&ce.rollBacking.color?ce.rollBacking.color=l:ce.rollBacking&&ce.rollBacking.mask&&(ce.rollBacking.mask.color=l)}}),Object.defineProperty(ce,"borderColor",{get:function(){return d},set:function(e){d=e,ce.rolled||(ce.backing&&ce.backing.borderColor&&(ce.backing.borderColor=e),ce.border&&(ce.border.borderColor=e))}}),Object.defineProperty(ce,"borderRollColor",{get:function(){return p},set:function(e){p=e,ce.rolled&&(ce.backing&&ce.backing.borderColor&&(ce.backing.borderColor=e),ce.border&&(ce.border.borderColor=e))}}),Object.defineProperty(ce,"hitPadding",{get:function(){return w},set:function(e){0==(w=e)?ge&&(this.hitArea=null):Ce()}}),this._enabled=!0,this.startMouseChildren=this.mouseChildren,Object.defineProperty(ce,"enabled",{get:function(){return ce._enabled},set:function(t){ce._enabled&&(ce.startMouseChildren=ce.mouseChildren),t?(x(ce,t),ce.mouseChildren=ce.startMouseChildren):(Ye(),x(ce,t)),r.color=r.color,a.OPTIMIZE||!e&&OPTIMIZE||!ce.stage||ce.stage.update()}}),this.setBacking=function(e,t){Re(e,t)},!(this.setIcon=function(e,t){Re(e,t)})!==te&&!1!==te&&P(this,re),this.clone=function(){var e=new a.Button(t,o,r.clone(),s,l,u,h,ae,p,se,g,b,v,w,k,T,O,c(A)?null:ce.backing.clone(),c(S)?null:ce.rollBacking.clone(),I,c(E)?null:E.clone(),c(M)?null:M.clone(),B,c(z)?null:z.clone(),c(j)?null:j.clone(),c(_)?null:_.clone(),c(D)?null:D.clone(),L,Y,R,X,W,F,V,N,G,c(H)?null:H.clone(),c(K)?null:K.clone(),c(q)?null:q.clone(),c(U)?null:U.clone(),Z,J,$,Q,ee,te,this.group);return ce.cloneProps(e)}},a.extend(a.Button,a.Container,"clone","zimContainer",!1),a.CheckBox=function(t,n,o,r,s,l,u,h,d,p,f,y,b,v,w){var k;if(k=m(a.CheckBox,arguments,"size, label, startChecked, color, backgroundColor, borderColor, borderWidth, corner, margin, indicatorType, indicatorColor, tap, style, group, inherit",this))return k;C("56"),this.zimContainer_constructor(null,null,null,null,!1),this.type="CheckBox",this.group=v;var T=!1===b?{}:a.getStyle(this.type,this.group,w);c(t)&&(t=null!=T.size?T.size:60),c(n)&&(n=null!=T.label?T.label:null),c(o)&&(o=null!=T.startChecked&&T.startChecked);var O=o;c(r)&&(r=null!=T.color?T.color:"#111"),c(s)&&(s=null!=T.backgroundColor?T.backgroundColor:"rgba(255,255,255,.8)"),c(l)&&(l=null!=T.borderColor?T.borderColor:"#111"),c(u)&&(u=null!=T.borderWidth?T.borderWidth:t/10),l<0||u<0?l=u=null:null!=l&&null==u&&(u=t/10),c(h)&&(h=null!=T.corner?T.corner:0),"string"!=typeof n&&"number"!=typeof n||(n=new a.Label({text:n,size:5*t/6,color:r,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),c(d)&&(d=null!=T.margin?T.margin:t/5),"box"!=p&&"square"!=p&&"x"!=p&&(p=null!=T.indicatorType?T.indicatorType:"check"),c(f)&&(f=null!=T.indicatorColor?T.indicatorColor:0<u?l:"black"),this.setBounds(-d,-d,t+2*d,t+2*d),c(y)&&(y=null!=T.tap&&T.tap);var A=this;this.cursor="pointer";var S=new a.Rectangle(t,t,s,null,null,h),I=new a.Rectangle(5*t/7,5*t/7,"rgba(0,0,0,0)",l,u,h);I.x=t/7,I.y=t/7,this.addChild(S,I);var E=t;n&&(n.center(A),n.x=A.getBounds().width,this.label=n,this.setBounds(-d,-d,t+3*d+n.getBounds().width,Math.max(t+2*d,n.getBounds().height)),E=n.x+n.width);var M=new a.Shape({style:!1});g=M.graphics,g.f("rgba(0,0,0,.01)").r(this.getBounds().x,this.getBounds().y,E+2*d,this.getBounds().height),this.hitArea=M;var B=new a.Shape({style:!1}),z=B.graphics;"check"==p?z.f(f).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg"):"box"==p||"square"==p?z.f(f).dr(-35,-35,70,70):z.f(f).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),B.setBounds(-47.5,-47.5,95,95);var j=t/161;function _(e){A.setChecked(O=!O),A.dispatchEvent("change")}B.scaleX=B.scaleY=j,B.alpha=.9,B.x=t/2,B.y=t/2,O&&this.addChild(B),y?this.tap(_):this.on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",_),Object.defineProperty(A,"checked",{get:function(){return O},set:function(e){A.setChecked(e)}}),this.toggle=function(e){c(e)&&(e=!O),A.setChecked(e)},Object.defineProperty(A,"toggled",{get:function(){return O},set:function(e){A.setChecked(e)}}),Object.defineProperty(A,"text",{get:function(){if(n)return n.text},set:function(t){n&&(n.text=t,a.OPTIMIZE||!e&&OPTIMIZE||!A.stage||A.stage.update())}}),Object.defineProperty(B,"indicatorColor",{get:function(){return f},set:function(n){O&&A.removeChild(B),B=new createjs.Shape,(z=B.graphics).f(f=n).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg"),B.scaleX=B.scaleY=j,B.alpha=.9,B.x=t/2,B.y=t/2,O&&A.addChild(B),a.OPTIMIZE||!e&&OPTIMIZE||!A.stage||A.stage.update()}}),Object.defineProperty(A,"indicator",{get:function(){return B},set:function(e){i("ZIM CheckBox - check is read only")}}),this._enabled=!0,Object.defineProperty(A,"enabled",{get:function(){return A._enabled},set:function(e){x(A,e)}}),!(this.setChecked=function(t){return c(t)&&(t=!0),(O=t)?A.addChild(B):A.removeChild(B),a.OPTIMIZE||!e&&OPTIMIZE||!A.stage||A.stage.update(),A})!==b&&P(this,T),this.clone=function(){return A.cloneProps(new a.CheckBox(t,n?n.clone():"",o,r,s,l,u,h,d,p,f,y,b,this.group,w))}},a.extend(a.CheckBox,a.Container,"clone","zimContainer",!1),a.RadioButtons=function(t,n,o,r,s,l,u,h,d,p,f,g,y,b){var v;if(v=m(a.RadioButtons,arguments,"size, buttons, vertical, color, backgroundColor, borderColor, borderWidth, spacing, margin, always, indicatorColor, style, group, inherit",this))return v;C("57"),this.zimContainer_constructor(null,null,null,null,!1),this.type="RadioButtons",this.group=y;var w=!1===g?{}:a.getStyle(this.type,this.group,b);c(t)&&(t=null!=w.size?w.size:60),t=Math.max(5,t),c(n)&&(n=null!=w.buttons?w.buttons:["A","B","C"]),c(o)&&(o=null==w.vertical||w.vertical),c(r)&&(r=null!=w.color?w.color:"#111"),c(s)&&(s=null!=w.backgroundColor?w.backgroundColor:"rgba(255,255,255,.8)"),c(l)&&(l=null!=w.borderColor?w.borderColor:"#111"),c(u)&&(u=null!=w.borderWidth?w.borderWidth:t/9),l<0||u<0?l=u=null:null!=l&&null==u&&(u=t/10),c(h)&&(h=o?null!=w.spacing?w.spacing:.2*t:null!=w.spacing?w.spacing:t),c(d)&&(d=null!=w.margin?w.margin:t/5),c(f)&&(f=null!=w.indicatorColor?w.indicatorColor:0<u?l:"black");var k,T=this;if(this.cursor="pointer",this.labels=[],this.indicators=[],"string"==typeof n){var O=n;n=[];for(var A=0;A<O.length;A++)n.push({label:O[A]})}var S=new a.Container({style:!1});function I(e){var t=S.getChildIndex(e.target);p&&T.selectedIndex==t||(T.setSelected(t),T.dispatchEvent("change"))}this.addChild(S),function(){for(var e,i,s=!1,l=n.length-1;0<=l;l--)(e=n[l]).selected&&!0===e.selected&&(s?e.selected="false":(s=!0,T.id=e.id));S.removeAllChildren(),T.buttons=[];var c=0;for(l=0;l<n.length;l++)"string"!=typeof(e=n[l])&&"number"!=typeof e||(e={selected:!1,label:new a.Label({text:e,size:5*t/6,color:null!=w.color?w.color:r,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:T.group})}),(e.label&&"string"==typeof e.label||"number"==typeof e.label)&&(e.label=new a.Label({text:e.label,size:null!=w.size?w.size:5*t/6,color:null!=w.color?w.color:r,valign:"center"})),T.labels.push(e.label),e.index=l,n[l]=e,(i=M(e.selected,e.label)).type="RadioButton",(i.obj=e).selected&&(k=i.obj),S.addChild(i),o?(i.y=c,c+=i.getBounds().height+h):(i.x=c,c+=i.getBounds().width+h)}();for(var E=0;E<S.numChildren;E++)S.getChildAt(E).on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",I);function M(e,n){var i=new a.Container({style:!1});T.buttons.push(i),i.mouseChildren=!1,i.setBounds(-d,-d,t+2*d,t+2*d);var o=new a.Shape({style:!1}),r=o.graphics;r.f(s).dc(t/2,t/2,t/1.85),r.s(l).ss(u).dc(t/2,t/2,t/2-t/2/5),i.addChild(o);var c=i.check=new a.Circle(t/5.2,f,null,null,null,null,null,!1);T.indicators.push(c),c.mouseEnabled=!1,c.alpha=.95,c.regX=c.regY=-t/2;var h=t;n&&(i.addChild(n),n.x=i.getBounds().width,n.y=t/2,i.setBounds(-d,-d,t+2*d+n.getBounds().width,Math.max(t+2*d,n.getBounds().height)),h=n.x+n.width,i.text=n.text),e&&(i.addChild(c),T.label=n,T.label&&(T.text=n.text));var p=new a.Shape({style:!1});return(r=p.graphics).f("rgba(0,0,0,.01)").r(i.getBounds().x,i.getBounds().y,h+2*d,i.getBounds().height),i.hitArea=p,i}this.getBounds()||this.setBounds(0,0,t,t),this.setBounds(-d,-d,this.getBounds().width+2*d,this.getBounds().height),this.setSelected=function(t){if(c(t)&&(t=-1),-1==t||S.getChildAt(t)){for(var n,i=0;i<S.numChildren;i++)(n=S.getChildAt(i)).removeChild(n.check);if(0<=t){n=S.getChildAt(t);var o=-2;k&&(o=k.index),k=n.obj}return-1==t||o==k.index?(k=null,T.id=null,T.label=null,T.text=""):(n.addChild(n.check),T.id=k.id,T.label=k.label,T.label&&(T.text=T.label.text)),a.OPTIMIZE||!e&&OPTIMIZE||!T.stage||T.stage.update(),T}},Object.defineProperty(T,"selected",{get:function(){return k},set:function(e){i("ZIM RadioButton - selected is read only")}}),Object.defineProperty(T,"selectedIndex",{get:function(){return k?k.index:-1},set:function(e){p&&T.selectedIndex==e||T.setSelected(e)}}),this._enabled=!0,Object.defineProperty(T,"enabled",{get:function(){return T._enabled},set:function(e){x(T,e)}}),P(this,w),this.clone=function(){for(var e=a.copy(n),i=0;i<e.length;i++)e[i].label=e[i].label.clone();return T.cloneProps(new a.RadioButtons(t,e,o,r,s,l,u,h,d,p,f,g,this.group,b))}},a.extend(a.RadioButtons,a.Container,"clone","zimContainer",!1),a.Toggle=function(t,n,i,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,O,A,S){var I;if(I=m(a.Toggle,arguments,"width, height, label, startToggled, backgroundColor, margin, indicatorType, indicatorColor, tap, toggleBackgroundColor, color, borderColor, borderWidth, corner, indicatorCorner, shadowColor, shadowBlur, time, labelLeft, style, group, inherit",this))return I;C("57.5"),this.group=A;var E=!1===O?{}:a.getStyle("Toggle",this.group,S);c(t)&&(t=null!=E.width?E.width:80),c(n)&&(n=null!=E.height?E.height:50),this.zimContainer_constructor(t,n,null,null,!1),this.type="Toggle",c(r)&&(r=null!=E.backgroundColor?E.backgroundColor:"#C60"),c(s)&&(s=null!=E.margin?E.margin:10),c(l)&&(l=null!=E.indicatorType?E.indicatorType:"circle"),c(u)&&(u=null!=E.indicatorColor?E.indicatorColor:"#fff"),c(d)&&(d=null!=E.toggleBackgroundColor?E.toggleBackgroundColor:"#F93"),c(p)&&(p=null!=E.color?E.color:"#111"),c(f)&&(f=null!=E.borderColor?E.borderColor:null),c(g)&&(g=null!=E.borderWidth?E.borderWidth:null),f<0||g<0?f=g=null:null!=f&&null==g&&(g=1),c(y)&&(y=null!=E.corner?E.corner:"circle"!=l?0:25),c(b)&&(b=null!=E.indicatorCorner?E.indicatorCorner:0),c(v)&&(v=null!=E.shadowColor?E.shadowColor:"rgba(0,0,0,.3)"),c(w)&&(w=null!=E.shadowBlur?E.shadowBlur:14),c(o)&&(o=null!=E.startToggled&&E.startToggled),c(k)&&(k=null!=E.time?E.time:100);var M=this;function B(e){var t=M.indicator.x,i=k;if(!0===e&&(i=0),M.indicator.pos("rectangle"==l||"square"==l?.2*n:.175*n,null,M.toggled),0<k&&M.indicator.animate({props:{x:t},from:!0,time:i}),M.background.color=M.toggled?d:r,M.text=M.toggled?M.label?M.label.text:"on":M.labelLeft?M.labelLeft.text:"off",M.zimAccessibility){var o="Toggle set to "+(M.toggled?M.label?M.label.text+".":"on.":M.labelLeft?M.labelLeft.text+".":"off.");setTimeout(function(){M.zimAccessibility.talk(o)},50)}}M.cursor="pointer","string"!=typeof i&&"number"!=typeof i||(i=this.label=new a.Label({text:i,size:5*n/6,color:p,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),"string"!=typeof T&&"number"!=typeof T||(T=this.labelLeft=new a.Label({text:T,size:5*n/6,color:p,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),this.background=new a.Rectangle(t,n,r,f,g,y).addTo(this),this.indicator="rectangle"==l||"square"==l?new a.Rectangle(.65*n,.65*n,u,null,null,b).center(this.background).pos(.2*n,null,o):new a.Circle(.35*n,u).center(this.background).pos(.175*n,null,o),this.toggled=o,M.background.color=M.toggled?d:r,-1!=v&&0<w&&(this.background.shadow=new createjs.Shadow(v,3,3,w)),i&&(this.addChild(i),i.x=t+2+s+g,i.y=n/2,this.label=i,this.setBounds(-s,-s,t+3*s+g+i.getBounds().width,Math.max(n+2*s,i.getBounds().height))),T&&(this.addChild(T),T.x=0,M.background.x+=T.width+3+s+g,M.label.x+=T.width+3+s+g,T.y=n/2,this.labelLeft=T,this.setBounds(-s,-s,M.getBounds().width+T.width+3+s+g,M.getBounds().height)),this.expand(a.mobile()?20:10),this.tap(function(e){if(T){var n=M.localToGlobal(T.width+3+s+g+t/2,0);if(e.stageX/M.stage.scaleX<n.x-t/2&&!M.toggled||e.stageX/M.stage.scaleX>=n.x+t/2&&M.toggled)return}M.toggled=!M.toggled,B(),M.dispatchEvent("change")},a.mobile()?20:10),new a.Swipe(this).on("swipe",function(e){0!=e.swipeX&&(1==e.swipeX&&M.toggled||-1==e.swipeX&&!M.toggled||(M.toggled=!M.toggled,B(),M.dispatchEvent("change")))}),Object.defineProperty(M,"textLeft",{get:function(){if(T)return T.text},set:function(t){T&&(T.text=t,a.OPTIMIZE||!e&&OPTIMIZE||!M.stage||M.stage.update())}}),M.toggle=function(e,t){var n=M.toggled;return c(e)&&(e=!0),M.toggled=e,n!=M.toggled&&B(t),M},M.text=M.toggled?M.label?M.label.text:"on":M.labelLeft?M.labelLeft.text:"off",this._enabled=!0,Object.defineProperty(M,"enabled",{get:function(){return M._enabled},set:function(e){x(M,e)}}),!1!==O&&P(this,E),this.clone=function(){return M.cloneProps(new a.Toggle(t,n,i?i.clone():"",o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T?T.clone():"",O,this.group,S))}},a.extend(a.Toggle,a.Container,"clone","zimContainer",!1),a.Tip=function(e,n,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,X,W,F,V,N,G){var H;if(H=m(a.Tip,arguments,"text, align, valign, margin, marginH, marginV, outside, target, size, font, color, rollColor, shadowColor, shadowBlur, textAlign, textValign, lineWidth, lineHeight, fontOptions, backing, outlineColor, outlineWidth, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backgroundDashed, padding, paddingHorizontal, paddingVertical, shiftHorizontal, shiftVertical, rollPersist, labelWidth, labelHeight, maxSize, style, group, inherit",this))return H;C("57.6"),this.group=N;var K=!1===V?{}:a.getStyle("Tip",this.group,G);c(e)&&(e=null!=K.text?K.text:"Here's a tip!"),c(r)&&(r=null!=K.margin?K.margin:40),c(s)&&(s=null!=K.marginH?K.marginH:r),c(l)&&(l=null!=K.marginV?K.marginV:r),c(n)&&(n=null!=K.align?K.align:"right"),c(o)&&(o=null!=K.valign?K.valign:"bottom"),c(u)&&(u=null!=K.outside&&K.outside),c(I)&&(I=null!=K.backgroundColor?K.backgroundColor:blue),c(f)&&(f=null!=K.color?K.color:white),c(B)&&(B=null!=K.corner?K.corner:25),c(B)&&(B=null!=K.corner?K.corner:25),c(B)&&(B=null!=K.corner?K.corner:25),c(_)&&(_=null!=K.paddingHorizontal?K.paddingHorizontal:14+(Array.isArray(B)?B[0]:B)),!c(y)&&"ignore"!=y||(y=null!=K.shadowColor&&"ignore"!=y?K.shadowColor:"rgba(0,0,0,.3)"),!c(b)&&"ignore"!=b||(b=null!=K.shadowBlur&&"ignore"!=b?K.shadowBlur:1),this.zimLabel_constructor(e,d,p,f,g,null,null,v,w,x,k,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,X,W,F,V,N,K),this.type="Tip",u&&(s=-s,l=-l);var q=this;q.align=n,q.valign=o,this.background.sha(y,3,5,b),this.show=function(e,n){c(e)&&(e=null!=K.delay?K.delay:0),c(n)&&(n=null!=K.time?K.time:2e3);var o="zim Tip(): Please pass in a reference to a container with bounds set as parameter to Tip";if(c(h)){if(!t)return i(o),q;h=t.stage}else{if(!h.getBounds)return i(o),q;if(c(h.stage))return i("zim display - Waiter(): The container must have a stage property"),q}function r(){if(h.boundsToGlobal)var e=h.boundsToGlobal();else e=h.getBounds();var t=new Container(e.x,e.y,e.width,e.height);t.zimTemp=!0,t.loc(0,0,h.stage),"center"!=q.align&&"middle"!=q.align&&"center"!=q.valign&&"middle"!=q.valign||q.center(t),q.pos("center"==q.align||"middle"==q.align?null:s,"center"==q.valign||"middle"==q.valign?null:l,"right"==q.align,"bottom"==q.valign,t),u&&("right"==q.align?q.x+=q.width:"left"==q.align&&(q.x-=q.width),"bottom"==q.valign?q.y+=q.height:"top"==q.valign&&(q.y-=q.height)),q.addTo(t.stage),t.zimTemp&&t.removeFrom&&(t.removeFrom(),t=null),t=q.stage,q.timeoutID&&q.timeoutID.clear(),q.timeoutID=a.timeout(n,function(){q.hide(),t.stage.update()}),q.upID&&t.stage.off("stagemouseup",q.upID),q.upID=t.stage.on("stagemouseup",function(){q.hide(),t.stage.update()}),t.stage.update()}return 0<e?q.showID=a.timeout(e,r):r(),q},this.hide=function(){return this.removeFrom(),this.timeoutID&&this.timeoutID.clear(),this.upID&&h.stage&&h.stage.off("stagemouseup",this.downID),q},!(this.clear=function(){q.showID&&q.showID.clear(),q.hide()})!==V&&P(this,K),this.clone=function(){return q.cloneProps(new a.Tip(e,n,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,X,W,F,V,this.group,G))}},a.extend(a.Tip,a.Label,"clone","zimLabel",!1),a.Panel=function(t,n,i,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,O){var A;if(A=m(a.Panel,arguments,"width, height, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, backgroundColor, borderColor, borderWidth, corner, arrow, align, shadowColor, shadowBlur, draggable, boundary, extraButton, style, group, inherit",this))return A;C("57.7"),this.group=T;var S=!1===k?{}:a.getStyle("Panel",this.group,O);c(t)&&(t=null!=S.width?S.width:250),c(n)&&(n=null!=S.height?S.height:300),this.zimContainer_constructor(t,n,null,null,!1),this.type="Panel",c(i)&&(i=null!=S.titleBar?S.titleBar:"PANEL"),c(o)&&(o=null!=S.titleBarColor?S.titleBarColor:"#fff"),c(r)&&(r=null!=S.titleBarBackgroundColor?S.titleBarBackgroundColor:"#555"),c(s)&&(s=null!=S.titleBarHeight?S.titleBarHeight:30),c(l)&&(l=null!=S.backgroundColor?S.backgroundColor:"#eee"),c(u)&&(u=null!=S.borderColor?S.borderColor:"#888"),c(h)&&(h=null!=S.borderWidth?S.borderWidth:null),u<0||h<0?u=h=null:null!=u&&null==h&&(h=1),c(d)&&(d=null!=S.corner?S.corner:5),c(f)&&(f=null!=S.align?S.align:"left"),c(g)&&(g=null!=S.shadowColor?S.shadowColor:"rgba(0,0,0,.3)"),c(y)&&(y=null!=S.shadowBlur?S.shadowBlur:14),c(b)&&(b=null!=S.draggable&&S.draggable),c(v)&&(v=null!=S.boundary?S.boundary:null),c(p)&&(p=null!=S.arrow?S.arrow:a.vee(i)),Array.isArray(d)||(d=[d,d,d,d]);var I=this;this.background=new a.Rectangle(t,n,l,u,h,d).addTo(this),-1!=g&&0<y&&(this.background.shadow=new createjs.Shadow(g,3,3,y));var E=i,M=a.Pick.choose(E),B=a.Pick.choose(o),z=a.Pick.choose(r);a.Pick.choose(l),a.Pick.choose(u),"string"==typeof M&&(M=new a.Label({text:M,color:B,size:null!=S.size?S.size:20,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}));var j=I.titleBarLabel=M;c(z)&&(z="rgba(0,0,0,.2)"),I.titleBar=i=new a.Container(t,s,null,null,!1).loc(0,0,I);var _=I.titleBar.backing=new a.Rectangle(t+h,s,z,null,null,[.95*d[0],.95*d[1],0,0],!0,null,!1).center(i);function D(){"right"==f?j.center(i).pos(Math.max(d[0]/2,10),null,!0):"center"==f||"middle"==f?j.center(i):j.center(i).loc(Math.max(d[0]/2,10))}if(D(),I.label=M,I.text=M.text,this.nextPanel=function(e,t){var n=c(e)||c(E.array)?a.Pick.choose(E):E.array[e],i=c(e)||c(o.array)?a.Pick.choose(o):o.array[e],s=c(e)||c(r.array)?a.Pick.choose(r):r.array[e],h=c(e)||c(l.array)?a.Pick.choose(l):l.array[e],d=c(e)||c(u.array)?a.Pick.choose(u):u.array[e];"string"==typeof n&&(n=new a.Label({text:n,color:i,size:null!=S.size?S.size:20,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),I.label=n,I.text=n.text,j.removeFrom(),j=I.titleBarLabel=n,D(),_.color=s,I.background.color=h,I.background.borderColor=d,t&&I.dispatchEvent("change"),!OPTIMIZE&&I.stage&&I.stage.update()},b&&(i.cursor="pointer",i.on("mousedown",function(){I.drag({rect:v,currentTarget:!0})}),i.on("pressup",function(){I.noDrag()})),0<p){var L=I.arrow=new a.Shape(-20,-20,40,40,null,!1);L.graphics.f(o).p("AiJieIETCeIkTCfg"),L.centerReg(i).scaleTo(i,null,70).alp(.8).hov(1).expand(),"right"==f?L.pos(Math.max(d[1]/2,10)):L.pos(Math.max(d[1]/2,10),null,!0),L.cursor="pointer",L.on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(){I.nextPanel(),I.dispatchEvent("change")})}c(w)||(w=I.extraButton=new a.Button({label:"R",width:50,height:50,group:"PanelExtra"}).scaleTo(i,null,70).centerReg(i).expand()).pos("left"==f?0<p?L.x-L.width-15:Math.max(d[1]/2,10):0<p&&"center"!=f?L.x+L.width:Math.max(d[1]/2,10)),I.overlay=new a.Rectangle(t,n).alp(.7),this._enabled=!0,Object.defineProperty(I,"enabled",{get:function(){return I._enabled},set:function(e){x(I,e),e?I.overlay.removeFrom():I.overlay.addTo(I),!OPTIMIZE&&I.stage&&I.stage.update()}}),!1!==k&&P(this,S),this.clone=function(){return I.cloneProps(new a.Toggle(t,n,i?i.clone():"",o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,this.group,O))}},a.extend(a.Panel,a.Container,"clone","zimContainer",!1),a.Pane=function(n,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,O,A,S,I,E,M,B,z,j,_){var D;if(D=m(a.Pane,arguments,"width, height, label, backgroundColor, color, draggable, resets, modal, corner, backdropColor, shadowColor, shadowBlur, center, displayClose, backdropClose, backing, fadeTime, container, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, close, closeColor, style, group, inherit",this))return D;C("58"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pane";var L="zim display - Pane(): Please pass in a reference to a container with bounds set as first parameter";if(c(O)){if(!t)return void i(L);O=t.stage}else{if(!O.getBounds)return void i(L);if(c(O.getStage))return void i("zim display - Pane(): The container must have a stage property")}this.group=j;var Y=!1===z?{}:a.getStyle(this.type,this.group,_);c(n)&&(n=null!=Y.width?Y.width:200),c(o)&&(o=null!=Y.height?Y.height:200),c(r)&&(r=null!=Y.label?Y.label:null),"string"!=typeof r&&"number"!=typeof r||(r=new a.Label({text:r,size:null!=Y.size?Y.size:40,align:null!=Y.align?Y.align:"center",valign:null!=Y.valign?Y.valign:"center",color:null!=Y.color?Y.color:l,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),c(s)&&(s=null!=Y.backgroundColor?Y.backgroundColor:"white"),c(u)&&(u=null!=Y.draggable&&Y.draggable),c(h)&&(h=null==Y.resets||Y.resets),c(d)&&(d=null==Y.modal||Y.modal),c(p)&&(p=null!=Y.corner?Y.corner:20),c(A)&&(A=null!=Y.titleBar?Y.titleBar:null),c(S)&&(S=null!=Y.titleBarColor?Y.titleBarColor:null),c(I)&&(I=null!=Y.titleBarBackgroundColor?Y.titleBarBackgroundColor:null),c(E)&&(E=null!=Y.titleBarHeight?Y.titleBarHeight:null),c(f)&&(f=null!=Y.backdropColor?Y.backdropColor:"rgba(0,0,0,.2)"),c(g)&&(g=null!=Y.shadowColor?Y.shadowColor:"rgba(0,0,0,.3)"),c(y)&&(y=null!=Y.shadowBlur?Y.shadowBlur:20),c(b)&&(b=null==Y.center||Y.center),c(v)&&(v=null==Y.displayClose||Y.displayClose),u&&(v=!1),c(w)&&(w=null==Y.backdropClose||Y.backdropClose),c(T)&&(T=null!=Y.fadeTime?Y.fadeTime:0),c(M)&&(M=null!=Y.close&&Y.close),c(B)&&(B=null!=Y.closeColor?Y.closeColor:"#555");var R=this.backdrop=new a.Shape({style:!1});R.type="CreateJS_Shape";var X=R.graphics;X.f(f),X.drawRect(-5e3,-5e3,1e4,1e4),this.setBounds(-n/2,-o/2,n,o);var W=this;W.container=O,R.on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",w?q:function(e){e.stopImmediatePropagation()});var F,V,N,G,H,K=new a.Dictionary(!0);function q(e){Z(),W.container.stage.update(),W.dispatchEvent("close"),e.stopImmediatePropagation()}if(R.on("mousedown",function(e){e.stopImmediatePropagation()}),d&&this.addChild(R),c(k))F=this.backing=this.display=new a.Rectangle({width:n,height:o,color:s,corner:p,style:!1});else{if("Pattern"==k.type){var U=k;F=new a.Rectangle(n,o,s,null,null,p,null,null,!1),U.centerReg(F),U.setMask(F.shape)}else F=k;W.display=W.backing=F}function Z(){function t(){var t;W.container.removeChild(W);for(var n=0;n<W.numChildren;n++)if("TextArea"==(t=W.getChildAt(n)).type||"Loader"==t.type||"Tag"==t.type){var i={obj:t,depth:W.getChildIndex(t)};K.add(t,i)}for(n=W.numChildren-1;0<=n;n--)"TextArea"!=(t=W.getChildAt(n)).type&&"Loader"!=t.type&&"Tag"!=t.type||W.removeChild(t);if(a.OPTIMIZE||!e&&OPTIMIZE||W.container.stage.update(),h&&(isNaN(W.resetX)||(W.x=W.resetX),isNaN(W.resetY)||(W.y=W.resetY)),W.zimAccessibility){var o=W.zimAccessibility;o.resize(W),H?H.focus():W.zimTabTag.nextSibling.focus(),setTimeout(function(){o.talk("Pane has been closed.")},50)}}0<T?W.animate({obj:{alpha:0},time:T,call:t}):t()}v&&(F.cursor="pointer",F.on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",q)),-1!=g&&0<y&&(F.shadow=new createjs.Shadow(g,8,8,y)),F.on("click",function(e){e.stopImmediatePropagation()}),u&&(F.cursor="pointer",F.on("mousedown",function(e){G=e.target.stage,isNaN(W.resetX)&&(W.resetX=W.x),isNaN(W.resetY)&&(W.resetY=W.y),V=e.stageX/G.scaleX-W.x,N=e.stageY/G.scaleY-W.y,F.cursor="pointer"}),F.on("pressmove",function(e){var t,i=function(e,t){return{x:e=Math.max(n/2,Math.min(W.container.getBounds().width-n/2,e)),y:t=Math.max(o/2,Math.min(W.container.getBounds().height-o/2,t))}}(e.stageX/G.scaleX-V,e.stageY/G.scaleY-N);W.x=i.x,W.y=i.y;for(var r=0;r<W.numChildren;r++)"TextArea"!=(t=W.getChildAt(r)).type&&"Loader"!=t.type&&"Tag"!=t.type||t.resize();G.update()}),this.on("pressup",function(e){F.cursor="pointer",W.stage&&W.stage.update()})),F.centerReg(this),r&&(this.addChild(r),a.center(r,this),this.label=r,this.text=r.text,r.mouseEnabled=!1),c(A)||("string"==typeof A&&(A=new a.Label(A,null,null,S)),titleBarLabel=W.titleBarLabel=A,c(E)&&(E=1.5*titleBarLabel.height),c(S)&&(S="black"),c(I)&&(I="rgba(0,0,0,.2)"),W.titleBar=A=new a.Container(n,E,null,null,!1).centerReg(W).mov(0,-o/2+E/2),A.mouseEnabled=!1,A.mouseChildren=!1,W.titleBar.backing=new a.Rectangle(n,E,I,null,null,[.95*p,.95*p,0,0],null,null,!1).addTo(A),titleBarLabel.center(A).pos({x:Math.max(p/2,10),reg:!0})),M&&((M=W.close=new a.Shape(-40,-40,80,80,null,!1)).graphics.f(B).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),A?M.addTo(W).scaleTo(A,null,50).mov(n/2-Math.max(p/2,10)-M.width/2,-o/2+E/2).expand(40):M.addTo(W).sca(.3).mov(n/2-M.width-3,-o/2+M.height).expand(40),M.cursor="pointer",M.expand(),M.on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",q)),Object.defineProperty(W,"text",{get:function(){return" "==r.text?"":r.text},set:function(e){r.text=e}}),this._enabled=!0,Object.defineProperty(W,"enabled",{get:function(){return W._enabled},set:function(e){x(W,e)}}),this.hide=function(){return Z(),W.toggled=!1,W},this.show=function(){b&&isNaN(W.resetX)&&(W.x=W.container.getBounds().width/2,W.y=W.container.getBounds().height/2),W.container.addChild(W);for(var e=0;e<K.length;e++)W.addChildAt(K.values[e].obj,K.values[e].depth);if(0<T?(W.alpha=0,W.animate({alpha:1},T)):W.container.stage&&W.container.stage.update(),W.zimAccessibility){var t=W.zimAccessibility;setTimeout(function(){t.activatedObject&&(H=t.activatedObject.zimTabTag)},50),t.resize(W),t.tabIndex=W.zimTabIndex}return W.toggled=!0,W},!(this.toggle=function(e){return!0===e?W.show():!1===e?W.hide():W.container.contains(W)?W.hide():W.show(),W})!==z&&P(this,Y),this.clone=function(){var e=r.x,t=r.y,i=W.cloneProps(new a.Pane(n,o,r.clone(),s,l,u,h,d,p,f,g,y,b,v,w,c(k)?k.clone():null,T,W.container,A,S,I,E,M,B,z,this.group,_));return i.label.x=e,i.label.y=t,i}},a.extend(a.Pane,a.Container,"clone","zimContainer",!1),a.Window=function(t,n,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,X,W,F,V){var N;if(N=m(a.Window,arguments,"width, height, backgroundColor, borderColor, borderWidth, padding, corner, swipe, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, slide, slideDamp, slideSnap, interactive, shadowColor, shadowBlur, paddingHorizontal, paddingVertical, scrollWheel, damp, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, draggable, boundary, close, closeColor, cancelCurrentDrag, style, group, inherit",this))return N;C("58.1"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Window",this.group=F;var G=!1===W?{}:a.getStyle(this.type,this.group,V);c(t)&&(t=null!=G.width?G.width:300),c(n)&&(n=null!=G.height?G.height:200),c(o)&&(o=null!=G.backgroundColor?G.backgroundColor:"#333");var H=r,K=s;c(r)&&(r=null!=G.borderColor?G.borderColor:"#999"),c(s)&&(s=null!=G.borderWidth?G.borderWidth:1),c(l)&&(l=null!=G.padding?G.padding:0),c(u)&&(u=null!=G.corner?G.corner:0),c(h)&&(h=null==G.swipe||G.swipe),c(d)&&(d=null==G.scrollBarActive||G.scrollBarActive),c(p)&&(p=null!=G.scrollBarDrag&&G.scrollBarDrag),c(f)&&(f=null!=G.scrollBarColor?G.scrollBarColor:r),c(g)&&(g=null!=G.scrollBarAlpha?G.scrollBarAlpha:.3),c(y)&&(y=null==G.scrollBarFade||G.scrollBarFade),c(b)&&(b=null==G.scrollBarH||G.scrollBarH),c(v)&&(v=null==G.scrollBarV||G.scrollBarV),p&&(y=null!=G.scrollBarFade&&G.scrollBarFade),c(w)&&(w=null==G.slide||G.slide),c(x)&&(x=null!=G.slideDamp?G.slideDamp:.6),c(k)&&(k=null!=G.slideSnap?G.slideSnap:"vertical"),c(T)&&(T=null==G.interactive||G.interactive),c(O)&&(O=null!=G.shadowColor?G.shadowColor:"rgba(0,0,0,.3)"),c(A)&&(A=null!=G.shadowBlur?G.shadowBlur:20),c(I)&&(I=null!=G.paddingVertical?G.paddingVertical:l),c(S)&&(S=null!=G.paddingHorizontal?G.paddingHorizontal:l),c(E)&&(E=null==G.scrollWheel||G.scrollWheel),c(B)&&(B=null!=G.titleBar?G.titleBar:null),c(z)&&(z=null!=G.titleBarColor?G.titleBarColor:null),c(j)&&(j=null!=G.titleBarBackgroundColor?G.titleBarBackgroundColor:null),c(_)&&(_=null!=G.titleBarHeight?G.titleBarHeight:null),c(D)&&(D=null!=G.draggable?G.draggable:null),c(L)&&(L=null!=G.boundary?G.boundary:null),c(Y)&&(Y=null!=G.close?G.close:null),c(R)&&(R=null!=G.closeColor?G.closeColor:null),c(X)&&(X=null!=G.cancelCurrentDrag&&G.cancelCurrentDrag),!1===B&&(B=null),c(B)||(c(_)&&(_=30),n-=_);var q=this;this.scrollX=this.scrollY=this.scrollXMax=this.scrollYMax=0;var U=this.backing=new a.Shape({style:!1});this.addChild(U);var Z=new createjs.Shape;Z.type="WindowBacking";var J=Z.graphics;this.addChild(Z);var $,Q=this.content=new a.Container({style:!1});if(this.addChild(Q),Q.mask=Z,!T)var ee=new createjs.Shape;if(0<s){var te=new createjs.Shape;this.addChild(te)}var ne=B?0:u;function ie(){q.setBounds(0,0,t,n),U.graphics.c().f(o).rc(0,0,t,n,ne,ne,u,u),-1!=O&&0<A&&(U.shadow=new createjs.Shadow(O,4,4,A)),0<s&&(u?te.graphics.c().s(r).ss(s,"square","miter").rc(0,0,t,n,ne,ne,u,u):te.graphics.c().s(r).ss(s,"square","miter").dr(0,0,t,n))}ie();var oe,re,ae,se,le,ce,ue,he,de,pe=this.scrollBar={};if(pe.color=f,pe.size=6,pe.minSize=2*pe.size,pe.spacing=3.5+s/2,pe.margin=0,pe.corner=pe.size/2,pe.showTime=500,pe.fadeTime=3e3,d){var fe=pe.horizontal=new a.Shape({style:!1}),ge=fe.graphics;fe.alpha=g,this.addChild(fe),p&&fe.drag({localBounds:!0});var me=pe.vertical=new a.Shape({style:!1}),ye=me.graphics;me.alpha=g,this.addChild(me),p&&me.drag({localBounds:!0})}function be(){a.dragBoundary(Q,new createjs.Rectangle(0,0,ae?-q.scrollXMax:0,se?-q.scrollYMax:0))}this.update=function(){d&&(ge.clear(),ye.clear()),le=d?pe.size+2*pe.spacing:0,ce=Q.getBounds()?Q.getBounds().width:0,ue=Q.getBounds()?Q.getBounds().height:0,ae=b&&t-S<ce&&(d||!0===h||"auto"==h||"horizontal"==h),q.scrollXMax=ce+2*S-t+((se=v&&n-I<ue&&(d||!0===h||"auto"==h||"vertical"==h))?le+pe.margin:0),q.scrollYMax=ue+2*I-n+(ae?le+pe.margin:0),J.clear();var e=s/2,i=s/2,o=t-(se&&d?pe.size+2*pe.spacing:0)-(se?0:s),r=n-(ae&&d?pe.size+2*pe.spacing:0)-(ae?0:s);J.f("rgba(0,0,0,0)").rc(e,i,o,r,ne,ne,se&&d?0:u,ae&&d?0:u),Z.setBounds(q.getBounds().x,q.getBounds().y,q.getBounds().width,q.getBounds().height),a.expand(Z,0),T||(ee.graphics.c().f("red").dr(e,i,o,r),Q.hitArea=ee);var l=Math.max(u,Math.min(pe.corner,pe.spacing)),c=l+s/2,f=l+(se?le:0)+s/2,g=l+s/2,m=l+(ae?le:0)+s/2;if(ae&&d&&(scrollBarLength=Math.max(pe.minSize,(t-c-f)*(t-c-f)/(ce+S+pe.margin)),ge.f(pe.color).rr(0,0,scrollBarLength,pe.size,pe.corner),fe.x=c,fe.y=n-pe.size-pe.spacing,oe=new a.Proportion(-q.scrollXMax,0,c,t-scrollBarLength-f,-1),p)){fe.setBounds(0,0,scrollBarLength,pe.size);var y=new createjs.Rectangle(c,fe.y,t-scrollBarLength-c-f,0);fe.dragBoundary(y),fe.proportion=new a.Proportion(y.x,y.x+y.width,0,-q.scrollXMax),fe.off("pressmove",he),he=fe.on("pressmove",function(){q.dispatchEvent("scrolling"),Q.x=fe.proportion.convert(fe.x)})}se&&d&&(scrollBarLength=Math.max(pe.minSize,(n-g-m)*(n-g-m)/(ue+I+pe.margin)),ye.f(pe.color).rr(0,0,pe.size,scrollBarLength,pe.corner),me.x=t-pe.size-pe.spacing,me.y=g,re=new a.Proportion(-q.scrollYMax,0,g,n-scrollBarLength-m,-1),p)&&(me.setBounds(0,0,pe.size,scrollBarLength),y=new createjs.Rectangle(me.x,g,0,n-scrollBarLength-g-m),me.dragBoundary(y),me.proportion=new a.Proportion(y.y,y.y+y.height,0,-q.scrollYMax),me.off("pressmove",de),de=me.on("pressmove",function(){q.dispatchEvent("scrolling"),Le=Q.y=me.proportion.convert(me.y)})),Te(),clearTimeout(q.d2Timeout),q.d2Timeout=setTimeout(function(){fe&&fe.proportion&&(Q.x=fe.proportion.convert(fe.x)),me&&me.proportion&&(Q.y=me.proportion.convert(me.y))},50),clearTimeout(q.dTimeout),q.dTimeout=setTimeout(function(){be()},300)},this.resize=function(e,i){return c(e)&&(e=t),c(i)&&(i=n),t=e,n=i,ie(),q.update(),Le=Q.y,M&&Re.immediate(Le),q},c(B)||(c(D)&&(D=!0),"string"==typeof B&&(B=new a.Label({text:B,color:z,size:null!=G.size?G.size:20,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),titleBarLabel=q.titleBarLabel=B,c(j)&&(j="rgba(0,0,0,.2)"),q.titleBar=B=new a.Container(t,_,null,null,!1).centerReg(q).mov(0,-n/2-_/2),q.titleBar.backing=new a.Rectangle(t+s,_,j,null,null,[.95*u,.95*u,0,0],!0,null,!1).center(B),titleBarLabel.center(B).pos({x:Math.max(u/2,Math.max(10,l)),reg:!0}),q.regX=0,q.regY=-_,q.setBounds(0,-_,t,n+_),D?(B.cursor="pointer",B.on("mousedown",function(){q.drag({rect:L,currentTarget:!0})}),B.on("pressup",function(){q.noDrag()})):B.on("mousedown",function(){})),Y&&(c(R)&&(R="#555"),(Y=q.close=new a.Shape(-40,-40,80,80,null,!1)).graphics.f(R).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),B?Y.centerReg(q).scaleTo(B,null,50).pos({x:t-Math.max(u/2,Math.max(10,l))-Y.width/2,y:_/2,reg:!0}).expand(40):Y.sca(.3).pos(Math.max(u/2,Math.max(10,l))/2,Y.height/2,!0,!1,q).expand(40),Y.cursor="pointer",Y.expand(),Y.on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(){q.removeFrom(),q.dispatchEvent("close")})),this.add=function(e,t){if(We(e),e.getBounds())return t&&q.removeAll(),Q.addChild(e),0==e.x&&(e.x=S),0==e.y&&(e.y=I),q.update(),q;i("SwipeBox.add() - please add content with bounds set")},this.remove=function(e){return Q.removeChild(e),q.update(),q};var ve,we,xe,Ce=!(this.removeAll=function(){return Q.removeAllChildren(),q.update(),q});function ke(){Le=Q.y,M&&Re.immediate(Le),d&&Te()}function Te(){q.dispatchEvent("scrolling"),ee&&(ee.x=-Q.x,ee.y=-Q.y),ae&&d&&(fe.x=oe.convert(Q.x)),se&&d&&(me.y=re.convert(Q.y))}function Pe(e){a.Ticker.remove(ke),Ce=!1,ae&&y&&a.animate(fe,{alpha:0},pe.fadeTime),se&&y&&a.animate(me,{alpha:0},pe.fadeTime)}if(h&&Q.on("mousedown",function(){Ce||a.Ticker.add(ke,Q.stage),Ce=!0,ae&&d&&y&&a.animate(fe,{alpha:g},pe.showTime),se&&d&&y&&a.animate(me,{alpha:g},pe.showTime)}),this.on("added",function(){We(q),h&&(a.drag({obj:Q,currentTarget:!0,localBounds:!0,slide:w,slideDamp:x,slideSnap:!((!b||!0!==h&&"auto"!=h&&"horizontal"!=h)&&(!v||!0!==h&&"auto"!=h&&"vertical"!=h))&&k}),Q.getBounds()&&0<Q.getBounds().width&&setTimeout(function(){be()},300))},null,!0),this.cancelCurrentDrag=function(){q.content.noDrag(),a.drag({obj:Q,currentTarget:!0,localBounds:!0,slide:w,slideDamp:x,slideSnap:!((!b||!0!==h&&"auto"!=h&&"horizontal"!=h)&&(!v||!0!==h&&"auto"!=h&&"vertical"!=h))&&k}),Q.getBounds()&&0<Q.getBounds().width&&setTimeout(function(){be()},300)},this.added(function(e){e.on("stagemousemove",function(t){q.windowMouseX=t.stageX/e.scaleX,q.windowMouseY=t.stageY/e.scaleY})}),w?Q.on("slidestop",Pe):Q.on("mousedown",function(){Q.stage.on("stagemouseup",Pe,null,!0)}),X&&(q.blurEvent=document.window.addEventListener("blur",function(){q.cancelCurrentDrag(),Pe()})),T){var Oe,Ae,Se;Q.on("mousedown",function(e){Oe=e.stageX/($=e.target.stage).scaleX,Ae=Date.now()}),Q.on("click",function(e){Date.now()-Ae<600&&Math.abs(e.stageX/$.scaleX-Oe)<5&&(q.contentMouse=Q.globalToLocal(e.stageX/$.scaleX,e.stageY/$.scaleY),q.dispatchEvent("select"))}),Q.on("mouseover",function(){Se=Date.now(),a.Ticker.add(De,Q.stage)}),Q.on("mouseout",function(){_e||(q.dispatchEvent("hoverout"),_e=!0),a.Ticker.remove(De)});var Ie=0,Ee=0,Me=0,Be=0,ze=300,je=2,_e=!1;function De(){if(!Q.stage)return _e||(q.dispatchEvent("hoverout"),_e=!0),void a.Ticker.remove(De);Math.abs(Ie-q.windowMouseX)>je||Math.abs(Ee-q.windowMouseY)>je?(_e||(q.dispatchEvent("hoverout"),_e=!0),Se=Date.now(),Ie=q.windowMouseX,Ee=q.windowMouseY):Date.now()-Se>ze&&((Math.abs(Me-q.windowMouseX)>je||Math.abs(Be-q.windowMouseY)>je)&&(q.contentMouse=Q.globalToLocal(q.windowMouseX,q.windowMouseY),q.dispatchEvent("hoverover"),Me=q.windowMouseX,Be=q.windowMouseY,_e=!1),Se=Date.now())}}var Le=q.scrollY;if(E){function Ye(e){if(se&&q.stage&&q.hitTestPoint(q.windowMouseX,q.windowMouseY)&&q.contains(q.stage.getObjectUnderPoint(q.windowMouseX*q.stage.scaleX,q.windowMouseY*q.stage.scaleY))){c(e)&&(e=event);var t=e.detail?-19*e.detail:e.wheelDelta;c(t)&&(t=-19*e.deltaY),Le+=t,Le=Math.max(-q.scrollYMax,Math.min(0,Le)),M||(q.scrollY=Le,Q.stage.update())}}ve=window.addEventListener("mousewheel",Ye),we=window.addEventListener("wheel",Ye),xe=window.addEventListener("DOMMouseScroll",Ye)}var Re,Xe=!1;function We(e){M&&!Xe&&e.stage&&(Xe=!0,Re=new a.Damp(q.scrollY,M),a.Ticker.add(function(){Ce||c(Le)||(q.scrollY=Re.convert(Le))},e.stage))}Object.defineProperty(q,"scrollX",{get:function(){return Q.x},set:function(e){Q.x=e,Q.zimDragImmediate&&Q.zimDragImmediate(Q.x,Q.y),Te()}}),Object.defineProperty(q,"scrollY",{get:function(){return Q.y},set:function(e){Q.y=e,Q.zimDragImmediate&&Q.zimDragImmediate(Q.x,Q.y),Te()}}),!1!==W&&P(this,G),this.clone=function(e){c(e)&&(e=!0);var i=q.cloneProps(new a.Window(t,n,o,H,K,l,u,h,d,p,pe.color,g,y,b,v,w,x,k,T,O,A,S,I,B,z,j,_,D,L,Y,R,X,W,F,V));return e&&(q.content.cloneChildren(i.content),i.update()),i},this.dispose=function(){return E&&(window.removeEventListener("mousewheel",ve),window.removeEventListener("wheel",we),window.removeEventListener("DOMMouseScroll",xe)),q.blurEvent&&document.window.removeEventListener("blur",q.blurEvent),c(De)||a.Ticker.remove(De),c(ke)||a.Ticker.remove(ke),this.zimContainer_dispose(),!0}},a.extend(a.Window,a.Container,["clone","dispose"],"zimContainer",!1),a.Layer=function(e,n,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I,E,M,B,z,j,_){var D;if(D=m(a.Layer,arguments,"width, height, titleBar, titleBarContainer, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, selectedColor, selectedRollColor, borderWidth, borderColor, dashed, transformObject, titleBarWidth, titleBarHeight, titleBarX, titleBarY, titleBarDraggable, close, closeColor, closeBackgroundColor, closeIndicatorColor, anchor, style, group, inherit",this))return D;C("58.5"),this.group=j;var L=!1===z?{}:a.getStyle("Layer",this.group,_);c(e)&&(e=null!=L.width?L.width:500),c(n)&&(n=null!=L.height?L.height:500),this.zimContainer_constructor(0,0,e,n,!1),this.type="Layer";var Y=this;Y.distX=40,Y.distY=0,c(o)&&(o=null!=L.titleBar?L.titleBar:"LAYER");var R=o,X=o,W=!0;c(s)&&(s=null!=L.backgroundColor?L.backgroundColor:"#eee"),c(l)&&(l=null!=L.rollBackgroundColor?L.rollBackgroundColor:"#fff"),c(u)&&(u=null!=L.selectedBackgroundColor?L.selectedBackgroundColor:"#666"),c(d)&&(d=null!=L.color?L.color:"#666"),c(p)&&(p=null!=L.rollColor?L.rollColor:"#666"),c(f)&&(f=null!=L.selectedColor?L.selectedColor:"#ddd"),c(y)&&(y=null!=L.borderWidth?L.borderWidth:1),c(b)&&(b=null!=L.borderColor?L.borderColor:s),(b<0||y<0)&&(b=y=null),c(v)&&(v=null==L.dashed||L.dashed),c(w)&&(w=null!=L.titleBar?L.titleBar:null),c(x)&&(x=null!=L.titleBarWidth?L.titleBarWidth:100);var F,V=x;if(c(k)&&(k=null!=L.titleBarHeight?L.titleBarHeight:40),c(T)&&(T=null!=L.titleBarX?L.titleBarX:null),c(O)&&(O=null!=L.titleBarY?L.titleBarY:null),c(A)&&(A=null==L.titleBarDraggable||L.titleBarDraggable),c(S)&&(S=null==L.close||L.close),c(I)&&(I=null!=L.closeColor?L.closeColor:u),c(E)&&(E=null!=L.closeBackgroundColor?L.closeBackgroundColor:u),c(M)&&(M=null!=L.closeIndicatorColor?L.closeIndicatorColor:f),c(B)&&(B=null==L.anchor||L.anchor),A||(B=!1),Y.anchor=B,S&&(x+=30),w=a.merge({borderColor:u},w,{events:!0,visible:!1,ghostColor:b,ghostWidth:y,ghostDashed:v,ghostHidden:!0}),c(r)&&(r=null!=L.titleBarContainer?L.titleBarContainer:null),c(r)){if(!t)return void i("zim Layer(): Please pass in a reference to a container with bounds set.");r=t.stage}Y.active=!1,Y.turnOff=function(e,t){Y.active=!1,S&&(Y.checkBox.visible=!1),Y.transformControls.remove(),Y.mouseChildren=!0,Y.button.backgroundColor=s,Y.button.rollBackgroundColor=l,Y.button.color=d,Y.button.rollColor=d,Y.transformControls.allowToggleOff(),Y.resizeChildren&&Y.resizeChildren()},Y.turnOn=function(){Y.active=!0,S&&(Y.checkBox.visible=!0,Y.checkBox.checked=!0),Y.button.backgroundColor=u,Y.button.rollBackgroundColor=u,Y.button.color=f,Y.button.rollColor=f,Y.mouseChildren=!1,Y.transformControls.add(),Y.transformControls.allowToggleOn()},Y.titleBarPos=function(e,t){if(Y.titleBar)return Y.titleBar.pos?(Y.titleBar.pos(e,t,arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]),F.update()):(Y.distX=e,Y.distY=t),W=!1,Y};var N=Y.visible;Y.visible=!1,this.added(function(e){Y.transform(w),0<=y&&Y.transformControls.hideGhost(),a.timeout(50,function(){Y.visible=N,0<=y&&a.timeout(100,function(){Y.transformControls.showGhost(),F.update()}),F=e;var t=Y.titleBar=new a.Container(x,k).reg(0,k).loc(Y,null,r).mov(Y.distX,Y.distY);function n(e){if(W&&A){var n=r.localToLocal(t.x-Y.distX,t.y-Y.distY,Y.parent),o=Y.localToLocal(Y.regX,Y.regY,Y.parent),a=Y.localToLocal(0,0,Y.parent);Y.x=n.x+(o.x-a.x),Y.y=n.y+(o.y-a.y),Y.transformControls.resize(e),i(Y)}}function i(e){e.loop(function(e){"Layer"==e.type&&(Y.titleBarDraggable&&e.move(),e.transformControls.ghost&&e.transformControls.resize(),i(e))})}function o(){return 0==t.x||t.y==t.height||t.x==r.width-t.width||t.y==r.height||void 0}if(A&&t.drag({all:!0,boundary:new a.Boundary(0,k,r.width-x,r.height-k),localBounds:!0}),40==Y.distX&&0==Y.distY||t.pos(Y.distX,Y.distY),S&&(Y.checkBox=new a.CheckBox({borderColor:I,backgroundColor:E,indicatorColor:M,size:20,startChecked:!0}).center(t).pos(0,null,!0).change(function(){Y.turnOff(!0,!0)}),Y.checkBox.visible=!1),t.mouseChildren=!0,(t.layer=Y).resetTitleBar=function(){Y.distX=40,Y.distY=0,W=!0,Y.move(!0),F.update()},"string"!=typeof X&&"number"!=typeof X||(X=new a.Label({text:X,color:d,rollColor:p,size:null!=L.size?L.size:18,group:this.group})),Y.label=X,Y.label.center(t),Y.button=new a.Button({shadowBlur:-1,width:V,height:k-1,label:Y.label,color:d,rollColor:p,backgroundColor:s,rollBackgroundColor:l,corner:null!=L.corner?L.corner:0,inherit:L}).addTo(t),Y.button.on("mousedown",function(){r.loop(function(e){e&&e!=t&&e.layer&&e.layer.turnOff&&e.layer.active&&e.layer.turnOff(!0,!0)}),Y.active||Y.turnOn(),t.top()}),Y.button.on("pressmove",function(){n()}),Y.button.on("pressup",function(){n(!0);var e=Y.localToLocal(0,0,r);Y.distX=t.x-e.x,Y.distY=t.y-e.y,t.top(),!o()&&A&&(e=Y.localToGlobal(0,0),Y.button.hitTestPoint(e.x,e.y)&&Y.resetTitleBar())}),Y.button.on("dblclick",function(){A&&Y.resetTitleBar()}),Y.turnOff(),Y.on("transformed",function(e){"move"!=e.transformType&&"size"!=e.transformType&&"stretch"!=e.transformType&&"rotate"!=e.transformType||(A&&Y.move(),i(Y))}),Y.move=function(e){!e&&!W&&Y.anchor&&o()||(t.loc(Y.localToLocal(0,0,r)).mov(Y.distX,Y.distY),t.x<0&&(W=!1,t.x=0),t.y<t.height&&(W=!1,t.y=t.height),t.x>r.width-t.width&&(W=!1,t.x=r.width-t.width),t.y>r.height&&(W=!1,t.y=r.height),Y.anchor||(W=!0))},Y.on("transformhide",function(){Y.turnOff(!0,!0),r.loop(function(e){e&&e!=t&&e.layer&&e.layer.turnOff&&e.layer.active&&e.layer.turnOff()})}),Y.resizeChildren=function(e){Y.transformControls.resize(e),Y.loop(function(e){e.transformControls&&(e.transformControls.visible&&e.transformControls.hide(),"Layer"==e.type?e.resizeChildren():e.transformControls.resize())})},Y.resize=function(e){return Y.move(),Y.resizeChildren(e),Y},Y.toggled=!1,Y.toggle=function(e){return Y.toggled=c(e)?!Y.toggled:e,Y.toggled?(r.loop(function(e){e&&e!=t&&e.layer&&e.layer.turnOff&&e.layer.active&&e.layer.turnOff()}),Y.turnOn()):(t.top(),Y.turnOff(),r.loop(function(e){e&&e!=t&&e.layer&&e.layer.turnOff&&e.layer.active&&e.layer.turnOff()})),Y.stage&&Y.stage.update(),Y},Object.defineProperty(Y,"titleBarDraggable",{get:function(){return A},set:function(e){(A=e)?t.drag({all:!0,boundary:a.Boundary(0,40,r.width-x,r.height-k),localBounds:!0}):t.noDrag()}}),F.on("stagemouseup",function(){Y.transformControls.visible&&t.top()}),!c(T)||!c(O)){W=!1;var u=c(T)?t.x:T,h=c(O)?t.y-k:O;Y.titleBarStartX=T,Y.titleBarStartY=O,Y.titleBarPos(u,h);var f=Y.parent.localToLocal(Y.x,Y.y,r);Y.distX=t.x-f.x,Y.distY=t.y-f.y}})}),!1!==z&&P(this,L),this.clone=function(){return Y.cloneProps(new a.Layer(e,n,R,r,s,l,u,h,d,p,f,g,y,b,v,w,V,k,T,O,A,S,I,E,M,B,z,this.group,_))},this.dispose=function(){return Y.transformControls.remove(),Y.transformControls.disable(),this.zimContainer_dispose(),!0}},a.extend(a.Layer,a.Container,["clone","dispose"],"zimContainer",!1),a.Waiter=function(e,n,o,r,s,l,u,h,d,p,f){var g;if(g=m(a.Waiter,arguments,"container, speed, foregroundColor, backgroundColor, corner, shadowColor, shadowBlur, fadeTime, style, group, inherit",this))return g;C("59"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Waiter",this.group=p;var y=!1===d?{}:a.getStyle(this.type,this.group,f);c(n)&&(n=null!=y.speed?y.speed:600),c(o)&&(o=null!=y.foregroundColor?y.foregroundColor:"white"),c(r)&&(r=null!=y.backgroundColor?y.backgroundColor:"orange"),c(s)&&(s=null!=y.corner?y.corner:16),c(l)&&(l=null!=y.shadowColor?y.shadowColor:"rgba(0,0,0,.3)"),c(u)&&(u=null!=y.shadowBlur?y.shadowBlur:14),c(h)&&(h=null!=y.fadeTime?y.fadeTime:0),this.setBounds(-52,-20,104,40);var b=this,v=this.display=new a.Shape({style:!1});this.addChild(v),v.setBounds(0,0,104,40),v.regX=52,v.regY=20;var w=v.graphics;w.f(r);var x=s;Array.isArray(x)||(x=[s,s,s,s]),w.rc(0,0,104,40,x[0],x[1],x[2],x[3]),-1!=l&&0<u&&(v.shadow=new createjs.Shadow(l,3,3,u)),v.on("click",function(e){e.stopImmediatePropagation()});var k,T,O=new a.Container({style:!1});this.addChild(O);for(var A=0;A<3;A++)(k=new createjs.Shape).graphics.f(o).dc(0,0,12),k.x=32*(A-1),O.addChild(k),k.cache(-12,-12,24,24),k.alpha=0;this.hide=function(){function e(){b.parent&&b.parent.removeChild(b);var e=b.stage;if(e&&e.update(),b.zimAccessibility){var t=b.zimAccessibility;t.resize(b),T?T.focus():b.zimTabTag.nextSibling.focus(),setTimeout(function(){t.talk("Waiter has finished.")},50)}}return 0<h?b.animate({obj:{alpha:0},time:h,call:e}):e(),b.toggled=!1,b};var S=[];this.show=function(){var o,r="zim display - Waiter(): Please pass in a reference to a container with bounds set as first parameter to Waiter";if(c(e)){if(!t)return void i(r);e=t.stage}else{if(!e.getBounds)return void i(r);if(c(e.stage))return void i("zim display - Waiter(): The container must have a stage property")}for(var a=0,s=0;s<O.numChildren;s++)O&&S.push(setTimeout(function(){o=O.getChildAt(a),createjs.Tween.get(o,{loop:!0}).to({alpha:1},n/3/2).wait(n/3).to({alpha:0},n/3).wait(n-n/3-n/3/2),a++},s*n/3));if(b.ticker=createjs.Ticker.on("tick",function(){e.stage.update()}),b.x=e.getBounds().width/2,b.y=e.getBounds().height/2,e.addChild(b),0<h&&(b.alpha=0,b.animate({alpha:1},h)),b.zimAccessibility){var l=b.zimAccessibility;setTimeout(function(){l.activatedObject&&(T=l.activatedObject.zimTabTag)},50),l.resize(b),l.talk(b.zimTabTag.getAttribute("aria-label"))}return b.toggled=!0,b},!(b.toggle=function(e){return!0===e?b.show():!1===e?b.hide():b.parent?b.hide():b.show(),b})!==d&&P(this,y),this.clone=function(){return b.cloneProps(new a.Waiter(e,n,o,r,s,l,u,h,d,this.group,f))},this.dispose=function(){b.ticker&&createjs.Ticker.off("tick",b.ticker),createjs.Tween.removeTweens(b),b.removeFrom();for(var e=0;e<O.numChildren;e++){var t=O.getChildAt(e);clearInterval(S[e]),createjs.Tween.removeTweens(t)}return this.zimContainer_dispose(),!0}},a.extend(a.Waiter,a.Container,["clone","dispose"],"zimContainer",!1),a.ProgressBar=function(e,n,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A){var S;if(S=m(a.ProgressBar,arguments,"barType, foregroundColor, backgroundColor, borderColor, borderWidth, padding, label, color, labelPosition, percentage, corner, shadowColor, shadowBlur, backing, delay, fastClose, container, autoHide, style, group, inherit",this))return S;C("59.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="ProgressBar",this.group=O;var I=!1===T?{}:a.getStyle(this.type,this.group,A);c(n)&&(n=null!=I.foregroundColor?I.foregroundColor:"#acd241"),c(o)&&(o=null!=I.backgroundColor?I.backgroundColor:"#444"),c(r)&&(r=null!=I.borderColor?I.borderColor:o),c(s)&&(s=null!=I.borderWidth?I.borderWidth:null),c(d)&&(d=null!=I.labelPosition?I.labelPosition:"bottom"),c(e)&&(e=null!=I.barType?I.barType:"circle"),c(l)&&(l=null!=I.padding?I.padding:"circle"==e?2:-.5),c(f)&&(f=null!=I.corner?I.corner:15),c(g)&&(g=null!=I.shadowColor?I.shadowColor:"rgba(0,0,0,.3)"),c(y)&&(y=null!=I.shadowBlur?I.shadowBlur:14),c(b)&&(b=null!=I.backing?I.backing.clone():null),c(w)&&(w=null==I.fastClose||I.fastClose),r<0||s<0?r=s=null:null!=r&&null==s&&(s="circle"==e?10:2),c(v)&&(v=null!=I.delay?I.delay:100),c(k)&&(k=null==I.autoHide||I.autoHide),c(u)&&(u=null!=I.label?I.label:null),c(h)&&(h=null!=I.color?I.color:n),"string"!=typeof u&&"number"!=typeof u||(u=new a.Label({text:u,color:h,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),!c(p)&&c(u)&&(u=new a.Label("")),this.label=u;var E,M=30,B=this,z=0;if(B.visible=!1,setTimeout(function(){B.visible=!0,B.stage&&B.stage.update()},v),"circle"==e)var j=20,_=(b=this.backing=new a.Circle(j,"rgba(0,0,0,0)",o,s,null,null,null,!1).addTo(this),this.bar=new a.Shape({style:!1}).addTo(B).pos({x:b.x,y:b.y,reg:!0}).rot(-90));else{j=200,-1!=g&&0<y&&(new a.Rectangle(j-2,M-2,o,null,null,f,null,null,!1).addTo(this).shadow=new createjs.Shadow(g,3,3,y)),b=R(b);var D=f;Array.isArray(D)||(D=[f,f,f,f]);var L=1.2*(l+s/2),Y=(_=this.bar=new a.Rectangle(j-1.8*(l+s/2),M-1.8*(l+s/2),n,null,null,[D[0]-L,D[1]-L,D[2]-L,D[3]-L],null,null,!1).center(this),this.mask=new a.Rectangle(j-1.8*(l+s/2),M-1.8*(l+s/2),null,null,null,null,null,null,!1).center(this).alp(0).sca(0,1));_.setMask(Y)}function R(e){if(B.backing){var t=B.getChildIndex(B.backing);B.removeChild(B.backing)}else t=B.numChildren;if(B.border&&B.removeChild(B.border),c(e)||"Pattern"!=e.type)e=B.backing=c(e)?new a.Rectangle(j,M,o,r,s,f,null,null,!1).addTo(B,t):b.addTo(B,t);else{var n=e;((e=B.backing=new a.Rectangle(j,M,o,null,null,f,null,null,!1).addTo(B,t)).pattern=n).center(e),e.getBounds(),n.setMask(e.shape),s&&(B.border=new a.Rectangle(j,M,"rgba(0,0,0,0)",r,s,f,null,null,!1).addTo(B,t+1))}return e}function X(t){"circle"==e?_.graphics.c().mt(0,0).s(n).ss(s-2*l+.5).a(0,0,j,0,360*t/100*Math.PI/180):(Y.sca(t/100,1),_.setMask(Y)),c(p)||(u.text=u.startText+" "+Math.min(Math.round(t),100)+"%"),k&&w&&100<=Math.round(t)&&(B.timeOut=setTimeout(function(){B.hide()},200)),B.stage&&B.stage.update()}B.setBacking=function(e){R(e),B.stage&&B.stage.update()},b.on("click",function(e){e.stopImmediatePropagation()}),c(u)||(u.scaleX=u.scaleY=.8,u.startText=u.text,c(p)||(u.text=u.startText+"  0%"),u.center(B),"above"==d?u.y-=60:u.y+=60,u.alpha=.8),this.hide=function(){var e=B.stage;if(B.parent&&B.parent.removeChild(B),"Pattern"==B.backing.type&&B.backing.pauseInterval&&B.backing.pauseInterval(),e&&e.update(),B.zimAccessibility){var t=B.zimAccessibility;t.resize(B),E?E.focus():B.zimTabTag.nextSibling.focus(),setTimeout(function(){t.talk("Progress Bar has finished.")},50)}return B.toggled=!1,B},this.show=function(){var e="zim display - ProgressBar(): Please pass in a reference to a container with bounds set as first parameter of the ProgressBar";if(c(x)){if(!t)return void i(e);x=t.stage}else{if(!x.getBounds)return void i(e);if(c(x.stage))return void i("zim display - Waiter(): The container must have a stage property")}if(B.timeOut&&clearTimeout(B.timeOut),X(0),B.zimActiveLoader&&B.zimActiveLoader.on("progress",function(e){X(z=100*e.progress)}),B.center(x),"Pattern"==B.backing.type&&B.backing.pauseInterval&&B.backing.pauseInterval(!1),B.zimAccessibility){var n=B.zimAccessibility;setTimeout(function(){n.activatedObject&&(E=n.activatedObject.zimTabTag)},50),n.resize(B),n.talk(B.zimTabTag.getAttribute("aria-label"))}return B.toggled=!0,B},B.toggle=function(e){return!0===e?B.show():!1===e?B.hide():B.parent?B.hide():B.show(),B},Object.defineProperty(B,"percent",{get:function(){return z},set:function(e){X(z=e)}}),!1!==T&&P(this,I),this.clone=function(){return B.cloneProps(new a.ProgressBar(e,n,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,this.group,A))},this.dispose=function(){return"Pattern"==B.backing.type&&B.backing.clearInterval&&B.backing.clearInterval(),this.zimContainer_dispose(),!0}},a.extend(a.ProgressBar,a.Container,["clone","dispose"],"zimContainer",!1),a.Indicator=function(t,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,O,A){var S;if(S=m(a.Indicator,arguments,"width, height, num, foregroundColor, backgroundColor, borderColor, borderWidth, backdropColor, corner, indicatorType, fill, scale, lightScale, interactive, shadowColor, shadowBlur, style, group, inherit",this))return S;C("60"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Indicator",this.group=O;var I=!1===T?{}:a.getStyle(this.type,this.group,A);c(t)&&(t=null!=I.width?I.width:300),c(o)&&(o=null!=I.height?I.height:50),c(r)&&(r=null!=I.num?I.num:6),c(s)&&(s=null!=I.foregroundColor?I.foregroundColor:"#f58e25"),c(l)&&(l=null!=I.backgroundColor?I.backgroundColor:"#666"),l<0&&(l=null!=I.backgroundColor?I.backgroundColor:"rgba(0,0,0,.01)"),c(u)&&(u=null!=I.borderColor?I.borderColor:null),c(h)&&(h=null!=I.borderWidth?I.borderWidth:null),u<0||h<0?u=h=null:null!=u&&null==h&&(h=1),c(d)&&(d=null!=I.backdropColor?I.backdropColor:-1),c(p)&&(p=null!=I.corner?I.corner:0),c(f)&&(f=null!=I.indicatorType?I.indicatorType:"dot"),c(g)&&(g=null!=I.fill&&I.fill),c(y)&&(y=null!=I.scale?I.scale:1),c(b)&&(b=null!=I.lightScale?I.lightScale:1),c(v)&&(v=null!=I.interactive&&I.interactive),c(w)&&(w=null!=I.shadowColor?I.shadowColor:"rgba(0,0,0,.3)"),c(k)&&(k=null!=I.shadowBlur?I.shadowBlur:5);var E,M=(e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",B=this;if(this.lights=[],new a.Container({style:!1}),-1!=d){var z=B.backdrop=new a.Rectangle(t,o,d,u,h,p,null,null,!1);this.addChild(z)}var j,_=this.lightsContainer=new a.Container({style:!1});this.addChild(_);var D=.5*o,L=t/(r+1),Y=new createjs.Shape;"square"==f||"box"==f?Y.graphics.f("black").dr(-L/2/b+D/2,-o/2+D/2,L/b,o):Y.graphics.f("black").dr(-L/2/b,-o/2,L/b,o);for(var R=0;R<r;R++)"square"==f||"box"==f?((j=new a.Rectangle(D,D,l,u,h,null,null,null,!1)).regX=j.width/2,j.regY=j.height/2):j=new a.Circle(D/2,l,u,h,null,null,null,!1),this.lights.push(j),j.znum=R,j.scaleX=j.scaleY=b,j.hitArea=Y,j.x=L+L*R,j.y=o/2,_.addChild(j);function X(t){var n;r<=t&&(t=-1);for(var i=0;i<r;i++)n=g&&i<t?s:l,i==t&&(n=s),_.getChildAt(i).color=n;B.zimAccessibility&&B.zimAccessibility.changeTitle(B),a.OPTIMIZE||!e&&OPTIMIZE||!B.stage||B.stage.update()}_.setBounds(0,0,t,o),_.regX=_.x=t/2,_.regY=_.y=o/2,this.addChild(_),-1!=w&&0<k&&(_.shadow=new createjs.Shadow(w,2,2,k)),v&&(_.cursor="pointer",_.on(M,function(e){E!=e.target.znum&&(X(E=e.target.znum),B.dispatchEvent("change"))})),_.scaleX=_.scaleY=y,Object.defineProperty(this,"selectedIndex",{get:function(){return E},set:function(e){E=Math.floor(e),X(E=a.constrain(E,-1,r-1))}}),Object.defineProperty(this,"num",{get:function(){return r},set:function(e){n&&i("num is read only")}}),this._enabled=!0,Object.defineProperty(B,"enabled",{get:function(){return B._enabled},set:function(e){x(B,e)}}),!1!==T&&P(this,I),this.clone=function(){return B.cloneProps(new a.Indicator(t,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,this.group,A))}},a.extend(a.Indicator,a.Container,"clone","zimContainer",!1),a.List=function(t,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,X,W,F,V,N,G,H,K,q,U,Z,J,$,Q,ee,te,ne,ie,oe,re,ae,se,le,ce,ue,he,de,pe,fe,ge,me,ye){var be;if(be=m(a.List,arguments,"width, height, list, viewNum, vertical, currentSelected, align, valign, labelAlign, labelValign, labelIndent, labelIndentHorizontal, labelIndentVertical, indent, spacing, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, selectedColor, rollColor, selectedRollColor, borderColor, borderWidth, padding, corner, swipe, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, scrollBarOverlay, slide, slideDamp, slideSnap, shadowColor, shadowBlur, paddingHorizontal, paddingVertical, scrollWheel, damp, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, draggable, boundary, close, closeColor, excludeCustomTap, organizer, checkBox, pulldown, clone, cancelCurrentDrag, style, group, inherit",this))return be;C("60.5"),this.group=me;var ve=!1===ge?{}:a.getStyle("List",this.group,ye);c(t)&&(t=null!=ve.width?ve.width:300),c(o)&&(o=null!=ve.height?ve.height:c(ue)?200:200+ue.height),c(r)&&(r=r=null!=ve.list?ve.list:["Option 1","Option 2","Option 3","Option 4","Option 5","Option 6","Option 7","Option 8","Option 9","Option 10"]),0==r.length&&(r=["%-&"]),this.originalList=r,c(s)&&(s=null!=ve.viewNum?ve.viewNum:5),c(l)&&(l=null==ve.vertical||ve.vertical),c(u)&&(u=null==ve.currentSelected||ve.currentSelected);var we=!c(h)||!c(p);c(he)&&(he=null!=ve.checkBox&&ve.checkBox),c(h)&&(h=null!=ve.align?ve.align:he?"left":"center"),c(d)&&(d=null!=ve.valign?ve.valign:"center"),c(p)&&(p=null!=ve.labelAlign?ve.labelAlign:h),c(f)&&(f=null!=ve.labelValign?ve.labelValign:d),c(v)&&(v=null!=ve.indent?ve.indent:he?0:10),c(g)&&(g=null!=ve.labelIndent?ve.labelIndent:v),c(y)&&(y=null!=ve.labelIndentHorizontal?ve.labelIndentHorizontal:g),c(b)&&(b=null!=ve.labelIndentVertical?ve.labelIndentVertical:g),c(w)&&(w=null!=ve.spacing?ve.spacing:2),c(S)&&(S=null!=ve.backdropColor?ve.backdropColor:"#333"),c(k)&&(k=null!=ve.backgroundColor?ve.backgroundColor:"#777"),c(T)&&(T=null!=ve.rollBackgroundColor?ve.rollBackgroundColor:"#555"),c(O)&&(O=null!=ve.selectedBackgroundColor?ve.selectedBackgroundColor:"#444"),c(A)&&(A=null!=ve.selectedRollBackgroundColor?ve.selectedRollBackgroundColor:"#555"),c(I)&&(I=null!=ve.color?ve.color:"white"),c(M)&&(M=null!=ve.rollColor?ve.rollColor:I),c(E)&&(E=null!=ve.selectedColor?ve.selectedColor:I),c(B)&&(B=null!=ve.selectedRollColor?ve.selectedRollColor:M),c(S)&&(S=null!=ve.backdropColor?ve.backdropColor:S);var xe=z,Ce=j;c(z)&&(z=null!=ve.borderColor?ve.borderColor:"#999"),c(j)&&(j=null!=ve.borderWidth?ve.borderWidth:1),c(_)&&(_=null!=ve.padding?ve.padding:w),c(D)&&(D=null!=ve.corner?ve.corner:0),c(L)&&(L=null==ve.swipe||ve.swipe),c(Y)&&(Y=null==ve.scrollBarActive||ve.scrollBarActive),c(R)&&(R=null==ve.scrollBarDrag||ve.scrollBarDrag),c(X)&&(X=null!=ve.scrollBarColor?ve.scrollBarColor:z),c(W)&&(W=null!=ve.scrollBarAlpha?ve.scrollBarAlpha:.3),c(F)&&(F=null==ve.scrollBarFade||ve.scrollBarFade),c(V)&&(V=null!=ve.scrollBarH?ve.scrollBarH:!l),c(N)&&(N=null!=ve.scrollBarV?ve.scrollBarV:l),R&&(F=null!=ve.scrollBarFade&&ve.scrollBarFade),c(G)&&(G=null==ve.scrollBarOverlay||ve.scrollBarOverlay),c(H)&&(H=null==ve.slide||ve.slide),c(K)&&(K=null!=ve.slideDamp?ve.slideDamp:.6),c(q)&&(q=null!=ve.slideSnap?ve.slideSnap:l?"vertical":"horizontal"),c(U)&&(U=null!=ve.shadowColor?ve.shadowColor:"rgba(0,0,0,.3)"),c(Z)&&(Z=null!=ve.shadowBlur?ve.shadowBlur:20),c($)&&($=null!=ve.paddingVertical?ve.paddingVertical:_),c(J)&&(J=null!=ve.paddingHorizontal?ve.paddingHorizontal:_),c(Q)&&(Q=null==ve.scrollWheel||ve.scrollWheel),c(te)&&(te=null!=ve.titleBar?ve.titleBar:null),c(ne)&&(ne=null!=ve.titleBarColor?ve.titleBarColor:null),c(ie)&&(ie=null!=ve.titleBarBackgroundColor?ve.titleBarBackgroundColor:null),c(oe)&&(oe=null!=ve.titleBarHeight?ve.titleBarHeight:35),c(re)&&(re=null!=ve.draggable?ve.draggable:null),c(ae)&&(ae=null!=ve.boundary?ve.boundary:null),c(se)&&(se=null!=ve.close?ve.close:null),c(le)&&(le=null!=ve.closeColor?ve.closeColor:null),c(ce)&&(ce=null!=ve.excludeCustomTap&&ve.excludeCustomTap),c(he)&&(he=null!=ve.checkBox&&ve.checkBox),c(de)&&(de=null!=ve.pulldown&&ve.pulldown),c(pe)&&(pe=null!=ve.clone&&ve.clone),!1===te&&(te=null),this.vertical=l;var ke,Te,Pe,Oe,Ae=this,Se=o;if(he&&a.loop(r,function(e,n){r[n]=a.List.checkItem(e,null,t,"left",10,10,w,I,M,E,B,k,T,O,A)}),r.constructor=={}.constructor){var Ie=c(r.shade)?c(ve.shade)?.2:ve.shade:r.shade,Ee=c(r.dim)?c(ve.dim)?.1:ve.dim:r.dim,Me=c(r.shift)?c(ve.shift)?15:ve.shift:r.shift,Be=c(r.bloom)?!c(ve.bloom)&&ve.bloom:r.bloom,ze=c(r.whither)?!c(ve.whither)&&ve.whither:r.whither,je=c(r.open)?!c(ve.open)&&ve.open:r.open;!0===Be&&(Be=10),!0===ze&&(ze=10),!0===Me&&(Me=15),!0===Ie&&(Ie=.2),!0===Ee&&(Ee=.1);var _e=c(r.subStyles)?c(ve.subStyles)?{}:ve.subStyles:r.subStyles;c(r.menu)||(r=r.menu),ke=new a.Hierarchy(r,je),je&&ke.data&&ke.data.id0&&(ke.data.id0.open=!1),r=ke.getLinearList(),we||(h=p="left")}if(de&&(s=c(ke)?r.length:ke.length,o=s*t/620*100+(s+1)*w+(c(te)?0:oe),j=0,O=k,S=a.clear,L=!1),a.loop(r,function(e){"ListItem"==e.type&&(e.width=t-2*w)}),this.align=h,this.valign=d,this.indent=v,c(ue)||(o-=ue.height,ue.list=Ae,ue.setButtons(),oe+=ue.height),this.zimWindow_constructor(t,o,S,z,j,_,D,L,Y,R,X,W,F,V,N,H,K,q,!0,U,Z,J,$,Q,ee,te,ne,ie,oe,re,ae,se,le,fe,ge,me,ve),this.type="List",c(te)||(o-=oe),c(ue)||ue.addTo(Ae).loc(0,-ue.height),Ae.itemWidth=l?t-2*J-(Y?G?0:6:0):(t-2*J)/s,Ae.itemHeight=l?(o-2*$)/s:o-2*$-(Y?G?0:6:0),Pe=a.copy(r,pe),Te=Ae.tabs=new a.Tabs({width:l?Ae.itemWidth:Ae.itemWidth*r.length,height:l?Ae.itemHeight*r.length:Ae.itemHeight,tabs:Pe,spacing:w,vertical:l,backgroundColor:k,rollBackgroundColor:T,selectedBackgroundColor:O,selectedRollBackgroundColor:A,color:I,rollColor:M,selectedColor:E,selectedRollColor:B,backdropColor:S,currentEnabled:!0,currentSelected:u,align:h,valign:d,labelAlign:p,labelValign:f,labelIndent:g,labelIndentHorizontal:y,labelIndentVertical:b,indent:v,useTap:!0,excludeCustomTap:ce,style:ge,group:me,inherit:ve}).mov(l?0:J,l?$:0),Ae.add(Te),ke){var De=ke.getLinearIDs();function Le(e,t,n){e.listZID=t,e.label&&(Ie&&new Rectangle(Me*(n.level+1),e.height).alp(Ie).pos(0,0,"right"==Ae.align,!1,e),Ee&&new Rectangle(e.width,e.height).alp((n.level+1)*Ee).addTo(e).bot().ord(1),Me&&"center"!=Ae.align&&(e.label.x+=("right"==Ae.align?-1:1)*Me*(n.level+1)));var i=ke.getData(t);i.obj=e,i.list&&!isEmpty(i.list)&&(e.accordion=new Label({text:i.open?"-":"+",align:"center",color:convertColor(I,"rgba",.6)}).center(e).alp(.7).pos(15,null,"right"!=Ae.align).mov(0,i.open?-3:0))}function Ye(){if(Ae.selected.accordion){var e=ke.getData(Ae.selected.listZID);if(e.open){Ae.selected.accordion&&(Ae.selected.accordion.text="+",Ae.selected.accordion.mov(0,3)),e.open=!1;var t=ke.getNextSibling(Ae.selected.listZID);if(c(t))var n=Ae.items.length-1;else n=a.loop(Ae.items,function(e,n){if(e.listZID==t)return n-1});if(ze){var i=0;Ae.enabled=!1,interval(ze,function(e){Ae.removeAt(1,Ae.selectedIndex+n-Ae.selectedIndex-i),i++,e.total==e.count+1&&(Ae.enabled=!0)},n-Ae.selectedIndex,!0)}else Ae.removeAt(n-Ae.selectedIndex,Ae.selectedIndex+1)}else{e.open=!0,Ae.selected.accordion&&(Ae.selected.accordion.text="-",Ae.selected.accordion.mov(0,-3));var o=ke.getLinearList(e.list),r=ke.getLinearIDs(e.list);if(e.opened)Array.isArray(o)&&(Be?(i=0,Ae.enabled=!1,interval(Be,function(e){Ae.addAt(o[i],Ae.selectedIndex+1+i),e.total==e.count+1&&(Ae.enabled=!0),i++},o.length,!0)):Ae.addAt(o,Ae.selectedIndex+1));else{e.opened=!0;var s=_e[e.level];c(s)&&(s={}),Array.isArray(o)&&(Be?(i=0,Ae.enabled=!1,interval(Be,function(t){Ae.addAt(o[i],Ae.selectedIndex+1+i,{backgroundColor:s.backgroundColor,color:s.color,rollBackgroundColor:s.rollBackgroundColor,rollColor:s.rollColor,selectedBackgroundColor:s.selectedBackgroundColor,selectedColor:s.selectedColor,selectedRollBackgroundColor:s.selectedRollBackgroundColor,selectedRollColor:s.selectedRollColor}),Le(Ae.items[Ae.selectedIndex+1+i],r[i],e),t.total==t.count+1&&(Ae.enabled=!0),i++,Ae.stage&&Ae.stage.update()},o.length,!0)):(Ae.addAt(o,Ae.selectedIndex+1,{backgroundColor:s.backgroundColor,color:s.color,rollBackgroundColor:s.rollBackgroundColor,rollColor:s.rollColor,selectedBackgroundColor:s.selectedBackgroundColor,selectedColor:s.selectedColor,selectedRollBackgroundColor:s.selectedRollBackgroundColor,selectedRollColor:s.selectedRollColor}),loop(r,function(t,n){Le(Ae.items[Ae.selectedIndex+1+n],t,e)})))}}}}loop(De,function(e,t){Ae.tabs.buttons[t].listZID=e}),loop(Ae.tabs.buttons,function(e){var t=ke.getData(e.listZID);isEmpty(t.list)||(e.accordion=new Label({text:"+",align:"center",color:convertColor(I,"rgba",.6)}).center(e).alp(.7).pos(15,null,"right"!=Ae.align))}),Ae.tap(Ye)}function Re(e){if(l){var n=-(Ae.itemHeight+w)*e+o/2-Ae.itemHeight/2;return(Ae.itemHeight+w)*Ae.length<o&&(n=0),0<n&&(n=0),(Ae.itemHeight+w)*Ae.length>o&&n<-Ae.tabs.height+o-2*$&&(n=-Ae.tabs.height+o-2*$),n}var i=-(Ae.itemWidth+w)*e+t/2-Ae.itemWidth/2;return(Ae.itemWidth+w)*Ae.length<t&&(i=0),0<i&&(i=0),(Ae.itemWidth+w)*Ae.length>t&&i<-Ae.tabs.width+t-2*J&&(i=-Ae.tabs.width+t-2*J),i}Te.tap(function(e){e.target.selectedIndex!=Ae.selectedIndex&&(Ae.selectedIndex=Te.selectedIndex,Ae.dispatchEvent("change"),e.preventDefault())}),this.getItemIndex=function(e){return Ae.items.indexOf(e)},this.animateTo=function(e,t){c(e)&&(e=0),c(t)&&(t=50);var n=Re(Ae.selectedIndex=e);if(l){var i=Math.abs(Ae.scrollY-n)/Ae.itemHeight;Ae.animate({scrollY:n},i*t)}else i=Math.abs(Ae.scrollX-n)/Ae.itemWidth,Ae.animate({scrollX:n},i*t);return Ae},this.addAt=function(e,n,i,o){return"ListItem"==e.type?e.width=t-2*w:Array.isArray(e)&&a.loop(e,function(e){"ListItem"==e.type&&(e.width=t-2*w)}),Ae.tabs.addAt(copy(e,o),n,i),Ae.content.x=0,Ae.content.y=0,Ae.update(),Ae},this.removeAt=function(e,t){Ae.tabs.removeAt(e,t);var n=Te.getBounds();return Te.setBounds(0,0,n.width,n.height),Ae.content.x=0,Ae.content.y=0,Ae.update(),Ae},"%-&"==r[0]&&1==r.length&&Ae.removeAt(1,0),this.clear=function(){return Ae.tabs.removeAt(Ae.length,0),Ae.content.x=0,Ae.content.y=0,Ae.update(),Ae},this.setCheck=function(e,t){c(e)&&(e=0),c(t)&&(t=!0),Ae.items[e].checkBox.checked=t,Ae.items[e].content.zimOut()},this.getCheck=function(e){return c(e)&&(e=0),Ae.items[e].checkBox.checked},this.setChecks=function(e){return a.loop(Ae.items,function(t){t.checkBox.checked=e,t.content.zimOut()}),Ae},Object.defineProperty(Ae,"items",{get:function(){return Ae.tabs.buttons},set:function(e){n&&i("List() - items is read only - use addAt() and removeAt() to change")}}),Object.defineProperty(Ae,"list",{get:function(){return Ae.tabs.buttons},set:function(e){n&&i("List() - list is read only - use addAt() and removeAt() to change")}}),Object.defineProperty(Ae,"length",{get:function(){return Ae.tabs.buttons.length},set:function(e){n&&i("List() - length is read only")}}),Object.defineProperty(Ae,"selectedIndex",{get:function(){return Oe},set:function(t){Te.selectedIndex=t,Ae.label=Te.label,Ae.selected=Te.selected,Oe=t,a.OPTIMIZE||!e&&OPTIMIZE||!Ae.stage||Ae.stage.update()}}),u&&(Ae.selectedIndex=0),Object.defineProperty(Ae,"selectedIndexPlusPosition",{get:function(){return Oe},set:function(t){Ae.selectedIndex=t,Oe=t,l?Ae.scrollY=Re(t):Ae.scrollX=Re(t),a.OPTIMIZE||!e&&OPTIMIZE||!Ae.stage||Ae.stage.update()}}),Object.defineProperty(Ae,"text",{get:function(){if(Ae.label)return Ae.label.text},set:function(e){Ae.label&&(Ae.label.text=e)}}),Object.defineProperty(Ae,"itemDown",{get:function(){return Ae.tabs.buttonDown},set:function(e){}}),Object.defineProperty(Ae,"itemsText",{get:function(){for(var e=[],t=0;t<Ae.tabs.buttons.length;t++){var n=Ae.tabs.buttons[t].label;n&&!c(n.text)?e.push(n.text):e.push(null)}return e},set:function(e){n&&i("List() - itemsText is read only")}}),u&&(Ae.selectedIndex=0),Object.defineProperty(Ae,"checkBoxes",{get:function(){for(var e=[],t=0;t<Ae.tabs.buttons.length;t++)e.push(Ae.tabs.buttons[t].checkBox);return e},set:function(e){n&&i("List() - checkBoxes is read only")}}),this._enabled=!0,Object.defineProperty(Ae,"enabled",{get:function(){return Ae._enabled},set:function(e){x(Ae,e)}}),this.last=function(){return this.selectedIndexPlusPosition=this.length-1,this},this.first=function(){return this.selectedIndexPlusPosition=0,this},je&&Ye&&(Ae.selected=Ae.items[0],Ye()),!1!==ge&&P(this,ve),this.clone=function(){return Ae.cloneProps(new a.List(t,Se,a.copy(Ae.originalList,!0),s,l,u,h,d,p,f,g,y,b,v,w,k,T,O,A,S,I,E,M,B,xe,Ce,_,a.copy(D),L,Y,R,X,W,F,V,N,G,H,K,q,U,Z,J,$,Q,ee,te,ne,ie,oe,re,ae,se,le,ce,ue,he,de,pe,fe,ge,this.group,ye))}},a.extend(a.List,a.Window,"clone","zimWindow",!1),a.List.makeBase=function(e,t,n){e.backing=new a.Rectangle(e.width,e.height,dark).center(e),e.label="Label"==t.type?t:new a.Label(t,null,null,white),e.label.center(e).loc(n)},a.List.slider=function(e,t,n,i,o,r,s,l,u,h){var d;if(d=m(a.List.slider,arguments,"label, min, max, val, call, step, obj, property, paddingLeft, paddingRight"))return d;var p=new a.Container(620,100);return p.type="ListItem",p.listItem="Slider",c(u)&&(u=20),c(h)&&(h=30),a.List.makeBase(p,e,u),p.slider=new a.Slider({inside:!0,barWidth:40,barLength:150,barColor:blue,min:t,max:n,step:r}).sca(1.5).center(p).mov(20).change(function(){p.stepper.currentValue=Math.round(p.slider.currentValue),s&&l&&(s[l]=p.slider.currentValue),o&&"function"==typeof o&&o(p.slider.currentValue),p.slider.stage&&p.slider.stage.update()}),c(i)||(p.slider.currentValue=i),p.stepper=new a.Stepper({corner:0,arrows:!1,stepperType:"number",min:t,max:n}).sca(.5).center(p).pos(h,null,!0).change(function(){p.slider.currentValue=p.stepper.currentValue,s&&l&&(s[l]=p.stepper.currentValue),o&&"function"==typeof o&&o(p.stepper.currentValue),p.stepper.stage&&p.stepper.stage.update()}),c(i)||(p.stepper.currentValue=i),p},a.List.checkBox=function(e,t,n,i,o,r,s){var l;if(l=m(a.List.checkBox,arguments,"label, checked, call, obj, property, paddingLeft, paddingRight"))return l;var u=new Container(620,100);return u.type="ListItem",u.listItem="CheckBox",c(r)&&(r=20),c(s)&&(s=30),a.List.makeBase(u,e,r),u.checkBox=new CheckBox({startChecked:t,label:""}).sca(1.2).center(u).pos(256+s,null,!0).change(function(){i&&o&&(i[o]=u.checkBox.checked),n&&"function"==typeof n&&n(u.checkBox.checked),u.checkBox.stage&&u.checkBox.stage.update()}),u},a.List.colorPicker=function(e,t,n,i,o,r,s,l){var u;if(u=m(a.List.colorPicker,arguments,"label, color, picker, call, obj, property, paddingLeft, paddingRight"))return u;var h=new Container(620,100);return h.type="ListItem",h.listItem="ColorPicker",c(s)&&(s=20),c(l)&&(l=30),a.List.makeBase(h,e,s),c(t)&&(t=a.pink),h.colorPicker=n||new a.ColorPicker({alphaPicker:!1}),h.swatch=new a.Rectangle(132,66,t,a.lighter,5).center(h).pos(270,null,!0).cur(),h.swatch.on("mousedown",function(){h.colorPicker.selectedColor=h.swatch.color,h.colorPicker.show()}),h.colorLabel=new a.Label(h.swatch.color.toUpperCase(),40,null,a.light).center(h).pos(l,null,!0),h.colorPicker.on("close",function(){var e=h.colorPicker.stage;h.colorPicker.hide(),e&&e.update()}),h.colorPicker.on("change",function(){var e=h.colorPicker.stage;h.swatch.color=h.colorPicker.selectedColor,h.colorLabel.text=h.swatch.color.toUpperCase(),h.colorPicker.hide(),o&&r&&(o[r]=h.colorPicker.selectedColor),i&&"function"==typeof i&&i(h.colorPicker.selectedColor),e&&e.update()}),h},a.List.checkItem=function(e,t,n,i,o,r,s,l,u,h,d,p,f,g,y,b,v){var w;if(w=m(a.List.checkItem,arguments,"label, size, width, align, paddingHorizontal, paddingVertical, spacing, color, rollColor, selectedColor, selectedRollColor, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, group, inherit"))return w;var x=a.getStyle("CheckBox",b,v);c(t)&&(t=null!=x.size?x.size:20),x=a.getStyle("List",b,v),c(n)&&(n=300),c(o)&&(o=10),c(r)&&(r=10),c(i)&&(i=null!=x.align?x.align:"center"),c(s)&&(s=null!=x.spacing?x.spacing:2),c(p)&&(p=null!=x.backgroundColor?x.backgroundColor:"#777"),c(f)&&(f=null!=x.rollBackgroundColor?x.rollBackgroundColor:"#555"),c(g)&&(g=null!=x.selectedBackgroundColor?x.selectedBackgroundColor:"#444"),c(y)&&(y=null!=x.selectedRollBackgroundColor?x.selectedRollBackgroundColor:"#555"),c(l)&&(l=null!=x.color?x.color:"white"),c(u)&&(u=null!=x.rollColor?x.rollColor:l),c(h)&&(h=null!=x.selectedColor?x.selectedColor:l),c(d)&&(d=null!=x.selectedRollColor?x.selectedRollColor:u);var C=new Container;return C.type="CheckItem",C.checkBox=new CheckBox({size:t,label:e,color:l,tap:!0}),C.backing=new Rectangle(n-2*s,C.checkBox.height+2*r,p).addTo(C),C.checkBox.center(C),"center"!=i&&"middle"!=i&&C.checkBox.pos(o,null,"right"==i),C.backing.tap(function(){C.checkBox.toggle(),C.zimOut()}),C.checkBox.change(function(){C.zimOut()}),C.zimOver=function(){C.backing.color=C.checkBox.checked?y:f,C.checkBox.label.color=C.checkBox.checked?d:u,C.stage&&C.stage.update()},C.zimOut=function(){C.backing.color=C.checkBox.checked?g:p,C.checkBox.label.color=C.checkBox.checked?h:l,C.stage&&C.stage.update()},C.backing.on("mouseover",C.zimOver),C.checkBox.on("mouseover",C.zimOver),C.backing.on("mouseout",C.zimOut),C.checkBox.on("mouseout",C.zimOut),C},a.Stepper=function(t,n,i,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,X,W){var F;if(F=m(a.Stepper,arguments,"list, width, backgroundColor, borderColor, borderWidth, label, color, vertical, arrows, corner, shadowColor, shadowBlur, continuous, display, press, hold, holdDelay, holdSpeed, draggable, dragSensitivity, dragRange, stepperType, min, max, step, step2, arrows2, arrows2Scale, keyEnabled, keyArrows, rightForward, downForward, style, group, inherit",this))return F;C("61"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Stepper",this.group=X;var V=!1===R?{}:a.getStyle(this.type,this.group,W);c(t)&&(t=null!=V.list?V.list:[0,1,2,3,4,5,6,7,8,9]),c(n)&&(n=null!=V.width?V.width:200),c(i)&&(i=null!=V.backgroundColor?V.backgroundColor:"white"),c(o)&&(o=null!=V.borderColor?V.borderColor:null),c(r)&&(r=null!=V.borderWidth?V.borderWidth:null),o<0||r<0?o=r=null:null!=o&&null==r&&(r=1),c(l)&&(l=null!=V.color?V.color:"#555"),c(s)&&(s=null!=V.label?V.label:""),"string"!=typeof s&&"number"!=typeof s||(s=new a.Label({text:s,size:null!=V.size?2*V.size:64,color:l,align:null!=V.align?V.align:"center",valign:null!=V.valign?V.valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),c(u)&&(u=null!=V.vertical&&V.vertical),c(h)&&(h=null==V.arrows||V.arrows),c(d)&&(d=null!=V.corner?V.corner:16),c(p)&&(p=null!=V.shadowColor?V.shadowColor:"rgba(0,0,0,.3)"),c(f)&&(f=null!=V.shadowBlur?V.shadowBlur:14),c(g)&&(g=null!=V.continuous&&V.continuous),c(y)&&(y=null==V.display||V.display),c(b)&&(b=null==V.press||V.press),c(v)&&(v=null==V.hold||V.hold),c(w)&&(w=null!=V.holdDelay?V.holdDelay:400),c(k)&&(k=null!=V.holdSpeed?V.holdSpeed:200),c(T)&&(T=null==V.draggable||V.draggable),(c(O)||O<=0)&&(O=null!=V.dragSensitivity?V.dragSensitivity:.1),c(A)&&(A=null!=V.dragRange?V.dragRange:200),c(S)&&(S=null!=V.stepperType?V.stepperType:"list"),c(I)&&(I=null!=V.min?V.min:0),c(E)&&(E=null!=V.max?V.max:100),c(M)&&(M=null!=V.step?V.step:1),c(B)&&(B=null!=V.step2?V.step2:M),c(z)&&B!=M&&"number"==S&&(z=null==V.arrows2||V.arrows2),c(j)&&(j=null!=V.arrows2Scale?V.arrows2Scale:.5),c(_)&&(_=null==V.keyEnabled||V.keyEnabled),c(D)&&(D=null==V.keyArrows||V.keyArrows),c(L)&&(L=null==V.rightForward||V.rightForward),c(Y)&&(Y=null!=V.downForward?V.downForward:"number"!=S);var N,G,H,K,q=this,U=100,Z=M,J=1;if("number"==S){if(I=Number(I),E=Number(E),NaN==I&&(I=0),NaN==E&&(E=100),E<I){J=-1;var $=E;E=I,I=$,G=E}else G=I;this.min=I,this.max=E,I<0&&0<E&&(G=0),M=Math.abs(M),H=Math.max(te(M),te(B))}else if("letter"==S){t="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),"string"!=typeof I&&(I="A"),"string"!=typeof E&&(E="Z"),I=I.substr(0,1).toUpperCase(),E=E.substr(0,1).toUpperCase();var Q=t.indexOf(I);Q<0&&(I="A",Q=0);var ee=t.indexOf(E);ee<0&&(E="Z",ee=t.length),ee<Q&&(t.reverse(),Q=t.length-1-Q,ee=t.length-1-ee),t=t.splice(Q,ee-Q+1)}else S="list";function te(e){var t=String(e).split(".")[1];return t?t.length:0}var ne=0,ie=0;T&&this.on("mousedown",function(e){q.zimAccessibility&&q.zimAccessibility.aria||(this.stage.mouseMoveOutside=!0,ne=e.rawX/e.target.stage.scaleX,ie=e.rawY/e.target.stage.scaleY,K=this.stage.on("stagemousemove",function(e){ne=e.rawX/e.target.stage.scaleX,ie=e.rawY/e.target.stage.scaleY}))},null,!0),(this.label=s).mouseChildren=!1,s.mouseEnabled=!1;var oe,re,ae,se,le,ce,ue,he,de,pe,fe,ge,me,ye=!1;if(h||z){var be=new createjs.Shape;be.graphics.ss(o).s(r).f("rgba(255,255,255,.11)").r(0,0,150,150),be.regX=75,be.regY=87.5}if(h&&(se=this.containerPrev=new a.Container({style:!1}),this.addChild(se),se.hitArea=be,le=this.arrowPrev=new a.Triangle(U,80,80,i,null,null,null,null,null,null,!1),-1!=p&&0<f&&(se.shadow=new createjs.Shadow(p,3,3,f)),se.addChild(le),se.cursor="pointer",se.on("mousedown",function(e){if(!q.zimAccessibility||!q.zimAccessibility.aria){Z=M;var t=u?Y?1:-1:L?-1:1;Te(t),Ce(t,null,null,e.stageX/e.target.stage.scaleX,e.stageY/e.target.stage.scaleY)}}),v&&se.on("pressup",ke),u?(se.rotation=180,se.x=n/2,se.y=y?se.height+25+U+se.height/2+25:2*se.height):(se.rotation=-90,se.x=se.height/2,se.y=se.width/2)),y){var ve=this.textBox=new a.Shape({style:!1});ve.cursor="pointer",this.addChild(ve),ve.setBounds(0,0,n,U),null!=o&&ve.graphics.s(o).ss(r);var we,xe=d;Array.isArray(xe)||(xe=[d,d,d,d]),ve.graphics.f(i).rc(0,0,n,U,xe[0],xe[1],xe[2],xe[3]),-1!=p&&0<f&&(ve.shadow=new createjs.Shadow(p,3,3,f)),h&&(u?h&&(ve.y=le.height+25):h&&(ve.x=le.height+25)),this.addChild(s),0<t.length&&(s.text=t[N=0]),s.center(q),ve.on("mousedown",function(e){q.zimAccessibility&&q.zimAccessibility.aria||(we=q.currentValue,b&&Te(1),Ce(1,!0,null,e.stageX/e.target.stage.scaleX,e.stageY/e.target.stage.scaleY),"number"==S&&(clearTimeout(ae),ye=!0,ae=setTimeout(function(){ye=!1},200)))}),ve.on("pressup",function(){q.zimAccessibility&&q.zimAccessibility.aria||ye&&(Oe(G=Math.round(G),G),q.currentValue!=we&&q.dispatchEvent("change"),we=q.currentValue)})}else 0<t.length&&(N=0);function Ce(e,t,n,i,o){if(v){holdY=o,0==(ge=i)&&(ge=1),0==holdY&&(holdY=1),T||(O=1),me=new a.Proportion(0,A,k,k*O);var r=k;oe=setTimeout(function(){!function i(){re=setTimeout(function(){var o=e;if(T){var a=Math.abs(ne-ge),s=Math.abs(ie-holdY);u?(t||n||(a=0),n&&(s=0)):(t||n||(s=0),n&&(a=0)),(10<=a||10<=s)&&(r=s<a?(Z=u?B:M,o=0<ne-ge?1:-1,me.convert(Math.abs(ge-ne))):(Z=u?M:B,o=0<ie-holdY?1:-1,"number"!=S&&Y||(o*=-1),me.convert(Math.abs(holdY-ie))))}Te(o),i()},r)}()},w)}}function ke(){q.zimAccessibility&&q.zimAccessibility.aria||(clearTimeout(oe),clearTimeout(re))}function Te(e){var n;if("number"==S){var i=G;G=a.decimals(G+=Z*e*J,H),g?G>q.max?G=q.min:G<q.min&&(G=q.max):(G>q.max?(G=1==M?q.max:i,y&&(ve.cursor="default")):y&&(ve.cursor="pointer"),G<q.min&&(G=1==M?q.min:i))}else{if(n=N+e,g)n>t.length-1&&(n=0),n<0&&(n=t.length-1);else{if(n>t.length-1)return void(y&&(ve.cursor="default"));if(y&&(ve.cursor="pointer"),n<0)return}N=n}Oe("number"==S?G:t[N],"number"==S?G:N),q.currentValue!=we&&q.dispatchEvent("change"),we=q.currentValue}function Pe(){q.keyFocus=!0;var e=document.activeElement;e&&e.blur()}function Oe(n,o){N=o,y&&("number"==S&&0!=n&&0<H&&(n=a.decimals(n,H,!0)),s.text=n,s.center(q)),h&&(se.alpha=1,le.color=i,se.cursor="pointer",ce.alpha=1,ue.color=i,ce.cursor="pointer",g||("number"==S?(N==q.min&&(0<J?Ae():Se()),N==q.max&&(0<J?Se():Ae())):(0==N&&(u?Se():Ae()),N==t.length-1&&(u?Ae():Se())))),!ce||a.OPTIMIZE||!e&&OPTIMIZE||!ce.stage?!s||a.OPTIMIZE||!e&&OPTIMIZE||!s.stage||s.stage.update():ce.stage.update(),q.zimAccessibility&&q.zimAccessibility.changeTitle(q,null,!0)}function Ae(){h&&(se.alpha=.8,le.color="#aaa",se.cursor="default")}function Se(){h&&(ce.alpha=.8,ue.color="#aaa",ce.cursor="default")}h&&(ce=this.containerNext=new a.Container({style:!1}),this.addChild(ce),ce.hitArea=be.clone(),ue=this.arrowNext=new a.Triangle(U,80,80,i,null,null,null,null,null,null,!1),-1!=p&&0<f&&(ce.shadow=new createjs.Shadow(p,3,3,f)),ce.addChild(ue),ce.cursor="pointer",ce.on("mousedown",function(e){if(!q.zimAccessibility||!q.zimAccessibility.aria){Z=M;var t=u?Y?-1:1:L?1:-1;Te(t),Ce(t,null,null,e.stageX/e.target.stage.scaleX,e.stageY/e.target.stage.scaleY)}}),v&&ce.on("pressup",ke),u?(ce.rotation=0,ce.x=n/2,ce.y=ce.getBounds().height/2):(ce.rotation=90,ce.x=y?ve.x+ve.getBounds().width+ce.getBounds().height/2+25:se.x+se.getBounds().width,ce.y=ce.getBounds().width/2)),v&&y&&ve.on("pressup",ke),z&&((he=this.prev2=new a.Container({style:!1})).hitArea=be.clone(),de=this.arrowPrev2=new a.Triangle(U,80,80,"rgba(0,0,0,.2)",i,2,null,null,null,null,!1),he.addChild(de),he.cursor="pointer",he.sca(j),he.alpha=.5,he.on("mousedown",function(e){if(!q.zimAccessibility||!q.zimAccessibility.aria){Z=B;var t=u?L?-1:1:Y?1:-1;Te(t),Ce(t,null,!0,e.stageX/e.target.stage.scaleX,e.stageY/e.target.stage.scaleY)}}),v&&he.on("pressup",ke),(pe=this.next2=new a.Container({style:!1})).hitArea=be.clone(),fe=this.arrowNext2=new a.Triangle(U,80,80,"rgba(0,0,0,.2)",i,2,null,null,null,null,!1),pe.addChild(fe),pe.cursor="pointer",pe.sca(j),pe.alpha=.5,pe.on("mousedown",function(e){if(!q.zimAccessibility||!q.zimAccessibility.aria){Z=B;var t=u?L?1:-1:Y?-1:1;Te(t),Ce(t,null,!0,e.stageX/e.target.stage.scaleX,e.stageY/e.target.stage.scaleY)}}),v&&pe.on("pressup",ke),u?(he.y=this.height/2,he.x=-he.width/2-25*Math.max(.2,Math.min(1,j)),he.rotation=270,pe.y=this.height/2,pe.x=this.width+pe.width/2+25*Math.max(.2,Math.min(1,j)),pe.rotation=90):(pe.x=this.width/2,pe.y=-pe.height/2-25*Math.max(.2,Math.min(1,j)),pe.rotation=0,he.x=this.width/2,he.y=this.height+he.height/2+25*Math.max(.2,Math.min(1,j)),he.rotation=180),this.addChild(he,pe)),Object.defineProperty(this,"stepperArray",{get:function(){if("number"==S){t=[];for(var e=q.min;e<=q.max;e+=Math.min(M,B))t.push(a.decimals(e,H,null,!1))}return t},set:function(e){t=e,q.selectedIndex=q.selectedIndex}}),Object.defineProperty(this,"min",{get:function(){return I},set:function(e){"number"==S?(q.currentValue<e&&(q.currentValue=e),I=e,q.selectedIndex=q.selectedIndex):I=e}}),Object.defineProperty(this,"max",{get:function(){return E},set:function(e){"number"==S?(q.currentValue>e&&(q.currentValue=e),E=e,q.selectedIndex=q.selectedIndex):E=e}}),Oe("number"==S?G:t[N],"number"==S?G:N),Object.defineProperty(this,"selectedIndex",{get:function(){return"number"==S?q.stepperArray.indexOf(q.currentValue):N},set:function(e){c(e)||("number"==S?(N=Math.min(q.stepperArray.length-1,Math.max(0,e)),Oe(G=q.stepperArray[N],G)):(e=Math.min(t.length-1,Math.max(0,e)),Oe(t[N=e],N)))}}),Object.defineProperty(this,"currentValue",{get:function(){return"number"==S?G:t[N]},set:function(e){if(!c(e))if("number"==S){if(e=Number(e),q.max>q.min){if(e>q.max||e<q.min)return}else if(e<q.max||e>q.min)return;if(newIndex=q.stepperArray.indexOf(e),newIndex<0)return;N=newIndex,Oe(G=q.stepperArray[N],G)}else{if(!(-1<t.indexOf(e)))return;if((e=t.indexOf(e))==q.selectedIndex)return;Oe(t[N=e],N)}}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return q.currentValue},set:function(e){String(e)!=String(q.currentValue)&&(q.currentValue=e,q.dispatchEvent("change"))}}),Object.defineProperty(this,"continuous",{get:function(){return g},set:function(e){g=e,"number"==S?Oe(G,G):Oe(t[q.selectedIndex],q.selectedIndex)}}),this._enabled=!0,Object.defineProperty(q,"enabled",{get:function(){return q._enabled},set:function(n){x(q,n),n?("number"==S?Oe(G,G):Oe(t[q.selectedIndex],q.selectedIndex),window.addEventListener("keydown",q.keyDownEvent)):(Ae(),Se(),window.removeEventListener("keydown",q.keyDownEvent),y&&(s.mouseChildren=!1),y&&(s.mouseEnabled=!1)),!ce||a.OPTIMIZE||!e&&OPTIMIZE||!ce.stage?!s||a.OPTIMIZE||!e&&OPTIMIZE||!s.stage||s.stage.update():ce.stage.update()}}),"undefined"!=typeof KEYFOCUS&&(a.KEYFOCUS=KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return a.KEYFOCUS==q},set:function(e){a.KEYFOCUS=q}}),a.KEYFOCUS||Pe(),this.on("mousedown",function(){Pe()});var Ie=!1,Ee=!1,Me=!1;this.on("mousedown",function(){q.zimAccessibility&&q.zimAccessibility.aria||(q.focus=!0,Me=Ee=!(Ie=!0))}),this.keyDownEvent=function(e){if(q.stage&&(q.zimAccessibility&&q.focus||!q.zimAccessibility&&q.keyFocus)){e||(e=event);var t,n=e.keyCode;if(D&&37<=n&&n<=40){var i=Y?40:38,o=L?39:37,r=Y?38:40,a=L?37:39;n==i||n==o?(Z=u&&n==i||!u&&n==o?M:B,Te(1)):n!=r&&n!=a||(Z=u&&n==r||!u&&n==a?M:B,Te(-1))}_&&("number"==S?(!e.shiftKey&&48<=n&&n<=57?t=n-48:96<=n&&n<=105?t=n-96:190==n?Ee=!0:173==n||189==n?(q.currentValue=-1*q.currentValue,q.currentValue!=we&&q.dispatchEvent("change"),we=q.currentValue,Me=!Me):46==n&&(Ee=!(Ie=!0)),Ie&&!c(t)?(Ee&&(t/=10),Me&&(t*=-1),q.currentValue=t,Ie=!1,q.currentValue!=we&&q.dispatchEvent("change"),we=q.currentValue):c(t)||(Ee&&(t=String(t/10).substr(1)),q.currentValue=Number(Math.floor(Number(s.text))+String(t)),q.currentValue!=we&&q.dispatchEvent("change"),we=q.currentValue)):(q.currentValue=String.fromCharCode(e.keyCode),q.currentValue!=we&&q.dispatchEvent("change"),we=q.currentValue))}},window.addEventListener("keydown",this.keyDownEvent),this.next=function(){Te(1)},!(this.prev=function(){Te(-1)})!==R&&P(this,V),this.clone=function(){return q.cloneProps(new a.Stepper(t,n,i,o,r,s.clone(),l,u,h,d,p,f,g,y,b,v,w,k,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,this.group,W))},this.dispose=function(){return window.removeEventListener("keydown",q.keyDownEvent),q.stage&&q.stage.off(K),this.zimContainer_dispose(),!0}},a.zut=function(e){if(c(e)||!e.key)return!0;a.async("https://zimjs.com/gamdata.php?id="+e.key+"&player="+e.player+"&score="+e.score+"&reverse="+e.info.reverse+"&total="+e.info.total+"&allowZero="+e.info.allowZero,e.info.type)},a.extend(a.Stepper,a.Container,["clone","dispose"],"zimContainer",!1),a.Slider=function(t,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,O){var A;if(A=m(a.Slider,arguments,"min, max, step, button, barLength, barWidth, barColor, vertical, useTicks, inside, keyArrows, keyArrowsStep, keyArrowsH, keyArrowsV, damp, style, group, inherit",this))return A;C("62"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Slider",this.group=T;var S=!1===k?{}:a.getStyle(this.type,this.group,O);if(c(t)&&(t=null!=S.min?S.min:0),c(o)&&(o=null!=S.max?S.max:10),o-t!=0){var I;c(r)&&(r=null!=S.step?S.step:0),c(l)&&(l=null!=S.barLength?S.barLength:300),c(u)&&(u=null!=S.barWidth?S.barWidth:3),c(h)&&(h=null!=S.barColor?S.barColor:"#666"),c(d)&&(d=null!=S.vertical&&S.vertical),c(p)&&(p=null!=S.useTicks&&S.useTicks),c(f)&&(f=null!=S.inside&&S.inside),c(g)&&(g=null==S.keyArrows||S.keyArrows),c(b)&&(b=null==S.keyArrowsH||S.keyArrowsH),c(v)&&(v=null==S.keyArrowsV||S.keyArrowsV),c(y)&&(y=null!=S.keyArrowsStep?S.keyArrowsStep:(o-t)/100),c(w)&&(w=null!=S.damp&&S.damp);var E,M,B=!(!c(S.backing)&&"Pattern"!=S.backing.type);if(c(s)){var z=30,j=40;d&&(z=50,j=40),s=null!=S.button?S.button:new a.Button({width:null!=S.width?S.width:z,height:null!=S.height?S.height:j,label:"",backgroundColor:null!=S.backgroundColor?S.backgroundColor:"#fff",rollBackgroundColor:null!=S.rollBackgroundColor?S.rollBackgroundColor:"#ddd",borderColor:null!=S.borderColor?S.borderColor:B?"#666":null,borderWidth:null!=S.borderWidth?S.borderWidth:B?1:null,corner:null!=S.corner?S.corner:0,backing:null!=S.backing?S.backing.clone():null,rollBacking:null!=S.rollBacking?S.rollBacking.clone():null,hitPadding:30,style:!1})}s.rollPersist=!0,d?(E=s.width,f?this.setBounds(0,0,E,M=l):this.setBounds(-s.width/2,-s.height/2,E,M=l+s.height)):(M=Math.max(s.height,u),f?this.setBounds(0,0,E=l,M):this.setBounds(-s.width/2,-s.height/2,E=l+s.width,M));var _,D,L,Y,R,X,W,F,V,N=this,G=t,H=0;if(this.button=s,this.cursor="pointer",p&&0!=r){Y=this.ticks=new a.Shape({style:!1}),this.addChild(Y),(R=Y.graphics).ss(1).s(h);var K=Math.round((o-t)/r),q=(o-t)/K;if(q!=r&&n&&i("zim.Slider() : non-divisible step ("+r+") adjusted"),r=q,f)var U=(l-(d?s.height:s.width))/Math.abs(K);else U=l/Math.abs(K)}if(d){var Z=f?s.height/2:0;if((_=this.bar=new a.Rectangle(u,l,h,null,null,null,null,null,!1)).expand(20,0),_.centerReg(this),s.centerReg(this),L=_.getBounds(),D=new createjs.Rectangle(_.x,L.y+Z,0,L.height-2*Z),p&&0!=r){for(var J=0;J<=Math.abs(K);J++)R.mt(0,Z+U*J).lt(20,Z+U*J);Y.x=_.x+15}}else if(Z=f?s.width/2:0,(_=this.bar=new a.Rectangle(l,u,h,null,null,null,null,null,!1)).expand(0,20),_.centerReg(this),s.centerReg(this),L=_.getBounds(),D=new createjs.Rectangle(L.x+Z,_.y,L.width-2*Z,0),p&&0!=r){for(J=0;J<=Math.abs(K);J++)R.mt(Z+U*J,0).lt(Z+U*J,-20);Y.y=_.y-10}s.x=D.x,s.y=D.y,s.on("mousedown",function(e){I=e.target.stage,N.focus=!0;var t=N.globalToLocal(e.stageX/I.scaleX,e.stageY/I.scaleY);X=t.x-s.x,W=t.y-s.y,N.stage&&(N.stage.mouseMoveOutside=!0)}),s.on("pressmove",function(e){ie(e)}),_.on("mousedown",function(e){I=e.target.stage,W=X=0,N.zimAccessibility&&N.zimAccessibility.aria||ie(e)}),w&&(V=new a.Damp(F=t,w),N.ticker=a.Ticker.add(function(){F=V.convert(G)})),Object.defineProperty(this,"currentValue",{get:function(){return w?F:G},set:function(n){c(n)||(t<o?(n<t&&(n=t),o<n&&(n=o)):(t<n&&(n=t),n<o&&(n=o)),G=n=ne(n),V&&V.immediate(G),H=d?(s.y=(n-o)/(t-o)*D.height+Z,s.y):(s.x=(n-t)/(o-t)*D.width+Z,s.x),re(),a.OPTIMIZE||!e&&OPTIMIZE||!N.stage||N.stage.update())}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return w?F:G},set:function(e){e!=N.currentValue&&(N.currentValue=e,N.dispatchEvent("change"))}}),Object.defineProperty(this,"min",{get:function(){return t},set:function(e){n&&i("min is read only")}}),Object.defineProperty(this,"max",{get:function(){return o},set:function(e){n&&i("max is read only")}}),Object.defineProperty(this,"step",{get:function(){return r},set:function(e){n&&i("step is read only")}}),Object.defineProperty(this,"keyArrowsH",{get:function(){return b},set:function(e){b=e}}),Object.defineProperty(this,"keyArrowsV",{get:function(){return v},set:function(e){v=e}}),"undefined"!=typeof KEYFOCUS&&(a.KEYFOCUS=KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return a.KEYFOCUS==N},set:function(e){a.KEYFOCUS=N}}),g&&!a.KEYFOCUS&&ae(),this.on("mousedown",function(){g&&ae()});var $=!1,Q=!1,ee=!1,te=!1;this.keyDownEvent=function(e){N.stage&&(N.zimAccessibility&&N.focus||!N.zimAccessibility&&N.keyFocus)&&(37==e.keyCode&&b?$=!0:40==e.keyCode&&v?Q=!0:39==e.keyCode&&b?ee=!0:38==e.keyCode&&v&&(te=!0),null==N.keyInterval&&($||Q||ee||te)&&(se(),N.keyTimeout=setTimeout(function(){null==N.keyInterval&&($||Q||ee||te)&&(N.keyInterval=setInterval(se,40))},140)))},window.addEventListener("keydown",this.keyDownEvent),N.keyUpEvent=function(e){37==e.keyCode?$=!1:40==e.keyCode?Q=!1:39==e.keyCode?ee=!1:38==e.keyCode&&(te=!1),null==N.keyInterval||$||Q||ee||te||(clearInterval(N.keyInterval),N.keyInterval=null)},window.addEventListener("keyup",this.keyUpEvent),this._enabled=!0,Object.defineProperty(N,"enabled",{get:function(){return N._enabled},set:function(e){x(N,e),e?(window.addEventListener("keydown",N.keyDownEvent),window.addEventListener("keyup",N.keyUpEvent)):(window.removeEventListener("keydown",N.keyDownEvent),window.removeEventListener("keyup",N.keyUpEvent))}}),!1!==k&&P(this,S),this.clone=function(){return N.cloneProps(new a.Slider(t,o,r,s.clone(),l,u,h,d,p,f,g,y,b,v,w,k,this.group,O))},this.dispose=function(){return window.removeEventListener("keydown",N.keyDownEvent),window.removeEventListener("keyup",N.keyUpEvent),this.zimContainer_dispose(),!0}}else i("ZIM Slider range must not be 0");function ne(e){return 0==r?e:Math.round(e/r)*r}function ie(n){var i=N.globalToLocal(n.stageX/I.scaleX,n.stageY/I.scaleY),r=function(e,t,n){return{x:e=Math.max(n.x,Math.min(n.x+n.width,e)),y:t=Math.max(n.y,Math.min(n.y+n.height,t))}}(i.x-X,i.y-W,D);H=d?(s.x=r.x,G=ne((r.y-D.y)/D.height*(t-o)),s.y=D.y+G*D.height/(t-o),G+=o,s.y!=H&&N.dispatchEvent("change"),s.y):(G=ne((r.x-D.x)/D.width*(o-t)),s.x=D.x+G*D.width/(o-t),G+=t,s.y=r.y,s.x!=H&&N.dispatchEvent("change"),s.x),re(),a.OPTIMIZE||!e&&OPTIMIZE||!N.stage||N.stage.update()}function oe(e){return 0<e?1:-1}function re(){N.zimAccessibility&&N.zimAccessibility.changeTitle(N,null,!0)}function ae(){N.keyFocus=!0;var e=document.activeElement;e&&e.blur()}function se(){($||Q)&&(N.currentValueEvent-=0<r?r*oe(o-t):y*oe(o-t)),(ee||te)&&(N.currentValueEvent+=0<r?r*oe(o-t):y*oe(o-t))}},a.extend(a.Slider,a.Container,["clone","dispose"],"zimContainer",!1),a.Dial=function(t,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,O,A,S,I,E,M,B,z){var j;if(j=m(a.Dial,arguments,"min, max, step, width, backgroundColor, indicatorColor, indicatorScale, indicatorType, innerCircle, innerScale, useTicks, innerTicks, tickColor, limit, keyArrows, keyArrowsStep, keyArrowsH, keyArrowsV, continuous, continuousMin, continuousMax, damp, style, group, inherit",this))return j;C("63"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Dial",this.group=B;var _=!1===M?{}:a.getStyle(this.type,this.group,z);if(c(t)&&(t=null!=_.min?_.min:0),c(o)&&(o=null!=_.max?_.max:10),o-t!=0){var D;c(r)&&(r=null!=_.step?_.step:1),c(s)&&(s=null!=_.width?_.width:100),c(l)&&(l=null!=_.backgroundColor?_.backgroundColor:"#666"),c(u)&&(u=null!=_.indicatorColor?_.indicatorColor:"#222"),c(h)&&(h=null!=_.indicatorScale?_.indicatorScale:1),c(d)&&(d=null!=_.indicatorType?_.indicatorType:"arrow"),c(p)&&(p=null==_.innerCircle||_.innerCircle),c(f)&&(f=null!=_.innerScale?_.innerScale:.5),c(g)&&(g=null==_.useTicks||_.useTicks),c(y)&&(y=null!=_.innerTicks&&_.innerTicksinnerTicks),c(b)&&(b=null!=_.tickColor?_.tickColor:u),c(v)&&(v=null==_.limit||_.limit),c(w)&&(w=null==_.keyArrows||_.keyArrows),c(k)&&(k=null!=_.keyArrowsStep?_.keyArrowsStep:(o-t)/100),c(T)&&(T=null==_.keyArrowsH||_.keyArrowsH),c(O)&&(O=null==_.keyArrowsV||_.keyArrowsV),c(A)&&(A=null!=_.continuous&&_.continuous),A&&(v=null!=_.limit&&_.limit),c(E)&&(E=null!=_.damp&&_.damp),0==v&&(E=null);var L=this;this.cursor="pointer";var Y=s/2,R=t,X=0,W=this.backing=new a.Circle(Y,l,null,null,null,null,null,!1);if(this.addChild(W),p){var F=y?"rgba(0,0,0,.2)":"rgba(0,0,0,.1)";"black"!=l&&"#000"!=l&&"#000000"!=l&&"#111"!=l&&"#111111"!=l||(F="#222");var V=this.inner=new a.Circle(Y*f,F,null,null,null,null,null,!1);if(this.addChild(V),!y){var N=this.inner2=new a.Circle(Y*(f-.1),"rgba(0,0,0,.1)",null,null,null,null,null,!1);this.addChild(N)}}var G,H,K,q,U=Math.abs(o-t)/r;if(g&&0!=r){var Z=this.ticks=new a.Container({style:!1});this.addChild(Z);for(var J=0;J<(A?U:U+1);J++){var $;($=new a.Rectangle(1,.2*Y,b,null,null,null,null,null,!1)).regY=Y*(y?f-.05:1.28),$.regX=.5,$.rotation=360/(A?U:U+1)*J,Z.addChild($)}}if(this.setBounds(-Y,-Y,s,s),"dot"==d||"circle"==d){var Q=this.indicator=new a.Container({style:!1}),ee=this.indicatorShape=new a.Circle(.19*Y,u,null,null,null,null,null,!1);Q.addChild(ee),a.sca(Q,h),Q.regY=Y-Q.getBounds().width*h/2-.07*Y}else"line"==d||"rectangle"==d?(Q=this.indicator=new a.Container({style:!1}),ee=this.indicatorShape=new a.Rectangle(.1*Y,.3*Y,u,null,null,null,null,null,null,!1),Q.addChild(ee),a.sca(Q,h),Q.regY=Y-Q.getBounds().width*h/2-.07*Y,Q.regX=.05*Y):(Q=this.indicator=new a.Container({style:!1}),ee=this.indicatorShape=new a.Triangle(.4*Y,.4*Y,.4*Y,u,null,null,null,null,null,null,!1),Q.addChild(ee),a.sca(Q,h),Q.regY=Y-Q.getBounds().height*h*(y?.85:.75),y&&(ee.rotation=180));Q.regY/=h,this.addChild(Q);var te,ne,ie=0;if(A)var oe=0,re=0,ae=!1,se=!1,le=!0;this.on("mousedown",function(e){if(D=e.target.stage,!L.zimAccessibility||!L.zimAccessibility.aria){G=Q.rotation;var t=L.parent.globalToLocal(e.stageX/D.scaleX,e.stageY/D.scaleY),n=t.x-L.x,i=L.y-t.y;H=180*Math.atan2(n,i)/Math.PI;var o=(new Date).getTime();K=L.on("pressmove",function(e){if(ae){var t=L.parent.globalToLocal(e.stageX/D.scaleX,e.stageY/D.scaleY),n=t.x-L.x,i=L.y-t.y;H=180*Math.atan2(n,i)/Math.PI,G=Q.rotation}n=(t=L.parent.globalToLocal(e.stageX/D.scaleX,e.stageY/D.scaleY)).x-L.x,i=L.y-t.y;var o=180*Math.atan2(n,i)/Math.PI,r=G+o-H;r=(r+36e5)%360,v&&180<Math.abs(r-ie)||(me(r),ie=r)}),q=this.on("pressup",function(e){(new Date).getTime()-o<200&&(t=L.parent.globalToLocal(e.stageX/D.scaleX,e.stageY/D.scaleY),n=t.x-L.x,i=L.y-t.y,me(180*Math.atan2(n,i)/Math.PI)),G=Q.rotation,L.off("pressmove",K),L.off("pressup",q)})}}),E&&(ne=new a.Damp(te=t,E),L.ticker=a.Ticker.add(function(){te=ne.convert(R)})),Object.defineProperty(this,"currentValue",{get:function(){return E?te:R},set:function(n){c(n)||(A?(ae=!1,c(S)||c(I)?c(S)?c(I)||I<n&&(n=I,ae=!0):n<S&&(n=S,ae=!0):S<I?(n<S&&(n=S,ae=!0),I<n&&(n=I,ae=!0)):(S<n&&(n=S,ae=!0),n<I&&(n=I,ae=!0)),le&&(se=!0,re=360*Math.floor(n/(o-t)))):t<o?(n<t&&(n=v?t:o),o<n&&(n=v?o:t)):(t<n&&(n=v?t:o),n<o&&(n=v?o:t)),n=pe(R=n),E&&E.immediate(R),Q.rotation=360*(n-t)/(o-t+(A?0:fe(o-t)*r)),Q.rotation=(Q.rotation+36e5)%360,X=n-t,ie=Q.rotation,ge(),a.OPTIMIZE||!e&&OPTIMIZE||!L.stage||L.stage.update())}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return E?te:R},set:function(e){e!=L.currentValue&&(L.currentValue=e,L.dispatchEvent("change"))}}),Object.defineProperty(this,"min",{get:function(){return t},set:function(e){A?t=e:n&&i("min is read only")}}),Object.defineProperty(this,"max",{get:function(){return o},set:function(e){A?o=e:n&&i("max is read only")}}),Object.defineProperty(this,"continuous",{get:function(){return A},set:function(e){n&&i("continuous is read only")}}),Object.defineProperty(this,"continuousMin",{get:function(){return S},set:function(e){L.currentValue<(S=e)&&(L.currentValue=S)}}),Object.defineProperty(this,"continuousMax",{get:function(){return I},set:function(e){L.currentValue>(I=e)&&(L.currentValue=I)}}),Object.defineProperty(this,"step",{get:function(){return r},set:function(e){n&&i("step is read only")}}),Object.defineProperty(this,"keyArrowsH",{get:function(){return T},set:function(e){T=e}}),Object.defineProperty(this,"keyArrowsV",{get:function(){return O},set:function(e){O=e}}),"undefined"!=typeof KEYFOCUS&&(a.KEYFOCUS=KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return a.KEYFOCUS==L},set:function(e){a.KEYFOCUS=L}}),w&&!a.KEYFOCUS&&ye(),this.on("mousedown",function(){w&&ye()});var ce=!1,ue=!1,he=!1,de=!1;this.keyDownEvent=function(e){L.stage&&(L.zimAccessibility&&L.focus||!L.zimAccessibility&&L.keyFocus)&&(37==e.keyCode&&T?ce=!0:40==e.keyCode&&O?ue=!0:39==e.keyCode&&T?he=!0:38==e.keyCode&&O&&(de=!0),null==L.keyInterval&&(ce||ue||he||de)&&(be(),L.keyTimeout=setTimeout(function(){null==L.keyInterval&&(ce||ue||he||de)&&(L.keyInterval=setInterval(be,40))},140)))},window.addEventListener("keydown",this.keyDownEvent),L.keyUpEvent=function(e){37==e.keyCode?ce=!1:40==e.keyCode?ue=!1:39==e.keyCode?he=!1:38==e.keyCode&&(de=!1),null==L.keyInterval||ce||ue||he||de||(clearInterval(L.keyInterval),L.keyInterval=null)},window.addEventListener("keyup",this.keyUpEvent),this._enabled=!0,Object.defineProperty(L,"enabled",{get:function(){return L._enabled},set:function(e){x(L,e),e?(L.keyDownEvent=window.addEventListener("keydown",L.keyDownEvent),L.keyUpEvent=window.addEventListener("keyup",L.keyUpEvent)):(window.removeEventListener("keydown",L.keyDownEvent),window.removeEventListener("keyup",L.keyUpEvent))}}),!1!==M&&P(this,_),this.clone=function(){return L.cloneProps(new a.Dial(t,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,O,A,S,I,E,M,this.group,z))},this.dispose=function(){return window.removeEventListener("keydown",L.keyDownEvent),window.removeEventListener("keyup",L.keyUpEvent),this.zimContainer_dispose(),!0}}else i("ZIM Dial range must not be 0");function pe(e){return 0==r?e:Math.round(e/r)*r}function fe(e){return 0<e?1:-1}function ge(){L.zimAccessibility&&L.zimAccessibility.changeTitle(L,null,!0)}function me(n){if(A){se&&(se=!1),oe+180<n?re-=360:n<oe-180&&(re+=360),le=!1;var i=L.currentValue;return L.currentValue=pe((re+n)*(o-t)/360),i!=L.currentValue&&L.dispatchEvent("change"),oe=n,le=!0}var s;n<0&&(n+=360),n%=360,0!=r?(s=pe((n=Math.min(n,360-360/(U+1)))/(360-360/(U+1))*(o-t)),Q.rotation=s*(360-360/(U+1))/(o-t)):s=(Q.rotation=n)/360*(o-t),s!=X&&(R=(X=s)+t,L.dispatchEvent("change"),a.OPTIMIZE||!e&&OPTIMIZE||!L.stage||L.stage.update()),ge()}function ye(){L.keyFocus=!0;var e=document.activeElement;e&&e.blur()}function be(){(ce||ue)&&(L.currentValueEvent-=0<r?r*fe(o-t):k*fe(o-t)),(he||de)&&(L.currentValueEvent+=0<r?r*fe(o-t):k*fe(o-t))}},a.extend(a.Dial,a.Container,["clone","dispose"],"zimContainer",!1),a.Tabs=function(t,o,r,s,l,u,d,p,f,g,y,b,v,k,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,X,W,F,V,N,G,H,K,q,U,Z,J,$,Q,ee){var te;if(te=m(a.Tabs,arguments,"width, height, tabs, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, selectedColor, selectedRollColor, vertical, spacing, currentEnabled, currentSelected, corner, base, keyEnabled, gradient, gloss, backing, rollBacking, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, waitColor, rollWaitColor, waitModal, waitEnabled, backdropColor, align, valign, labelAlign, labelValign, labelIndent, labelIndentHorizontal, labelIndentVertical, indent, useTap, excludeCustomTap, style, group, inherit",this))return te;C("65");var ne=!1===$?{}:a.getStyle("Tabs",this.group,ee);c(b)&&(b=null!=ne.vertical&&ne.vertical);var ie=!c(t);if(c(t)&&(t=null!=ne.width?ne.width:b?60:240),c(o)&&(o=null!=ne.height?ne.height:b?240:60),this.zimContainer_constructor(null,null,null,null,!0),this.type="Tabs",this.group=Q,(c(r)||r.length<=0)&&(r=null!=ne.tabs?ne.tabs:[1,2,3,4]),c(s)&&(s=null!=ne.backgroundColor?ne.backgroundColor:"#777"),c(l)&&(l=null!=ne.rollBackgroundColor?ne.rollBackgroundColor:"#555"),c(u)&&(u=null!=ne.selectedBackgroundColor?ne.selectedBackgroundColor:"#333"),c(d)&&(d=null!=ne.selectedRollBackgroundColor?ne.selectedRollBackgroundColor:l),c(p)&&(p=null!=ne.color?ne.color:"white"),c(f)&&(f=null!=ne.rollColor?ne.rollColor:p),c(g)&&(g=null!=ne.selectedColor?ne.selectedColor:p),c(y)&&(y=null!=ne.selectedRollColor?ne.selectedRollColor:f),c(M)&&(M=null!=ne.backing?ne.backing.clone():null),c(B)&&(B=null!=ne.rollBacking?ne.rollBacking.clone():null),c(F)&&(F=null!=ne.align?ne.align:"center"),c(V)&&(V=null!=ne.valign?ne.valign:"center"),c(N)&&(N=null!=ne.labelAlign?ne.labelAlign:F),c(G)&&(G=null!=ne.labelValign?ne.labelValign:V),c(U)&&(U=null!=ne.indent?ne.indent:10),c(H)&&(H=null!=ne.labelIndent?ne.labelIndent:U),c(K)&&(K=null!=ne.labelIndentHorizontal?ne.labelIndentHorizontal:H),c(q)&&(q=null!=ne.labelIndentVertical?ne.labelIndentVertical:H),c(k)&&(k=null!=ne.currentEnabled&&ne.currentEnabled),c(T)&&(T=null==ne.currentSelected||ne.currentSelected),T||(k=!0),c(v)&&(v=null!=ne.spacing?ne.spacing:1),c(O)&&(O=null!=ne.corner?ne.corner:0),c(I)&&(I=null!=ne.gradient?ne.gradient:null),c(E)&&(E=null!=ne.gloss?ne.gloss:null),c(A)&&(A=null!=ne.base?ne.base:0!=O||Array.isArray(O)?b?"left":"bottom":"none"),c(S)&&(S=null==ne.keyEnabled||ne.keyEnabled),c(Z)&&(Z=null!=ne.useTap&&ne.useTap),c(J)&&(J=null!=ne.excludeCustomTap&&ne.excludeCustomTap),c(W)&&(W=null!=ne.backdropColor?ne.backdropColor:null),"none"==A||0==O||Array.isArray(O))Array.isArray(O)||(O=[O,O,O,O]);else switch(A){case"bottom":O=[O,O,0,0];break;case"left":O=[0,O,O,0];break;case"top":O=[0,0,O,O];break;case"right":O=[O,0,0,O]}var oe=this;this.keyEnabled=S;var re,ae=0,se=[],le=[],ce=r.length,ue=(t-v*(ce-1))/ce,he=(o-v*(ce-1)-2)/ce;if(!c(W)){var de=this.backdrop=new a.Rectangle(t,o,W,null,null,null,null,null,!1);this.addChild(de)}var pe,fe=!1;function ge(e){for(var t=0;t<e.length;t++){var n=e[t];n.constructor!=={}.constructor?pe="string"==typeof n||"number"==typeof n||"Label"==n.type?(e[t]={type:"TabObject",label:String(null!=n)||"Label"==n.type?n:"1"},pe&&"TabObject"!=pe&&(fe=!0),"TabObject"):(pe&&"TabObject"==pe&&(fe=!0),"Other"):(pe&&"TabObject"!=pe&&(fe=!0),pe="TabObject",n.type="TabObject")}}ge(r);for(var me,ye,be=0,ve=0,we=0;we<r.length;we++)me=r[we],b?ie&&(me.width=me.width?me.width:t):(c(me.width)&&ve++,be+=c(me.width)?ue:me.width);if(!b)if(t-v*(ce-1)<be)for(we=0;we<r.length;we++)(me=r[we]).width=(t-v*(ce-1))/be*(c(me.width)?ue:me.width);else if(Math.round(be)<Math.round(t-v*(ce-1))&&0<ve)for(ye=(ce*ue-(be-ve*ue))/ve,we=0;we<r.length;we++)(me=r[we]).width=c(me.width)?ye:me.width;function xe(e,t){for(we=0;we<e.length;we++)""!=(me=e[we])&&"TabObject"==me.type&&(c(me.label)&&(me.label=" "),"string"!=typeof me.label&&"number"!=typeof me.label||(me.label=new a.Label({text:me.label,size:null!=ne.size?ne.size:b?he/2:o/2,font:null!=ne.font?ne.font:null,style:!1,valign:G,inherit:t})))}xe(r);var Ce=0;for(we=0;we<r.length;we++)!(me=r[we]).width&&b&&me.label.width>Ce&&(Ce=me.label.width);var ke=0;function Te(n,i){var r=[],h=[];for(we=0;we<n.length;we++){if("TabObject"==(me=n[we]).type){var m={color:c(me.color)?p:me.color,rollColor:c(me.rollColor)?f:me.rollColor,selectedColor:c(me.selectedColor)?g:me.selectedColor,selectedRollColor:c(me.selectedRollColor)?y:me.selectedRollColor,backgroundColor:c(me.backgroundColor)?s:me.backgroundColor,rollBackgroundColor:c(me.rollBackgroundColor)?l:me.rollBackgroundColor,selectedBackgroundColor:c(me.selectedBackgroundColor)?u:me.selectedBackgroundColor,selectedRollBackgroundColor:c(me.selectedRollBackgroundColor)?d:me.selectedRollBackgroundColor,wait:c(me.wait)?z:me.wait};if(i)for(aStyle in i)c(i[aStyle])||(m[aStyle]=i[aStyle]);(re=new a.Button({width:b?c(me.width)?ie?t:Ce+he/2+O[0]/2:me.width:c(me.width)?ue:me.width,height:b?he:o,label:me.label,borderColor:null!=ne.borderColor?ne.borderColor:null,borderWidth:null!=ne.borderWidth?ne.borderWidth:null,backgroundColor:m.backgroundColor,rollBackgroundColor:m.rollBackgroundColor,corner:O,shadowColor:-1,gradient:I,gloss:E,backing:M?M.clone():null,rollBacking:B?B.clone():null,wait:m.wait,waitTime:c(me.waitTime)?j:me.waitTime,waitBackgroundColor:c(me.waitBackgroundColor)?_:me.waitBackgroundColor,rollWaitBackgroundColor:c(me.rollWaitBackgroundColor)?D:me.rollWaitBackgroundColor,waitColor:c(me.waitColor)?L:me.waitColor,rollWaitColor:c(me.rollWaitBackgroundColor)?Y:me.rollWaitColor,waitModal:c(me.waitModal)?R:me.waitModal,waitEnabled:c(me.waitEnabled)?X:me.waitEnabled,align:N,valign:G,indentHorizontal:K,indentVertical:q,inherit:ne})).tabInfo=m,re.color=re.tabInfo.color,re.rollColor=re.tabInfo.rollColor,re.type="TabsButton",re.listIndentReady=!0}else me.listIndentReady?re=me:(re=new a.Container).type=me.type,(re.content=me).checkBox&&(re.checkBox=me.checkBox),re.tabInfo={},J&&(re.excludeTap=!0),re.tabInfo.color=c(me.color)?p:me.color,re.tabInfo.backgroundColor=c(me.backgroundColor)?s:me.backgroundColor,me.listIndentReady||(new a.Rectangle(Math.max(me.width,b?ie?t:Ce+he/2+O[0]/2:ue),Math.max(me.height,b?he:o),a.faint).addTo(re),me.center(re),"center"!=F&&"middle"!=F&&me.pos(0,null,"right"==F),"center"!=V&&"middle"!=V&&me.pos(null,0,null,"bottom"==V));re.width>ke&&(ke=re.width),Z?re.tap(function(t){Ae(t.currentTarget.znum),oe.dispatchEvent("change"),a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update()}):re.zimTabEvent=re.on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(t){Ae(t.currentTarget.znum),oe.dispatchEvent("change"),a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update()}),re.on("mousedown",function(e){oe.buttonDown=e.currentTarget}),re.on("pressup",function(){oe.buttonDown=null}),h.push(me.label),r.push(re)}return[r,h]}var Pe=Te(r);function Oe(){var e,n=0,i=0;for(we=0;we<le.length;we++)(e=le[we]).znum=we,e.selectedIndex=we,e.selectedIndex==ae&&T&&(e.backgroundColor=u,e.rollBackgroundColor=d,e.color=g),se[we]&&(se[we].znum=we),oe.addChild(e),b&&!ie||(e.x=(t-e.width)/2,e.y=(o-e.height)/2),b?(e.y=i,i=e.y+e.height+v,"left"==F?e.x=("TabsButton"==e.type||"ListItem"==e.type?0:U)+(e.regX-(e.getBounds()?e.getBounds().x:0))*e.scaleX:"right"==F&&(e.x=(ie?t:ke)-e.width-("TabsButton"==e.type||"ListItem"==e.type?0:U))):(e.x=n,n=e.x+e.width+v,"top"==V?e.y=("TabsButton"!=e.type||fe?U:0)+(e.regY-(e.getBounds()?e.getBounds().y:0))*e.scaleY:"bottom"==V&&(e.y=o-e.height-("TabsButton"!=e.type||fe?U:0))),0!=we||k||(e.enabled=!1),e.enabled=!0;c(W)||oe.removeChild(de),oe._bounds=null;var r=oe.getBounds();if(r||0==createjs.EaselJS.version[0]?r&&(w=b&&0!=r.width&&ie?t:r.width,h=b&&0!=r.height?r.height:o,oe.setBounds(w,h)):(w=h=0,oe.setBounds()),c(W)||(de.widthOnly=w,de.heightOnly=h,oe.addChildAt(de,0)),b&&!ie)for(we=0;we<=le.length;we++)"center"!=F&&"middle"!=F||(e.x=(w-e.width)/2)}function Ae(e){var t=le[ae];t&&T&&(t.tabInfo&&c(t.tabInfo.wait)&&(t.tabInfo.backgroundColor&&(t.backgroundColor=t.tabInfo.backgroundColor),t.tabInfo.rollBackgroundColor&&(t.rollBackgroundColor=t.tabInfo.rollBackgroundColor),t.tabInfo.color&&t.label&&(t.color=t.tabInfo.color),t.tabInfo.rollColor&&t.label&&(t.rollColor=t.tabInfo.rollColor)),k||(t.enabled=!0)),(t=le[ae=e])&&(t.tabInfo&&c(t.tabInfo.wait)&&T&&(t.tabInfo.selectedBackgroundColor&&(t.backgroundColor=t.tabInfo.selectedBackgroundColor),t.tabInfo.selectedRollBackgroundColor&&(t.rollBackgroundColor=t.tabInfo.selectedRollBackgroundColor),t.tabInfo.selectedColor&&t.label&&(t.color=t.tabInfo.selectedColor),t.tabInfo.selectedRollColor&&t.label&&(t.rollColor=t.tabInfo.selectedRollColor)),k||(t.enabled=!1))}function Se(){oe.keyFocus=!0;var e=document.activeElement;e&&e.blur()}le=Pe[0],se=Pe[1],Oe(),this.addAt=function(e,t,n){c(t)&&(t=le.length),t=a.constrain(t,0,le.length),Array.isArray(e)||(e=[e]),ge(e),xe(e,n);var i=Te(e,n),o=i[0],r=i[1];t<=ae&&(ae+=o.length);var s=[t,0].concat(o);return Array.prototype.splice.apply(le,s),s=[t,0].concat(r),Array.prototype.splice.apply(se,s),Oe(),oe},this.removeAt=function(t,n){if(0==le.length)return oe;for(c(t)&&(t=1),c(n)&&(n=le.length-t),(n=a.constrain(n,0,le.length-t))<=ae&&ae<=n+t&&(ae=-1),n+t<ae&&(ae-=t),we=n;we<n+t;we++)le[we].tabInfo&&(le[we].tabInfo.backgroundColor&&(le[we].backgroundColor=le[we].tabInfo.backgroundColor),le[we].tabInfo.color&&le[we].label&&(le[we].color=le[we].tabInfo.color)),Z?le[we].noTap():le[we].off((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",le[we].zimTabEvent),le[we].removeFrom();return le.splice(n,t),se.splice(n,t),Oe(),oe},window.addEventListener("keydown",function(t){if(oe.keyEnabled&&oe.keyFocus&&!oe.zimAccessibility&&9==t.keyCode){var n=ae;Ae(t.shiftKey?--n<0?r.length-1:n:++n>r.length-1?0:n),oe.dispatchEvent("change"),a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update(),t.preventDefault()}}),Object.defineProperty(this,"selected",{get:function(){return le[ae]},set:function(e){n&&i("selected is read only - try selectedIndex")}}),Object.defineProperty(this,"selectedIndex",{get:function(){return ae},set:function(t){Ae(t),a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update()}}),this.last=function(){return this.selectedIndex=this.buttons.length-1,this},this.first=function(){return this.selectedIndex=0,this},Object.defineProperty(this,"tabs",{get:function(){return ae},set:function(t){Ae(Math.min(Math.max(t,0),r.length-1)),a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update()}}),Object.defineProperty(this,"color",{get:function(){return oe.buttons[0].tabItems?oe.buttons[0].tabItems.color:p},set:function(t){if(p=t,oe.buttons[0].tabInfo){for(var n=0;n<oe.buttons.length;n++)oe.buttons[n].tabInfo&&(oe.buttons[n].tabInfo.color=t),n==ae&&T||(oe.buttons[n].color=p);a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update()}}}),Object.defineProperty(this,"rollColor",{get:function(){return oe.buttons[0].tabItems?oe.buttons[0].tabItems.rollColor:f},set:function(t){if(f=t,oe.buttons[0].tabInfo){for(var n=0;n<oe.buttons.length;n++)oe.buttons[n].tabInfo&&(oe.buttons[n].tabInfo.rollColor=t),oe.buttons[n].rollColor=f,n!=ae&&oe.buttons[n].rolled&&(oe.buttons[n].color=f);a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update()}}}),Object.defineProperty(this,"selectedColor",{get:function(){return oe.buttons[0].tabItems?oe.buttons[0].tabItems.selectedColor:g},set:function(t){if(g=t,oe.buttons[0].tabInfo){for(var n=0;n<oe.buttons.length;n++)oe.buttons[n].tabInfo&&(oe.buttons[n].tabInfo.selectedColor=t),n==ae&&T&&(oe.buttons[n].color=g);a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update()}}}),Object.defineProperty(this,"selectedRollColor",{get:function(){return oe.buttons[0].tabItems?oe.buttons[0].tabItems.selectedRollColor:y},set:function(t){if(y=t,oe.buttons[0].tabInfo){for(var n=0;n<oe.buttons.length;n++)oe.buttons[n].tabInfo&&(oe.buttons[n].tabInfo.selectedRollColor=t),n==ae&&T&&oe.buttons[n].rolled&&(oe.buttons[n].color=y);a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update()}}}),Object.defineProperty(this,"backgroundColor",{get:function(){return oe.buttons[0].tabItems?oe.buttons[0].tabItems.backgroundColor:s},set:function(t){if(s=t,oe.buttons[0].tabInfo){for(var n=0;n<oe.buttons.length;n++)oe.buttons[n].tabInfo&&(oe.buttons[n].tabInfo.backgroundColor=t),n==ae&&T||(oe.buttons[n].backgroundColor=s);a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update()}}}),Object.defineProperty(this,"rollBackgroundColor",{get:function(){return oe.buttons[0].tabItems?oe.buttons[0].tabItems.rollBackgroundColor:l},set:function(t){if(l=t,oe.buttons[0].tabInfo){for(var n=0;n<oe.buttons.length;n++)oe.buttons[n].tabInfo&&(oe.buttons[n].tabInfo.rollBackgroundColor=t),oe.buttons[n].rollBackgroundColor=l,n!=ae&&oe.buttons[n].rolled&&(oe.buttons[n].backgroundColor=l);a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update()}}}),Object.defineProperty(this,"selectedBackgroundColor",{get:function(){return oe.buttons[0].tabItems?oe.buttons[0].tabItems.selectedBackgroundColor:u},set:function(t){if(u=t,oe.buttons[0].tabInfo){for(var n=0;n<oe.buttons.length;n++)oe.buttons[n].tabInfo&&(oe.buttons[n].tabInfo.selectedBackgroundColor=t),n==ae&&T&&(oe.buttons[n].backgroundColor=u);a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update()}}}),Object.defineProperty(this,"selectedRollBackgroundColor",{get:function(){return oe.buttons[0].tabItems?oe.buttons[0].tabItems.selectedRollBackgroundColor:d},set:function(t){if(d=t,oe.buttons[0].tabInfo){for(var n=0;n<oe.buttons.length;n++)oe.buttons[n].tabInfo&&(oe.buttons[n].tabInfo.selectedRollBackgroundColor=t),n==ae&&T&&oe.buttons[n].rolled&&(oe.buttons[n].backgroundColor=d);a.OPTIMIZE||!e&&OPTIMIZE||!oe.stage||oe.stage.update()}}}),Object.defineProperty(this,"label",{get:function(){return se[ae]},set:function(e){n&&i("selected is read only - try selectedIndex")}}),Object.defineProperty(this,"text",{get:function(){return null!=se[ae]?se[ae].text:void 0},set:function(e){n&&i("selected is read only - try selectedIndex")}}),Object.defineProperty(this,"buttons",{get:function(){return le},set:function(e){n&&i("buttons is read only")}}),Object.defineProperty(this,"labels",{get:function(){return se},set:function(e){n&&i("labels is read only")}}),this._enabled=!0,Object.defineProperty(oe,"enabled",{get:function(){return oe._enabled},set:function(e){x(oe,e)}}),"undefined"!=typeof KEYFOCUS&&(a.KEYFOCUS=KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return a.KEYFOCUS==oe},set:function(e){a.KEYFOCUS=oe}}),S&&a.KEYFOCUS&&Se(),this.on("mousedown",function(){S&&Se()});var Ie=oe.getBounds();c(Ie)||0==Ie.width?oe.setBounds(0,0,t,o):oe.width=t,!1!==$&&P(this,ne),this.clone=function(){for(var e=a.copy(r,!0),n=0;n<e.length;n++)e[n].label=e[n].label.clone();return oe.cloneProps(new a.Tabs(t,o,e,s,l,u,d,p,f,g,y,b,v,k,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,X,W,F,V,N,G,H,K,q,U,Z,J,$,this.group,ee))}},a.extend(a.Tabs,a.Container,"clone","zimContainer",!1),a.Pad=function(t,n,i,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,O,A,S,I,E,M,B,z,j,_,D,L){var Y;if(Y=m(a.Pad,arguments,"width, cols, rows, keys, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, selectedColor, selectedRollColor, spacing, currentEnabled, corner, labelColor, gradient, gloss, backing, rollBacking, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, waitColor, rollWaitColor, waitModal, waitEnabled, style, group, inherit",this))return Y;C("66"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pad",this.group=D;var R=!1===_?{}:a.getStyle(this.type,this.group,L);if(c(t)&&(t=null!=R.width?R.width:150),c(n)&&(n=null!=R.cols?R.cols:3),c(i)&&(i=null!=R.rows?R.rows:n),c(o))if(null!=R.keys)o=R.keys;else{o=[];for(var X=1;X<=i*n;X++)o.push(X)}c(y)&&(y=null==R.currentEnabled||R.currentEnabled),c(g)&&(g=null!=R.spacing?R.spacing:1);var W,F=this;this.cols=n,this.rows=i;var V,N=t/n-g,G=[],H=0;for(this.labels=[],this.buttons=[],X=0;X<i;X++){for(var K=[],q=0;q<n;q++)K.push(null!=o[H]?o[H]:""),H++;var U=null!=R.corner?R.corner:b;U&&!Array.isArray(U)&&(U=[U,U,U,U]),V=G[X]=new a.Tabs({width:t,height:N,tabs:K,backgroundColor:null!=R.backgroundColor?R.backgroundColor:r,rollBackgroundColor:null!=R.rollBackgroundColor?R.rollBackgroundColor:s,selectedBackgroundColor:null!=R.selectedBackgroundColor?R.selectedBackgroundColor:l,color:null!=R.color?R.color:h,rollColor:null!=R.rollColor?R.rollColor:d,selectedColor:null!=R.selectedColor?R.selectedColor:p,spacing:null!=R.spacing?R.spacing:g,currentEnabled:null!=R.currentEnabled?R.currentEnabled:y,corner:U,backing:null!=R.backing?R.backing.clone():T,rollBacking:null!=R.rollBacking?R.rollBacking.clone():O,base:null,keyEnabled:!1,gradient:null!=R.gradient?R.gradient:w,gloss:null!=R.gloss?R.gloss:k,wait:null!=R.wait?R.wait:A,waitTime:null!=R.waitTime?R.waitTime:S,waitBackgroundColor:null!=R.waitBackgroundColor?R.waitBackgroundColor:I,rollWaitBackgroundColor:null!=R.rollWaitBackgroundColor?R.rollWaitBackgroundColor:E,waitColor:null!=R.waitColor?R.waitColor:M,rollWaitColor:null!=R.rollWaitColor?R.rollWaitColor:B,waitModal:null!=R.waitModal?R.waitModal:z,waitEnabled:null!=R.waitEnabled?R.waitEnabled:j,group:D,style:!1}),this.labels=this.labels.concat(V.labels),this.buttons=this.buttons.concat(V.buttons),this.addChild(V),V.selectedIndex=-1,V.y=(N+g)*X,V.znum=X,V.on("change",Z)}function Z(t){var i=t.target;F.selected=i.selected,F.text=i.text,F.label=i.label;for(var o=i.selectedIndex,r=0;r<G.length;r++)G[r].selectedIndex=-1;i.selectedIndex=o,W=i.znum*n+o,F.dispatchEvent("change"),a.OPTIMIZE||!e&&OPTIMIZE||!F.stage||F.stage.update()}this.tabs=G,Object.defineProperty(this,"selectedIndex",{get:function(){return W},set:function(e){W=e;for(var t=0;t<G.length;t++)G[t].selectedIndex=-1;var i=Math.floor(W/n);0<=i&&i<F.tabs.length&&(F.tabs[i].selectedIndex=W%n)}}),this._enabled=!0,Object.defineProperty(F,"enabled",{get:function(){return F._enabled},set:function(e){x(F,e)}}),!1!==_&&P(this,R),this.clone=function(){return F.cloneProps(new a.Pad(t,n,i,o,r,s,l,u,h,d,p,f,g,y,b,v,w,k,T,O,A,S,I,E,M,B,z,j,_,this.group,L))}},a.extend(a.Pad,a.Container,"clone","zimContainer",!1),a.ColorPicker=function(o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A){var S;if(S=m(a.ColorPicker,arguments,"width, colors, cols, spacing, greyPicker, alphaPicker, startBackgroundColor, draggable, shadowColor, shadowBlur, buttonBar, circles, indicator, backgroundColor, keyArrows, container, style, group, inherit",this))return S;C("67"),this.zimContainer_constructor(null,null,null,null,!1),this.type="ColorPicker",this.group=O;var I=!1===T?{}:a.getStyle(this.type,this.group,A);c(o)&&(o=null!=I.width?I.width:500),c(r)&&(r=null!=I.colors?I.colors:null),c(r)&&(X=!0),c(s)&&(s=null!=I.cols?I.cols:10),c(l)&&(l=null!=I.spacing?I.spacing:2);var E=!X&&0<r.length&&r.length<=s;c(h)&&(h=null!=I.alphaPicker?I.alphaPicker:!E),c(u)&&(u=null!=I.greyPicker?I.greyPicker:!E),c(f)&&(f=null!=I.shadowColor?I.shadowColor:"rgba(0,0,0,.3)"),c(g)&&(g=null!=I.shadowBlur?I.shadowBlur:14),c(y)&&(y=null!=I.buttonBar?I.buttonBar:!E),c(p)&&(p=y?null==I.draggable||I.draggable:null!=I.draggable&&I.draggable),c(b)&&(b=null!=I.circles&&I.circles),c(v)&&(v=null!=I.indicator&&I.indicator,y||(v=null==I.indicator||I.indicator)),c(w)&&(w=null!=I.backgroundColor?I.backgroundColor:"black"),c(d)&&(d=null!=I.startBackgroundColor?I.startBackgroundColor:null),c(x)&&(x=null==I.keyArrows||I.keyArrows);var M,B=this;if(c(k)){if(!t)return;k=t.stage}else{if(!k.getBounds)return;if(c(k.getStage))return}B.container=k;var z="#e472c4",j="#50c4b7",_=1,D=1,L=new createjs.Shape;this.addChild(L),L.x+=l,L.y+=l;var Y,R,X=!1,W=[];if(c(r)){X=!0;var F=6,V=F*F*F;F=Math.ceil(Math.pow(V,.5)),R=(o-l)/18-l;var N=Math.floor(Math.pow(F*F,1/3));Y=[];for(var G=0;G<6;G++)for(var H=0;H<6;H++)for(var K=0;K<6;K++)Y.push("#"+Q(3*G)+Q(3*H)+Q(3*K));for(r=[],G=0;G<Y.length;G++)te=Math.floor(G/6),r[18*((ee=G%6)+6*(N=18<=te?1:0))+(te-6*N*3)]=Y[G];s=18,W=[j,z]}else R=(o-l)/s-l;var q,U=Math.ceil(r.length/s),Z=1,J=String(r[r.length-1]);if(!c(d)){var $=d.match(/rgba\((.*)\)/);$&&(Z=(te=$[1].split(",")).pop(),d="rgb("+te.join(",")+")"),J=String(d)}function Q(e){return(e=Math.floor(e).toString(16))+""+e}X&&(q=j);var ee,te,ne,ie,oe=L.graphics,re=(N=0,null!=I.borderColor?I.borderColor:null),ae=null!=I.borderWidth?I.borderWidth:null;for(!c(re)&&c(ae)&&(ae=1),ae&&c(re)&&(re="#333"),ae&&oe.s(re).ss(ae),G=0;G<r.length;G++)te=G%s,ee=Math.floor(G/s),ne=te*(R+l),ie=ee*(R+l),b?oe.f(r[G]).dc(ne+R/2,ie+R/2,R/2):oe.f(r[G]).r(ne,ie,R,R);var se=ie+R+l;B.colors=r;var le=se;if(u){for(G=0;G<16;G++)W.push("#"+Q(G)+Q(G)+Q(G));for(G=0;G<W.length;G++)te=Math.floor(G/s),ne=(ee=G%s)*(R+l),ie=te*(R+l)+se,b?oe.f(W[G]).dc(ne+R/2,ie+R/2,R/2):oe.f(W[G]).r(ne,ie,R,R);se=ie+R+l;var ce=s,ue=Math.ceil(W.length/s)}if(B.greys=W,v){function he(e){c(e)||e<0?v.visible=!1:(v.visible=!0,"#000"==J||"#000000"==J||"black"==J?(v.color="#222",v.alpha=1):(v.color="black",v.alpha=.5),v.x=L.x+e%s*(R+l)+R/2,v.y=L.x+Math.floor(e/s)*(R+l)+R/2)}(v=this.indicator=b?new a.Circle(R/2*.5,null,null,null,null,null,null,!1):new a.Rectangle(.5*R,.5*R,null,null,null,null,null,null,!1)).alpha=.5,v.centerReg(),this.addChild(v),he(r.indexOf(J))}if(h){var de=new a.Container({style:!1});de.setBounds(0,0,600,70),this.addChild(de),de.x=0,de.y=se;var pe=this.alphaBacking=new a.Rectangle(580,50,"#222",null,null,0,null,null,!1);de.addChild(pe),a.centerReg(pe,de);var fe=this.alphaBut=new a.Button({width:20,height:30,backgroundColor:"darkorange",rollBackgroundColor:"orange",label:"",corner:0,hitPadding:20,style:!1}),ge=this.alphaSlider=new a.Slider({min:0,max:1,step:.05,button:fe,barLength:330,barWidth:2,barColor:"#999",vertical:!1,useTicks:!1,inside:!1,style:!1});ge.currentValue=c(Z)?1:Z,de.addChild(ge),ge.x=40,ge.y=de.height/2;var me=this.alphaText=new a.Label({text:"Alpha: "+a.decimals(Z),size:30,color:"orange",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",rollColor:"orange",group:this.group});de.addChild(me),me.x=ge.x+ge.bar.width+40,me.y=de.height/2-me.height/2,de.scaleX=de.scaleY=o/600,ge.on("change",function(){me.text="Alpha: "+De(ge.currentValue),ke&&(ke.alpha=D=ge.currentValue),B.dispatchEvent(y?"set":"change"),B.stage&&B.stage.update()}),se+=de.height-10}if(y){var ye=new a.Container({style:!1});ye.setBounds(0,0,600,100),this.addChild(ye),ye.x=0,ye.y=se+10;var be=this.swatchText=new a.Label({align:"center",text:J.toUpperCase(),labelWidth:120,labelHeight:50,size:30,color:"orange",rollColor:"orange",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",group:this.group});if(ye.addChild(be),a.centerReg(be),be.x=90,be.y=48,p){var ve=this.grip=new a.Shape({style:!1});ye.addChild(ve),ve.graphics.f("rgba(256,256,256,.25)").r(0,0,5,20).r(10,0,5,20).r(20,0,5,20).r(30,0,5,20),ve.x=70,ve.y=65,be.y=40,ve.mouseEnabled=!1}var we=this.closeBut=new a.Button({width:90,height:90,label:"X",backgroundColor:"#222",rollBackgroundColor:"#444",corner:0,style:!1});ye.addChild(we),we.x=600-we.width-10,we.y=0,we.on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(){B.dispatchEvent("close")});var xe=this.okBut=new a.Button({width:150,height:90,label:"OK",backgroundColor:"#222",rollBackgroundColor:"#444",corner:0,style:!1});ye.addChild(xe),xe.x=we.x-xe.width-10,xe.y=0,xe.on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",Se);var Ce=this.swatchBacking=new a.Shape({style:!1});ye.addChild(Ce),(oe=Ce.graphics).f("black").r(.5,.5,50,89).f("#666").r(50,.5,50,89).f("white").r(100,.5,49.5,89),Ce.x=xe.x-150-10,Ce.y=0;var ke=this.swatch=new a.Rectangle(150,90,J,null,null,null,null,null,!1);ye.addChild(ke),ke.x=Ce.x,ke.y=0,ke.on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",Se),ke.cursor="pointer",ke.alpha=D=Z,ye.scaleX=ye.scaleY=o/600,se+=ye.height}else L.cursor="pointer";h||y||(se-=10-l);var Te=se+10;this.setBounds(0,0,o,Te);var Pe,Oe,Ae=this.background=new a.Rectangle(o,Te,w,null,null,null,null,null,!1);function Se(){if(J!=q||D!=_){if(X&&u){var t=[j=z,z=q];for(G=0;G<2;G++){var n=L.graphics;te=Math.floor(G/s),ne=(ee=G%s)*(R+l),ie=te*(R+l)+le,W[G]=t[G],n.f(Ae.color).r(ne-1,ie-1,R+2,R+2).f(t[G]).r(ne,ie,R,R)}a.OPTIMIZE||!e&&OPTIMIZE||!B.stage||B.stage.update()}q=J,_=D,B.dispatchEvent("change")}else B.dispatchEvent("close")}this.addChildAt(Ae,0),-1!=f&&0<g&&(Ae.shadow=new createjs.Shadow(f,8,8,g)),p&&(Ae.on("mousedown",function(e){Pe=e.stageX/(M=e.target.stage).scaleX-B.x,Oe=e.stageY/M.scaleY-B.y,Ae.cursor="move"}),Ae.on("pressmove",function(e){B.x=e.stageX/M.scaleX-Pe,B.y=e.stageY/M.scaleY-Oe,B.stage&&B.stage.update()}),Ae.on("pressup",function(e){Ae.cursor="default",B.stage&&B.stage.update()}));var Ie,Ee=s*(R+l),Me=U*(R+l);if(u)var Be=ce*(R+l),ze=ue*(R+l);function je(){B.keyFocus=!0;var e=document.activeElement;e&&e.blur()}function _e(){B.zimAccessibility&&B.zimAccessibility.changeTitle(B,null,!0)}function De(e){return Math.round(e*Math.pow(10,2))/Math.pow(10,2)}L.on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(e){var t=a.hitTestGrid(L,Ee,Me,s,U,e.stageX,e.stageY,0,0,l,l);c(t)||(J=r[t],y?(ke.color=J,be.text=String(r[t]).toUpperCase(),J!=q&&B.dispatchEvent("set")):Se()),u&&(t=null,c(t=a.hitTestGrid(L,Be,ze,ce,ue,e.stageX,e.stageY,0,Me,l,l))||(J=W[t],y?(ke.color=J,be.text=W[t].toUpperCase(),J!=q&&B.dispatchEvent("set")):Se())),v&&he(r.indexOf(J)),y?B.stage&&B.stage.update():v&&B.stage&&B.stage.update(),_e()}),Object.defineProperty(this,"selectedColor",{get:function(){return J},set:function(e){e=e.toUpperCase(),q=J=e,y&&(ke.color=J,be.text=J,B.stage&&B.stage.update()),v&&he(r.indexOf(J)),_e()}}),Object.defineProperty(this,"currentValue",{get:function(){return J},set:function(e){B.selectedColor=e}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return J},set:function(e){e!=B.selectedColor&&(B.selectedColor=e,B.dispatchEvent("change"))}}),Object.defineProperty(this,"selectedIndex",{get:function(){return r.indexOf(J)},set:function(e){q=J=r[e],y&&(ke.color=J,be.text=J,B.stage&&B.stage.update()),v&&he(r.indexOf(J)),_e()}}),Object.defineProperty(this,"selectedAlpha",{get:function(){return h?De(ge.currentValue):1},set:function(e){h&&(_=ge.currentValue=e,ke&&(ke.alpha=_),me&&(me.text="Alpha: "+De(ge.currentValue)),B.stage&&B.stage.update())}}),Object.defineProperty(this,"colors",{get:function(){return u?r.concat(W):r},set:function(e){n&&i("Display - ColorPicker() colors is read only - make a new ColorPicker to change")}}),"undefined"!=typeof KEYFOCUS&&(a.KEYFOCUS=KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return a.KEYFOCUS==B},set:function(t){e?a.KEYFOCUS=B:KEYFOCUS=B}}),x&&a.KEYFOCUS&&je(),this.on("mousedown",function(){x&&je()}),this.keyDownEvent=function(e){if(B.stage&&(B.zimAccessibility&&B.focus||!B.zimAccessibility&&B.keyFocus)){var t=B.selectedIndex;function n(){t<0&&(t=B.colors.length-1),t>B.colors.length-1&&(t=0),B.selectedIndex=t,B.dispatchEvent("change"),B.stage&&B.stage.update()}37==e.keyCode||40==e.keyCode?(t--,n()):38!=e.keyCode&&39!=e.keyCode||(t++,n())}},window.addEventListener("keydown",this.keyDownEvent),this.hide=function(){if(B.removeFrom(),B.toggled=!1,B.zimAccessibility){var e=B.zimAccessibility;e.resize(B),Ie?Ie.focus():B.zimTabTag.nextSibling.focus(),setTimeout(function(){e.talk("ColorPicker has been closed.")},50)}return B},this.show=function(){if(B.center(B.container),B.zimAccessibility){var e=B.zimAccessibility;setTimeout(function(){e.activatedObject&&(Ie=e.activatedObject.zimTabTag)},50),e.resize(B),e.tabIndex=B.zimTabIndex}return B.toggled=!0,B},!(this.toggle=function(e){return!0===e?B.show():!1===e?B.hide():B.container.contains(B)?B.hide():B.show(),B})!==T&&P(this,I),this.clone=function(){return B.cloneProps(new a.ColorPicker(o,X?null:r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,this.group,A))},this.dispose=function(){return window.removeEventListener("keydown",B.keyDownEvent),ge&&ge.dispose(),this.zimContainer_dispose(),!0}},a.extend(a.ColorPicker,a.Container,["clone","dispose"],"zimContainer",!1),a.Keyboard=function(e,n,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I,E,M,B){var z;if(z=m(a.Keyboard,arguments,"labels, backgroundColor, color, shiftBackgroundColor, shiftHoldBackgroundColor, placeBackgroundColor, placeColor, cursorColor, shadeAlpha, borderColor, borderWidth, margin, corner, draggable, placeClose, shadowColor, shadowBlur, container, data, place, special, rtl, hardKeyboard, style, group, inherit",this))return z;C("67.2"),this.zimContainer_constructor(1e3,400,null,null,!1),this.type="Keyboard",this.group=M;var j=!1===E?{}:a.getStyle(this.type,this.group,B);c(e)&&(e=null!=j.labels?j.labels:[]),Array.isArray(e)||(e=[e]),c(n)&&(n=null!=j.backgroundColor?j.backgroundColor:"#333"),c(o)&&(o=null!=j.color?j.color:"white"),c(r)&&(r=null!=j.shiftBackgroundColor?j.shiftBackgroundColor:"orange"),c(s)&&(s=null!=j.shiftHoldBackgroundColor?j.shiftHoldBackgroundColor:"red"),c(l)&&(l=null!=j.placeBackgroundColor?j.placeBackgroundColor:"#50c4b7"),c(u)&&(u=null!=j.placeColor?j.placeColor:o),c(h)&&(h=null!=j.cursorColor?j.cursorColor:"#50c4b7"),c(d)&&(d=null!=j.shadeAlpha?j.shadeAlpha:.2),c(p)&&(p=null!=j.borderColor?j.borderColor:"rgba(0,0,0,.1)"),c(f)&&(f=null!=j.borderWidth?j.borderWidth:null),p<0||f<0?p=f=null:null!=p&&null==f&&(f=1),c(g)&&(g=null!=j.margin?j.margin:5),c(y)&&(y=null!=j.corner?j.corner:30),c(b)&&(b=null!=j.draggable&&j.draggable),c(v)&&(v=null==j.placeClose||j.placeClose),c(w)&&(w=null!=j.shadowColor?j.shadowColor:"rgba(0,0,0,.2)"),c(x)&&(x=null!=j.shadowBlur?j.shadowBlur:14),c(T)&&(T=null!=j.data?j.data:[[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["shift","z","x","c","v","b","n","m","backspace"],["?123"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20ac","\xa3","\xa5","$","\uffe6","~","`","\xa4","\u2661","\u2606"],["2/2","_","\\","|","\u300a","\u300b","\xa1","\xbf","backspace"],["ABC"]]]);var _=this;_.data=T,c(O)&&(O=null==j.place||j.place),c(S)&&(S=null!=j.rtl&&j.rtl),c(I)&&(I=null==j.hardKeyboard||j.hardKeyboard);var D="zim display - Keyboard(): Please pass in a reference to a container with bounds set";if(c(k)){if(!t)return void i(D);k=t.stage}else{if(!k.getBounds)return void i(D);if(c(k.stage))return void i("zim display - Keyboard(): The container must have a stage property")}-1!=w&&0<x&&(_.shadow=new createjs.Shadow(w,3,3,x));var L,Y=t?t.stage:null;_.labels=e;var R=["@","",".","/","away"];c(A)||R.splice(1,0,A);var X=a.copy(T[0]);X[3]=X[3].concat(R);var W=a.copy(T[1]);W[3]=W[3].concat(R);var F=a.copy(T[2]);F[3]=F[3].concat(R);var V,N,G,H,K,q,U,Z,J,$,Q,ee,te=["\u0117","\u0113","\u0119","\xea","\xe9","\xeb","\xe8"],ne=["\u016b","\xfb","\xfa","\xfc","\xf9"],ie=["\u012b","\u012f","\xec","\xed","\xef","\xee"],oe=["\u014d","\u0153","\xf8","\xf5","\xf4","\xf3","\xf6","\xf2"],re=["\u0101","\xe3","\xe5","\xe2","\xe1","\xe4","\xe0","\xe6"],ae=["\xf1","\u0144"],se=[],le=95.5,ce={def:"default",shift:"shift",number1:"number1",number2:"number2"},ue=ce.def,he=!1,de=0,pe=[];function fe(e){var t,i=!1;if(ue===ce.def){for(H.color=e?s:r,t=0;t<se.length-6-(c(A)?0:1);t++)0<(o=se[t]).label.text.length&&(1===o.name.length?(o.label.text=o.label.text.toUpperCase(),o.label.centerReg(o).mov(0,6)):o.label.centerReg(o));e||(i=!0,a.timeout(500,function(){i&&(he=!0,H.color=s,V.updateCache(),_.stage.update())}),ee=_.on("pressup",function(e){_.off("pressup",ee),i=!1})),ue=ce.shift}else{for(H.color=n,he=!1,t=0;t<se.length-6;t++){var o;0<(o=se[t]).label.text.length&&(1===o.name.length?(o.label.text=o.label.text.toLowerCase(),o.label.centerReg(o).mov(0,3)):o.label.centerReg(o))}ue=ce.def}V.updateCache(),_.stage.update()}function ge(e){var t,i,r,s,l,u,h,g=0,m=0,b=!1,v=!1;c(e)&&(e=ce.def),e===ce.def?t=X:e===ce.number1?t=W:e===ce.number2&&(t=F),V=new a.Container(1e3,430,null,null,!1).addTo(_);for(var w=0;w<t.length;w++){(w<=1||e==ce.def&&2==w&&"shift"!=t[2][0])&&(g=(le/2+2.5)*(10-t[w].length));for(var x=0;x<t[w].length;x++){if(u=null,v=b=!1,"backspace"==t[w][x]?(u=Z,v=l=!0):"shift"==t[w][x]?(l=!0,u=U):(3==w||e!=ce.def&&2==w)&&0==x?v=l=!0:""==t[w][x]?b=!(l=!1):"away"==t[w][x]?(u=J,v=l=!0):l=!1,s=l?1.5*le+2.5:b?(le+5)*(c(A)?4:3)-5:le,r=new a.Rectangle(s,le,n,p,f,y,null,null,!1).cur().addTo(V),v&&r.addChild(new a.Rectangle(s,le,"black",null,null,y,null,null,!1).alp(d)),r.label=i=new a.Label(u?{text:"",backgroundColor:"ignore",font:null!=j.font?j.font:null,style:!1}:{lineWidth:10,lineHeight:25,font:null!=j.font?j.font:null,text:t[w][x],color:o,align:"center",style:!1}),u){var C=u.clone();C.scaleTo(r,70,70),C.centerReg(r)}h?(h=!1,g+=67.33):(i.centerReg(r).mov(0,isNaN(i.text)?3:7),r.x=g,r.y=m,r.name=t[w][x],2==w&&0==x&&e==ce.number1&&(r.toggle="1/2"),2==w&&0==x&&e==ce.number2&&(r.toggle="2/2"),3==w&&0==x&&e==ce.def&&(r.toggle="?123"),3==w&&0==x&&e!=ce.def&&(r.toggle="ABC"),r.toggle&&i.mov(0,3),se.push(r),"shift"==r.name&&(H=r),g=r.x+r.width+5)}m+=le+5,g=0}V.cache(f?-f:0,f?-f:0,f?V.width+2*f:V.width,f?V.height+2*f:V.height)}function me(){_.mouseYAmount&&(_.y=_.parent.globalToLocal(0,_.mouseYAmount-Q).y)}function ye(){Y.off("pressmousemove",_.tickerMouseEvent),a.Ticker.remove(me)}function be(){if(K&&G){for(var e=K.label.x+K.label.getBounds().x,t=0;t<de;t++)e+=K.widthArray[t]?K.widthArray[t]:0;G.heightOnly=K.getBounds().height*(K.backing&&c(K.padding)?.9:1)-(K.paddingVertical&&K.background?2*K.paddingVertical:0),G.center(K),G.x=e}}function ve(){if(q)return _;if(!K)return _;var e,t,n,i=v?["<",">","x"]:["<",">"];pe=[],n=K.localToLocal(0,0,_),q=new a.Container({style:!1}).addTo(_).pos({x:n.x,y:n.y+K.height+15,reg:!0}).cur();for(var o=0;o<i.length;o++)e=new a.Rectangle(le,le,l,p,f,y,null,null,!1),"x"==i[o]&&new a.Rectangle(le,le,"black",null,null,y,null,null,!1).alp(d).addTo(e),(t=new a.Label({lineWidth:10,text:i[o],backing:e,font:null!=j.font?j.font:null,color:u,align:"center",valign:"center",style:!1}).addTo(q).cache()).x=o*(le+5),pe.push(t);n=K.localToLocal(0,0,_),q.x=n.x,q.y=n.y+K.height+15,q.on("click",function(e){0==pe.indexOf(e.target)?0<de&&de--:1==pe.indexOf(e.target)?de<K.text.length&&de++:we(),be()}),_.stage.update()}function we(){if(!q)return _;q.removeAllEventListeners(),_.removeChild(q),q=null}function xe(e){if(K){var t,n;if("del"===e)K&&(K.text=[K.text.slice(0,de-1),K.text.slice(de)].join("")),de--,ke();else{ue===ce.shift&&(e=e.toUpperCase());var i=K.text;(t=K.clone().removeFrom()).text=e,n=t.label.getMeasuredWidth(),K.widthArray?K.widthArray.splice(de,0,n):K.widthArray=[K.breedte],de<K.text.length?K.text=[K.text.slice(0,de),e,K.text.slice(de)].join(""):K.text+=e,K&&K.label.getBounds().width<L?(de++,be()):K.text=i}ue!==ce.shift||he||(_.removeChild(V),ge(),ue=ce.def),be();var o=new createjs.Event("keydown");o.letter=e,_.dispatchEvent(o),_.stage.update()}}function Ce(e){if(_.stage){var t,n=0,i=!1;(K=e.target).widthArrayCheck||ke(),L=K.label.lineWidth?K.label.lineWidth:1e4,(t=K.globalToLocal(e.stageX/e.target.stage.scaleX,e.stageY/e.target.stage.scaleY)).x-=K.label.x,t.y-=K.label.y;for(var o=0;o<K.widthArray.length;o++)if(t.x<(n+=K.widthArray[o])-K.widthArray[o]/2+K.label.getBounds().x){de=o,i=!0;break}i||(de=K.text.length),be(),O&&!q&&0<K.text.length&&ve(),q&&K&&(0<K.text.length?(t=K.localToLocal(0,0,_),q.x=t.x,q.y=t.y+K.height+15):we())}}function ke(){if(K){var e;K.widthArray=[];for(var t=0;t<K.text.length;t++)(e=K.clone().removeFrom()).text=K.text[t],K.widthArray.push(e.label.getMeasuredWidth());K.widthArrayCheck=!0,be()}}function Te(e){var t,n=!0;function i(){K&&0<K.text.length?(0<_.selectedIndex&&xe("del"),e?o():_.on("pressup",o)):xe("del")}function o(){n=!1,t&&t.clear(),_.off("pressup",o)}i(),t=a.timeout(300,function e(){(!K||K.text.length<1||0==_.currentIndex)&&(n=!1),n&&(i(),t&&(t=a.timeout(200,e))),K&&K.text.length<1&&o()}),_.stage.update()}function Pe(){for(var t=0;t<e.length;t++)e[t].clickEvent=e[t].on("click",Ce)}function Oe(){if(1<e.length)for(var t=0;t<e.length;t++)e[t].off("click",e[t].clickEvent)}function Ae(){if(!G&&(L=(K=e[0])&&K.label.lineWidth?K.label.lineWidth:1e4,K)){(G=new a.Rectangle(3,K.height-(K.paddingVertical&&K.background?2*K.paddingVertical:0),h,null,null,null,null,null,!1).center(K)).x=0,G.visible=!1,G.animate({obj:{alpha:0},rewind:!0,loop:!0,loopWait:750,time:250,id:"knipperTekst"});for(var t=0;t<e.length;t++)e[t].widthArray=[0];ke()}}function Se(){a.stopAnimate("knipperTekst"),K&&K.removeChild(G),K=G=null}!function(){(U=new a.Shape({style:!1})).graphics.f(o).p("AhIFoIAAjYIixAAID5n3ID6H3IixAAIAADYgAjHBxICeAAIAADYIBTAAIAAjYICeAAIjImSg"),U.setBounds(-25.5,-36,51,72),Z=new a.Container({style:!1});var e=new a.Shape({style:!1});e.graphics.f(o).p("ACgC+IigigIifCgQgGAGgJAAQgJAAgGgGQgGgGgBgJQABgJAGgGICgigIigifQgGgGgBgJQABgJAGgGQAGgGAJAAQAIAAAHAGICfCgICgigQAGgGAJAAQAJAAAGAGQAGAGABAJQgBAJgGAGIigCfICgCgQAGAGABAJQgBAJgGAGQgGAGgJAAQgJAAgGgGg"),e.setTransform(82.6,32),e.addTo(Z);var t=new a.Shape({style:!1});t.graphics.f(o).s().p("AkhFAQgcAAgUgUIkHj6QgVgUAAgeQAAgdAVgVIEHj6QAUgTAcAAINKAAQAdAAAUAUQAUAUAAAdIAAH1QAAAdgUATQgUAVgdAAgAk0kOIkGD8QgIAHAAALQAAALAIAIIEGD7QAIAHALAAINKAAQALAAAIgIQAHgHAAgLIAAn1QAAgLgHgIQgIgIgLAAItKAAQgLAAgIAHg"),t.setTransform(62.2,32),t.addTo(Z),Z.setBounds(0,0,125,64),(J=new a.Container({style:!1})).setBounds(0,0,147,86);for(var n,i=[{p:"Ai+heIF9AAIi/C9g",transform:[73.4,76]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128.4,43.2]},{p:"AnNAzIAAhlIObAAIAABlg",transform:[73,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.8,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128.2,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[114.5,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[100.8,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[87.1,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[73.4,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[59.7,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.6,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[114.3,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[100.6,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[86.9,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[73.2,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[59.5,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[45.8,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.1,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.4,15.8]},{p:"AphEnQgzAAgkgkQglglAAgzIAAlVQAAgzAlglQAkgkAzAAITDAAQAzAAAkAkQAlAlAAAzIAAFVQAAAzglAlQgkAkgzAAgAqjjtQgcAcAAAnIAAFVQAAAnAcAbQAbAcAnAAITDAAQAnAAAcgcQAbgbAAgnIAAlVQAAgngbgcQgcgcgnAAIzDAAQgnAAgbAcg",transform:[73.4,29.5]}],r=0;r<i.length;r++)(n=new a.Shape({style:!1})).graphics.f(o).s().p(i[r].p),n.setTransform(i[r].transform[0],i[r].transform[1]),n.addTo(J)}(),ge(ue),b&&function(){$=new a.Rectangle(1.5*le+2.5+2.5,le,n,p,f,y,null,null,!1).addTo(_,0).cur();for(var e=0;e<4;e++)new a.Rectangle(.4*$.width,4,o,null,null,null,null,null,!1).centerReg($).alp(.2).y-=15*e-22;$.x=8.5*le+40,$.y=-le-5,$.name="drag"}(),this.on("mousedown",function(e){Y=_.stage,N&&_.removeChild(N),q&&pe.indexOf(e.target)<0&&we(),c(e.target.name)||(b&&e.target===$?(_.tickerMouseEvent=Y.on("stagemousemove",function(e){_.mouseYAmount=e.stageY}),a.Ticker.add(me),_.on("pressup",ye),Q=e.stageY-_.localToGlobal(0,0).y):c(A)||e.target.name!==A?"shift"===e.target.name?fe():"?123"===e.target.toggle?(_.removeChild(V),ge(ce.number1)):"ABC"===e.target.toggle?(_.removeChild(V),ue=ce.def,ge(),he&&fe(!0)):"1/2"===e.target.toggle?(_.removeChild(V),ge(ce.number2)):"2/2"===e.target.toggle?(_.removeChild(V),ge(ce.number1)):"away"===e.target.name?(_.hide(),_.dispatchEvent("close")):"e"===e.target.name||"u"===e.target.name||"i"===e.target.name||"o"===e.target.name||"a"===e.target.name||"n"===e.target.name?function(e){var t,i,r=!1,s=!1;switch(e){case"e":t=te;break;case"u":t=ne;break;case"i":t=ie;break;case"o":t=oe;break;case"a":t=re;break;case"n":t=ae}i=a.timeout(500,function(){var e,l,c,u,h=0;if(i.clear(),!r){s=!0,(N=new a.Container(1e3,le,null,null,!1).addTo(_,0)).y=-le-5;for(var d=0;d<t.length;d++)u=ue===ce.shift?t[d].toUpperCase():t[d],e=new a.Label({lineWidth:10,lineHeight:25,text:u,font:null!=j.font?j.font:null,color:o,align:"center",style:!1}),l=new a.Rectangle(le,le,n,p,f,y,null,null,!1).addTo(N),c=new a.Rectangle(le,le,"white",null,null,y,null,null,!1).alp(.2),l.addChild(c),e.center(l),l.name=t[d],l.x=h,h+=le+5;_.stage.update()}});var l=_.on("pressup",function(t){r=!0,_.off("pressup",l),s||xe(e)})}(e.target.name):"return"===e.target.name?xe("\n"):"backspace"===e.target.name?Te():xe(""===e.target.name?" ":e.target.name):_.dispatchEvent("special"),Y.update())}),_.addChar=function(e){!c(e)&&e.match(/^.$/)&&xe(e)},_.removeChar=function(){Te(!0)},Pe(),Ae(),Object.defineProperty(this,"selectedLabel",{get:function(){return K},set:function(e){Ce({target:e}),_.hidePlace()}}),Object.defineProperty(this,"selectedIndex",{get:function(){return de},set:function(e){de=e,be()}}),this.show=function(t){return _.addTo(k),c(t)||Ce({target:e[t]}),G&&(G.visible=!0),_.toggled=!0,_},this.hide=function(){return _.removeFrom(k),G&&(G.visible=!1),Y.update(),_.toggled=!1,_},this.toggle=function(e){return!0===e?_.show():!1===e?_.hide():_.parent?_.hide():_.show(),_},this.showPlace=function(){return ve(),_},this.hidePlace=function(){return we(),_},this.addLabels=function(t){Array.isArray(t)||(t=[t]);for(var n=t.length-1;0<=n;n--)0<=e.indexOf(t[n])||"Label"!=t[n].type?t.splice(n,1):t[n].widthArray=[0];return Oe(),e=e.concat(t),Pe(),Ae(),G&&(G.visible=!0),_},this.removeLabels=function(t){Array.isArray(t)||(t=[t]),Oe();for(var n=0;n<t.length;n++){var i=e.indexOf(t[n]);0<=i&&e.splice(i,1)}return Pe(),0==e.length?K&&Se():K&&-1==e.indexOf(K)&&(Se(),Ae()),_};var Ie=new a.Rectangle(this.width,this.height,a.clear,null,null,null,null,null,!1).addTo(this).expand().bot();Ie.on("mousedown",function(){}),Ie.on("click",function(){}),this.resize=function(){return _.scaleTo(Y,100-2*g/Y.width*100,50-2*g/Y.height*100),_.y=Y.height-_.height-g,_.x=Y.width/2-_.width/2,K&&q&&(point=K.localToLocal(0,0,_),q.x=point.x,q.y=point.y+K.height+15),_.stage&&_.stage.update(),_},this.resize(),_.selectedLabel&&(_.selectedIndex=_.selectedLabel.text.length),I&&(this.keydownEvent=window.addEventListener("keydown",function(e){if(_.stage){var t=_;c(t)||(35==e.keyCode&&(t.selectedIndex=t.selectedLabel.text.length),36==e.keyCode&&(t.selectedIndex=0),37==e.keyCode&&(t.selectedIndex=t.selectedIndex-1),39==e.keyCode&&(t.selectedIndex=t.selectedIndex+1),46==e.keyCode&&t.selectedIndex<t.selectedLabel.text.length&&(t.selectedIndex=t.selectedIndex+1,t.removeChar()),8==e.keyCode&&(e.preventDefault(),t.removeChar()),t.addChar(e.key),_.stage&&_.stage.update())}})),!1!==E&&P(this,j),this.clone=function(){var t=new a.Keyboard(e,n,o,r,s,l,h,d,g,y,b,v,w,x,k,T,O,A,S,I,E,this.group,B);return _.cloneProps(t)},this.dispose=function(){return Ie.removeAllEventListeners(),_.keydownEvent&&window.removeEventListener("keydown",_.keydownEvent),_.zimContainer_dispose(),!0}},a.extend(a.Keyboard,a.Container,"clone, dispose","zimContainer",!1),a.Organizer=function(e,t,n,i,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I,E,M){var B;if(B=m(a.Organizer,arguments,"width, list, useAdd, useRemove, usePosition, autoAdd, autoRemove, autoPosition, addForward, removeForward, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, selectedColor, selectedRollColor, spacing, corner, keyEnabled, gradient, gloss, backdropColor, style, group, inherit",this))return B;C("67.3"),this.group=E;var z=!1===I?{}:a.getStyle("Organizer",this.group,M);c(e)&&(e=null!=z.width?z.width:t&&t.vertical?t.width:300),c(n)&&(n=null==z.useAdd||z.useAdd),c(i)&&(i=null==z.useRemove||z.useRemove),c(o)&&(o=null==z.usePosition||z.usePosition),c(r)&&(r=null!=z.autoAdd?z.autoAdd:n),c(s)&&(s=null!=z.autoRemove?z.autoRemove:i),c(l)&&(l=null!=z.autoPosition?z.autoPosition:o),c(u)&&(u=null==z.addForward||z.addForward),c(h)&&(h=null==z.removeForward||z.removeForward),c(d)&&(d=null!=z.backgroundColor?z.backgroundColor:"#777"),c(p)&&(p=null!=z.rollBackgroundColor?z.rollBackgroundColor:"#555"),c(f)&&(f=null!=z.selectedBackgroundColor?z.selectedBackgroundColor:"#333"),c(y)&&(y=null!=z.color?z.color:"white"),c(b)&&(b=null!=z.rollColor?z.rollColor:y),c(v)&&(v=null!=z.selectedColor?z.selectedColor:y),c(x)&&(x=null!=z.spacing?z.spacing:1),c(k)&&(k=null!=z.corner?z.corner:0),c(O)&&(O=null!=z.gradient?z.gradient:.2),c(A)&&(A=null!=z.gloss?z.gloss:null),c(S)&&(S=null!=z.backdropColor?z.backdropColor:null),Array.isArray(k)||(k=[k,k,k,k]);var j={width:50,height:50,label:"",shadowColor:-1,gradient:O,corner:k,backgroundColor:d,rollBackgroundColor:p},_=this.buttons=[],D=new a.Shape;if(D.graphics.f(y).p("AAAA4Ih6B8Ig5g4IB8h8Ih7h6IA4g5IB6B8IB7h8IA5A5Ih8B6IB8B7Ig5A5g"),n&&_.push(new a.Button({icon:D.sca(.55).rot(-45).reg(1),inherit:j})),o){var L=new a.Shape;L.graphics.f(y).p("AiJieIETCeIkTCfg"),_.push(new a.Button({icon:L.sca(.6).rot(t&&!t.vertical?180:-90).reg(-2),inherit:j})),_.push(new a.Button({icon:L.clone().sca(.6).rot(t&&!t.vertical?0:90).reg(-2),inherit:j}));var Y=new a.Shape;Y.graphics.f(y).p("AiFCLIAAkVIBXAAIAAEVgAgiAAICoiHIAAEQg"),_.push(new a.Button({icon:Y.sca(.62).rot(t&&!t.vertical?0:90).reg(0),inherit:j})),_.push(new a.Button({icon:Y.clone().sca(.62).rot(t&&!t.vertical?180:-90).reg(0),inherit:j}))}i&&_.push(new a.Button({icon:D.clone().rot(0).sca(.55),inherit:j})),0==_.length&&(_=[""]),this.zimTabs_constructor(e,e/_.length,_,d,p,f,g,y,b,v,w,!1,x,!0,!1,k,null,!0,O,A,null,null,null,null,null,null,null,null,null,null,S);var R=this;R.list=t,R.type="Organizer";var X=!(R.setButtons=function(){o&&(R.buttons[1].icon.rotation=R.list&&!R.list.vertical?180:-90,R.buttons[2].icon.rotation=R.list&&!R.list.vertical?0:90,R.buttons[3].icon.rotation=R.list&&!R.list.vertical?0:90,R.buttons[4].icon.rotation=R.list&&!R.list.vertical?180:-90)}),W=t;R.change(function(e){(!X&&R.list||R.list&&R.list!=W)&&(R.list!=W&&W&&W.noChange(),R.list.change(function(e){R.orgItem=R.list.selected,R.orgIndex=R.list.selectedIndex}),X=!0,W=R.list);var t=e.target.selectedIndex;n||t++,o||n&&!(0<t)||(t=5);var i=c(R.list.selectedIndex)||R.list.selectedIndex<0;switch(i&&(R.currentValue=null),R.lastIndex=R.list.selectedIndex,t){case 0:if(r){var a=Math.max(0,R.list.selectedIndex);R.add(a)}R.orgType="add";break;case 1:if(i)break;l&&R.up(a=R.list.selectedIndex),R.orgType="up";break;case 2:if(i)break;l&&R.down(a=R.list.selectedIndex),R.orgType="down";break;case 3:if(i)break;l&&R.toTop(a=R.list.selectedIndex),R.orgType="top";break;case 4:if(i)break;l&&R.toBottom(a=R.list.selectedIndex),R.orgType="bottom";break;case 5:if(i)break;s&&R.remove(a=R.list.selectedIndex),R.orgType="remove"}}),this.add=function(e,t,n){c(e)&&(e=R.lastIndex),c(t)&&(t=""),e=u?Math.min(R.list.length,Math.max(0,R.list.selectedIndex)+1):Math.max(0,R.list.selectedIndex),R.list.addAt(t,e,n),R.list.selectedIndexPlusPosition=e,R.orgItem=R.list.selected,R.orgIndex=R.list.selectedIndex},this.up=function(e){c(e)&&(e=R.lastIndex);var t=R.list.items[e];c(t)||(R.list.removeAt(1,e),R.list.addAt(t,e-1),R.list.selectedIndexPlusPosition=Math.max(0,e-1),R.orgItem=R.list.selected,R.orgIndex=R.list.selectedIndex)},this.down=function(e){c(e)&&(e=R.lastIndex);var t=R.list.items[e];c(t)||(R.list.removeAt(1,e),R.list.addAt(t,e+1),R.list.selectedIndexPlusPosition=Math.min(R.list.length-1,e+1),R.orgItem=R.list.selected,R.orgIndex=R.list.selectedIndex)},this.toTop=function(e){c(e)&&(e=R.lastIndex);var t=R.list.items[e];c(t)||(R.list.removeAt(1,e),R.list.addAt(t,0),R.list.first(),R.orgItem=R.list.selected,R.orgIndex=R.list.selectedIndex)},this.toBottom=function(e){c(e)&&(e=R.lastIndex);var t=R.list.items[e];c(t)||(R.list.removeAt(1,e),R.list.addAt(t,R.list.length),R.list.last(),R.orgItem=R.list.selected,R.orgIndex=R.list.selectedIndex)},!(this.remove=function(e){c(e)&&(e=R.lastIndex),R.removedItem=R.list.selected,e=Math.max(0,R.list.selectedIndex),R.list.removeAt(1,e),e=h?Math.max(0,R.list.selectedIndex):Math.max(0,R.list.selectedIndex-1),R.list.selectedIndexPlusPosition=Math.min(R.list.length-1,e),R.orgItem=R.list.selected,R.orgIndex=R.list.selectedIndex})!==I&&P(this,z),this.clone=function(){return R.cloneProps(new a.Organizer(e,t,n,i,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I,R.group,M))}},a.extend(a.Organizer,a.Tabs,"clone","zimTabs",!1),a.Marquee=function(e,o,r,l,u,h,d,p,f,g,y,b,v,w,x,k,T){var O;if(O=m(a.Marquee,arguments,"width, height, items, time, transition, speed, direction, marqueeType, borderColor, borderWidth, refresh, mix, style, group, inherit",this))return O;C("67.4"),this.group=k;var A=!1===x?{}:a.getStyle("Marquee",this.group,T),S=this;c(e)&&(e=null!=A.width?A.width:300),c(o)&&(o=null!=A.height?A.height:100),c(l)&&(l=null!=A.time?A.time:2e3),c(u)&&(u=null!=A.transition?A.transition:"slide"),c(y)&&(y=null!=A.borderColor?A.borderColor:"#333"),c(b)&&(b=null!=A.borderWidth?A.borderWidth:1),y<0||b<0?y=b=null:null!=y&&null==b&&(b=1),c(p)&&(p=null!=A.marginLeft?A.marginLeft:25),c(f)&&(f=null!=A.marginRight?A.marginRight:25),c(h)&&(h=null!=A.speed?A.speed:500),c(d)&&(d=null!=A.direction?A.direction:"right"),c(v)&&(v=null!=A.refresh?A.refresh:18e5),c(w)&&(w=null==A.mix||A.mix),this.zimContainer_constructor(e+p+f,o,null,null,!1),this.type="Marquee",this.speed=h;var I=new Rectangle(e-1,o-1,clear).addTo(S).mov(p+.5,.5),E=this.content=new Container(e,o).loc(p,0,S).setMask(I),M=this.pages=new a.Pages(null,u,h,null,E).addTo(S),B=!1;this.add=function(e,t,n,i){e.scaleTo(E),t&&e.cur().on("click",function(){s(t,n)}),M.addPage(e),e.marqueeViews=0,e.marquee=S,B||(B=!0,S.selectedIndex=0,S.selected=M.pages[S.selectedIndex].page,S.lastSelected=null,S.selected.marqueeOn&&S.selected.marqueeOn(),S.interval=a.interval(l,function(){S.go()})),i||R(),N&&N.top()},this.remove=function(e){if(S.selected==e){if(1==S.pages.pages.length)return;var t=S.selectedIndex+1;t==S.pages.pages.length&&(t=0),S.pages.go(t,null,null,0),a.timeout(20,function(){S.pages.removePage(e),e.dispose&&e.dispose(),R()})}else S.pages.removePage(e),e.dispose&&e.dispose(),R()},c(r)||Array.isArray(r)||(r=[r]),r&&0<r.length&&(w&&a.shuffle(r),a.loop(r,function(e){S.add(e,null,null,!0)})),0<v&&a.timeout(v,function(){location.reload()}),S.go=function(e){S.selected.marqueeViews+=1,S.selected.marqueeOff&&S.selected.marqueeOff(),e?(S.selected=e,a.loop(M.pages,function(t,n){t.page!=e||(S.selectedIndex=n)}),S.interval.interval=S.selected.marqueeTime?S.selected.marqueeTime:l,S.interval.pause(Y.toggled,null,!0)):(S.selectedIndex=(S.selectedIndex+1)%M.pages.length,S.selected=M.pages[S.selectedIndex].page,S.interval.time=S.selected.marqueeTime?S.selected.marqueeTime:l),S.dispatchEvent("page"),S.selected.marqueeOn&&S.selected.marqueeOn(),M.go(S.selected,d,u,h)},M.on("pagetransitioned",function(){S.dispatchEvent("pagetransitioned"),S.indicator&&(S.indicator.selectedIndex=S.selectedIndex)});var z=!1,j=S.left=new Container(p-4,o-4),_=(new Shape).sca(.6);_.graphics.f(light).mt(0,0).p("AAhCLIAAkVIBXAAIAAEVgAh3CLIAAkVIBXAAIAAEVg");var D=(new Shape).sca(.6).reg(-2,0);D.graphics.f(light).mt(0,0).p("AiJieIETCeIkTCfg");var L,Y=S.button=new Button({label:"",icon:_,toggleIcon:D,width:45,height:45,corner:0,shadowBlur:0}).scaleTo(j,100).pos(0,0,!1,!0,j);function R(){if(!c(p)&&0!=p){var e=4*p/25;j.pos(p-j.width-e,e/2,!1,!0,S),S.indicator&&(S.indicator.dispose(),S.indicator.removeFrom()),L||(L=new Proportion(8,16,j.width+e,j.width/2+e,-1)),S.indicator=new a.Indicator({width:(M.pages.length<=2?M.pages.length:M.pages.length-1)*(j.width-3),height:L.convert(M.pages.length),num:M.pages.length,shadowBlur:-1,interactive:!0,scale:1.2,indicatorType:g}),S.indicator.fit(0,0,o-Y.height,Y.width),S.indicator.rot("down"==d?-90:90).center(j).pos(null,j.width-e/2,null,!0),S.indicator.selectedIndex=S.selectedIndex,S.indicator.on("change",function(){S.go(M.pages[S.indicator.selectedIndex].page)})}}if(Y.on("click",function(){S.interval&&S.interval.pause(Y.toggled),z=Y.toggled,S.stage.update()}),R(),!c(f)&&0<f&&void 0!==t&&t){var X=4*f/25,W=S.right=new a.Container(45,270),F=S.icon=t.makeIcon(a.grey,a.lighter,a.silver).sca(.5).pos(0,0,!0,!0,W).mov(0,0).cur();F.on("mouseover",function(){V.animate({props:{scaleX:1},time:500,ease:"backOut",override:!0}),F.stage.update()}),F.on("mouseout",function(){V.animate({props:{scaleX:0},time:300,ease:"backIn",override:!0}),F.stage.update()}),F.on("mousedown",function(){s("https://zimjs.com/marquee","_blank")});var V=S.label=new Label({text:"MARQUEE",color:dark,backgroundColor:lighter,shiftVertical:1,paddingVertical:5}).rot(-90).pos(0,13,!0,!1,W).reg(-10).sca(0,1).mov(0);W.fit(0,0,f-X,o-X),W.pos(f-W.width-X,X/2,!0,!0,S)}if(S.stage&&S.stage.update(),this.pause=function(e,t){c(e)&&(e=!0),e!=z&&(z=e,S.interval.pause(e,t),S.button.toggle(e))},Object.defineProperty(this,"paused",{get:function(){return z},set:function(e){n&&i("ZIM Marquee() - paused is read only - use pause()")}}),Object.defineProperty(this,"time",{get:function(){return l},set:function(e){S.interval.time=l=e}}),this.load=function(e,t){var n=[];return w&&a.shuffle(e),a.loop(e,function(e){Array.isArray(e)?n.push(e[0]):n.push(e)}),S.marqueeLoader=frame.loadAssets(n,t),S.marqueeLoader.on("assetload",function(t){var n=e[t.asset.id];if(Array.isArray(n))var i=n[0],o=n[1];else i=n,o="_self";S.add(t.asset,i,o),R()}),S},!c(y)){var N=new Rectangle(e-1,o-1,a.clear,y,b).loc(I,null,S);N.mouseEnabled=!1}!1!==x&&P(this,A),this.clone=function(){return S.cloneProps(new a.Marquee(e,o,r,l,u,h,d,g,y,b,v,w,x,this.group,T))},this.dispose=function(){return S.interval&&S.interval.clear(),this.zimContainer_dispose(),!0}},a.extend(a.Marquee,a.Container,["clone","dispose"],"zimContainer"),a.Loader=function(e,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R){var X;if(X=m(a.Loader,arguments,"width, height, label, backgroundColor, rollBackgroundColor, color, rollColor, borderColor, borderRollColor, borderWidth, corner, shadowColor, shadowBlur, hitPadding, gradient, gloss, dashed, backing, rollBacking, rollPersist, icon, rollIcon, toggle, toggleBacking, rollToggleBacking, toggleIcon, rollToggleIcon, toggleEvent, frame, style, group, inherit",this))return X;C("67.5"),this.group=Y;var W=!1===L?{}:a.getStyle("Loader",this.group,R);if(c(e)&&(e=null!=W.width?W.width:250),c(o)&&(o=null!=W.height?W.height:70),c(s)&&(s=null!=W.backgroundColor?W.backgroundColor:"rgba(0,0,0,.05)"),c(l)&&(l=null!=W.rollBackgroundColor?W.rollBackgroundColor:"rgba(0,0,0,.1)"),c(u)&&(u=null!=W.color?W.color:"rgba(0,0,0,.5)"),c(h)&&(h=null!=W.rollColor?W.rollColor:u),c(d)&&(d=null!=W.borderColor?W.borderColor:"rgba(0,0,0,.3)"),c(f)&&(f=null!=W.borderWidth?W.borderWidth:1),c(k)&&(k=null==W.dashed||W.dashed),c(g)&&(g=null!=W.corner?W.corner:0),c(r)&&(r=null!=W.label?W.label:new a.Label({text:"UPLOAD PIC",color:u,rollColor:h,valign:"center",align:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",group:this.group})),c(D)){if(!t)return void(n&&i("zim.Loader - please provide a reference to zim Frame"));D=t}this.zimButton_constructor(e,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I,E,M,B,z,j,_,null,null,null,null,null,null,null,null,null,null,null,null,!1),this.type="Loader";var F=this,V=D.stage;r=F.label;var N=F.tag=document.createElement("input");document.body.appendChild(N),N.setAttribute("type","file"),N.setAttribute("multiple","multiple"),N.setAttribute("aria-hidden",!0),N.hidden=!0,N.style.cssText="border:thin solid grey; z-index:2; width:"+e+"px; height:"+o+"px; overflow:hidden; outline:none;position:absolute; left:0px; top:0px; display:none; cursor:pointer; opacity: 0; filter: alpha(opacity=0);",this.addEventListener("mousedown",function(){N.click()}),N.addEventListener("change",K);var G=new createjs.DOMElement(N);V.addChild(G),G.alpha=0;var H=D.retina&&window.devicePixelRatio||1;function K(e){var t;t=e.dataTransfer&&e.dataTransfer.files&&0<e.dataTransfer.files.length?e.dataTransfer.files:e.target.files;for(var n,i,o,r=[],s=0;s<t.length;s++)i=t[s],o=void 0,(o=new FileReader).onload=function(e){var i=new Image;i.onload=function(){var e=new a.Bitmap(i);if(r.push(e),1==r.length&&(n=e),r.length==t.length){var o=new createjs.Event("loaded");o.bitmaps=r,o.bitmap=n,o.lastBitmap=e,o.total=r.length,F.dispatchEvent(o),N.value=""}},i.src=e.target.result},o.readAsDataURL(i)}this.resize=function(){return F.stage?(N.setAttribute("aria-hidden",!1),N.hidden=!1,N.style.display="block",setTimeout(function(){var e=F.localToGlobal(0,0);D.retina?(G.x=D.x/V.scaleX+e.x/H,G.y=D.y/V.scaleY+e.y/H,a.sca(G,F.scaleX/H,F.scaleY/H)):(G.x=D.x+e.x*D.scale,G.y=D.y+e.y*D.scale,a.sca(G,D.scale*F.scaleX,D.scale*F.scaleY)),V.update()},50),F):(N.setAttribute("aria-hidden",!0),N.hidden=!0,void(N.style.display="none"))},this.resize(),F.on("added",function(){N.style.display="block",N.hidden=!1,N.style.display="block",F.resize()}),F.added(function e(){F.resize(),setTimeout(function(){N.style.display="block",N.hidden=!1,N.style.display="block"},50),F.on("added",e,null,!0)}),F.on("removed",function(){N.style.display="none",N.hidden=!0,N.style.display="none"}),(new XMLHttpRequest).upload&&N.addEventListener("drop",function(e){N.removeEventListener("change",K),K(e),setInterval(function(){N.addEventListener("change",K)},100)}),!(this.save=function(e,t,n,i,o,r,s,l,u,h){var d;if(d=m(F.save,arguments,"content, filename, x, y, width, height, cached, cachedBounds, type, data"))return d;if(c(e)&&(e=D.stage),c(u)&&(u="png"),c(t))t="saved_"+String(a.makeID("numbers",5))+"."+u;else{var p=t.split(".");if(1==p.length)t+="."+u;else{var f=["png","jpg","jpeg"],g=f.indexOf(p[p.length-1].toLowerCase());-1==g?t+="."+u:u=f[g]}}if(c(n)&&(n=0),c(i)&&(i=0),c(o)&&(o=e.getBounds&&e.getBounds()?e.getBounds().width:D.width),c(r)&&(r=e.getBounds&&e.getBounds()?e.getBounds().height:D.height),e.cache(n,i,o,r),h){var y=e.cacheCanvas.toDataURL("image/"+u);return s?l&&e.cache(cashedBound.x,cashedBound.y,cashedBound.width,cashedBound.height):e.uncache(),y}if(/Edge\/(\d)+/.test(navigator.userAgent)){var b=window.open();b.document.write("<html><head><title>saved</title></head><body style='margin:0px;padding:0px;overflow:hidden'><img src="+e.cacheCanvas.toDataURL("image/"+u)+"></body></html>"),b.document.close()}else{var v=document.createElement("a");v.setAttribute("download",t),v.setAttribute("href",e.cacheCanvas.toDataURL("image/"+u)),document.body.appendChild(v),v.click(),document.body.removeChild(v)}return s?l&&e.cache(cashedBound.x,cashedBound.y,cashedBound.width,cashedBound.height):e.uncache(),F})!==L&&P(this,W),this.clone=function(){var t=new a.Loader(e,o,c(r)?null:r.clone(),s,l,u,h,d,f,g,y,b,v,w,x,c(T)?null:T.clone(),c(O)?null:O.clone(),A,c(S)?null:S.clone(),c(I)?null:I.clone(),E,c(M)?null:M.clone(),c(B)?null:B.clone(),c(z)?null:z.clone(),c(j)?null:j.clone(),_,D,L,this.group);return F.cloneProps(t)},Object.defineProperty(this,"frame",{get:function(){return D},set:function(e){e!=D&&(D.off("update",F.updateEvent),D.off("resize",F.resizeEvent),F.resizeEvent=(D=e).on("resize",F.resize),F.updateEvent=D.on("update",F.resize),F.resize())}}),this.resizeEvent=D.on("resize",F.resize),this.updateEvent=D.on("update",F.resize),this.dispose=function(){return D.off("update",F.updateEvent),D.off("resize",F.resizeEvent),document.body.removeChild(N),this.zimButton_dispose(),!0}},a.extend(a.Loader,a.Button,["clone","dispose"],"zimButton",!1),a.TextArea=function(e,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I,E){var M;if(M=m(a.TextArea,arguments,"width, height, size, padding, color, backgroundColor, borderColor, borderWidth, corner, shadowColor, shadowBlur, dashed, id, placeholder, readOnly, spellCheck, password, inputType, frame, expand, style, group, inherit",this))return M;C("67.6"),this.group=I;var B=!1===S?{}:a.getStyle("TextArea",this.group,E);if(c(e)&&(e=null!=B.width?B.width:250),c(o)&&(o=null!=B.height?B.height:70),c(r)&&(r=null!=B.size?B.size:20),c(s)&&(s=null!=B.padding?B.padding:5),c(l)&&(l=null!=B.color?B.color:"#666"),c(u)&&(u=null!=B.backgroundColor?B.backgroundColor:"rgba(256,256,256,.1)"),c(h)&&(h=null!=B.borderColor?B.borderColor:"rgba(0,0,0,.1)"),c(d)&&(d=null!=B.borderWidth?B.borderWidth:null),h<0||d<0?h=d=null:null!=h&&null==d&&(d=1),c(p)&&(p=null!=B.corner?B.corner:0),!c(g)&&c(f)&&(f=null!=B.shadowColor?B.shadowColor:"rgba(0,0,0,.3)"),!c(f)&&c(g)&&(g=null!=B.shadowBlur?B.shadowBlur:10),c(k)&&(k=null!=B.password&&B.password),c(T)&&(T=null!=B.inputType&&B.inputType),c(A)&&(A=null!=B.expand?B.expand:20),!0===A&&(A=20),c(O)){if(!t)return void(n&&i("zim.TextArea - please provide a reference to zim Frame"));O=t}this.zimContainer_constructor(e,o,null,null,!1),this.type="TextArea";var z=this,j=O.stage,_=this.background=new a.Rectangle(e,o,u,h,d,p,y,null,!1).expand(A);-1!=f&&0<g&&(_.shadow=new createjs.Shadow(f,3,3,g)),z.addChild(_);var D=z.tag=T||k?document.createElement("input"):document.createElement("textarea");document.body.appendChild(D),c(b)||(D.setAttribute("id",b),D.setAttribute("name",b)),k?D.setAttribute("type","password"):T&&D.setAttribute("type",T),w&&(D.readOnly=!0),x||(D.spellcheck=!1),c(v)||D.setAttribute("placeholder",v),D.style.cssText="background-color:rgba(0,0,0,.01); color:"+l+"; resize:none; z-index:3; width:"+(e-2*s)+"px; height:"+(o-2*s)+"px; overflow:hidden; outline:none;font-size:"+r+"px; font-family:"+(null!=B.font?B.font:"arial")+"; border:none; position:absolute; left:0px; top:0px; display:none;",D.addEventListener("change",function(){z.dispatchEvent("change")}),D.addEventListener("input",function(){z.dispatchEvent("input")}),D.addEventListener("focus",function(){O.zil&&window.removeEventListener("keydown",O.zil[0]),z.dispatchEvent("focus")}),D.addEventListener("blur",function(){O.zil&&window.addEventListener("keydown",O.zil[0]),z.dispatchEvent("blur")});var L=new createjs.DOMElement(D);L.alpha=0,this.on("mousedown",function(){setTimeout(function(){D.focus()},100)}),this.setFocus=function(e){return c(e)&&(e=!0),e?D.focus():D.blur(),z};var Y=O.retina&&window.devicePixelRatio||1;this.resize=function(){return setTimeout(function(){var e=z.localToGlobal(s,s);O.retina?(L.x=O.x/j.scaleX+e.x/Y,L.y=O.y/j.scaleY+e.y/Y,a.sca(L,z.scaleX/Y,z.scaleY/Y)):(L.x=O.x+e.x*O.scale,L.y=O.y+e.y*O.scale,a.sca(L,O.scale*z.scaleX,O.scale*z.scaleY)),L.alpha=1,z.stage&&j.update()},20),z},this.resize(),z.added(function e(){j.addChild(L),setTimeout(function(){D.style.display="block"},50),z.resize(),z.on("added",e,null,!0)}),z.on("removed",function(){j.removeChild(L),D.style.display="none"}),Object.defineProperty(this,"currentValue",{get:function(){return D.value},set:function(e){D.value=e}}),Object.defineProperty(this,"text",{get:function(){return D.value},set:function(e){D.value=e}}),Object.defineProperty(this,"focus",{get:function(){return document.activeElement==D},set:function(e){z.setFocus(e)}}),Object.defineProperty(this,"readOnly",{get:function(){return D.readOnly},set:function(e){D.readOnly=e}}),"undefined"!=typeof KEYFOCUS&&(a.KEYFOCUS=KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return a.KEYFOCUS==z},set:function(e){a.KEYFOCUS=z}}),a.KEYFOCUS||(z.keyFocus=!0),D.addEventListener("mousedown",function(){z.keyFocus=!0}),!1!==S&&P(this,B),this.clone=function(){var t=new a.TextArea(e,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,this.group,E);return z.cloneProps(t)},Object.defineProperty(this,"frame",{get:function(){return O},set:function(e){e!=O&&(O.off("update",z.updateEvent),O.off("resize",z.resizeEvent),z.resizeEvent=(O=e).on("resize",z.resize),z.updateEvent=O.on("update",z.resize),z.resize())}}),this.resizeEvent=O.on("resize",z.resize),this.updateEvent=O.on("update",z.resize),this.dispose=function(){return O.off("update",z.updateEvent),O.off("resize",z.resizeEvent),document.body.removeChild(D),this.zimContainer_dispose(),!0}},a.extend(a.TextArea,a.Container,["clone","dispose"],"zimContainer",!1),a.Tag=function(e,o,r,s,l,u,h,d,p,f,g,y){var b;if(b=m(a.Tag,arguments,"width, height, id, frame, backgroundColor, padding, paddingHorizontal, paddingVertical, expand, style, group, inherit",this))return b;C("67.7"),this.group=g;var v=!1===f?{}:a.getStyle("Tag",this.group,y);if(c(e)&&(e=null!=v.width?v.width:250),c(o)&&(o=null!=v.height?v.height:70),c(r)&&(r=null!=v.id?v.id:"zimTag_"+a.rand(1e4)),c(s)){if(!t)return void(n&&i("zim.TextArea - please provide a reference to zim Frame"));s=t}c(l)&&(l=null!=v.backgroundColor?v.backgroundColor:"rgba(0,0,0,0)"),c(u)&&(u=null!=v.padding?v.padding:10),c(h)&&(h=null!=v.paddingHorizontal?v.paddingHorizontal:u),c(d)&&(d=null!=v.paddingVertical?v.paddingVertical:u),c(p)&&(p=null!=v.expand?v.expand:20),!0===p&&(p=20),this.zimContainer_constructor(e,o,null,null,!1),this.type="Tag",this.tagID=r,this.id=r;var w=this,x=s.stage,k=(w.background=new a.Rectangle(e+h,o+d,l).center(this).expand(p||0),w.tag=document.createElement("div"));document.body.appendChild(k),k.setAttribute("id",r),k.setAttribute("name",r),k.style.cssText="resize:none; z-index:3; width:"+e+"px; height:"+o+"px; overflow:hidden; outline:none;position:absolute; left:0px; top:0px; display:none;";var T=new createjs.DOMElement(k);T.alpha=0;var O=s.retina&&window.devicePixelRatio||1;this.resize=function(){return setTimeout(function(){var e=w.localToGlobal(0,0);s.retina?(T.x=s.x/x.scaleX+e.x/O,T.y=s.y/x.scaleY+e.y/O,a.sca(T,w.scaleX/O,w.scaleY/O)):(T.x=s.x+e.x*s.scale,T.y=s.y+e.y*s.scale,a.sca(T,s.scale*w.scaleX,s.scale*w.scaleY)),T.alpha=1,w.stage&&x.update()},50),w},this.resize(),w.added(function e(){x.addChild(T),setTimeout(function(){k.style.display="block"},50),w.resize(),w.on("added",e,null,!0)}),w.on("removed",function(){x.removeChild(T),k.style.display="none"}),this.add=function(e){return k.innerHTML+=e,w},Object.defineProperty(this,"innerHTML",{get:function(){return k.innerHTML},set:function(e){k.innerHTML=e}}),Object.defineProperty(this,"style",{get:function(){return k.style},set:function(e){k.style=e}}),!1!==f&&P(this,v),this.clone=function(){var t=new a.Tag(e,o,r,s,l,u,h,d,p,f,this.group,y);return w.cloneProps(t)},Object.defineProperty(this,"frame",{get:function(){return s},set:function(e){e!=s&&(s.off("update",w.updateEvent),s.off("resize",w.resizeEvent),w.resizeEvent=(s=e).on("resize",w.resize),w.updateEvent=s.on("update",w.resize),w.resize())}}),this.resizeEvent=s.on("resize",w.resize),this.updateEvent=s.on("update",w.resize),this.dispose=function(){return s.off("update",w.updateEvent),s.off("resize",w.resizeEvent),document.body.removeChild(k),this.zimContainer_dispose(),!0}},a.extend(a.Tag,a.Container,["clone","dispose"],"zimContainer",!1),a.addTo=function(e,n,o,r){var s;if(s=m(a.addTo,arguments,"obj, container, index, localToLocal"))return s;if(C("47.5"),!c(e)){if(c(n)){if(!t)return void i("zim methods - addTo(): please provide container");n=t.stage}if(c(r)&&(r=!0),e.parent||(r=!1),r)var l=e.parent.localToLocal(e.x,e.y,n);return c(o)||isNaN(o)?n.addChild(e):n.addChildAt(e,o),r&&(e.x=l.x,e.y=l.y),e}i("zim methods - addTo(): please provide object")},a.removeFrom=function(e,t){if(C("47.6"),!c(e))return c(t)?e.parent&&e.parent.removeChild(e):t.removeChild(e),e;i("zim methods - removeFrom(): please provide object")},a.added=function(e,t,n,i){if(C("47.7"),!c(e)&&!c(t)&&"function"==typeof t){if(c(n)&&(n=100),!e.stage){var o=Date.now(),r=0,a=setInterval(function(){5<r?clearInterval(a):(r++,e.stage&&(t(e.stage,e),clearInterval(a),clearInterval(s)))},10),s=setInterval(function(){0<i&&o-Date.now()>i&&clearInterval(s),e.stage&&(t(e.stage,e),clearInterval(s))},n);return s}t(e.stage,e)}},a.centerReg=function(e,t,n,o){var r;if(r=m(a.centerReg,arguments,"obj, container, index, add"))return r;if(C("48"),c(e)||!e.getBounds||!e.getBounds())return i("zim methods - centerReg(): please provide object with bounds set"),e;c(o)&&(o=!0),c(t)&&e.parent&&o&&(t=e.parent,c(n)&&(n=e.parent.getChildIndex(e)),e.parent.removeChild(e)),c(t)||t!=e.parent||(c(n)&&(n=e.parent.getChildIndex(e)),e.parent.removeChild(e));var s=e.getBounds();return e.regX=s.x+s.width/2,e.regY=s.y+s.height/2,o?a.center(e,t,n):e},a.centerCheck=!1,a.center=function(e,n,o,r){var s;if(s=m(a.center,arguments,"obj, container, index, add"))return s;if(a.centerCheck||(C("48.1"),a.centerCheck=!0),!c(e)&&e.getBounds){if(c(n)&&(e.parent?n=e.parent:t&&(n=t.stage)),!c(n)&&n.getBounds){var l=e.getBounds(),u=n.getBounds();if(c(r)&&(r=!0),r&&n.addChild&&(c(o)||"number"==typeof o&&isNaN(o)?n.contains(e)||n.addChild(e):n.addChildAt(e,o)),c(u))return l?(e.x=l.x+e.regX-l.width/2,e.y=l.y+e.regY-l.height/2):e.x=e.y=0,e;if(c(l))return e.x=n.getBounds().width/2,e.y=n.getBounds().height/2,e;var h=e.localToLocal(e.regX,e.regY,n),d=a.boundsToGlobal(e),p=a.boundsToGlobal(n,d,!0);if(e.x=u.x+u.width/2-p.width/2+(h.x-p.x),e.y=u.y+u.height/2-p.height/2+(h.y-p.y),!r&&n.getStage&&n.stage&&e.parent){var f=n.localToLocal(e.x,e.y,e.parent);e.x=f.x,e.y=f.y}return e}i("zim.center(): please provide container with bounds")}else i("zim.center(): please provide object with bounds")},a.place=function(e,t){if(C("49"),!c(e))return c(t)&&(t="obj"),a.drag({obj:e,currentTarget:!0,dragCursor:"crosshair"}),i("place "+t+" - to get new position"),e.on("click",function(){i(t+".x = "+Math.round(e.x)+"; "+t+".y = "+Math.round(e.y)+";"),i(t+".loc("+Math.round(e.x)+", "+Math.round(e.y)+");")}),e},a.placeReg=function(e,t){if(C("49.5"),!c(e)){var n=e.stage;if(c(n))return i("zim.placeReg() - add object to stage before calling placeReg()"),e;c(t)&&(t="obj");var o=e.parent.localToGlobal(e.x,e.y),r=new a.Shape(-25,-25,50,50,null,!1).addTo(n).pos({x:o.x,y:o.y,reg:!0});return r.graphics.s("white").mt(-25,0).lt(25,0).mt(0,-25).lt(0,20),r.compositeOperation="difference",r.expand(0),a.drag({obj:r}),i("place cursor to get new registration point location"),n.on("stagemouseup",function(){var n=e.globalToLocal(r.x,r.y);i(t+".regX = "+Math.round(n.x)+"; "+t+".regY = "+Math.round(n.y)+";"),i(t+".reg("+Math.round(n.x)+", "+Math.round(n.y)+");")}),e}},a.pos=function(e,n,i,o,r,s,l,u,h,d,p){var f;if(f=m(a.pos,arguments,"obj, x, y, right, bottom, container, index, add, reg, regX, regY"))return f;C("41.5");var g=a.POSREG;if("undefined"!=typeof POSREG&&(g=POSREG),c(h)&&(h=g),!c(e)){if(c(h)&&c(d)&&(d=!1),c(h)&&c(p)&&(p=!1),!c(h)&&c(d)&&(d=h),!c(h)&&c(p)&&(p=h),!0!==o&&(o=!1),!0!==r&&(r=!1),c(u)&&(u=!0),c(s)||s.addChild||(s=null),e.getBounds||object.getBounds()||(d=p=!1),c(s)&&(e.parent?s=e.parent:t&&(s=t.stage)),!e.parent&&c(n)&&(n=0),!e.parent&&c(i)&&(i=0),!c(s)&&s.addChild&&u&&(c(l)||"number"==typeof l&&isNaN(l)?s.contains(e)||s.addChild(e):s.addChildAt(e,l)),e.parent&&e.parent.getBounds){if(s=e.parent,c(n)&&1==o&&(n=0),c(i)&&1==r&&(i=0),c(n)||(e.x=n),c(i)||(e.y=i),c(n)&&c(i)&&!o&&!r)return e;var y=0,b=0;if(e.getBounds()){var v=function(){var t=e.getBounds(),n=t.x,i=t.y,o=t.width,r=t.height,a=e._props.matrix;a=e.getMatrix(a),(n||i)&&a.appendTransform(0,0,1,1,0,0,0,-n,-i);var s=o*a.a,l=o*a.b,c=r*a.c,u=r*a.d,h=a.tx,d=a.ty,p=h,f=h,g=d,m=d;return(n=s+h)<p?p=n:f<n&&(f=n),(n=s+c+h)<p?p=n:f<n&&(f=n),(n=c+h)<p?p=n:f<n&&(f=n),(i=l+d)<g?g=i:m<i&&(m=i),(i=l+u+d)<g?g=i:m<i&&(m=i),(i=u+d)<g?g=i:m<i&&(m=i),{x:p,y:g,width:f-p,height:m-g}}();if(!c(n)){if(o)w=new a.Point(v.x+v.width,v.y+v.height);else var w=new a.Point(v.x,v.y);y=w.x-n}c(i)||(b=(w=r?new a.Point(v.x+v.width,v.y+v.height):new a.Point(v.x,v.y)).y-i);var x=s.getBounds();c(n)||(o?e.x=d?x.width+x.x-n:x.width+x.x-n-y:(e.x=d?n:n-y,e.x+=x.x)),c(i)||(r?e.y=p?x.height+x.y-i:x.height+x.y-i-b:(e.y=p?i:i-b,e.y+=x.y))}}return e}},a.loc=function(e,n,i,o,r,s,l,u){var h;if(h=m(a.loc,arguments,"obj, target, y, container, index, add, localToLocal, x"))return h;if(C("41.55"),!c(e)){if("number"==typeof n&&(u=n,n=null),c(n)||(c(n.x)||(u=n.x),c(n.y)||(i=n.y)),c(u)&&c(n)&&(u=e.x),c(i)&&c(n)&&(i=e.y),c(s)&&(s=!0),c(o)&&(e.parent?o=e.parent:t&&(o=t.stage)),s&&o&&(e.parent&&o==e.parent||(c(r)||isNaN(r)?o.addChild(e):o.addChildAt(e,r))),c(l)&&(l=!0),n&&n.parent&&e.parent&&l){var d=n.parent.localToLocal(u,i,e.parent);u=d.x,i=d.y}return e.x=u,e.y=i,e}},a.mov=function(e,t,n){var i;return(i=m(a.mov,arguments,"obj, x, y"))?i:(C("41.6"),c(e)?void 0:(c(t)||(e.x+=t),c(n)||(e.y+=n),e))},a.sca=function(e,t,n){if(C("41.97"),!c(e)&&!c(e.scaleX))return c(t)&&(t=e.scaleX),c(n)&&(n=t),e.scaleX=t,e.scaleY=n,e},a.alp=function(e,t){if(C("41.7"),!c(e))return c(t)||(e.alpha=e.hovOriginal=t),e},a.hov=function(e,t,n){if(C("41.75"),!c(e))return c(t)&&(t=1),c(n)&&(n="number"==typeof t?"alpha":"color"),e.hovMouseover&&(e.off("mouseover",e.hovMouseover),e.off("mouseout",e.hovMouseout)),-1==t?(e.cur("default"),c(e.hovOld)||(e[e.hovType]=e.hovOld),e.hovOld=null,e.stage&&e.stage.update()):(e.cur(),e.hovOld=e[n],e.hovNew=t,e.hovType=n,e.hovMouseover=e.on("mouseover",function(){e[n]=e.hovNew,e.stage.update()}),e.hovMouseout=e.on("mouseout",function(){e[n]=e.hovOld,e.stage.update()})),e},a.rot=function(e,t,n,i){if(C("41.8"),!c(e)){if(!c(t))if(!e.parent||c(n)&&c(i))e.rotation=t;else{c(n)&&(n=e.x),c(i)&&(i=e.y);var o=e.parent.localToLocal(n,i,e),r=new a.Point(e.x,e.y);e.reg(o.x,o.y),e.rotation=t,e.x=n,e.y=i;var s=e.parent.localToLocal(r.x,r.y,e);e.reg(s.x,s.y),e.x=r.x,e.y=r.y}return e}},a.siz=function(e,t,n,i){if(C("41.85"),!c(e))return c(i)&&(i=!1),c(t)||c(n)?c(t)?c(n)||(i?e.heightOnly=n:e.height=n):i?e.widthOnly=t:e.width=t:(e.widthOnly=t,e.heightOnly=n),e},a.ske=function(e,t,n){if(C("41.9"),!c(e))return c(t)||(e.skewX=t),c(n)||(e.skewY=n),e},a.reg=function(e,t,n,i){if(C("41.95"),!c(e)){var o=e.regX,r=e.regY;if(c(t)||(e.regX=t),c(n)||(e.regY=n),i&&e.parent){var a=e.localToLocal(o,r,e.parent);e.x-=a.x-e.x,e.y-=a.y-e.y}return e}},a.top=function(e){if(C("41.62"),!c(e)&&e.parent)return e.parent.setChildIndex(e,e.parent.numChildren-1),e},a.bot=function(e){if(C("41.63"),!c(e)&&e.parent)return e.parent.setChildIndex(e,0),e},a.ord=function(e,t){if(C("41.64"),!c(e)&&e.parent)return c(t)&&(t=0),e.parent.setChildIndex(e,e.parent.getChildIndex(e)+t),e},a.cur=function(e,t){return C("41.1"),c(e)?i("zim methods - cur(): please provide object"):(c(t)&&(t="pointer"),e.cursor=t),e},a.sha=function(e,t,n,o,r){return C("41.2"),c(e)?(i("zim methods - sha(): please provide object"),e):(c(t)&&(t="rgba(0,0,0,.3)"),t.blur?e.shadow=t:(c(n)&&(n=e.width?.08*e.width:5),c(o)&&(o=e.height?.08*e.height:5),c(r)&&(r=e.width?.16*e.width:10),e.shadow=new createjs.Shadow(t,n,o,r)),e)},a.dep=function(e,t){if(C("41.65"),!c(e))return c(t)&&(t=0),e.depth=t,e},a.tap=function(e,t,n,i,o){var r;if(C("47.8"),!c(e)&&!c(t)&&"function"==typeof t)return c(n)&&(n=5),c(i)&&(i=1e4),c(o)&&(o=!1),e.cursor="pointer",e.zimClickDownEvent=e.on("mousedown",function(o){if(r=o.target.stage,"List"==o.currentTarget.type){if("WindowBacking"==o.target.type)return;if(o.currentTarget.globalToLocal(o.stageX/r.scaleX,o.stageY/r.scaleY).y<=0)return}var a=o.stageX/r.scaleX,s=o.stageY/r.scaleY,l=Date.now();e.zimClickUpEvent=e.on("pressup",function(o){if(Math.abs(a+s-o.stageX/r.scaleX-o.stageY/r.scaleY)<n&&Date.now()-l<i){if(e.excludeTap)return;t(o)}},null,!0)},null,o),e},a.noTap=function(e){if(C("47.9"),!c(e))return e.cursor&&(e.cursor="default"),e.off("mousedown",e.zimClickDownEvent),e.off("pressup",e.zimClickUpEvent),e},a.change=function(e,t,n){if(C("47.85"),!c(e)&&!c(t)&&"function"==typeof t)return c(n)&&(n=!1),e.zimChangeEvent=e.on("change",function(e){t(e)},null,n),e},a.noChange=function(e){if(C("47.95"),!c(e))return e.off("mousedown",e.zimChangeEvent),e},a.drag=function(e,t,n,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x){var k;if(k=m(a.drag,arguments,"obj, boundary, overCursor, dragCursor, all, swipe, localBounds, onTop, surround, slide, slideDamp, slideSnap, reg, removeTweens, startBounds, rect, currentTarget, offStage"))return k;if(C("31"),!c(e)&&e.on){var T=a.DRAGALL;if("undefined"!=typeof DRAGALL&&(T=DRAGALL),c(r)&&c(w)&&(r=T),e.zimDown&&e.noDrag(),e.cursor=c(n)?"pointer":n,c(r)&&c(w)?w=!1:c(r)?c(w)&&(w=!1):w=r,"Tag"!=e.type&&"TextArea"!=e.type&&"Loader"!=e.type||(w=!0),c(s)&&(s=!1),c(l)&&(l=!1),c(u)&&(u=!0),c(h)&&(h=!1),c(d)&&(d=!1),c(p)&&(p=.3),c(f)&&(f=!0),!0!==f&&["horizontal","vertical","auto"].indexOf(f)<0&&(f=!1),c(g)&&(g=!1),c(y)&&(y=!0),c(b)&&(b=!0),c(t)&&!c(v)&&(t=v),d)var P,O,A,S,I,E,M,B,z,j,_,D,L,Y,R;a.setSwipe(e,s),e.zimBoundary=t,e.zimLocalBounds=l;var X,W,F,V,N,G,H,K=!1,q=!1;return e.zimAdded=e.on("added",U,null,!0),e.zimRemoved=e.on("removed",function(){e.zimDragTicker&&a.Ticker.remove(e.zimDragTicker)},null,!0),e.parent&&U(),e.pointers={},e.zimDown=e.on("mousedown",function(t){if(e.stage){H=e.stage,e.dragMouseX=Math.round(t.stageX/H.scaleX),e.dragMouseY=Math.round(t.stageY/H.scaleY);var n="id"+Math.abs(t.pointerID+1);if(e.pointers[n]=!0,G=w?t.currentTarget:t.target,!e.zimBoundary||G.getBounds()){if(K=!0,e.stage.mouseMoveOutside=!0,d||(e.zimDragTicker&&a.Ticker.remove(e.zimDragTicker),e.zimDragTicker=a.Ticker.add(function(){},H)),y&&createjs.Tween.removeTweens(G),G.parent){if(u){var r=G.parent.numChildren-1;"Keyboard"==G.parent.getChildAt(r).type&&r--,G.parent.setChildIndex(G,r),G.ZIMoutlineShape&&G.outline()}if(G.parent==e.stage)var s=new a.Point(t.stageX/H.scaleX,t.stageY/H.scaleY);else s=G.parent.globalToLocal(t.stageX/H.scaleX,t.stageY/H.scaleY);g&&(G.x=s.x,G.y=s.y),X=s.x-G.x,W=s.y-G.y,e.zimBoundary&&(l?(V=a.boundsToGlobal(G.parent,e.zimBoundary),h&&(N=e.zimBoundary)):(V=e.zimBoundary,h&&(N=a.boundsToGlobal(G.parent,e.zimBoundary,!0)))),e.cursor=c(o)?"pointer":o,d&&(e.slideStartX=e.x,e.slideStartY=e.y,R=!1,S=0,I=[s.x],E=[s.y],Y=L=-1e4,e.zimDragMoving=!0),"Pen"==e.type&&(e.zimDragCheck=!0,q=!1)}}else i("zim.drag() - drag object needs bounds set")}},!0),e.zimMove=e.on("pressmove",function(t){if(K){var n=x?t.rawX:t.stageX,i=x?t.rawY:t.stageY;e.dragMouseX=Math.round(n/H.scaleX),e.dragMouseY=Math.round(i/H.scaleY),Z(G,n/H.scaleX,i/H.scaleY),G.ZIMoutlineShape&&G.outline(),"Pen"==e.type&&!q&&e.drawing?q=!0:"Tag"!=e.type&&"TextArea"!=e.type&&"Loader"!=e.type||e.resize()}},!0),e.zimPosition=Z,e.zimUp=e.on("pressup",function(t){var i="id"+Math.abs(t.pointerID+1);if(delete e.pointers[i],K){if(e.cursor=c(n)?"pointer":n,d){if(G.parent)var o=G.parent.globalToLocal((x?t.rawX:t.stageX)/H.scaleX,(x?t.rawY:t.stageY)/H.scaleY);else o=new a.Point(0,0);K=!1,M=o.x,B=o.y,z=G.x,j=G.y,P.immediate(G.x),O.immediate(G.y)}else{var r=0;for(var s in e.pointers)r++;0==r&&a.Ticker.remove(e.zimDragTicker),"Pen"==e.type&&(e.zimDragCheck=!1,q&&e.stopCheck())}e.stage&&e.stage.update()}},!0),e}function U(){e.off("added",e.zimAdded),W=X=0,e.zimBoundary&&(l?(V=a.boundsToGlobal(e.parent,e.zimBoundary),h&&(N=e.zimBoundary)):(V=e.zimBoundary,h&&(N=a.boundsToGlobal(e.parent,e.zimBoundary,!0)))),V&&b&&(F=e.parent.localToGlobal(e.x,e.y),Z(e,F.x,F.y)),d&&setTimeout(function(){P=new a.Damp(e.x,p),O=new a.Damp(e.y,p),e.zimDragImmediate=function(e,t){j=t,M=_=B=D=0,c(z=e)||P.immediate(e),c(t)||O.immediate(t)},A=3,S=0,I=[],E=[],M=e.x,B=e.y,z=e.x,j=e.y,_=e.x,D=e.y,Y=L=-1e4,e.zimDragMoving=!0,function(){var t=e.stage;function n(t,n,i,o,r){Math.abs(t.x-L)<.1&&Math.abs(t.y-Y)<.1?(e.zimDragMoving=!1,t.x=o,t.y=r,t.slideStartX=null,t.slideStartY=null,R&&t.dispatchEvent("slidestop"),"Pen"==e.type&&(e.zimDragCheck=!1,q&&e.stopCheck())):(L=n,Y=i)}e.zimDragTicker=function(){if(!c(e.slideStartX))if(G||(G=e),K){if(G.parent)var t=G.parent.globalToLocal(e.dragMouseX,e.dragMouseY);else t=new a.Point(0,0);S++,I.push(t.x),E.push(t.y),D=A<=S?(_=I.shift(),E.shift()):(_=I[0],E[0])}else{if(!e.zimDragMoving)return;var i=z+M-_,o=j+B-D;if(V&&(i=(r=J(G,i,o)).x,o=r.y),f)G.x=P.convert(i),G.y=O.convert(o),n(G,G.x,G.y,i,o);else{var r=J(G,P.convert(i),O.convert(o));G.x=r.x,G.y=r.y,n(G,G.x,G.y,G.x,G.y)}}},a.Ticker.add(e.zimDragTicker,t)}()},50),c(e.zimMaskDynamic)||e.zimMaskApply()}function Z(t,n,i){if(c(t)&&(t=G||e),t.parent){if(c(n)||c(i)){var o=t.parent.localToGlobal(t.x,t.y);X=W=0,e.zimBoundary&&(l?(V=a.boundsToGlobal(t.parent,e.zimBoundary),h&&(N=t.zimBoundary)):(V=e.zimBoundary,h&&(N=a.boundsToGlobal(t.parent,e.zimBoundary,!0)))),n=o.x,i=o.y,d&&(z=t.x,j=t.y,G=t,P&&P.immediate(z),O&&O.immediate(j))}var r,s=t.parent.globalToLocal(n,i);d&&f?"vertical"==f?(r=J(t,s.x-X,s.y-W),t.x=r.x,t.y=s.y-W):"horizontal"==f?(r=J(t,s.x-X,s.y-W),t.x=s.x-X,t.y=r.y):(t.x=s.x-X,t.y=s.y-W):(r=J(t,s.x-X,s.y-W),t.x=r.x,t.y=r.y),!d||R||t.slideStartX==t.x&&t.slideStartY==t.y||(R=!0)}}function J(e,t,n){if(!e.parent)return{x:t,y:n};if(V)if(h){var i=e.getBounds().width,o=e.getBounds().height,r=e.getBounds().x,a=e.getBounds().y;i<N.width?t=N.x+(N.width-i)/2+(e.regX-r):(t-(e.regX-r)>N.x&&(t=N.x+(e.regX-r)),t-(e.regX-r)+i<N.x+N.width&&(t=N.x+N.width+(e.regX-r)-i)),e.height<N.height?n=N.y+(N.height-o)/2+(e.regY-a):(n-(e.regY-a)>N.y&&(n=N.y+(e.regY-a)),n-(e.regY-a)+o<N.y+N.height&&(n=N.y+N.height+(e.regY-a)-o))}else{var s=e.parent.localToGlobal(t,n);t=Math.max(V.x,Math.min(V.x+V.width,s.x)),n=Math.max(V.y,Math.min(V.y+V.height,s.y)),t=(s=e.parent.globalToLocal(t,n)).x,n=s.y}return{x:t,y:n}}},a.noDrag=function(e){if(C("32"),!c(e)&&e.on)return e.cursor="default",a.setSwipe(e,!0),e.off("added",e.zimAdded),e.off("removed",e.zimRemoved),e.off("mousedown",e.zimDown),e.off("pressmove",e.zimMove),e.off("pressup",e.zimUp),a.Ticker&&e.zimDragSlide&&a.Ticker.remove(e.zimDragSlide),e.zimDragMoving=e.zimAdded=e.zimRemoved=e.zimDown=e.zimMove=e.zimUp=e.zimBoundary=e.zimDragSlide=null,e},a.dragBoundary=function(e,t,n){if(C("33"),!c(e)&&e.on&&!c(t))return e.zimBoundary=t,e.zimDragMoving=!0,e.zimPosition&&e.zimPosition(),e},a.dragRect=a.dragBoundary,a.transform=function(e,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,P,O,A,S,I,E,M,B,z,j){var _;if(_=m(a.transform,arguments,"obj, move, stretchX, stretchY, scale, rotate, allowToggle, visible, onTop, showStretch, showRotate, showScale, showReg, showBorder, borderColor, borderWidth, dashed, customCursors, handleSize, regSize, snapDistance, snapRotation, cache, events, ghostColor, ghostWidth, ghostDashed, ghostHidden"))return _;if(C("33.5"),c(e)||!e.getBounds)return i("zim methods - transform(): please provide object with bounds set"),e;if(!e.getBounds())return i("zim methods - transform(): please setBounds() on object"),e;if(!e.parent)return i("zim methods - transform(): object should be on stage first"),e;c(o)&&(o=!0),c(r)&&(r=!0),c(s)&&(s=!0),c(l)&&(l=!0),c(u)&&(u=!0);var D=a.mobile();c(h)&&(h=!0),c(d)&&(d=!0),c(p)&&(p=!0),c(f)&&(f=!!D),c(g)&&(g=!!D),c(y)&&(y=!0),c(b)&&(b=!0),c(v)&&(v=!0),c(w)&&(w="brown"),c(x)&&(x=1),c(M)&&(M=null),c(B)&&(B=null),M<0||B<0?M=B=null:null!=M&&null==B&&(B=1),c(z)&&(z=!0),c(j)&&(j=!1),c(T)&&(T=!D),c(P)&&(P=a.mobile()?20:10),c(O)&&(O=16),c(A)&&(A=10),c(S)&&(S=5),c(I)&&(I=!0),c(E)&&(E=!1),e.mouseChildren=!1;var L=e.getConcatenatedMatrix().decompose();if(void 0===t)if("undefined"==typeof frame||null==frame){if(!e.stage)return n&&i("ZIM transform() - please add object to stage before calling transform()"),e;frame=t={stage:Y,canvas:Y.canvas}}else t=frame;else"undefined"!=typeof frame&&null!=frame||(frame=t);c(e.stage)&&e.added(function(){e.transformControls&&e.transformControls.resize()});var Y=e.stage?e.stage:frame.stage;c(frame.eventRemove)&&(Y.enableMouseOver(),frame.ctrlKey=!1,frame.shiftKey=!1,window.addEventListener("keydown",function(e){frame.altKey=e.altKey,frame.ctrlKey=e.ctrlKey}),window.addEventListener("keyup",function(e){frame.altKey=e.altKey,frame.ctrlKey=e.ctrlKey}));var R=e.getBounds(),X=new a.Shape({style:!1}),W=new a.Shape({style:!1}),F=new a.Shape({style:!1});W.mouseEnabled=!1,F.controlType="reg";var V,N,G,H,K,q,U,Z=e.parent,J=X.graphics,$=W.graphics,Q=F.graphics,ee=new a.Container({style:!1});ee.type="TransformControls";var te,ne,ie,oe,re,ae=new a.Container({style:!1}),se=new a.Container({style:!1}),le=new a.Container({style:!1}),ce=new a.Container({style:!1});if(c(e.zimMaskDynamic)||e.zimMaskApply(),T){var ue=new a.Container({style:!1}),he=new a.Container({style:!1});function de(e){e==ue&&new a.Triangle(16,12,12,"white").addTo(e).mov(0,-13.5),new a.Triangle(16,12,12,"white").addTo(e).mov(13.5).rot(90),e==ue&&new a.Triangle(16,12,12,"white").addTo(e).mov(0,13.5).rot(180),new a.Triangle(16,12,12,"white").addTo(e).mov(-13.5).rot(-90),e==ue&&new a.Triangle(10,7,7,"black").addTo(e).mov(0,-13),new a.Triangle(10,7,7,"black").addTo(e).mov(13).rot(90),e==ue&&new a.Triangle(10,7,7,"black").addTo(e).mov(0,13).rot(180),new a.Triangle(10,7,7,"black").addTo(e).mov(-13).rot(-90),I&&e.cache(-20,-20,40,40)}de(ue),de(he);var pe={"nw-resize":45,"ne-resize":-45,"n-resize":90,"e-resize":0}}function fe(){var t=e;for(ie=ne=1,re=oe=te=0;t.parent;)te+=t.rotation,ne*=t.scaleX,ie*=t.scaleY,oe+=t.skewX,re+=t.skewY,t=t.parent}fe();for(var ge=te,me=["nw-resize","ne-resize","nw-resize","ne-resize"],ye=[2,3,0,1],be=0;be<4;be++)y?((Te=new a.Rectangle(P,P,"#e472c4","#333",2,null,null,null,!1)).centerReg(ae),I&&Te.cache(-1,-1,P+2,P+2)):((Te=new a.Rectangle(P,P,"rgba(0,0,0,0)","rgba(0,0,0,0)",2,null,null,null,!1)).centerReg(ae),Te.expand(0)),Te.rotation=te,Te.drag({overCursor:q=T?"none":me[be],dragCursor:q,onTop:!1}),Te.controlType="corner",Te.cu=me[be];for(be=0;be<ye.length;be++)ae.getChildAt(be).op=ae.getChildAt(ye[be]);var ve=["n-resize","e-resize","n-resize","e-resize"];for(ye=[1,1,0,0],be=0;be<4;be++){var we=be%2==0?e.width/2:P,xe=be%2==0?P:e.height/2;f?((Te=new a.Rectangle(P,P,"#AAA","#333",2,null,null,null,!1)).centerReg(be%2==0?le:se),I&&Te.cache(-1,-1,P+2,P+2)):((Te=new a.Rectangle(we,xe,"rgba(0,0,0,0)",null,null,null,null,null,!1)).centerReg(be%2==0?le:se),Te.expand(0)),Te.rotation=te,Te.drag({overCursor:q=T?"none":ve[be],dragCursor:q,onTop:!1}),Te.controlType="side",Te.cu=ve[be]}for(be=0;be<ye.length;be++){var Ce=be%2==0?le:se;Ce.getChildAt(Math.floor(be/2)).op=Ce.getChildAt(ye[be])}var ke=["ne-resize","nw-resize","ne-resize","nw-resize"];for(be=0;be<4;be++){var Te;g?((Te=new a.Circle(P,"#e472c4",null,null,null,null,null,!1)).addTo(ce),I&&Te.cache(-P,-P,2*P,2*P)):((Te=new a.Circle(P,"rgba(0,0,0,0)",null,null,null,null,null,!1)).addTo(ce),Te.expand(0)),Te.drag({overCursor:q=T?"none":ke[be],dragCursor:q,onTop:!1}),Te.controlType="rotate",Te.cu=ke[be]}var Pe=1.8;function Oe(){var e=P*Pe*a.sign(ne),t=P*Pe*a.sign(ie);ce.getChildAt(0).reg(e,t),ce.getChildAt(1).reg(-e,t),ce.getChildAt(2).reg(-e,-t),ce.getChildAt(3).reg(e,-t),Y.update()}function Ae(){J.c(),$.c(),Q.c(),V=e.localToGlobal(R.x,R.y),N=e.localToGlobal(R.x+R.width,R.y),G=e.localToGlobal(R.x+R.width,R.y+R.height),H=e.localToGlobal(R.x,R.y+R.height),pTM=e.localToGlobal(R.x+R.width/2,R.y),pRM=e.localToGlobal(R.x+R.width,R.y+R.height/2),pBM=e.localToGlobal(R.x+R.width/2,R.y+R.height),pLM=e.localToGlobal(R.x,R.y+R.height/2),K=e.localToGlobal(e.regX,e.regY),pMid=e.localToGlobal(R.x+R.width/2,R.y+R.height/2),U=[V,N,G,H],mids=[pTM,pRM,pBM,pLM],v&&(J.s(w),k&&J.sd([10,5],0),J.ss(x).mt(V.x,V.y).lt(N.x,N.y).lt(G.x,G.y).lt(H.x,H.y).lt(V.x,V.y).cp()),c(M)||($.s(M),z&&$.sd([10,5],0),$.ss(B).mt(V.x,V.y).lt(N.x,N.y).lt(G.x,G.y).lt(H.x,H.y).lt(V.x,V.y).cp()),X.setBounds(V.x,V.y,N.x-V.x,H.y-V.y),b&&(Q.s("#eee").ss(x).f("rgba(0,0,0,.1)").dc(0,0,O),Q.s("#222").ss(x).dc(0,0,.3*O)),fe();for(var t=Math.min(50,Math.abs(oe))*a.sign(oe),n=Math.min(50,Math.abs(re))*a.sign(re),i=te*a.sign(ne*ie)*a.sign(e.scaleX*e.scaleY),o=0;o<U.length;o++){var r=U[o];ae.getChildAt(o).loc(r.x,r.y).ske(t,n).rot(i),ce.getChildAt(o).loc(r.x,r.y).rot(i);var s=mids[o],l=o%2==0?le:se;l.getChildAt(Math.floor(o/2)).loc(s.x,s.y).ske(t,n).rot(i),f||l.getChildAt(Math.floor(o/2)).sca(o%2==0?ne/2:1,o%2==0?1:ie/2)}F.x=K.x,F.y=K.y}ce.alpha=.5,Oe(),Ae();var Se=new a.Shape(1e3,1e3,null,null,null,!1);function Ie(){Se.x=0,Se.y=0,Se.graphics.c().f("rgba(0,0,0,.01)").mt(V.x,V.y).lt(N.x,N.y).lt(G.x,G.y).lt(H.x,H.y).lt(V.x,V.y).cp(),Se.reg(K.x,K.y),Se.x=K.x,Se.y=K.y}Ie(),ee.on("dblclick",function(t){frame.ctrlKey&&e.transformControls.visible&&(e.scaleX=1,e.scaleY=1,e.rotation=0,Ae(),Ie(),Y.update()),tt(t,!0)});var Ee=ee.on("mousedown",Be),Me=e.on("mousedown",Be);function Be(t){var n=Y.getObjectUnderPoint(t.stageX,t.stageY,1);a.mobile()||n&&(e.contains&&e.contains(n)||!e.contains&&e==n)?e.transformControls.visible||(T?(st=!1,Se.mouseEnabled=!1):frame.canvas.style.cursor="move",e.transformControls.show(),e.dispatchEvent("transformshow")):!e.transformControls.visible||n&&ee.contains(n)||(e.transformControls.hide(),e.dispatchEvent("transformhide"))}var ze,je,_e,De,Le,Ye,Re,Xe,We,Fe,Ve,Ne=Y.on("stagemousedown",function(t){var n=Y.getObjectUnderPoint(t.stageX,t.stageY,1),i=n&&n.parent&&n.parent.layer&&n.parent.layer==e;!e.transformControls.visible||n&&(ee.contains(n)||i)||(e.dispatchEvent("transformhide"),e.transformControls.hide())});h||(ee.off("mousedown",Ee),e.off("mousedown",Me),Y.off("stagemousedown",Ne));var Ge,He,Ke,qe=!1,Ue=!1,Ze=e.cursor,Je=new a.Circle(30,"rgba(0,0,0,0)",null,null,null,null,null,!1).expand(20);if(T){Je.mouseEnabled=!1,Je.mouseChildren=!1,Je.addChild(he),ae.on("mouseover",it),ae.on("mouseout",ot),se.on("mouseover",it),se.on("mouseout",ot),le.on("mouseover",it),le.on("mouseout",ot),ce.on("mouseover",it),ce.on("mouseout",ot);var $e=new a.Circle(30,"rgba(0,0,0,0)",null,null,null,null,null,!1).expand(20);$e.cursor="none"}function Qe(t){if(Ue=!0,p&&rt(),Ge&&Y.off("stagemousemove",Ge),ze=t.target.x,je=t.target.y,Xe=e.x,We=e.y,startSX=e.scaleX,startSY=e.scaleY,"rotate"==t.target.controlType){qe=!0,_e=e.rotation;var n=t.stageX/Y.scaleX,i=t.stageY/Y.scaleY,o=Z.localToGlobal(Xe,We);Fe=o.x,Ve=o.y,De=180*Math.atan2(i-Ve,n-Fe)/Math.PI}Ye=frame.ctrlKey||"rotate"==t.target.controlType?(Le=Math.abs(ze-e.x),Math.abs(je-e.y)):(Le=Math.abs(ze-t.target.op.x),Math.abs(je-t.target.op.y)),cornerPointObj=t.target.op,"rotate"!=t.target.controlType&&(Re=t.target.op.parent.localToLocal(t.target.op.x,t.target.op.y,e.parent)),Je.stage?Y.setChildIndex(Je,Y.getChildIndex(ee)):Je.addTo(Y,Y.getChildIndex(ee)+1),Je.x=t.stageX/Y.scaleX,Je.y=t.stageY/Y.scaleY,Je.cursor=T?"none":t.target.cu,T&&(e.getConcatenatedMatrix().decompose(L),L.rotation||(L.rotation=0),he.rotation=L.rotation*a.sign(ne*ie)*a.sign(e.scaleX*e.scaleY)+pe[t.target.cu]+ge,"side"!=t.target.controlType&&ne*ie<0&&(he.rotation+=90),$e.addTo(Y,1).pos({x:t.stageX/Y.scaleX,y:t.stageY/Y.scaleY,reg:!0})),Se.visible=!1,e.cursor="none"}function et(t){var n;if(n=frame.ctrlKey&&"corner"==t.target.controlType?Ye<Le?(t.target.x-Xe)/(ze-Xe):(t.target.y-We)/(je-We):Ye<Le?(t.target.x-t.target.op.x)/(ze-t.target.op.x):(t.target.y-t.target.op.y)/(je-t.target.op.y),"corner"==t.target.controlType?(e.scaleX=n*startSX,e.scaleY=n*startSY):(e.scaleX="e-resize"==t.target.cu?n*startSX:startSX,e.scaleY="n-resize"==t.target.cu?n*startSY:startSY),Ae(),Je.x=t.stageX/Y.scaleX,Je.y=t.stageY/Y.scaleY,T&&($e.x=t.stageX/Y.scaleX,$e.y=t.stageY/Y.scaleY),!frame.ctrlKey||"side"==t.target.controlType){var i=t.target.op.parent.localToLocal(t.target.op.x,t.target.op.y,e.parent);e.x-=(i.x-Re.x)*a.sign(ne)*a.sign(e.scaleX),e.y-=(i.y-Re.y)*a.sign(ie)*a.sign(e.scaleY)}Ae(),e.transformControls.events&&nt(t,t.target.controlType)}function tt(e,t){Oe();var n=e?e.target.controlType:"move";t&&(n="reset"),T&&$e.removeFrom(Y),nt(e,n,!0),Y.update()}function nt(t,n,i,o){null==o&&(o=!0);var r=!1;Ke=null,"move"==n?(e.x==lt.x&&e.y==lt.y||((Ke=new createjs.Event("transformed")).transformType="move"),o&&(r=Se.hitTestPoint(t.stageX/Y.scaleX,t.stageY/Y.scaleY))):"corner"==n?(e.scaleX==lt.scaleX&&e.scaleY==lt.scaleY||((Ke=new createjs.Event("transformed")).transformType="size"),o&&(r=ae.hitTestPoint(t.stageX/Y.scaleX,t.stageY/Y.scaleY))):"side"==n?(e.scaleX==lt.scaleX&&e.scaleY==lt.scaleY||((Ke=new createjs.Event("transformed")).transformType="stretch"),o&&(r=se.hitTestPoint(t.stageX/Y.scaleX,t.stageY/Y.scaleY)||le.hitTestPoint(t.stageX/Y.scaleX,t.stageY/Y.scaleY))):"rotate"==n?(e.rotation!=lt.rotation&&((Ke=new createjs.Event("transformed")).transformType="rotate"),o&&(r=ce.hitTestPoint(t.stageX/Y.scaleX,t.stageY/Y.scaleY))):"reg"==n?e.regX==lt.regX&&e.regY==lt.regY||((Ke=new createjs.Event("transformed")).transformType="reg"):(Ke=new createjs.Event("transformed")).transformType="reset"==n?"reset":"unknown",o&&!r&&(Je.removeFrom(Y),frame.canvas.style.cursor="default",e.cursor=Ze),Ke&&(Ke.pressup=i,e.dispatchEvent(Ke))}function it(t){Ue||(Je.stage?Y.setChildIndex(Je,Y.getChildIndex(ee)):Je.addTo(Y,Y.getChildIndex(ee)+1),$e.addTo(Y,1),Je.x=t.stageX/Y.scaleX,Je.y=t.stageY/Y.scaleY,$e.x=t.stageX/Y.scaleX,$e.y=t.stageY/Y.scaleY,e.getConcatenatedMatrix().decompose(L),L.rotation||(L.rotation=0),he.rotation=L.rotation*a.sign(ne*ie)*a.sign(e.scaleX*e.scaleY)+pe[t.target.cu]+ge,"side"!=t.target.controlType&&ne*ie<0&&(he.rotation+=90),Y.update(),Ge&&Y.off("stagemousemove",Ge),Ge=Y.on("stagemousemove",function(e){Je.x=e.stageX/Y.scaleX,Je.y=e.stageY/Y.scaleY,Y.update()}))}function ot(t){Y.off("stagemousemove",Ge),Ue||(e.cursor=Ze,Je.removeFrom(Y),$e.removeFrom(Y),Y.update())}function rt(){if(p){var t=Z.numChildren-1;"Keyboard"==Z.getChildAt(t).type&&t--,Z.setChildIndex(e,t),at()}}function at(){if(Z==Y)ee.removeFrom(),Y.addChildAt(ee,Y.getChildIndex(e)+1);else{for(var t=Z;t.parent&&t.parent!=Y;)t=t.parent;e.stage&&(ee.parent==Y&&Y.removeChild(ee),Y.addChildAt(ee,Y.getChildIndex(t)+1))}}ae.on("mousedown",Qe),ae.on("pressmove",et),ae.on("pressup",tt),se.on("mousedown",Qe),se.on("pressmove",et),se.on("pressup",tt),le.on("mousedown",Qe),le.on("pressmove",et),le.on("pressup",tt),ce.on("mousedown",Qe),ce.on("pressmove",function(t){var n=180*Math.atan2(t.stageY/Y.scaleY-Ve,t.stageX/Y.scaleX-Fe)/Math.PI;frame.shiftKey?e.rot(45*Math.round((_e+(n-De)*a.sign(ne)*a.sign(e.scaleX))/45)):e.rot(_e+(n-De)*a.sign(ne)*a.sign(e.scaleX)),Ae(),Je.x=t.stageX/Y.scaleX,Je.y=t.stageY/Y.scaleY,T&&(e.getConcatenatedMatrix().decompose(L),L.rotation||(L.rotation=0),he.rotation=L.rotation*a.sign(ne*ie)*a.sign(e.scaleX*e.scaleY)+pe[t.target.cu]+ge,"side"!=t.target.controlType&&ne*ie<0&&(he.rotation+=90),$e.x=t.stageX/Y.scaleX,$e.y=t.stageY/Y.scaleY),Ae(),e.transformControls.events&&nt(t,t.target.controlType,null,!1)}),ce.on("pressup",tt),F.drag(),F.on("mousedown",rt),F.on("pressup",function(t){if(!frame.ctrlKey){for(var n=0;n<U.length;n++)if(a.dist(F.x,F.y,U[n].x,U[n].y)<A){F.x=U[n].x,F.y=U[n].y;break}a.dist(F.x,F.y,pMid.x,pMid.y)<A&&(F.x=pMid.x,F.y=pMid.y)}var i=e.rotation,o=e.globalToLocal(F.x,F.y);if(Z==Y)var r=new a.Point(F.x,F.y);else r=Z.globalToLocal(F.x,F.y);e.reg(o.x,o.y),e.rotation=0,e.x=e.x+r.x-e.x,e.y=e.y+r.y-e.y,e.rotation=i,Ae(),Ie(),tt(t),Y.update()});var st=!0;Se.drag({overCursor:q=T?"none":"move",dragCursor:q,onTop:!1}),Se.controlType="move",T&&(Se.on("mouseover",function(e){!Ue&&T&&st&&(ue.addTo(ee).pos({x:e.stageX/Y.scaleX,y:e.stageY/Y.scaleY,reg:!0}),Y.update(),He&&Y.off("stagemousemove",He),He=Y.on("stagemousemove",function(e){ue.x=e.stageX/Y.scaleX,ue.y=e.stageY/Y.scaleY,Y.update()}))}),Se.on("mouseout",function(){Y.off("stagemousemove",He),Ue||(ue.removeFrom(ee),Y.update())})),Se.on("mousedown",rt),Se.on("pressmove",function(t){if(e.transformControls.visible){if(Z==Y)var n=new a.Point(Se.x,Se.y);else n=Z.globalToLocal(Se.x,Se.y);e.x=n.x,e.y=n.y,Ae(),e.transformControls.events&&nt(t,"move")}}),Se.on("pressup",function(t){e.transformControls.visible&&tt(t)});var lt,ct=Y.on("stagemouseup",function(){Ue=!1,Se.mouseEnabled=!0,st||((Ke=new createjs.Event("transformed")).transformType=e.x!=lt.x||e.y!=lt.y?"move":"select",Ke.pressup=!0,e.dispatchEvent(Ke)),st=!0,Se.visible=!0,qe&&!frame.ctrlKey&&1<S&&(e.rotation=Math.round(e.rotation/S)*S,Ae()),Ie(),Se.mouseEnabled=!0,qe=!1,Y.update()});function ut(){lt={x:e.x,y:e.y,rotation:e.rotation,regX:e.regX,regY:e.regY,scaleX:e.scaleX,scaleY:e.scaleY}}ut();var ht,dt=e.on("mousedown",ut);ee.on("mousedown",ut),ee.addChild(X),o&&ee.addChild(Se),l&&ee.addChild(ae),r&&ee.addChild(se),s&&ee.addChild(le),u&&ee.addChild(ce),ee.addChild(F),o&&(e.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),ht=e.on("pressmove",function(){Ae(),Ie(),Oe()}));var pt=h;return e.transformControls={visible:d,events:E,ghost:!c(M),ghostEnabled:!c(M),show:function(){return p&&rt(),at(),e.toggled=!0,e.transformControls.visible=!0,W.parent&&W.removeFrom(),Y.update(),e},hide:function(){if(e.transformControls.ghost)var t=Y.getChildIndex(ee);return Y.removeChild(ee),e.transformControls.ghost&&e.transformControls.ghostEnabled&&Y.addChildAt(W,t),e.toggled=!1,e.transformControls.visible=!1,T&&(Ge&&Y.off("stagemousemove",Ge),He&&Y.off("stagemousemove",He),Ue=!1,Je.removeFrom(Y),$e.removeFrom(Y)),o||(e.cursor=Ze),Y.update(),e},remove:function(t){t||e.transformControls.hide(),toggle=!1,o&&(e.noDrag(),e.off("pressmove",ht))},add:function(t){t||e.transformControls.show(),toggle=pt,o&&(e.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),ht=e.on("pressmove",ht))},allowToggleOn:function(){toggle=pt=!0,Ee=ee.on("mousedown",Ee),Me=e.on("mousedown",Me),Ne=Y.on("stagemousedown",Ne)},allowToggleOff:function(){toggle=pt=!1,ee.off("mousedown",Ee),e.off("mousedown",Me),Y.off("stagemousedown",Ne)},disable:function(){ee.mouseChildren=!1,ee.mouseEnabled=!1,o&&(e.noDrag(),e.off("pressmove",ht))},enable:function(){ee.mouseChildren=!0,ee.mouseEnabled=!0,o&&(e.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),ht=e.on("pressmove",ht))},recordData:function(t){var n={type:e.type,index:Z.getChildIndex(e),x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY,rotation:e.rotation,skewX:e.skewX,skewY:e.skewY,regX:e.regX,regY:e.regY,controls:e.transformControls.visible};return t?JSON.stringify(n):n},setData:function(t,n){if(!c(t)){n&&(t=JSON.parse(t)),delete t.controls;var i=t.index;for(var o in c(i)&&(i=0),delete t.index,t)e[o]=t[o];return timeout(90,function(){Ae(),Ie(),Oe(),Z.setChildIndex(e,i),e.transformControls.visible&&"Layer"!=e.type?e.transformControls.show():e.transformControls.hide(),!e.transformControls.ghost||e.transformControls.ghostEnabled||e.transformControls.visible||Y.addChild(W)}),e}},hideGhost:function(){e.transformControls.ghost=!1,W.removeFrom()},showGhost:function(){if(e.transformControls.ghost=!0,e.transformControls.ghostEnabled&&!e.transformControls.visible){for(var t=Z;t.parent&&t.parent!=Y;)t=t.parent;W.stage?Y.setChildIndex(W,Y.getChildIndex(t)+1):Y.addChildAt(W,Y.getChildIndex(t)+1)}},addGhost:function(){0<B?(e.transformControls.ghostEnabled=!0,e.transformControls.showGhost()):n&&i("ZIM transform() - ghostWidth must be > 0 when making transform")},removeGhost:function(){e.transformControls.ghostEnabled=!1,e.transformControls.hideGhost()},resize:function(t){if(Z=e.parent,Ae(),Ie(),Oe(),d&&e.transformControls.show(),t){var n=new createjs.Event("transformed");n.pressup=!0,n.transformType="resize",e.dispatchEvent(n)}return e},dispose:function(){e.transformControls.hide(),toggle=!1,o&&(e.noDrag(),e.off("pressmove",ht)),ee.removeAllEventListeners(),Me&&e.off("mousedown",Me),Ee&&e.off("mousedown",Ee),Ne&&Y.off("stagemousedown",Ne),Ge&&Y.off("stagemousemove",Ge),He&&Y.off("stagemousemove",He),ct&&Y.off("stagemouseup",ct),dt&&e.off("mousedown",dt),ht&&e.off("pressmove",ht),ee=Je=$e=null,e.transformControls=null},controls:ee,scaleControls:ae,stretchXControls:se,stretchYControls:le,rotateControls:ce},e.toggle=function(t){return!0===t?e.transformControls.show():!1===t?e.transformControls.hide():e.transformControls.visible?e.transformControls.hide():e.transformControls.show(),e},e.transformControls.ghost&&(e.transformControls.toggleGhost=function(t){return!0===t?e.transformControls.showGhost():!1===t?e.transformControls.hideGhost():e.transformControls.visible?e.transformControls.hideGhost():e.transformControls.showGhost(),e}),d?e.transformControls.show():!j&&e.transformControls.ghost&&e.transformControls.showGhost(),e},a.gesture=function(e,t,o,r,s,l,u,h,d,p,f,g,y,b,v,w){var x;if(x=m(a.gesture,arguments,"obj, move, scale, rotate, boundary, minScale, maxScale, snapRotate, localBounds, slide, slideEffect, regControl, onTop, surround, circularBounds, rect"))return x;if(C("34.5"),!c(e)&&e.on){var k,T;if(c(t)&&(t=!0),c(o)&&(o=!0),c(r)&&(r=!0),c(d)&&(d=!1),c(h)&&(h=1),c(p)&&(p=!1),c(f)&&(f=5),c(g)&&(g=!1),c(y)&&(y=!0),c(b)&&(b=!1),b&&r&&(b=w=null,n&&i("ZIM Gesture() - does not support surround when rotate is true")),c(v)&&(v=!1),c(s)&&!c(w)&&(s=w),c(e.zimMaskDynamic)||e.zimMaskApply(),!e.zimTouch){var P,O,A,S,I,E,M,B,z=new a.Damp(e.scaleX,.05),j=new a.Damp(e.scaleY,.05),_=e.scaleX/e.scaleY;if(e.zimTouch={move:t,scale:o,rotate:r,pointers:{},checkBounds:function(t,n){if(e.zimTouch.boundary){var i=e.zimTouch.boundary,o=e.parent.localToLocal(t,n,e.parent);n=b?(t=Math.min(i.x,Math.max(i.x+i.width,o.x)),Math.min(i.y,Math.max(i.y+i.height,o.y))):(t=Math.max(i.x,Math.min(i.x+i.width,o.x)),Math.max(i.y,Math.min(i.y+i.height,o.y))),t=(o=e.parent.globalToLocal(t,n)).x,n=o.y}return{x:t,y:n}}},s){e.zimTouch.boundary=s,d&&(e.zimTouch.boundary=a.boundsToGlobal(e.parent,s)),e.zimTouch.boundaryStartX=e.zimTouch.boundary.x,e.zimTouch.boundaryStartY=e.zimTouch.boundary.y,e.zimTouch.boundaryStartW=e.zimTouch.boundary.width,e.zimTouch.boundaryStartH=e.zimTouch.boundary.height;var D=e.zimTouch.checkBounds(e.x,e.y);e.x=D.x,e.y=D.y}function L(){e.zimTouch.pair=[],a.loop(e.zimTouch.pointers,function(t,n,i){n.startX=n.x,n.startY=n.y,i<=1&&e.zimTouch.pair.push(n)}),e.zimTouch.startX=e.x,e.zimTouch.startY=e.y,e.zimTouch.startSX=e.scaleX,e.zimTouch.startSY=e.scaleY,e.zimTouch.startR=e.rotation}function Y(){var t=e.localToGlobal(e.regX,e.regY);if(v)var n=e.parent.localToGlobal(e.x-e.width/2,e.y-e.height/2),i=e.parent.localToGlobal(e.x+e.width/2,e.y+e.height/2),o={x:n.x,y:n.y,width:i.x-n.x,height:i.y-n.y};else o=e.boundsToGlobal();e.gestureBoundary({x:e.zimTouch.boundaryStartX+t.x-o.x,y:e.zimTouch.boundaryStartY+t.y-o.y,width:e.zimTouch.boundaryStartW-o.width,height:e.zimTouch.boundaryStartH-o.height},!1)}p&&(slideSlice=10,slideTotal=5,T=0,k=[],e.zimTouch.slideInterval=a.interval(slideSlice,function(){k[T++%slideTotal]=[e.x,e.y]}),e.zimTouch.slideInterval.pause(),e.animate({x:e.x,y:e.y},10,"quadOut")),e.zimTouch.mousedown=e.on("mousedown",function(t){c(B)?B=1:B++;var n=e.stage;if(y){var i=e.parent.numChildren-1;"Keyboard"==e.parent.getChildAt(i).type&&i--,e.parent.setChildIndex(e,i),e.ZIMoutlineShape&&e.outline()}g||(M=null,O=e.scaleX,A=e.scaleY,S=e.rotation,I=e.regX,E=e.regY,e.reg(0,0),P=e.getMatrix(),e.regX=I,e.regY=E);var o="id"+Math.abs(t.pointerID+1),r=e.parent.globalToLocal(t.stageX/n.scaleX,t.stageY/n.scaleY);e.zimTouch.pointers[o]={startX:r.x,startY:r.y,x:r.x,y:r.y},(e.zimTouch.move||e.zimTouch.rotate)&&(e.zimTouch.total=0,a.loop(e.zimTouch.pointers,function(t){e.zimTouch.total++})),p&&1==e.zimTouch.total&&e.zimTouch.slideInterval.pause(!1),L()}),e.zimTouch.pressmove=e.on("pressmove",function(t){var n=e.stage,i="id"+Math.abs(t.pointerID+1),o=e.parent.globalToLocal(t.stageX/n.scaleX,t.stageY/n.scaleY);e.zimTouch.pointers[i]&&(e.zimTouch.pointers[i].x=o.x,e.zimTouch.pointers[i].y=o.y);var r,s,h=0,d=0,p=0,f=0;a.loop(e.zimTouch.pointers,function(e,t){h+=t.x-t.startX,d+=t.y-t.startY,p+=t.x,f+=t.y}),h=e.zimTouch.startX+(r=h/e.zimTouch.total),d=e.zimTouch.startY+(s=d/e.zimTouch.total),p/=e.zimTouch.total,f/=e.zimTouch.total;var m={x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY,rotation:e.rotation};if(e.zimTouch.move){var y=e.zimTouch.checkBounds(h,d);m.x=y.x,m.y=y.y}if(2==e.zimTouch.pair.length){var b=e.zimTouch.pair[0],v=e.zimTouch.pair[1];if(e.zimTouch.scale){var w=Math.sqrt(Math.pow(v.startX-b.startX,2)+Math.pow(v.startY-b.startY,2)),x=Math.sqrt(Math.pow(v.x-b.x,2)+Math.pow(v.y-b.y,2)),C=e.zimTouch.startSX+(x/w-1),k=e.zimTouch.startSY+(x/w-1);m.scaleX=C,m.scaleY=k,m.scaleX=z.convert(C),m.scaleY=j.convert(k);var T=!c(l)&&Math.min(C,k)<l,B=!c(u)&&Math.max(C,k)>u;(T||B)&&(T?1<_?(m.scaleY=l,m.scaleX=l*_):(m.scaleX=l,m.scaleY=l/_):B&&(1<_?(m.scaleX=u,m.scaleY=u/_):(m.scaleY=u,m.scaleX=u*_)),z.immediate(m.scaleX),j.immediate(m.scaleY))}if(e.zimTouch.rotate){var D=Math.atan2(b.startY-v.startY,b.startX-v.startX)*(180/Math.PI),L=Math.atan2(b.y-v.y,b.x-v.x)*(180/Math.PI)-D;m.rotation=e.zimTouch.startR+L}if(g)e.scaleX=m.scaleX,e.scaleY=m.scaleY,e.rotation=m.rotation,e.zimTouch.move&&(e.x=m.x,e.y=m.y);else{e.reg(0,0);var Y=e.parent.localToGlobal(p,f);p=Y.x,f=Y.y;var R=c(M)?e.globalToLocal(p,f):e.globalToLocal(M.x,M.y);P.clone().translate(R.x,R.y).rotate(m.rotation-S).scale(m.scaleX/O,m.scaleY/A).translate(-R.x,-R.y).decompose(e),e.zimTouch.move&&(e.x+=r,e.y+=s),M=e.localToGlobal(R.x,R.y),e.reg(I,E)}e.zimTouch.scale&&e.dispatchEvent("scale"),e.zimTouch.rotate&&e.dispatchEvent("rotate"),e.zimTouch.move&&e.dispatchEvent("move")}else e.x=m.x,e.y=m.y,e.zimTouch.move&&e.dispatchEvent("move");"Tag"!=e.type&&"TextArea"!=e.type&&"Loader"!=e.type||e.resize(),e.ZIMoutlineShape&&e.outline(),e.getStage&&e.stage&&e.stage.update()}),e.on("mousedown",function(){var t=1;e.stage.on("stagemousedown",function(){t++}),e.stage.on("stagemouseup",function(){0==--t&&setTimeout(function(){e.zimTouch&&(e.zimTouch.total=0),e.zimTouch&&(e.zimTouch.pointers={}),B=null},50)})},null,!0),e.zimTouch.pressup=e.on("pressup",function(t){var n="id"+Math.abs(t.pointerID+1);if(delete e.zimTouch.pointers[n],(e.zimTouch.move||e.zimTouch.rotate)&&e.zimTouch.total--,r&&!c(h)&&0==e.zimTouch.total&&(0<h?e.rotation=Math.round(e.rotation/h)*h:0==h&&(e.rotation=Math.round(e.rotation))),p&&0==e.zimTouch.total&&1==B){e.zimTouch.slideInterval.pause();var i=k[(T+1)%k.length],o=k[T%k.length],a=e.x+(i[0]-o[0])*f,s=e.y+(i[1]-o[1])*f,l=e.zimTouch.checkBounds(a,s),u=slideTotal*slideSlice*f*Math.min((e.x-l.x)/(e.x-a)||1,(e.y-l.y)/(e.y-s)||1);e.animate({x:l.x,y:l.y},u,"quadOut",function(){e.dispatchEvent("slidestop")})}0==e.zimTouch.total&&(B=null),e.getStage&&e.stage&&e.stage.update(),L()}),s&&(Y(),e.on("move",Y))}return e}},a.noGesture=function(e,t,n,i){var o;return(o=m(a.noGesture,arguments,"obj, move, scale, rotate"))?o:(C("34.6"),!c(e)&&e.on&&e.zimTouch?(c(t)&&(t=!0),c(n)&&(n=!0),c(i)&&(i=!0),e.zimTouch.move=!t,e.zimTouch.scale=!n,e.zimTouch.rotate=!i,e.zimTouch.move||e.zimTouch.scale||e.zimTouch.rotate||(e.off("mousedown",e.zimTouch.mousedown),e.off("pressmove",e.zimTouch.pressmove),e.off("pressup",e.zimTouch.pressup),delete e.zimTouch),e):void 0)},a.gestureBoundary=function(e,t,n){if(C("34.7"),!c(e)&&e.on&&!c(t)&&e.zimTouch){e.zimTouch.boundary=e.zimTouch.localBounds&&e.parent?a.boundsToGlobal(e.parent,t):t,c(n)&&(n=!0),n&&(e.zimTouch.boundaryStartX=t.x,e.zimTouch.boundaryStartY=t.y,e.zimTouch.boundaryStartW=t.width,e.zimTouch.boundaryStartH=t.height);var i=e.zimTouch.checkBounds(e.x,e.y);return e.x=i.x,e.y=i.y,e}},a.addPhysics=function(e,t,o,r,s,l,u,h,d,p,f,g){var y;if(y=m(a.addPhysics,arguments,"obj, dynamic, contract, shape, friction, linear, angular, density, restitution, maskBits, categoryBits, physics"))return y;if(C("34.8"),c(g)){if("undefined"==typeof zimPhysics)return n&&i("ZIM Physics module must be imported"),e;c(zimDefaultPhysics)&&(zimDefaultPhysics=new a.Physics),g=zimDefaultPhysics}e.physics=g;var b="rectangle";return"Circle"==e.type||"Dial"==e.type?b="circle":"Triangle"==e.type&&(b="triangle"),c(r)&&(r=b),function(e,t,n,o,r,s,l,u,h,d,p){function f(){zimContactListener=new b2ContactListener,S=new a.Dictionary(!0),I=new a.Dictionary(!0),zimContactListener.BeginContact=function(e){var t=S.at(e.m_fixtureB.GetBody());t?t(e.m_fixtureA.GetBody().zimObj,e.m_fixtureA.GetBody()):(t=S.at(e.m_fixtureA.GetBody()))&&t(e.m_fixtureB.GetBody().zimObj,e.m_fixtureB.GetBody())},zimContactListener.EndContact=function(e){var t=I.at(e.m_fixtureB.GetBody());t?t(e.m_fixtureA.GetBody().zimObj,e.m_fixtureA.GetBody()):(t=I.at(e.m_fixtureB.GetBody().zimObj,e.m_fixtureB.GetBody()))&&t(e.m_fixtureB.GetBody())},e.physics.world.SetContactListener(zimContactListener)}C("69.97"),c(n)&&(n=0),"rectangle"==o?e.body=e.physics.makeRectangle(e.width-n,e.height-n,t,r,l,u,h,d,p,s):"circle"==o?e.body=e.physics.makeCircle(e.width/2-n,t,r,l,u,h,d,p,s):"triangle"==o&&(c(e.a)&&(e.a=e.width,e.b=e.c=Math.sqrt(Math.pow(e.a/2,2)+Math.pow(e.height,2))),e.body=e.physics.makeTriangle(e.a-n,e.b-n,e.c-n,t,r,l,u,h,d,p,s)),e.body.x=e.x,e.body.y=e.y,e.body.rotation=e.rotation,e.physics.addMap(e.body,e),e.impulse=function(t,n,i,o){c(t)&&(t=0),c(n)&&(n=0);var r=e.body.GetWorldCenter();return c(i)&&(i=r.x*e.physics.scale),c(o)&&(o=r.y*e.physics.scale),e.body.ApplyImpulse(new b2Vec2(t,n),new b2Vec2(i/e.physics.scale,o/e.physics.scale)),e},e.force=function(t,n,i,o){c(t)&&(t=0),c(n)&&(n=0);var r=e.body.GetWorldCenter();return c(i)&&(i=r.x*e.physics.scale),c(o)&&(o=r.y*e.physics.scale),e.body.ApplyForce(new b2Vec2(t,n),new b2Vec2(i/e.physics.scale,o/e.physics.scale)),e},e.spin=function(t){return c(t)&&(t=10),e.body.ApplyTorque(1e3*t),e},e.torque=function(t){return c(t)&&(t=10),e.body.ApplyTorque(t),e},e.follow=function(t,n,i,o,r,a,s,l,c,u,h,d){var p;return(p=m(e.follow,arguments,"damp, dampY, leftOffset, rightOffset, upOffset, downOffset, offsetDamp, offsetDampY, horizontal, vertical, borderLock, borderOriginal"))?p:(e.physics.follow(e,t,n,i,o,r,a,s,l,c,u,h,d),e)},e.noFollow=function(){return e.physics.follow(null),e},e.control=function(t,n,i,o,r){var a;return(a=m(e.control,arguments,"type, speed, speedY, horizontal, vertical"))?a:(e.physics.control(e,t,n,i,o,r),e)},e.noControl=function(){return e.physics.noControl(e),e},e.sleep=function(){return i(e.body),e.body.SetAwake(!1),e},e.wake=function(){return e.body.SetAwake(!0),e},e.contact=function(t){return zimContactListener||f(),S.add(e.body,t),e},e.noContact=function(){return S.remove(e.body),e},e.contactEnd=function(t){return zimContactListener||f(),I.add(e.body,t),e},e.noContactEnd=function(){return I.remove(e.body),e},Object.defineProperty(e,"dynamic",{get:function(){return 2==e.body.GetType()},set:function(t){e.body.SetType(1==t?2:0)}})}(e,t,o,r,s,l,u,h,d,p,f),e},a.removePhysics=function(e){return C("34.85"),c(e.physics)||(e==e.physics.followObj&&e.physics.follow(null),e.physics.remove(e.body),e.follow=e.noFollow=e.control=e.noControl=e.sleep=e.wake=null,e.physics=e.impulse=e.force=e.spin=e.torque=null),e},a.hitTestPoint=function(e,t,n,i){if(C("35"),!e.stage||c(t)||c(n))return!1;var o=e.stage;if(!c(e)&&e.globalToLocal){if(c(i)&&(i=!0),i){var r=e.getBounds();if(r){var a=e.globalToLocal(t,n);if(a.x>r.x+r.width||a.x<r.x)return!1;if(a.y>r.y+r.height||a.y<r.y)return!1}}var s={x:t,y:n};return s=e.image||e.spriteSheet?e.globalToLocal(s.x,s.y):e.globalToLocal(s.x*o.scaleX,s.y*o.scaleY),e.hitTest(s.x,s.y)}},a.hitTestReg=function(e,t,n){if(C("36"),!e.stage||!t.stage)return!1;var i=e.stage;if(!c(e)&&!c(t)&&e.localToLocal&&t.localToLocal){c(n)&&(n=!0);var o=t.localToGlobal(t.regX,t.regY),r=e.getBounds();if(n&&r){var a=e.globalToLocal(o.x,o.y);if(a.x>r.x+r.width||a.x<r.x)return!1;if(a.y>r.y+r.height||a.y<r.y)return!1}return o=e.image||e.spriteSheet?e.globalToLocal(o.x,o.y):e.globalToLocal(o.x*i.scaleX,o.y*i.scaleY),e.hitTest(o.x,o.y)}},a.hitTestRect=function(e,t,n,o){if(C("37"),!e.stage||!t.stage)return!1;var r=e.stage;if(!c(e)&&!c(t)&&e.hitTest&&t.getBounds){c(n)&&(n=0),c(o)&&(o=!0);var s=t.getBounds();if(s){if(o&&e.getBounds()&&!a.hitTestBounds(e,t))return!1;var l,u;if(d(t.localToGlobal(s.x+s.width/2,s.y+s.height/2)))return!0;for(var h=0;h<=n;h++){if(u=s.height*(h+1)/(n+1),d(t.localToGlobal(s.x+(l=s.width*(h+1)/(n+1)),s.y)))return!0;if(d(t.localToGlobal(s.x+s.width,s.y+u)))return!0;if(d(t.localToGlobal(s.x+s.width-l,s.y+s.height)))return!0;if(d(t.localToGlobal(s.x,s.y+s.height-u)))return!0}}else i("zim methods - hitTestRect():\n please setBounds() on param b object")}function d(t){if(t=e.image||e.spriteSheet?e.globalToLocal(t.x,t.y):e.globalToLocal(t.x*r.scaleX,t.y*r.scaleY),e.hitTest(t.x,t.y))return!0}},a.hitTestCircle=function(e,t,n,o){if(C("38"),e.stage&&t.stage&&(stage=e.stage,!c(e)&&!c(t)&&e.hitTest&&t.getBounds)){c(n)&&(n=8),c(o)&&(o=!0);var r=t.getBounds();if(r){var s=e.getBounds();if(o&&s&&!a.hitTestBounds(e,t))return!1;var l=r.x+r.width/2,u=r.y+r.height/2,h=t.localToGlobal(l,u);if(y(h))return!0;for(var d,p,f,g=(r.width+r.height)/2/2,m=0;m<n;m++)if(d=m/n*2*Math.PI,p=l+g*Math.cos(d),f=u+g*Math.sin(d),y(h=t.localToGlobal(p,f)))return!0}else i("zim methods - hitTestCircle():\n please setBounds() on param b object")}function y(t){if(t=e.image||e.spriteSheet?e.globalToLocal(t.x,t.y):e.globalToLocal(t.x*stage.scaleX,t.y*stage.scaleY),e.hitTest(t.x,t.y))return!0}},a.hitTestCircles=function(e,t,n){if(C("38.5"),e.stage&&t.stage){var o=e.stage;if(!c(e)&&!c(t)&&e.hitTest&&e.getBounds&&t.getBounds){var r=e.getBounds(),a=t.getBounds();if(r&&a){c(n)&&(n=0);var s=e.localToGlobal(r.x+r.width/2,r.y+r.height/2),l=t.localToGlobal(a.x+a.width/2,a.y+a.height/2),u=e.getConcatenatedMatrix(),h=t.getConcatenatedMatrix();scale1X=Math.sqrt(u.a/o.scaleX*u.a/o.scaleX+u.c/o.scaleX*u.c/o.scaleX),scale1Y=Math.sqrt(u.b/o.scaleY*u.b/o.scaleY+u.d/o.scaleY*u.d/o.scaleY),scale2X=Math.sqrt(h.a/o.scaleX*h.a/o.scaleX+h.c/o.scaleX*h.c/o.scaleX),scale2Y=Math.sqrt(h.b/o.scaleY*h.b/o.scaleY+h.d/o.scaleY*h.d/o.scaleY);var d=Math.sqrt(Math.abs(Math.pow(s.x-l.x,2)+Math.pow(s.y-l.y,2)));return r.width*Math.max(scale1X,scale1Y)/2+a.width*Math.max(scale2X,scale2Y)/2>=d-n}i("zim methods - hitTestCircles():\n please setBounds() on both objects")}}},a.hitTestBounds=function(e,t,n,o){if(C("39"),e.stage&&t.stage&&!c(e)&&!c(t)&&e.getBounds&&t.getBounds){var r=!1;o&&o.graphics&&(r=!0);var s=e.getBounds(),l=t.getBounds();if(s&&l){c(n)&&(n=0);var u=a.boundsToGlobal(e),h=a.boundsToGlobal(t);if(r){var d=o.graphics;d.c(),d.ss(1).s("blue"),d.r(u.x,u.y,u.width,u.height),d.s("green"),d.r(h.x,h.y,h.width,h.height),o.stage.update()}return a.rectIntersect(u,h,n)}i("zim methods - hitTestBounds():\n please setBounds() on both objects")}},a.hitTestPath=function(e,t,n,i){if(C("37.5"),e.stage&&t.stage&&(stage=e.stage,!c(e)&&!c(t)&&e.hitTest&&("Squiggle"==t.type||"Blob"==t.type))){var o=e.getBounds();c(n)&&(n=2),c(i)&&(i=!1);var r=t.interpolate(n,null,!0);if(i){t.hitPathPoints?t.hitPathPoints.removeAllChildren():t.hitPathPoints=(new Container).addTo(stage),t.hitPathPoints.top();for(var s=0;s<r.length;s++){var l=r[s];l=t.localToGlobal(l.x,l.y),new a.Circle(3).loc(l.x,l.y,t.hitPathPoints)}}if(o){var u=a.boundsAroundPoints(r);if(!a.rectIntersect(e.boundsToGlobal(o),t.boundsToGlobal(u)))return}for(s=0;s<r.length;s++)if(h(l=t.localToGlobal((l=r[s]).x,l.y)))return!0;return!1}function h(t){if(t=e.image||e.spriteSheet?e.globalToLocal(t.x,t.y):e.globalToLocal(t.x*stage.scaleX,t.y*stage.scaleY),e.hitTest(t.x,t.y))return!0}},a.hitTestGrid=function(e,t,n,i,o,r,a,s,l,u,h,d,p){if(C("41"),!e.stage)return!1;if(!c(e)&&!d){var f=e.globalToLocal(r,a);r=f.x,a=f.y}c(s)&&(s=0),c(l)&&(l=0),c(u)&&(u=0),c(h)&&(h=0);var g=(t+=u)/i,m=(n+=h)/o,y=Math.min(i-1,Math.max(0,Math.floor((r-s)/g))),b=Math.min(o-1,Math.max(0,Math.floor((a-l)/m)));if(!(g*(y+1)-u<r-s||r-s<g*y||m*(b+1)-h<a-l||a-l<m*b)){var v=b*i+y;return c(p)||"index"==p?v:"col"==p?y:"row"==p?b:"array"==p?[v,y,b]:void 0}},a.animate=function(e,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,P,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,X,W,F,V,N,G,H,K,q,U,Z){var J;if(J=m(a.animate,arguments,"target, props, time, ease, call, params, wait, waitedCall, waitedParams, loop, loopCount, loopWait, loopCall, loopParams, loopWaitCall, loopWaitParams, rewind, rewindWait, rewindCall, rewindParams, rewindWaitCall, rewindWaitParams, sequence, sequenceCall, sequenceParams, sequenceReverse, ticker, cjsProps, css, protect, override, from, set, id, events, sequenceTarget, dynamic, drag, clamp, startPaused, clean, obj, seriesWait, sequenceWait"))return J;if(C("45"),0==a.ANIMATE||!window.zns&&!ANIMATE)return e;var $=Array.prototype.slice.call(arguments);if(c(o)&&!c(q)&&(o=q),c(q=o))return n&&i("animate() - need props"),e;r=a.Pick.choose(r),s=a.Pick.choose(s),h=a.Pick.choose(h),g=a.Pick.choose(g),y=a.Pick.choose(y),k=a.Pick.choose(k),T=a.Pick.choose(T),B=a.Pick.choose(B),Y=a.Pick.choose(Y),R=a.Pick.choose(R);var Q={override:!c(e)&&!c(e.zimX)&&!c(q.x)||!c(e)&&!c(e.zimY)&&!c(q.y)};function ee(e,t,n){if("."==t.substr(0,1)){for(var i=t.split("."),o=e,r=1;r<i.length-1;r++)o=o[i[r]];o[i[i.length-1]]=n}else e[t]=n}if(c(f)||(Q.loop=f),c(g)||(Q.count=g),c(y)||(Q.loopWait=y),c(b)||(Q.loopCall=b),c(x)||(Q.loopWaitParams=x),c(w)||(Q.loopWaitCall=w),c(v)||(Q.loopParams=v),c(k)||(Q.rewind=k),c(T)||(Q.rewindWait=T),c(P)||(Q.rewindCall=P),c(O)||(Q.rewindParams=O),c(A)||(Q.rewindWaitCall=A),c(S)||(Q.rewindWaitParams=S),c(o)||(Q=a.merge(Q,j)),j=Q,a.loop(q,function(e,t){if("string"==typeof e){var n=e.split(".");if(1<n.length&&"."!=e.substr(0,1)&&(q["."+e]=t,delete q[e],e="."+e),1<n.length&&"string"==typeof t){var i=t.substr(0,1);"+"!=i&&"-"!=i&&(q[e]="+"+t)}}}),c(I)&&(I=0),0<I&&e.addChild){for(var te=[],ne=0;ne<e.numChildren;ne++)te.push(e.getChildAt(ne));F=e,e=te}if(e instanceof Array){for(B&&e.reverse(),ne=0;ne<e.length;ne++){var ie,oe=e[ne];if(Y)for(var re in oe.zimObj={},q)ie=a.Pick.choose(q[re]),oe.zimObj[re]=oe[re],oe[re]=ie;else for(var re in oe.zimObj={},q)oe.zimObj[re]=a.Pick.choose(q[re]);var ae=ne*I;0==ne&&(ae=20),a.animate(oe,oe.zimObj,r,s,l,u,h,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,z,a.copy(j),_,D,L,null,R,X,W,F,V,N,G,H,K,q,U,ae)}return F}var se,le,ce,ue=r;if(c(ue)&&(ue=1e3),c(s)&&(s="quadInOut"),c(h)&&(h=0),c(j)&&(j={override:!c(e.zimX)&&!c(q.x)||!c(e.zimY)&&!c(q.y)}),c(u)&&(u=e),c(z)&&(z=!0),c(_)&&(_=!1),c(D)&&(D=!1),c(Y)&&(Y=!1),c(R)&&(R={}),R.scale&&(R.scaleX=R.scaleY=R.scale,delete R.scale),c(L)||(j.override=L),c(N)&&(N=!1),c(H)&&(H=!!N),c(V)&&(V=!1),c(G)&&(G=!0),c(K)&&(K=!0),q instanceof Array){var he,de,pe=1;if(0==q.length)return this;function fe(){var t;e.zimLastObj&&a.loop(e.zimLastObj,function(t){c(e.zimTweenOriginals[t])||(e[t]=e.zimTweenOriginals[t],e.zimLastObj[t]=e.zimTweenOriginals[t])});for(var n,i=h,o=0,r=0;r<q.length;r++)if(!c((t=q[r]).target)){c(t.time)&&(t.time=ue),i+=t.wait?t.wait:0,n=t.time,t.rewind&&(n=2*n+(t.rewindWait?t.rewindWait:0)),t.loop&&(n*=t.loopCount,n+=(t.loopCount-1)*(t.loopWait?t.loopWait:0)),c(t.params)&&(t.params=t.target),de=t.target;var s={target:t.target,obj:a.copy(t.obj),seriesWait:o,wait:i,waitedCall:t.waitedCall,waitedParams:t.waitedParams,time:t.time,ease:t.ease,from:t.from,rewind:t.rewind,call:t.call,params:t.params,loop:t.loop,loopCount:t.loopCount,loopWait:t.loopWait,loopCall:t.loopCall,loopParams:t.loopParams,loopWaitCall:t.loopWaitCall,loopWaitParams:t.loopWaitParams,rewind:t.rewind,rewindWait:t.rewindWait,rewindCall:t.rewindCall,rewindParams:t.rewindParams,rewindWaitCall:t.rewindWaitCall,rewindWaitParams:t.rewindWaitParams,set:a.copy(t.masterSet),events:W,override:!1,id:X};r==q.length-1&&ge(s),a.animate(s),o+=i+n,i=0}}function ge(t){var n=t.call,i=t.params;t.call=j.loop&&(!j.count||pe<j.count)?function(){function t(){for(var e=0;e<he.objects.length;e++)he.objects[e].set&&he.objects[e].set(he.values[e]);j.loopWaitCall&&"function"==typeof j.loopWaitCall&&j.loopWaitCall(j.loopWaitParams),fe()}j.loopCall&&"function"==typeof j.loopCall&&j.loopCall(j.loopParams),j.loopWait?(c(e.zimTweens)&&(e.zimTweens={}),se=e.zimTweens[X]=e.zimTween=createjs.Tween.get(e,{override:j.override}).wait(j.loopWait,!0).call(t)):t()}:function(){n&&"function"==typeof n&&n(i),c(u)&&(u=de),l&&"function"==typeof l&&l(u),rn(X)},pe++}return function(){var t=new a.Dictionary;he=new a.Dictionary;for(var n=0;n<q.length;n++)if(Se=q[n],e||(e=Se.target),c(Se.target)&&(Se.target=e),c(Se.ease)&&(Se.ease=s),!c(Se.target)){if(c(Se.props)&&!c(Se.obj)&&(Se.props=Se.obj),Se.obj=Se.props,Se.loop&&(c(Se.loopCount)||Se.loopCount<=0)&&(Se.loopCount=0,q.splice(n+1,q.length)),c(Se.obj.scale)||(Se.obj.scaleX=Se.obj.scaleY=Se.obj.scale,delete Se.obj.scale),Se.from){var i=t.at(Se.target);if(i){if(Se.set){var o=a.copy(Se.obj),r=a.merge(i,Se.set);Se.obj=Zt(Se.target,Se.obj,r),Se.set=a.merge(Se.set,o)}else Se.set=a.copy(Se.obj),Se.obj=Zt(Se.target,Se.obj,i);Se.from=!1}else t.add(Se.target,Zt(Se.target,Se.obj,Se.set))}var l={};for(var u in Se.obj)l[u]=Se.set&&Se.set[u]?Se.set[u]:Se.target[u];c(he.at(Se.target))&&he.add(Se.target,{});var h=a.merge(he.at(Se.target),l);he.remove(Se.target),he.add(Se.target,h),Se.masterSet=a.copy(Se.set)}c(e.zimTweens)&&(e.zimTweens={})}(),qt(),fe(),e}if(q&&(q.x&&(e.zimX=!0),q.y&&(e.zimY=!0)),!c(q.shape)&&q.shape.type==e.type&&("Blob"==e.type||"Squiggle"==e.type)){var me=e.pointObjects,ye=q.shape.pointObjects;if(me.length!=ye.length)n&&i("ZIM animate() - shapes must be of same number of points"),delete q.shape;else{delete q.shape;var be=c(q.blobShift)?0:q.blobShift;delete q.blobShift;var ve=!0;for(ne=0;ne<me.length;ne++){var we=me[ne],xe=ye[(2e4*me.length+ne+be)%me.length];for(Rt=0;Rt<4;Rt++)if(1!=Rt){var Ce=we[Rt],ke=a.copy($);ke[0]=Ce,ke[1]={x:xe[Rt].x,y:xe[Rt].y,rotation:xe[Rt].rotation},ve&&(ke[34]=!0,Ce.animateEvent&&Ce.off("animation",Ce.animateEvent),Ce.animateEvent=Ce.on("animation",function(){e.update()})),ve=!1,a.animate.apply(a.animate,ke)}}if(a.isEmpty(q))return e}}if(!c(e)){var Te,Pe,Oe;if("Sprite"!=e.type&&e.hasOwnProperty("paused")||Object.defineProperty(e,"paused",{get:function(){return e.animatePaused},set:function(t){e.animatePaused=t}}),e.endTween=function(){return e.stopAnimate(),a.loop(q,function(t){ee(e,t,q[t])}),e.stage&&e.stage.update(),e},e.zimTweenOriginals={},a.loop(q,function(t,n){e.zimTweenOriginals[t]=function(e,t){if("."!=t.substr(0,1))return e[t];for(var n=t.split("."),i=e,o=1;o<n.length;o++)i=i[n[o]];return i}(e,t)}),e.resetTween=function(){return a.loop(e.zimTweenOriginals,function(t){ee(e,t,e.zimTweenOriginals[t])}),e.stage&&e.stage.update(),e},e.replayTween=function(){return e.resetTween(),e.stopAnimate(),a.animate.apply(null,$),e},(q.path||V)&&(e.requestedPercentComplete?Te=e.requestedPercentComplete:e.percentComplete&&(Pe=e,Oe="percentComplete",!Object.getOwnPropertyDescriptor(Pe,Oe).get)&&(Te=e.percentComplete),e.requestedPercentComplete=null,c(Te)&&(Te=0),e.pathRatio=0),_&&(z=!1),c(e.zimTweens)&&(e.zimTweens={}),!_)if(e.stage)He=e.stage;else{if(!t)return;He=t.stage}if(c(q.scale)||(q.scaleX=q.scaleY=a.Pick.choose(q.scale),delete q.scale),e.setColorRange&&!c(q.color)){var Ae=q.color;delete q.color,q.colorRange=1,e.setColorRange(e.color,Ae),e.colorRange=0}for(var Se in q){if(!e.zimBusy)break;e.zimBusy[Se]&&delete q[Se]}if(!a.isEmpty(q)){"Sprite"!=e.type&&(e.paused=!1);var Ie=e.mouseEnabled;(D||j.loop||j.rewind)&&(e.mouseEnabled=!1,setTimeout(function(){for(var t in e.zimBusy||(e.zimBusy={}),q)e.zimBusy[t]=!0;e.mouseEnabled=Ie},70)),qt();var Ee,Me=["extra","zoom","speed","layer","fade"],Be={zoom:"Pen"==e.type?"size":"scale",speed:"percentSpeed",layer:"layer",fade:"alpha"};for(var ne in q)0<=Me.indexOf(ne)||(q[ne]=a.Pick.choose(q[ne]));for(ne in Me.shift(),R)R[ne]=a.Pick.choose(R[ne]);for(ne in j)"waitedCall"!=ne&&"waitedParams"!=ne&&"loopCall"!=ne&&"rewindCall"!=ne&&"loopWaitCall"!=ne&&"rewindWaitCall"!=ne&&(j[ne]=a.Pick.choose(j[ne]));if(e.getBounds&&c(e.percentCompleteCheck)&&(e.percentCompleteCheck=!0,Object.defineProperty(e,"percentComplete",{get:function(){return this.zimTween&&this.zimTween.duration?this.zimTween.position/this.zimTween.duration*100:0},set:function(e){this.zimTween?(this.zimTween.startPaused=!1,V?c(this.zimTween.currentTime)||(this.zimTween.currentTime=this.zimTween.currentTime-this.zimTween.position+e*this.zimTween.duration/100):this.zimTween.setPosition(Math.round(e*this.zimTween.duration/100)),en()):this.requestedPercentComplete=e}})),!c(q.path)&&q.path.segmentPoints){"Pen"==e.type&&(e.infinite=!0),e.zimOnPath=!0,c(e.pathRatio)&&(e.pathRatio=0),c(q.orient)&&(q.orient=q.path);var ze=!(Ee=q.path).lockControls;delete q.path,q.pathRatio=1}Y&&(q=Zt(e,q,R,!0));var je,_e,De,Le,Ye,Re=!0,Xe=!1,We=!0,Fe=!0;if(c(q.redirect)||(Fe=q.redirect,delete q.redirect),Ee){var Ve;ze||(Je=a.copy(Ee.segmentPoints),Ve=a.copy(Ee.segmentRatios));var Ne=Ee.getCurvePoint(e.pathRatio,Ve,Je);if(e.parent&&Ne){var Ge=e.parent.globalToLocal(Ne.x,Ne.y);e.x=Ge.x,e.y=Ge.y}if(N){s="linear",e.cursor="pointer";var He,Ke=e.percentComplete,qe=!0,Ue=!0,Ze=Ke,Je=copy(Ee.segmentPoints),$e=0;a.loop(Je,function(e){$e+=distanceAlongCurve(e)});var Qe=Math.round($e/Je.length/10),et=Ee.interpolate(Qe,null,!0),tt=(Ke||0)/100*$e,nt=tt,it=!1;a.copy(Ee.segmentRatios),e.zimAnimatePathChange=Ee.on("change",function(){it=!0}),e.zimAnimateDragDown=e.on("mousedown",function(t){(He=t.target.stage).mouseMoveOutside=!0,We=!(Re=!1),setTimeout(function(){Re=!0},50),Xe=!0,it&&(Je=a.copy(Ee.segmentPoints),$e=0,a.loop(Je,function(e){$e+=distanceAlongCurve(e)}),Qe=Math.round($e/Je.length/10),et=Ee.interpolate(Qe,null,!0),a.copy(Ee.segmentRatios)),it=!1,ot.immediate(Ke=e.percentComplete);var n=Ke;k&&(n=se.position>se.duration/2?2*(100-Ke):2*Ke),nt=tt=(n||0)/100*$e}),e.zimAnimateDragPress=e.on("pressmove",function(e){var t=Ee.globalToLocal(e.rawX/He.scaleX,e.rawY/He.scaleY),n=tt;"Blob"==Ee&&(st[0]<st[4]?Ue=!0:st[0]>st[4]&&(Ue=!1),n<10&&!Ue?(nt=tt=n=$e-5,ot.immediate(nt/$e*100),st=[$e-1,$e-2,$e,$e-3,$e-4]):$e-10<n&&Ue&&(nt=tt=n=5,ot.immediate(nt/$e*100),st=[0,0,0,0,0]));var i=t.x,o=t.y,r=n;et.sort(function(e,t){var n=e.y,a=e.r*$e,s=t.x,l=t.y,c=t.r*$e;return Math.sqrt(Math.pow(i-e.x,2)+Math.pow(o-n,2)+Math.pow(r-a,2))-Math.sqrt(Math.pow(i-s,2)+Math.pow(o-l,2)+Math.pow(r-c,2))}),Ke=(nt=et[0].r*$e)/$e*100,Ke=constrain(Ke,0,99.95),k&&(Ke/=2,se.position>se.duration/2&&(Ke=100-Ke))}),e.animateReturn=function(){k?(Ue=qe=!1,e.percentComplete<50&&(e.percentComplete=100-e.percentComplete),e.pauseAnimate(!1)):n&&i("ZIM animate() - animateReturn() needs rewind set to true")},e.zimAnimateDragUp=e.on("pressup",function(){0==e.paused&&(Xe=!1),Re=!1,setTimeout(function(){Re=!0},50),st[0]<st[4]?Ue=!0:st[0]>st[4]&&(Ue=!1),!e.paused&&k&&Fe&&Ue!=qe&&(e.percentComplete=100-e.percentComplete,qe=Ue)});var ot=new a.Damp(Ke,.15),rt=0,at=0,st=[0,0,0,0,0];e.zimDragAnimateTicker=a.Ticker.add(function(){if(N)if(++at%20&&(st.push(nt),st.shift()),tt=nt,Xe||We&&1==e.paused){if("Blob"==Ee.type&&Math.abs(rt-Ke)>(k?45:90)){var t=Ke;ot.immediate(t)}else t=ot.convert(Ke);.1<Math.abs(rt-t)?(e.percentComplete=t,rt=t):(e.percentComplete=t,We=!1)}else We=!1},He)}}if(q.orient){if(!0===q.orient){var lt=e.parent.localToGlobal(c(q.x)?e.x:q.x,c(q.y)?e.y:q.y);q.orient={x:lt.x,y:lt.y}}je=q.orient,delete q.orient;var ct,ut=e.rotation;je!=Ee&&(ct=je.parent?je.parent.localToLocal(je.x,je.y,e.parent):e.parent.globalToLocal(je.x,je.y),e.rotation=a.angle(e.x,e.y,ct.x,ct.y)+ut)}q.flip&&(_e=q.flip,delete q.flip,De=e.scaleX),q.flipVertical&&(Le=q.flipVertical,delete q.flipVertical,Ye=e.scaleY);var ht=e.x,dt=e.y,pt=0;j.loop&&!c(j.count)&&(pt=j.count,delete j.count,pe=1);var ft,gt=0;j.loopWait&&(gt=j.loopWait,delete j.loopWait),j.loopCall&&(ft=j.loopCall,delete j.loopCall);var mt,yt=e;j.loopParams&&(yt=j.loopParams,delete j.loopParams),j.loopWaitCall&&(mt=j.loopWaitCall,delete j.loopWaitCall);var bt,vt=e;if(j.loopWaitParams&&(vt=j.loopWaitParams,delete j.loopWaitParams),j.rewind){if(s){var wt=s;-1==wt.indexOf("InOut")&&(-1!=wt.indexOf("Out")?wt=wt.replace("Out","In"):-1!=wt.indexOf("In")&&(wt=wt.replace("In","Out")))}var xt,Ct,kt=0;if(delete j.rewind,j.rewindWait&&(kt=j.rewindWait,delete j.rewindWait),j.rewindCall){xt=j.rewindCall;var Tt=j.rewindParams;c(Tt)&&(Tt=e),delete j.rewindCall,delete j.rewindParams}function Pt(){xt&&"function"==typeof xt&&xt(Tt)}if(j.rewindWaitCall){Ct=j.rewindWaitCall;var Ot=j.rewindWaitParams;c(Ot)&&(Ot=e),delete j.rewindWaitCall,delete j.rewindWaitParams}function At(){Ct&&"function"==typeof Ct&&Ct(Ot)}function St(t){Ut(),se=e.zimTweens[X]=e.zimTween=createjs.Tween.get(e,{override:j.override}).wait(h,!0).call(function(){d&&"function"==typeof d&&d(c(p)?e:p),It(se)}),t&&Qt(t,se)}function It(t){var n=nn();e.set&&!Y&&e.set(R),se=e.zimTweens[X]=e.zimTween=createjs.Tween.get(e,j).to(q,ue,createjs.Ease[s]).call(At).wait(kt,!0).call(Pt).to(n,ue,createjs.Ease[wt]).call(tn).wait(gt,!0).call(Jt),t&&Qt(t,se),on()}0<U||0<Z||0<h?0<U||0<Z?se=e.zimTweens[X]=e.zimTween=createjs.Tween.get(e,{override:j.override}).wait(0<U?U:0,!0).wait(0<Z?Z:0,!0).call(function(){E&&"function"==typeof E&&E(c(M)?e:M)}).call(function(){St(se)}):St():(Ut(),It())}else{function Et(t){Ut(),se=e.zimTweens[X]=e.zimTween=createjs.Tween.get(e,{override:j.override}).wait(h,!0).call(function(){d&&"function"==typeof d&&d(c(p)?e:p),Mt(se)}),t&&Qt(t,se)}function Mt(t){e.set&&!Y&&e.set(R),se=e.zimTweens[X]=e.zimTween=createjs.Tween.get(e,j).to(q,ue,createjs.Ease[s]).call(tn).wait(gt,!0).call(Jt),t&&Qt(t,se),on()}0<U||0<Z||0<h?0<U||0<Z?se=e.zimTweens[X]=e.zimTween=createjs.Tween.get(e,{override:j.override}).wait(0<U?U:0,!0).wait(0<Z?Z:0,!0).call(function(){E&&"function"==typeof E&&E(c(M)?e:M)}).call(function(){Et(se)}):Et():(Ut(),Mt())}se.startPaused=H,se.rewinding=!1,!_&&z&&(Te&&(e.pathRatio=e.percentComplete&&100!=Math.round(e.percentComplete)?e.percentComplete/100:0,e.percentComplete=100!=Math.round(Te)?Te:0),bt=W&&!c(F)&&F.dispatchEvent?a.Ticker.add(function(){(Ee||je||_e||Le)&&en(),F.dispatchEvent("animation")},He):a.Ticker.add(W&&e.dispatchEvent?function(){(Ee||je||_e||Le)&&en(),e.dispatchEvent("animation")}:function(){(Ee||je||_e||Le)&&en()},He));var Bt=[1,1,1];c(e.zimMaskDynamic)||e.zimMaskApply();var zt,jt,_t,Dt=!1;for(on(),e.stopAnimate&&e.stopAnimate.real||(e.stopAnimate=function(t,n,i,o){if(c(i)&&(i=!0),e.paused=!0,"Pen"==e.type&&e.zimOnPath&&(e.stop(),e.zimOnPath=!1),c(n)&&(n=!0),i&&N&&(Ee&&Ee.off("change",e.zimAnimatePathChange),e.off("mousedown",e.zimAnimateDragDown),e.off("pressmove",e.zimAnimateDragPress),e.off("pressup",e.zimAnimateDragUp),a.Ticker.remove(e.zimDragAnimateTicker)),c(t)){if(!n)return e;for(var r in e.zimBusy=null,createjs.Tween.removeTweens(e),e.zimTweens)an(r);e.zimTweens=null,e.zimIdSets=null,e.zimTween=null,a.idSets&&a.idSets[le||r]&&(delete a.idSets[le||r],a.isEmpty(a.idSets)&&delete a.idSets),a.animatedObjects.remove(e)}else{Array.isArray(t)||(t=[t]);var s=ln(t);for(var r in e.zimTweens)e.zimTweens[r].requestID&&cancelAnimationFrame(e.zimTweens[r].requestID),n&&0<=s.indexOf(r)&&rn(r),!n&&s.indexOf(r)<0&&rn(r)}return e},e.stopAnimate.real=!0,e.pauseAnimate=function(t,n,i,o){if("Pen"==e.type&&(!1===t?e.zimOnPath&&(e.infinite=!0):e.stop()),jt&&!o)return e.pause(t,n),e;if(c(t)&&(t=!0),Xe=!1,e.paused=t,c(i)&&(i=!0),c(n)&&!i)return e;if(c(n))for(var r in e.zimTweens)sn(r,t);else{Array.isArray(n)||(n=[n]);var a=ln(n);for(var r in e.zimTweens)i&&0<=a.indexOf(r)&&sn(r,t),!i&&a.indexOf(r)<0&&sn(r,t)}return e}),H&&e.pauseAnimate(!0,X,null,!0),q.extra&&(zt=q.extra,delete q.extra,Array.isArray(zt)||(zt=[zt])),ne=0;ne<Me.length;ne++){var Lt=Me[ne];q[Lt]&&(c(zt)&&(zt=[]),cn(Lt,q[Lt]),delete q[Lt])}if(zt)for(se.extraTickers=[],ne=0;ne<zt.length;ne++){var Yt=zt[ne];for(var Rt in c(Yt.inputObj)&&(Yt.inputObj=e),c(Yt.inputProp)&&(Yt.inputProp="y"),c(Yt.inputMin)&&(Yt.inputMin=0),c(Yt.inputMax)&&(Yt.inputMax="x"==Yt.inputProp?He.width:He.height),c(Yt.outputObj)&&(Yt.outputObj=e),c(Yt.outputProp)&&(Yt.outputProp="scale"),c(Yt.outputMin)&&(Yt.outputMin=0),c(Yt.outputMax)&&(Yt.outputMax=Yt.outputMin+1),c(Yt.constrain)&&(Yt.constrain=!0),Yt)q[Rt]=a.Pick.choose(q[Rt]);"percentSpeed"==Yt.outputProp&&(V=!0),_t=new a.Proportion(Yt.inputMin,Yt.inputMax,Yt.outputMin,Yt.outputMax,Yt.factor,Yt.outputRound);var Xt=function(){var e=Yt,t=_t;return function(){var n,i=e.outputObj;if(n=e.constrain?a.constrain(t.convert(e.inputObj[e.inputProp]),e.outputMin,e.outputMax):t.convert(e.inputObj[e.inputProp]),"scale"==e.outputProp)i.scaleX=a.sign(i.scaleX)*n,i.scaleY=a.sign(i.scaleY)*n;else if("scaleX"==e.outputProp)i.scaleX=a.sign(i.scaleX)*n;else if("scaleY"==e.outputProp)i.scaleY=a.sign(i.scaleY)*n;else if("layer"==e.outputProp){if(!i.parent)return;var o=a.constrain(Math.round(n),0,i.parent.numChildren-1);o!=i.parent.getChildIndex(i)&&i.parent.setChildIndex(i,o)}else i[e.outputProp]=n}}();Xt(),se.extraTickers.push(a.Ticker.add(Xt,He))}if(V||e.zimAnimateDragDown){if(V){jt=!0,e.pauseAnimate(!0,X,null,!0),e.paused=!1,se.currentTime=0;var Wt=se;c(e.percentSpeed)&&(e.percentSpeed=se.startPaused?0:100);var Ft=1e3/60;se.currentTime=0;var Vt=!h&&c(g)&&f;G&&f&&c(g)&&(G=!1);var Nt,Gt=r+(k?r:0)+(T||0)+(y||0),Ht=1;f&&g&&(Ht=g),G&&(Nt=Gt*Ht),function t(){if(se.requestID=requestAnimationFrame(t),V&&(!se.startPaused||0!=e.percentSpeed)){se.startPaused=!1,0<h&&se!=Wt&&(h=0,se.currentTime=0,e.pauseAnimate(!0,X),e.paused=!1,Vt=c(g)&&f),Vt&&(se.currentTime+=1e4*Gt,se.setPosition(se.currentTime,!0),Vt=!1);var n=se.currentTime+Ft*e.percentSpeed/100;Nt&&0==h&&(n=a.constrain(n,0,Nt)),se.currentTime=n,se.setPosition(se.currentTime),(Ee||je||_e||Le)&&en(),He.update()}}()}var Kt;e.pause=function(t,n){if(c(t)&&(t=!0),c(n)&&(n=0),t){if(e.zimAnimateDragDown&&(N=!1,e.cursor="default",Ee&&Ee.off("change",e.zimAnimatePathChange),e.off("mousedown",e.zimAnimateDragDown),e.off("pressmove",e.zimAnimateDragPress),e.off("pressup",e.zimAnimateDragUp),!V))return;Kt=e.percentSpeed,0<n?a.animate({target:e,props:{percentSpeed:0},override:!1,ticker:!1,time:n,call:function(){e.percentSpeed=0,e.paused=!0,V=!1,e.dispatchEvent("pause")}}):(se.startPaused=!1,e.percentSpeed=0,e.paused=!0,V=!1,setTimeout(function(){e.dispatchEvent("pause")},10))}else{if(e.zimAnimateDragDown&&(N=!0,e.cursor="pointer",Ee&&(e.zimAnimatePathChange=Ee.on("change",e.zimAnimatePathChange)),e.zimAnimateDragDown=e.on("mousedown",e.zimAnimateDragDown),e.zimAnimateDragPress=e.on("pressmove",e.zimAnimateDragPress),e.zimAnimateDragUp=e.on("pressup",e.zimAnimateDragUp),!V))return;Xe=!1,se.currentTime=se.position,0<n?a.animate({target:e,props:{percentSpeed:Kt},override:!1,ticker:!1,time:n,call:function(){e.percentSpeed=Kt,e.paused=!1,V=!0}}):(e.percentSpeed=Kt,e.paused=!1,V=!0)}return e}}return e}}function qt(){c(X)?X=a.makeID(10):(X=String(X),ce=X),c(e.zimIdSets)&&(e.zimIdSets={}),c(e.zimIdSets[X])?c(e.zimTweens[X])||(le=X,X=a.makeID(10),e.zimIdSets[le]=[le],e.zimTweens[le].zimIdSet=le,e.zimIdSets[le].push(X)):(le=X,X=a.makeID(10),e.zimIdSets[le].push(X))}function Ut(){var t;for(ne in e.zimLastObj||(e.zimLastObj={}),q){if("string"==typeof q[ne]){if("+"==q[ne].substr(0,1))continue;t=e.zimLastObj&&!c(e.zimLastObj[ne])?e.zimLastObj[ne]:e[ne],q[ne]=t+Number(q[ne].replace(/\s/g,""))}e.zimLastObj[ne]=k?e.zimTweenOriginals[ne]:q[ne]}for(ne in R){if("string"==typeof R[ne]){if("+"==R[ne].substr(0,1))continue;t=e.zimLastObj&&!c(e.zimLastObj[ne])?e.zimLastObj[ne]:e[ne],R[ne]=t+Number(R[ne].replace(/\s/g,""))}e.zimLastObj[ne]=k?e.zimTweenOriginals[ne]:q[ne]}}function Zt(e,t,n,i){Ee&&(!c(e.percentComplete)||n&&!c(n.percentComplete))&&(n||(n={}),c(n.pathRatio)&&(n.pathRatio=c(n.percentComplete)?e.percentComplete/100:n.percentComplete/100));var o={};for(ne in t)o[ne]=n&&!c(n[ne])?n[ne]:e[ne],i&&(e[ne]=t[ne]);return o}function Jt(){ft&&"function"==typeof ft&&ft(yt)}function $t(){mt&&"function"==typeof mt&&mt(vt)}function Qt(e,t){t.zimIdSet=e.zimIdSet,t.zimObj=e.zimObj,t.zimTicker=e.zimTicker,t.zimExtraTickers=e.zimExtraTickers,t.requestID=e.requestID}function en(){if(e.parent&&!se.passive&&!se.startPaused){if(N&&k&&(Ze<50&&50<e.percentComplete||50<Ze&&e.percentComplete<50)&&(qe=e.percentComplete<50),Ze=e.percentComplete,Ee){ze&&(Je=Ee.segmentPoints,Ve=Ee.segmentRatios);var t=Ee.getCurvePoint(e.pathRatio,Ve,Je);if(t){var n=e.parent.globalToLocal(t.x,t.y);e.x=n.x,e.y=n.y}}var i,o;if(_e&&Re&&(ht>e.x&&a.sign(e.scaleX)==a.sign(De)&&(e.scaleX*=-1),ht<e.x&&a.sign(e.scaleX)!=a.sign(De)&&(e.scaleX*=-1)),Le&&Re&&(dt>e.y&&a.sign(e.scaleY)==a.sign(Ye)&&(e.scaleY*=-1),dt<e.y&&a.sign(e.scaleY)!=a.sign(Ye)&&(e.scaleY*=-1)),je&&(Ee==je?i=a.angle(ht,dt,e.x,e.y)+ut:(o=je.parent?je.parent.localToLocal(je.x,je.y,e.parent):e.parent.globalToLocal(je.x,je.y),i=a.angle(e.x,e.y,o.x,o.y)+ut),0!=i&&(_e&&0<ht-e.x&&(i+=180),e.rotation=i==ut?e.rotation:i)),N){var r=e.x-ht+e.y-dt;2<Math.abs(r)&&(Bt.push(sign(r)),Bt.shift(),se.forward=function(e){if(Array.isArray(e)){for(var t=0,n=0,i=e.length;n<i;n++)t+=e[n];return t}}(Bt))}ht=e.x,dt=e.y}}function tn(){if(e.paused&&"Sprite"!=e.type)l&&"function"==typeof l&&l(u);else{if(j.loop){if(!(0<pt))return void $t();if(pe<pt)return $t(),void pe++;k?e.set&&e.set(nn()):e.set&&e.set(q)}K?rn(X):e.pauseAnimate(!0,X),l&&"function"==typeof l&&l(u)}}function nn(){var t={};for(var n in q)if(_)t[n]=c(R[n])||Y?e.style[n]:R[n];else if(c(R[n])||Y)if("."==n.substr(0,1)){for(var i=n.split("."),o=e,r=1;r<i.length;r++)o=o[i[r]];t[n]=o}else t[n]=e[n];else t[n]=R[n];return t}function on(){se.zimObj=q,se.zimTicker=bt,se.zimPaused=Dt,le&&(se.zimIdSet=le),ce&&(c(a.idSets)&&(a.idSets={}),c(a.idSets[ce])?a.idSets[ce]=[e]:a.idSets[ce].indexOf(e)<0&&a.idSets[ce].push(e)),a.animatedObjects||(a.animatedObjects=new a.Dictionary(!0)),a.animatedObjects.add(e,!0)}function rn(t){if(!c(e.zimTweens)&&!c(e.zimTweens[t])){e.zimX=null,e.zimY=null,function(t){if(e.zimBusy){for(var n in t)delete e.zimBusy[n];a.isEmpty(e.zimBusy)&&(e.zimBusy=null)}}(e.zimTweens[t].zimObj),e.zimTweens[t].paused=!0,an(t);var n=e.zimTweens[t].zimIdSet;if(!c(n)&&e.zimIdSets){var i=e.zimIdSets[n];i&&i.splice(i.indexOf(t),1),i&&0==i.length&&(delete e.zimIdSets[n],a.isEmpty(e.zimIdSets)&&delete e.zimIdSets)}if("Pen"==e.type&&e.zimOnPath&&(e.stop(),e.zimOnPath=!1),delete e.zimTweens[t],a.isEmpty(e.zimTweens)&&e.stopAnimate(null,null,!1,!0),e.zimTweens&&e.zimTweens[t]||e.zimIdSets&&e.zimIdSets[n||t]);else if(a.idSets&&a.idSets[n||t]){var o=a.idSets[n||t].indexOf(e);0<=o&&a.idSets[n||t].splice(o,1),a.idSets[n||t].length<=0&&(delete a.idSets[n||t],a.isEmpty(a.idSets)&&delete a.idSets)}}}function an(t){!function(){var n=e.zimTweens[t].zimTicker;if(e.zimTweens[t].extraTickers)for(var i=0;i<e.zimTweens[t].extraTickers.length;i++)a.Ticker.remove(e.zimTweens[t].extraTickers[i]);n&&setTimeout(function(){n&&a.Ticker.remove(n),n=null},200)}()}function sn(t,n){var i=e.zimTweens[t];(i.paused=n)!=i.zimPaused&&((i.zimPaused=n)?i.zimTicker&&(i.zimAnimateTimeout=setTimeout(function(){a.Ticker.remove(i.zimTicker)},200)):(i.startPaused=!1,clearTimeout(i.zimAnimateTimeout),i.zimTicker&&(i.zimTicker=a.Ticker.add(i.zimTicker,He))))}function ln(t){for(var n=[],i=0;i<t.length;i++)e.zimIdSets&&!c(e.zimIdSets[t[i]])?n=n.concat(e.zimIdSets[t[i]]):n.push(t[i]);return n}function cn(e,t){!0===t?zt.push({outputProp:Be[e]}):Array.isArray(t)?zt.push({outputProp:Be[e],outputMin:t[0],outputMax:t[1],inputMin:t[2],inputMax:t[3]}):zt.push({outputProp:Be[e],outputMax:t})}},a.stopAnimate=function(e){if(C("45.12"),c(e)){if(a.animatedObjects)for(var t=a.animatedObjects.length-1;0<=t;t--)a.animatedObjects.objects[t].stopAnimate()}else if(Array.isArray(e)||(e=[e]),a.idSets)for(var n=0;n<e.length;n++){var i=e[n];if(a.idSets[i])for(t=a.idSets[i].length-1;0<=t;t--)a.idSets[i][t].stopAnimate(i)}},a.stopZimAnimate=function(e){C("45.1"),a.stopAnimate(e)},a.pauseAnimate=function(e,t){if(C("45.22"),c(e)&&(e=!0),c(t)){if(a.animatedObjects)for(var n=a.animatedObjects.length-1;0<=n;n--)a.animatedObjects.objects[n].pauseAnimate(e)}else if(Array.isArray(t)||(t=[t]),a.idSets)for(var i=0;i<t.length;i++){var o=t[i];if(a.idSets[o])for(n=a.idSets[o].length-1;0<=n;n--)a.idSets[o][n].pauseAnimate(e,o)}},a.pauseZimAnimate=function(e,t){C("45.2"),a.pauseAnimate(e,t)},a.wiggle=function(e,t,n,i,o,r,s,l,u,h,d,p,f,g){var y;if(y=m(a.wiggle,arguments,"target, property, baseAmount, minAmount, maxAmount, minTime, maxTime, totalTime, type, ease, integer, id, startType, ticker"))return y;if(C("45.25"),c(e)||c(n)||c(i))return e;c(o)&&(o=i),c(r)&&(r=1e3),c(s)&&(s=r),c(h)&&(h="quadInOut"),c(d)&&(d=!1),c(p)&&(p=a.makeID()),c(u)&&(u="both"),c(f)&&(f="both"),c(g)&&(g=!0),c(l)||(e.wiggleTimeout=setTimeout(function(){e.stopAnimate(p),e.dispatchEvent("wigglestop")},l));var b,v=0;return function l(){var c=a.rand(a.Pick.choose(r),a.Pick.choose(s)),g={},m={};if(m[t]=a.Pick.choose(n),"negative"==u||0==v&&"negative"==f)var y=-a.rand(a.Pick.choose(i),a.Pick.choose(o),d);else y="positive"==u||0==v&&"positive"==f?a.rand(a.Pick.choose(i),a.Pick.choose(o),d):0==v?a.rand(a.Pick.choose(i),a.Pick.choose(o),d,!0):a.rand(a.Pick.choose(i),a.Pick.choose(o),d)*a.sign(b)*-1;g[t]=a.Pick.choose(n)+y,0==v&&(c/=2),b=y,v++,a.animate("negative"==u||"positive"==u?{target:e,obj:g,set:m,ease:h,time:2*c,rewind:!0,override:!1,call:l,id:p,ticker:!!e.stage}:{target:e,obj:g,ease:h,time:c,override:!1,call:l,id:p,ticker:!!e.stage})}(),e},a.zimLoopCheck=!1,a.loop=function(e,t,n,i,o,r){var s;if(s=m(a.loop,arguments,"obj, call, reverse, step, start, end"))return s;if(a.zimLoopCheck||C("45.3"),a.zimLoopCheck=!0,!c(e)&&!c(t)){c(n)&&(n=!1),(c(i)||i<=0)&&(i=1);var l="number"==typeof e?"number":e.constructor===Array?"array":e.constructor==={}.constructor?"object":e instanceof NodeList?"nodelist":e instanceof HTMLCollection?"htmlcollection":"invalid";if("container"!=l||e.addChild)if("number"==l||"array"==l||"nodelist"==l||"htmlcollection"==l){if(0==(f=g((d="number"==l?e:e.length)-1)))return;if(n)for(var u=o;r<=u;u-=i){if("number"==l)var h=t(u,f,o,r,e);else h=t("array"==l?e[u]:e.item(u),u,f,o,r,e);if(void 0!==h)return h}else for(u=o;u<=r;u+=i)if(void 0!==(h="number"==l?t(u,f,o,r,e):t("array"==l?e[u]:e.item(u),u,f,o,r,e)))return h}else if("object"==l){var d=0,p=[];for(var u in e)d++,p.push(u);if(0==(f=g(d-1)))return;if(n){for(u=o;r<=u;u-=i)if(void 0!==(h=t(p[u],e[p[u]],u,f,o,r,e)))return h}else for(u=o;u<=r;u+=i)if(void 0!==(h=t(p[u],e[p[u]],u,f,o,r,e)))return h}else{var f;if(0==(f=g(e.numChildren-1)))return;if(n){for(u=o;r<=u;u-=i)if(void 0!==(h=t(e.getChildAt(u),u,f,o,r,e)))return h}else for(u=o;u<=r;u+=i)if(void 0!==(h=t(e.getChildAt(u),u,f,o,r,e)))return h}}function g(e){return c(o)&&(o=n?e:0),c(r)&&(r=n?0:e),n&&o<r||!n&&r<o?0:(o<0&&r)<0||e<o&&e<r?0:(o=Math.max(0,Math.min(o,e)),r=Math.max(0,Math.min(r,e)),Math.floor((n?o-r:r-o)/i)+1)}},a.scaleTo=function(e,t,n,o,r,s){var l;if(l=m(a.scaleTo,arguments,"obj, boundObj, percentX, percentY, type, boundsOnly"))return l;if(C("43"),!c(e)&&e.getBounds&&e.getBounds()){if(!c(t)&&t.getBounds&&t.getBounds()){c(n)&&(n=-1),c(o)&&(o=-1),-1==n&&-1==o&&(n=o=100),c(r)&&(r="smallest"),c(s)&&(s=!1);var u=t.getBounds().width*n/100*(s?1:t.scaleX),h=t.getBounds().height*o/100*(s?1:t.scaleY);if("Stage"!=t.type&&"StageGL"!=t.type||(u=t.width*n/100,h=t.height*o/100),(-1==n||-1==o)&&"both"!=r&&"stretch"!=r)return a.sca(e,-1==n?h/e.getBounds().height:u/e.getBounds().width),e;if("both"==r||"stretch"==r)return e.scaleX=-1!=n?u/e.getBounds().width:e.scaleX,e.scaleY=-1!=o?h/e.getBounds().height:e.scaleY,e;if("biggest"==r||"largest"==r||"outside"==r)var d=Math.max(u/e.getBounds().width,h/e.getBounds().height);else d=Math.min(u/e.getBounds().width,h/e.getBounds().height);return a.sca(e,d),e}i("zim methods - scaleTo(): please provide a boundObject (with setBounds) to scale to")}else i("zim methods - scaleTo(): please provide an object (with setBounds) to scale")},a.fit=function(e,t,n,o,r,s){var l;if(l=m(a.fit,arguments,"obj, left, top, width, height, inside"))return l;if(C("46"),!c(e)&&e.getBounds){if(e.getBounds()){if(c(t)){if(!e.stage)return void i("zim methods - fit(): please add boundary dimensions or add obj to stage first");if(!e.stage.getBounds())return void i("zim methods - fit(): please add boundary dimensions or add obj with bounds to stage first");n=t=0,o=e.stage.getBounds().width,r=e.stage.getBounds().height}c(s)&&(s=!0),e.scaleX=e.scaleY=1;var u,h=o,d=r,p=e.getBounds().width,f=e.getBounds().height;e.scaleX=e.scaleY=u=s?p/f<=h/d?d/f:h/p:p/f<=h/d?h/p:d/f;var g=p*u,y=f*u;return e.x=(e.regX-e.getBounds().x)*u+t+(h-g)/2,e.y=(e.regY-e.getBounds().y)*u+n+(d-y)/2,{x:e.x,y:e.y,width:g,height:y,scale:u,bX:t,bY:n,bWidth:o,bHeight:r}}i("zim methods - fit(): please setBounds() on object")}},a.boundsCheck=!1,a.boundsToGlobal=function(e,t,n){if(a.boundsCheck||(C("40"),a.boundsCheck=!0),!c(e)&&e.getBounds){c(n)&&(n=!1);var o=e.getBounds();if(o||!c(t)){if(t&&(o=t),n)var r=e.globalToLocal(o.x,o.y),s=e.globalToLocal(o.x+o.width,o.y),l=e.globalToLocal(o.x+o.width,o.y+o.height),u=e.globalToLocal(o.x,o.y+o.height);else r=e.localToGlobal(o.x,o.y),s=e.localToGlobal(o.x+o.width,o.y),l=e.localToGlobal(o.x+o.width,o.y+o.height),u=e.localToGlobal(o.x,o.y+o.height);var h=Math.min(r.x,s.x,l.x,u.x),d=Math.min(r.y,s.y,l.y,u.y),p=Math.max(r.x,s.x,l.x,u.x),f=Math.max(r.y,s.y,l.y,u.y);return new createjs.Rectangle(h,d,p-h,f-d)}i("zim methods - boundsToGlobal():\n please setBounds() on object (or a rectangle)")}},a.resetBounds=function(e,t,n,i,o){if(C("40.5"),c(i))r=0,a=t,s=0,l=n;else var r=t,a=i,s=n,l=o;return c(l)&&(l=a),c(t)?e.setBounds(null):e.setBounds(r,s,a,l),e},a.copyMatrix=function(e,t){return C("45.5"),e.x=t.x,e.y=t.y,e.scaleX=t.scaleX,e.scaleY=t.scaleY,e.regX=t.regX,e.regY=t.regY,e.rotation=t.rotation,e.skewX=t.skewX,e.skewY=t.skewY,e},a.duplicate=function(e){C("45.6");var t=e.clone();for(var n in e)e.hasOwnProperty(n)&&null==t.prop&&(t[n]=e[n]);return t},a.expand=function(e,t,n){if(C("50"),c(e)||!e.getBounds||!e.getBounds())return i("zim methods - expand(): please provide object with bounds set"),e;c(t)&&(t=20),c(n)&&(n=t);var o=e.getBounds(),r=new createjs.Shape;return r.graphics.f("0").r(o.x-t,o.y-n,o.width+2*t,o.height+2*n),e.hitArea=r,e},a.setSwipe=function(e,t){if(C("34"),!c(e)&&e.on)return e.zimNoSwipe=!t||null,e instanceof createjs.Container&&function t(n){for(var i,o=n.numChildren,r=0;r<o;r++)(i=n.getChildAt(r)).zimNoSwipe=e.zimNoSwipe,i instanceof createjs.Container&&t(i)}(e),e},a.setMask=function(e,n,o){if(C("50.1"),c(e)&&i("zim methods - setMask(): please provide obj"),c(n))return l(),e;var r,s=e.stage||(t?t.stage:null);function l(){e.zimMask&&e.zimMask.parent&&e.zimMask.parent.removeChild(e.zimMask),e.zimMask=null,e.zimMaskTicker&&a.Ticker.remove(e.zimMaskTicker),e.mask=null}function u(){if(o&&(!s||!n.stage))return e;if(r=null,e.zimMask=n.zimMask=r=n.shape.clone(),a.copyMatrix(r,n),n.addChildAt(r,0),r.alpha=0,e.parent){var t=n.getConcatenatedMatrix().decompose(),i=e.parent.getConcatenatedMatrix().decompose();r.scaleX=t.scaleX/i.scaleX,r.scaleY=t.scaleY/i.scaleY,r.rotation=(t.rotation?t.rotation:0)-(i.rotation?i.rotation:0);var l=n.localToLocal(n.shape.x+n.regX,n.shape.y+n.regY,e.parent);r.x=l.x,r.y=l.y,e.mask=r}else e.mask=r}return e.zimMaskOriginal&&e.zimMaskOriginal!=n&&l(),c(o)&&(o=!("Blob"!=n.type&&c(n.zimDown)&&c(n.transformControls)&&c(n.zimTouch)&&c(n.zimTweens)),n.zimMaskDynamic=o),(e.zimMaskOriginal=n).zimMaskApply=function(){e.zimMaskTicker&&a.Ticker.remove(e.zimMaskTicker),e.zimMaskTicker=a.Ticker.add(u)},n&&n.shape?(u(),o&&n.zimMaskApply()):e.mask=r=n,e},a.outline=function(e,t,o){var r;if(r=m(a.outline,arguments,"obj, color, size"))return r;if(C("47"),e.type&&"zimOultineShape"==e.type)return n&&i("zim.outline() - warning, you are trying to outline an outline - do not outline in a loop"),e;if(c(e)||!e.getBounds)return i("zim methods - outline(): please provide object with bounds set"),e;if(!e.getBounds())return i("zim methods - outline(): please setBounds() on object"),e;if(!e.parent)return i("zim methods - outline(): object should be on stage first"),e;if(c(t)&&(t="brown"),c(o)&&(o=2),o<=0)return e.ZIMoutlineShape&&e.ZIMoutlineShape.parent.removeChild(e.ZIMoutlineShape),e.ZIMoutlineShapeC&&e.ZIMoutlineShapeC.parent.removeChild(e.ZIMoutlineShapeC),void(e.ZIMoutlineShape=e.ZIMoutlineShapeC=null);var s=e.getBounds(),l=e.ZIMoutlineShape=e.ZIMoutlineShape?e.ZIMoutlineShape:new a.Shape;l.type="zimOutlineShape";var u=e.ZIMoutlineShapeC=e.ZIMoutlineShapeC?e.ZIMoutlineShapeC:new a.Shape;u.type="zimOutlineShape";var h=e.parent;e.outlineToggled=!0,e.outlineToggle=function(t){return!0===t?(e.ZIMoutlineShape.visible=!0,e.ZIMoutlineShapeC.visible=!0):!1===t?(e.ZIMoutlineShape.visible=!1,e.ZIMoutlineShapeC.visible=!1):(e.ZIMoutlineShape.visible=!e.ZIMoutlineShape.visible,e.ZIMoutlineShapeC.visible=!e.ZIMoutlineShapeC.visible),e.outlineToggled=e.ZIMoutlineShape.visible,e};var d=e.localToLocal(s.x,s.y,h),p=e.localToLocal(s.x+s.width,s.y,h),f=e.localToLocal(s.x+s.width,s.y+s.height,h),g=e.localToLocal(s.x,s.y+s.height,h),y=e.localToLocal(0,0,h),b=l.graphics.c(),v=u.graphics.c();b.s(t).ss(o).mt(d.x,d.y).lt(p.x,p.y).lt(f.x,f.y).lt(g.x,g.y).lt(d.x,d.y).cp(),v.s("white").ss(o+2),v.mt(-11,0).lt(11,0),v.mt(0,-11).lt(0,11),v.s(t).ss(o),v.mt(-10,0).lt(10,0),v.mt(0,-10).lt(0,10),u.x=y.x,u.y=y.y,u.rotation=e.rotation,b.s("white").ss(o+2).dc(e.x,e.y,16),b.s(t).ss(o).dc(e.x,e.y,16),e.parent.removeChild(l),e.parent.removeChild(u);var w=e.parent.getChildIndex(e);return e.parent.addChildAt(u,w+1),e.parent.addChildAt(l,w+1),l.mouseEnabled=!1,u.mouseEnabled=!1,e},a.STYLE=null,a.STYLECHECK=!1,a.ignore="ignore",a.getStyle=function(e,t,n){a.STYLECHECK||(C("50.34"),a.STYLECHECK=!0);var i=["pos","addTo","center","centerReg","mov","drag","transform","gesture","outline","bounds","animate","wiggle"],o=a.STYLE;if("undefined"!=typeof STYLE&&(o=STYLE),o=c(o)?{}:a.copy(o),c(n))n={};else for(var r=0;r<i.length;r++)delete n[i[r]];var s,l=n,u=o.type;if(u&&delete o.type,!c(t)&&!c(o.group)){var h=t.split(","),d={};for(r=0;r<h.length;r++){var p=h[r].trim();c(o.group[p])||(d=a.merge(d,o.group[p]))}delete o.group}for(var f in c(e)||c(u)||c(u[e])||(o=a.merge(o,u[e])),c(t)||c(d)||(o=a.merge(o,d)),o)l[f]?delete o[f]:"ignore"!=(s=-1!=i.indexOf(f)||o.delayPick?o[f]:a.Pick.choose(o[f]))?(s&&s.constructor==={}.constructor&&(s=a.copy(s,!0,!1)),o[f]=s):delete o[f];return!1===(o=a.merge(o,l)).style?{}:o};var T=["visible","x","y","scale","scaleX","scaleY","rotation","alpha","skewX","skewY","regX","regY"],P=function(e,t){if(t){t.add&&e.addTo(),t.addTo&&e.addTo(!0===t.addTo?null:t.addTo),t.center&&e.center(!0===t.center?null:t.center),t.centerReg&&e.centerReg(!0===t.centerReg?null:t.centerReg);for(var n=0;n<T.length;n++)null!=t[T[n]]&&(e[T[n]]=a.Pick.choose(t[T[n]]));if(t.bounds&&t.bounds.constructor==={}.constructor&&e.setBounds(t.bounds.x?t.bounds.x:0,t.bounds.y?t.bounds.y:0,t.bounds.width?t.bounds.width:100,t.bounds.height?t.bounds.height:100),(t.mov||t.move)&&(t.move&&(t.mov=t.move),t.mov.constructor==={}.constructor?e.mov(a.Pick.choose(t.mov.x),a.Pick.choose(t.mov.y)):e.mov(a.Pick.choose(t.mov))),t.loc&&(t.loc.constructor==={}.constructor?e.loc(a.Pick.choose(t.loc.x),a.Pick.choose(t.loc.y)):e.loc(a.Pick.choose(t.loc))),t.pos)if(t.pos.constructor==={}.constructor)e.pos(a.Pick.choose(t.pos.x),a.Pick.choose(t.pos.y),a.Pick.choose(t.pos.right),a.Pick.choose(t.pos.bottom),a.Pick.choose(t.pos.index),t.pos.add,a.Pick.choose(t.pos.reg),a.Pick.choose(t.pos.regX),a.Pick.choose(t.pos.regY));else{var i=a.Pick.choose(t.pos);"left"!=i&&"top"!=i||e.pos(),"right"==i&&e.pos({right:!0}),"bottom"==i&&e.pos({bottom:!0}),"rightbottom"!=i&&"bottomright"!=i||e.pos({right:!0,bottom:!0}),"center"==i&&e.center()}if(t.outline&&setTimeout(function(){e.outline(t.outline.constructor==={}.constructor?t.outline:null),e.stage&&e.stage.update()},20),t.drag&&e.drag(t.drag.constructor==={}.constructor?t.drag:{currentTarget:!0}),t.gesture&&e.gesture(t.gesture.constructor==={}.constructor?t.gesture:null),t.transform&&setTimeout(function(){e.transform(t.transform.constructor==={}.constructor?t.transform:null)},20),t.animate)for(Array.isArray(t.animate)||(t.animate=[t.animate]),n=0;n<t.animate.length;n++)!function(){var i=t.animate[n];i.constructor==={}.constructor&&setTimeout(function(){e.animate(i)},20)}();if(t.wiggle)for(Array.isArray(t.wiggle)||(t.wiggle=[t.wiggle]),n=0;n<t.wiggle.length;n++)!function(){var i=t.wiggle[n];i.constructor==={}.constructor&&setTimeout(function(){e.wiggle(i)},20)}();t.expand&&e.expand(!0===t.expand?null:t.expand)}};a.ANIMATE=!0,a.OPTIMIZE=!1,a.ACTIONEVENT="mousedown",a.KEYFOCUS=null,a.POSREG=!1,a.DRAGALL=!1,a.Ticker={stages:null,myUpdate:null,alwaysList:new a.Dictionary,list:new a.Dictionary,setFPS:function(e,t){c(e)&&c(t)?(e=30,t=60):c(e)?e=30:c(t)&&(t=e),a.Ticker.framerate=createjs.Ticker.framerate=a.mobile()?e:t},setTimingMode:function(e){createjs.Ticker.timingMode=createjs.Ticker.RAF,"synched"==e&&(createjs.Ticker.timingMode=createjs.Ticker.RAF_SYNCHED),"timeout"==e&&(createjs.Ticker.timingMode=createjs.Ticker.TIMEOUT)},add:function(e,n){C("30");var o=a.Ticker;return o.has(e,n)?e:(o.framerate||o.setFPS(),!c(n)&&n.update||(n=t.stage),c(e)||"function"!=typeof e?void i("zim.Ticker.add() - only add functions"):(o.ticker||(o.ticker=createjs.Ticker.on("tick",o.call)),o.list.at(n)?o.list.at(n).push(e):o.list.add(n,[e]),e))},rawID:{},raw:function(e){C("30");var t=a.makeID(7,"letters");return function n(i){e(i),a.Ticker.rawID[t]=requestAnimationFrame(n)}(),t},removeRaw:function(e){cancelAnimationFrame(a.Ticker.rawID[e]),delete a.Ticker.rawID[e]},call:function(t){for(var n,i,o=a.Ticker,r=0;r<o.list.length;r++){n=o.list.objects[r],i=o.list.values[r];for(var s=0;s<i.length;s++)i[s](t);o.alwaysList.at(n)?n.update():0<i.length&&(!c(o.update)||a.OPTIMIZE||!e&&OPTIMIZE?o.update&&n.update():n.update())}if(0==o.list.length)for(r=0;r<o.alwaysList.length;r++)null==o.list[n=o.alwaysList.objects[r]]&&n.update()},always:function(e){C("30");var n=a.Ticker;n.framerate||n.setFPS(),!c(e)&&e.update||(e=t.stage),n.alwaysList.add(e,!0),n.ticker||(n.ticker=createjs.Ticker.on("tick",n.call))},alwaysOff:function(e){var n=a.Ticker;!c(e)&&e.update||(e=t.stage),n.alwaysList.remove(e)},remove:function(e){var t=a.Ticker;if(c(e)||"function"!=typeof e)i("zim.Ticker - only remove functions");else{for(var n=0,o=0;o<t.list.length;o++){var r=t.list.values[o].indexOf(e);-1<r&&t.list.values[o].splice(r,1),n+=t.list.values[o].length}0<t.alwaysList.length||0==n&&(createjs.Ticker.off("tick",t.ticker),t.ticker=null)}},removeAll:function(e){for(var t,n=a.Ticker,i=0,o=0;o<n.list.length;o++)t=n.list.objects[o],!c(e)&&e!==t||(n.list.values[o]=[]),i+=n.list.values[o].length;0<n.alwaysList.length||0==i&&(createjs.Ticker.off("tick",n.ticker),n.ticker=null)},has:function(e,n){return!c(n)&&n.update||(n=t.stage),a.Ticker.list&&a.Ticker.list.at(n)&&0<=a.Ticker.list.at(n).indexOf(e)},dispose:function(e){for(var t,n=a.Ticker,i=0,o=n.list.length-1;0<=o;o--)t=n.list.objects[o],c(e)||e===t?(n.list.remove(e),n.alwaysList.remove(e)):i+=n.list.values[o].length;if(!(0<n.alwaysList.length))return 0==i&&(createjs.Ticker.off("tick",n.ticker),n.ticker=null),!0}},Object.defineProperty(a.Ticker,"update",{get:function(){return a.Ticker.myUpdate},set:function(e){var t=a.Ticker;"boolean"!=typeof e&&(e=null),t.myUpdate=e,!1===t.myUpdate&&(cancelAnimationFrame(t.ticker),t.alwaysList=new a.Dictionary)}}),a.Pages=function(e,n,o,r,s,l,u,h){var d;if(d=m(a.Pages,arguments,"pages, transition, speed, transitionTable, holder, style, group, inherit",this))return d;C("71"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pages",this.group=u;var p=!1===l?{}:a.getStyle(this.type,this.group,h);if(c(e)&&(e=null!=p.pages?p.pages:[]),this.pages=e,c(n)&&(n=null!=p.transition?p.transition:"none"),c(o)&&(o=null!=p.speed?p.speed:200),c(r)&&(r=null!=p.transitionTable?p.transitionTable:[]),this.transitionTable=r,c(s)&&(s=null!=p.holder?p.holder:null),c(s)&&t&&(s=t.stage),s.getBounds&&s.getBounds()){this.speed=o,this.active=!0;var f=this;f.transitioning=!1;var g,y,b=s.getBounds().width,v=s.getBounds().height;"none"==n&&r==[]||M();for(var w,x,k=["left","right","up","down"],T=0;T<e.length;T++)(w=e[T]).constructor!=={}.constructor&&(w=e[T]={page:e[T]}),B(w.page,w.swipe);var O,A=this.page=e[0]?e[0].page:null;c(this.page)||(this.index=0),this.addChild(A),z(A),this.swipe=new a.Swipe(s);var S=!1,I=this.swipe.on("swipe",function(e){if(f.active){var t=e.currentTarget.direction;if("none"!=t){var n="";"left"==t?n="right":"right"==t?n="left":"up"==t?n="down":"down"==t&&(n="up");var i=k.indexOf(t=n);O=[x=A.zimSwipeArray[i],t,null,null,!0],f.page=A,f.nextPage=x,f.direction=t,f.dispatchEvent("swipe"),setTimeout(function(){S||f.go(x,t,null,null,!0)},50)}}});this.addPage=function(e,t){B(e,t),f.pages.push({page:e}),A?e.parent&&e.parent.removeChild(e):(A=f.page=e,s.addChild(A))},this.removePage=function(e){j(e),f.currentPage==e&&(f.removeChild(e),s.stage&&s.stage.update()),a.loop(f.pages,function(t,n){t.page!=e&&t!=e||f.pages.splice(n,1)},!0),e.zimSwipeArray=null},this.setSwipeArray=function(e,t){c(t)&&(t=[]);var n={page:e,swipe:t};n.page.zimSwipeArray=n.swipe?n.swipe:[]},this.pause=function(){S=!0},this.unpause=function(){S&&f.go(O[0],O[1],O[2],O[3],O[4])};var E=!0;this.go=function(e,t,i,r,l){if("number"==typeof e){var u=f.pages[e];if(c(u))return;e=u.page}setTimeout(function(){S=!1},200);for(var h=[{x:b},{x:-b},{y:v},{y:-v}],d=[{x:b/2,alpha:0},{x:-b/2,alpha:0},{y:v/2,alpha:0},{y:-v/2,alpha:0}],p=n,m=o,w=0;w<f.transitionTable.length;w++)if(f.transitionTable[w][0]==A&&f.transitionTable[w][1]==e){p=f.transitionTable[w][2],m=f.transitionTable[w][3];break}if(c(i)&&(i=p),c(r)&&(r=m),f.speed=r,f.direction=t,""==e||null==e)f.page=A,f.dispatchEvent("nothing");else if("string"==typeof e)f.page=A,f.dispatchEvent(e);else{if(e==A)return;c(t)&&(t="right");var x=k.indexOf(t);if(!E)return;function C(e){e[0].uncache(),e[1].uncache(),f.transitioning=!1,f.dispatchEvent("pagetransitioned"),f.removeChild(f.lastPage),f.removeChild(g),f.removeChild(y),z(A),E=!0}function T(e){f.removeChild(f.lastPage),a.animate(e.shift(),{alpha:0},f.speed/2,null,C,e)}for(E=!1,e.x=0,e.y=0,e.alpha=e.zimOriginalAlpha,f.transitioning=!0,"slide"==i?(e.x=-(0|h[x].x),e.y=-(0|h[x].y),e.cache(0,0,(b+1)/e.scaleX,(v+1)/e.scaleY),A.cache(0,0,(b+1)/A.scaleX,(v+1)/A.scaleY),s.addChild(e),s.addChild(A),a.animate(A,h[x],f.speed,null,C,[A,e]),a.animate(e,[{x:0},{x:0},{y:0},{y:0}][x],f.speed)):"reveal"==i?(e.cache(0,0,(b+1)/e.scaleX,(v+1)/e.scaleY),A.cache(0,0,(b+1)/A.scaleX,(v+1)/A.scaleY),s.addChild(e),s.addChild(A),a.animate(A,d[x],f.speed,null,C,[A,e])):"fade"==i?(e.cache(0,0,(b+1)/e.scaleX,(v+1)/e.scaleY),A.cache(0,0,(b+1)/A.scaleX,(v+1)/A.scaleY),e.alpha=1,s.addChild(e),s.addChild(A),a.animate(A,{alpha:0},f.speed,null,C,[A,e])):"black"==i?(e.cache(0,0,(b+1)/e.scaleX,(v+1)/e.scaleY),A.cache(0,0,(b+1)/A.scaleX,(v+1)/A.scaleY),e.alpha=1,s.addChild(e),s.addChild(A),g.alpha=0,s.addChild(g),a.animate(g,{alpha:1},f.speed/2,null,T,[g,A,e])):"clear"==i?(e.cache(0,0,(b+1)/e.scaleX,(v+1)/e.scaleY),A.cache(0,0,(b+1)/A.scaleX,(v+1)/A.scaleY),e.alpha=0,s.addChild(e),s.addChild(A),a.animate(A,{alpha:0},f.speed/2),a.animate(e,{alpha:1},f.speed/2,null,C,[A,e],f.speed/2)):"white"==i?(e.cache(0,0,(b+1)/e.scaleX,(v+1)/e.scaleY),A.cache(0,0,(b+1)/A.scaleX,(v+1)/A.scaleY),e.alpha=1,s.addChild(e),s.addChild(A),y.alpha=0,s.addChild(y),a.animate(y,{alpha:1},f.speed/2,null,T,[y,A,e])):(f.transitioning=!1,s.addChild(e),f.removeChild(A),E=!0),j(A),f.lastPage=A,f.page=e,f.index=-1,w=0;w<f.pages.length;w++)f.pages[w].page==f.page&&(f.index=w);"none"==i&&z(e),c(l)&&(l=!1),f.fromSwipe=l,f.dispatchEvent("page"),A=e,s.stage&&s.stage.update()}},this.resize=function(){b=s.getBounds().width,v=s.getBounds().height,"none"==n&&r==[]||M()},this.puff=function(t){for(var n=0;n<e.length;n++)s.addChild(e[n].page);s.addChild(A),0<t&&setTimeout(function(){f.settle()},t)},this.settle=function(){s.removeAllChildren(),s.addChild(A),f.dispatchEvent("puffed")},this.disable=function(){f.active=!1},!(this.enable=function(){f.active=!0})!==l&&P(this,p),this.dispose=function(){return f.swipe.off("swipe",I),this.zimContainer_dispose(),!0}}else i("zim controls - Pages():\nholder object must have bounds set");function M(){(g=new createjs.Shape).graphics.f("black").r(0,0,b,v+1),(y=new createjs.Shape).graphics.f("white").r(0,0,b,v+1)}function B(e,t){e.zimHTMLList=new a.Dictionary,j(e),e.zimSwipeArray=t||[],e.zimOriginalAlpha=e.alpha,e.parent&&e.parent.removeChild(w.page)}function z(e){if(!c(e))for(var t=0;t<e.zimHTMLList.length;t++)e.addChildAt(e.zimHTMLList.values[t].obj,e.zimHTMLList.values[t].depth)}function j(e){e.zimHTMLList.clear();for(var t=0;t<e.numChildren;t++)if(ch=e.getChildAt(t),"TextArea"==ch.type||"Loader"==ch.type||"Tag"==ch.type){var n={obj:ch,depth:e.getChildIndex(ch)};e.zimHTMLList.add(ch,n)}for(t=e.numChildren-1;0<=t;t--)ch=e.getChildAt(t),"TextArea"!=ch.type&&"Loader"!=ch.type&&"Tag"!=ch.type||e.removeChild(ch)}},a.extend(a.Pages,a.Container,["clone","dispose"],"zimContainer",!1),a.HotSpots=function(t,n,o){var r;if(r=m(a.HotSpots,arguments,"spots, local, mouseDowns",this))return r;if(C("72"),this.zimContainer_constructor(null,null,null,null,!1),this.type="HotSpots",!c(t)&&Array.isArray(t)){c(n)&&(n=!0),c(o)&&(o=!1);for(var s,l,u=(e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",h=this.hotSpots=[],d=0;d<t.length;d++)p(t[d]);this.addHotSpot=function(e,n,i,o,r,a){t.push(s={page:e,rect:n,call:i,callOver:o,callOut:r,talk:a}),p(s)},this.show=function(){for(var e=0;e<h.length;e++)(l=h[e]).button||(l.spot.alpha=.2)},this.hide=function(){for(var e=0;e<h.length;e++)(l=h[e]).spot.alpha=0},this.removeHotSpots=function(e,n){for(var i=t.length-1;0<=i;i--)s=t[i],l=h[i],n&&!Array.isArray(n)&&(n=[n.x,n.y,n.getBounds().width,n.getBounds().height]),(c(e)&&c(n)||c(n)&&e==s.page||c(e)&&a.arraysEqual(n,s.rect)||e==s.page&&a.arraysEqual(n,s.rect))&&(t.splice(i,1),l.button&&(l.button.off(u,l.button.zimHSEvent),l.button.zimHSEvent=null,o||(l.button.off("mousedown",l.button.zimHSMDEvent),l.button.zimHSMDEvent=null)),l.off(u,f),l.dispose(),h.splice(i,1))},this.dispose=function(){for(var e=0;e<h.length;e++)(l=h[e]).button&&(l.button.off(u,l.button.zimHSEvent),l.button.zimHSCall=null,l.button.zimHSEvent=null,o||(l.button.off("mousedown",l.button.zimHSMDEvent),l.button.zimHSMDEvent=null)),l.off(u,f),l.dispose();return!0}}else i("zim controls - HotSpots():\nplease provide an array of HotSpot data");function p(e){var t=null;if(!Array.isArray(e.rect)){if(!(t=e.rect))return void i("zim controls - HotSpots(): HotSpot "+e.page+" "+e.rect+" button does not exist");e.rect=[t.x,t.y,t.width,t.height]}(l=new a.HotSpot(e.page,e.rect[0],e.rect[1],e.rect[2],e.rect[3],e.call,e.callOver,e.callOut,n,e.talk)).zimHSpage=e.page,l.button=t,h.push(l),l.on(u,f),t&&c(e.callOver)&&c(e.callOut)&&(l.spot.mouseEnabled=!1,l.spot.mouseChildren=!1,t.zimHScall=e.call,t.zimHSEvent=t.on(u,f,!0),o||(t.zimHSMDEvent=t.on("mousedown",function(e){e.stopImmediatePropagation()})),t.cursor="pointer")}function f(e){e.stopImmediatePropagation&&e.stopImmediatePropagation(),window.event&&(window.event.cancelBubble=!0),"function"==typeof e.currentTarget.zimHScall&&e.currentTarget.zimHScall(e)}},a.extend(a.HotSpots,a.Container,"clone","zimContainer",!1),a.HotSpot=function(t,n,o,r,s,l,u,h,d,p){var f;if(f=m(a.HotSpot,arguments,"obj, x, y, width, height, call, callOver, callOut, local, talk",this))return f;if(C("73"),this.zimContainer_constructor(null,null,null,null,!1),this.type="HotSpot",!c(t)&&t.addChild)if(t instanceof createjs.Container!=0)if(c(n)||c(o)||c(r)||c(s))i("zim controls - HotSpot():\nPlease pass in x, y, width, height");else{c(d)&&(d=!0),eventType=(e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click";var g=r,y=s;if(d)b=new a.Point(n,o),w=r,x=s;else var b=t.globalToLocal(n,o),v=t.globalToLocal(n+g,o+y),w=v.x-b.x,x=v.y-b.y;var k=new a.Shape(r,s);if(k.talk=c(p)?"HotSpot":p,k.alpha=0,k.graphics.f("black").dr(0,0,w,x),k.x=b.x,k.y=b.y,k.cursor="pointer",k.expand(0),this.spot=k,"function"==typeof l)var T=k.on(eventType,function(e){l(e)});if("function"==typeof u)var P=k.on("mouseover",function(e){u(e)});if("function"==typeof h)var O=k.on("mouseout",function(e){h(e)});t.addChild(k),this.show=function(){t.addChild(backing)},this.hide=function(){t.removeChild(backing)},this.dispose=function(){return T&&k.off(eventType,P),P&&k.off("mouseover",P),O&&k.off("mouseout",O),t.removeChild(k),!(k=null)}}else i("zim controls - HotSpot():\nObjects passed in should be Containers");else i("zim controls - HotSpot():\nPlease pass in container object for obj")},a.extend(a.HotSpot,a.Container,"clone","zimContainer",!1),a.Guide=function(e,n,o,r,s,l,u,h){var d;if(d=m(a.Guide,arguments,"obj, vertical, percent, hideKey, pixelKey, style, group, inherit",this))return d;C("76"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Guide",this.group=u;var p=!1===l?{}:a.getStyle(this.type,this.group,h);if(c(e)&&(size=null!=p.obj?p.obj:null),c(e)&&(e=t?t.stage:"stage"),c(n)&&(n=null==p.vertical||p.vertical),"stage"==e||e.addChild&&e.getBounds&&e.getBounds()){c(o)&&(o=null==p.percent||p.percent),c(r)&&(r=null!=p.hideKey?p.hideKey:"G"),c(s)&&(s=null!=p.pixelKey?p.pixelKey:"P");var f,g,y,b,v,w=this,x=80,k=26,T=x/6+x/2,O=2*k;n?((b=j("#00c5af","white","white")).shape.regX=x+x/6,b.shape.regY=k/2,b.label.x=-x/2-x/6):((b=j("#d61fa0","white","white")).shape.regX=x/2,b.shape.regY=k+k/4,b.label.y=3*-k/4),"stage"!=e&&e.addChild(w);var A,S,I,E,M=a.added(w,function(){"stage"==e?e=v=w.stage:v=e.stage,e.addChild(w),A=e.getBounds().width,S=e.getBounds().height,n?(b.y=S/2,b.label.text="x:"+(w.percent?"70%":Math.round(70*A/100))):(b.x=A/2,b.label.text="y:"+(w.percent?"70%":Math.round(70*S/100))),I=new createjs.Shape,w.addChild(I),n?I.x=.7*A:I.y=.7*S,B||(e.addChild(w),D()),v.off("stagemousemove",f),f=v.on("stagemousemove",_),v.update()}),B=!1,z={x:0,y:0};Object.defineProperty(this,"pixels",{get:function(){return!o},set:function(e){o=!e,w.resize()}}),window.addEventListener("keydown",L),this.toggled=!0,this.toggle=function(e){return!0===e?w.visible=w.toggled=!0:!1===e?w.visible=w.toggled=!1:(w.visible=!w.visible,w.toggled=w.visible),v.off("stagemousemove",f),w.visible&&(f=v.on("stagemousemove",_,w)),w},!(this.resize=function(){return!!w&&(v&&(D(),_()),!0)})!==l&&P(this,p),this.dispose=function(){return!(!w||(a.noDrag(I),clearInterval(M),w.removeAllChildren(),window.removeEventListener("keydown",L),w.parent&&w.parent.removeChild(w),w=null))}}else i("zim controls - Guide(): Please provide container with bounds for the obj (setBounds())");function j(e,t,n){var i=new a.Container({style:!1});return i.shape=new createjs.Shape,i.shape.graphics.s(t).ss(1).f(e).r(0,0,x,k),i.shape.alpha=.9,i.addChild(i.shape),i.label=new createjs.Text("10","16px arial",n),i.label.textAlign="center",i.label.textBaseline="middle",i.addChild(i.label),i.mouseChildren=!1,i.mouseEnabled=!1,i}function _(t){var i,r;t?(i=e.globalToLocal(t.rawX/v.scaleX,t.rawY/v.scaleY),z=i):i={x:z.x,y:z.y},o?n?(r=Math.round(Math.abs(i.x-I.x)/A*100),b.label.text="x:"+Math.max(0,Math.min(r,100))+"%",b.y=Math.max(O,Math.min(i.y,y))):(r=Math.round(Math.abs(i.y-I.y)/S*100),b.label.text="y:"+Math.max(0,Math.min(r,100))+"%",b.x=Math.max(T,Math.min(i.x,g))):n?(r=Math.round(Math.abs(i.x-I.x)),b.label.text="x:"+Math.max(0,Math.min(r,Math.round(A))),b.y=Math.max(O,Math.min(i.y,y))):(r=Math.round(Math.abs(i.y-I.y)),b.label.text="y:"+Math.max(0,Math.min(r,Math.round(S))),b.x=Math.max(T,Math.min(i.x,g))),v&&v.update()}function D(){var t;B=!0,A=e.getBounds().width,S=e.getBounds().height,E=n?(t="ew-resize",new createjs.Rectangle(0,0,A,0)):(t="ns-resize",new createjs.Rectangle(0,0,0,S)),a.noDrag(I),setTimeout(function(){a.drag(I,E,t,t,null,null,!0)},500),v.mouseMoveOutside=!0,v.enableMouseOver(10),g=A-2*x/3,y=S-k-k,I.uncache();var i=I.graphics;n?(i.c().s("rgba(0,255,255,.1)").ss(20).mt(0,0).lt(0,S),i.f().s("white").ss(2).mt(0,0).lt(0,S),i.s("#00c5af").sd([20,20]).mt(0,0).lt(0,S).sd(),I.cache(-10,0,20,S)):(i.c().s("rgba(255,0,255,.1)").ss(20).mt(0,0).lt(A,0),i.f().s("white").ss(2).mt(0,0).lt(A,0),i.s("#d61fa0").sd([20,20]).mt(0,0).lt(A,0).sd(),I.cache(0,-10,A,20)),n?b.x=A:b.y=S,w.addChild(b)}function L(e){e||(e=event),v&&(String.fromCharCode(e.keyCode)==r.toUpperCase()&&w.toggle(),String.fromCharCode(e.keyCode)==s.toUpperCase()&&(w.pixels=!w.pixels))}},a.extend(a.Guide,a.Container,"clone","zimContainer",!1),a.Grid=function(e,n,o,r,s,l,u,h){var d;if(d=m(a.Grid,arguments,"obj, color, percent, hideKey, pixelKey, style, group, inherit",this))return d;C("78"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Grid",this.group=u;var p=!1===l?{}:a.getStyle(this.type,this.group,h);if(c(e)&&(size=null!=p.obj?p.obj:null),c(e)&&(e=t?t.stage:"stage"),c(n)&&(n=null!=p.color?p.color:"black"),"stage"==e||e.addChild&&e.getBounds&&e.getBounds()){c(o)&&(o=null==p.percent||p.percent),c(r)&&(r=null!=p.hideKey?p.hideKey:"G"),c(s)&&(s=null!=p.pixelKey?p.pixelKey:"P");var f,g=this,y=10;this.mouseChildren=!1,this.mouseEnabled=!1;var b=80,v=26,w=_("#dddddd",n,"#333333");w.shape.regX=b/2,w.shape.regY=-v/4,w.label.y=3*v/4;var x=_("#dddddd",n,"#333333");x.shape.regX=-b/6,x.shape.regY=v/2,x.label.x=b/2+b/6;var k,T,O,A=b/6+b/2,S=2*v;w.x=A,x.y=S,w.label.text="x:0",x.label.text="y:0","stage"!=e&&e.addChild(g);var I,E,M,B=a.added(g,function(){"stage"==e?e=O=g.stage:O=e.stage,z||(L(),e.addChild(g)),O.off("stagemousemove",f),f=O.on("stagemousemove",D),O.update()}),z=!1,j={x:0,y:0};Object.defineProperty(this,"pixels",{get:function(){return!o},set:function(e){o=!e,g.resize()}}),window.addEventListener("keydown",Y),this.toggled=!0,this.toggle=function(e){return!0===e?g.visible=g.toggled=!0:!1===e?g.visible=g.toggled=!1:(g.visible=!g.visible,g.toggled=g.visible),O.off("stagemousemove",f),g.visible&&(f=O.on("stagemousemove",D,g)),g},!(this.resize=function(){return!!g&&(g.removeChild(M),M=null,O&&(L(),D(),setTimeout(function(){g.removeChild(M),M=null,L()},200)),!0)})!==l&&P(this,p),this.dispose=function(){return clearInterval(B),g.removeAllChildren(),window.removeEventListener("keydown",Y),g.parent&&g.parent.removeChild(g),!(g=null)}}else i("zim controls - Grid(): Please provide container with bounds for the obj (setBounds())");function _(e,t,n){var i=new a.Container({style:!1});return i.shape=new createjs.Shape,i.shape.graphics.s(t).ss(1).f(e).r(0,0,b,v),i.shape.alpha=.9,i.addChild(i.shape),i.label=new createjs.Text("10","16px arial",n),i.label.textAlign="center",i.label.textBaseline="middle",i.addChild(i.label),i.mouseChildren=!1,i.mouseEnabled=!1,i}function D(t){var n;t?(n=e.globalToLocal(t.rawX/O.scaleX,t.rawY/O.scaleY),j=n):n={x:j.x,y:j.y},o?(w.label.text="x:"+Math.max(0,Math.min(Math.round(n.x/I*100),100))+"%",w.x=Math.max(A,Math.min(n.x,k)),x.label.text="y:"+Math.max(0,Math.min(Math.round(n.y/E*100),100))+"%"):(w.label.text="x:"+Math.max(0,Math.min(Math.round(n.x),Math.round(I))),w.x=Math.max(A,Math.min(n.x,k)),x.label.text="y:"+Math.max(0,Math.min(Math.round(n.y),Math.round(E)))),x.y=Math.max(S,Math.min(n.y,T)),O&&O.update()}function L(){z=!0,e&&e.getBounds&&(I=e.getBounds().width,E=e.getBounds().height),O&&(O.mouseMoveOutside=!0,O.enableMouseOver(10)),k=I-2*b/3,T=E-v-v,M=new a.Container({style:!1}),g.addChild(M);var t=new createjs.Shape;M.addChild(t);var i=t.graphics;i.s(n).ss(1);var r=new createjs.Shape;if(M.addChild(r),o){for(s=1;s<22;s++)i.mt(s*I/20,0).lt(s*I/20,E);for(s=1;s<20;s++)i.mt(0,s*E/20).lt(I,s*E/20);for(t.alpha=.3,(i=r.graphics).s(n).ss(1),s=1;s<10;s++)i.mt(s*I/10,0).lt(s*I/10,E);for(s=1;s<10;s++)i.mt(0,s*E/10).lt(I,s*E/10)}else{for(var s=0;s<I/y;s++)i.mt(s*y,0).lt(s*y,E);for(s=0;s<E/y;s++)i.mt(0,s*y).lt(I,s*y);for(t.alpha=.3,(i=r.graphics).s(n).ss(1),s=0;s<I/(10*y);s++)i.mt(s*(10*y),0).lt(s*(10*y),E);for(s=0;s<E/(10*y);s++)i.mt(0,s*(10*y)).lt(I,s*(10*y))}i.s("#FFFFFF").ss(8),i.mt(I/2,E/2-40).lt(I/2,E/2+40),i.mt(I/2-40,E/2).lt(I/2+40,E/2),i.s("#000000").ss(4),i.mt(I/2,E/2-40).lt(I/2,E/2+40),i.mt(I/2-40,E/2).lt(I/2+40,E/2),i.s(n).ss(3),i.dr(0,0,I,E),r.alpha=.5,M.cache(0,0,I,E),g.addChild(w),g.addChild(x),O&&O.update()}function Y(e){e||(e=event),O&&(String.fromCharCode(e.keyCode)==r.toUpperCase()&&g.toggle(),String.fromCharCode(e.keyCode)==s.toUpperCase()&&(g.removeChild(M),M=null,g.pixels=!g.pixels))}},a.extend(a.Grid,a.Container,"clone","zimContainer",!1),a.Tile=function(e,o,r,s,l,u,d,p,f,g,y,b,v,x,k,T,O,A,S,I,E){var M;if(M=m(a.Tile,arguments,"obj, cols, rows, spacingH, spacingV, width, height, squeezeH, squeezeV, colSize, rowSize, align, valign, count, mirrorH, mirrorV, snapToPixel, clone, group, style, inherit",this))return M;C("66.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Tile",this.group=S;var B=!1===I?{}:a.getStyle(this.type,this.group,E);c(e)&&(e=null!=B.obj?B.obj:new a.Circle),c(o)&&(o=null!=B.cols?B.cols:1),c(r)&&(r=null!=B.rows?B.rows:1),c(u)&&(u=null!=B.width?B.width:null),c(d)&&(d=null!=B.height?B.height:null),c(g)&&(g=null!=B.colSize?B.colSize:null),c(y)&&(y=null!=B.rowSize?B.rowSize:null),c(u)||(g=null),c(d)||(y=null),c(s)&&(s=null!=B.spacingH?B.spacingH:null),c(l)&&(l=null!=B.spacingV?B.spacingV:null),!c(s)&&c(g)||(s=0),!c(l)&&c(y)||(l=0),c(p)&&(p=null!=B.squeezeH&&B.squeezeH),c(f)&&(f=null!=B.squeezeV&&B.squeezeV),c(b)&&(b=null!=B.align?B.align:"left"),c(v)&&(v=null!=B.valign?B.valign:"top"),c(x)&&(x=null!=B.count?B.count:null),0==x&&(x=null,n&&i("ZIM Tile() - count parameter of 0 is ignored - see docs")),c(k)&&(k=null!=B.mirrorH&&B.mirrorH),c(T)&&(T=null!=B.mirrorV&&B.mirrorV),c(O)&&(O=null==B.snapToPixel||B.snapToPixel),O&&(e&&e.stage?e.stage.snapToPixelEnabled=!0:"undefined"!=typeof elem&&t&&(t.stage.snapToPixelEnabled=!0)),c(A)&&(A=null==B.clone||B.clone);var z=this;z.cols=o,z.rows=r,z.spacingH=s,z.spacingV=l,z.squeezeH=p,z.squeezeV=f;var j,_="function"==typeof b,D="function"==typeof v;z.align=_?"left":b,z.valign=D?"top":v,z.mirrorH=k,z.mirrorV=T,z.items=[];var L,Y,R,X,W,F,V,N,G,H,K,q,U,Z,J=0;e:for(var $=0;$<r;$++)for(var Q=0;Q<o;Q++){if(J++,!c(x)&&x<J)break e;c(j=a.Pick.choose(e))&&(j=new a.Container(0,0,0,0)),A&&(0==$&&0==Q||(j=j.clone())),z.items.push(j),j.tileNum=J-1}function ee(){z.removeAllChildren(),L=[],Y=[],R=[],X=[],W=[],G=N=V=F=0,H=[],K=[],q=[],Z=[],U=[],z.items&&z.items.length||(z.items=[]),x=z.items.length;for(var e,t=0,n=0,i=0,o=0;o<x;o++)n=Math.floor(o/z.cols),i=o%z.cols,c(L[n])&&(L[n]=[]),c(z.items[o])&&(z.items[o]=new Container(0,0,0,0)),L[n][i]=z.items[o];z.rows=Math.max(1,L.length),z.cols=Math.max(1,c(L[0])?0:L[0].length);e:for(n=0;n<z.rows;n++)for(H.push([]),K.push([]),Z.push([]),y&&c(d)&&(h=a.Pick.choose(y)),o=0;o<z.cols;o++){if(t++,!c(x)&&x<t)break e;(e=L[n][o]).snapToPixel=O,z.addChild(e),H[n].push(e.scaleX),K[n].push(e.scaleY),0==n&&g&&c(u)&&(w=a.Pick.choose(g)),0==n&&U.push(a.Pick.choose(b)),g&&c(u)||(w=Math.abs(e.width)),y&&c(d)||(h=Math.abs(e.height)),Z[n][o]=[w,h],c(X[o])&&(X[o]=0),c(W[n])&&(W[n]=0),w>X[o]&&(X[o]=w),h>W[n]&&(W[n]=h),c(Y[n])&&(Y[n]=0),c(R[o])&&(R[o]=0),Y[n]+=w,R[o]+=h,Y[n]>F&&(F=Y[n]),R[o]>V&&(V=R[o]),c(q[o])&&(q[o]=0),q[o]++}!1===z.squeezeH&&a.loop(X,function(e){N+=e}),!1===z.squeezeV&&a.loop(W,function(e){G+=e})}function te(e,t){var n,i,o,r;e<=0&&(e=null),t<=0&&(t=null),n=c(e)||"full"!=z.squeezeH?c(e)?0<N?N+(z.cols-1)*z.spacingH:F+(z.cols-1)*z.spacingH:Math.max(F+(z.cols-1)*z.spacingH,e):e,i=c(t)||"full"!=z.squeezeV?c(t)?0<G?G+(z.rows-1)*z.spacingV:V+(z.rows-1)*z.spacingV:Math.max(V+(z.rows-1)*z.spacingV,t):t,z.setBounds(0,0,n,i);var s=[],l=[],u=[];for($=0;$<L.length;$++)for(o=L[$],r=0,c(e),Q=0;Q<o.length;Q++){var h,d;j=o[Q],0==$&&(s[Q]=0,c(t)||(l[Q]="full"==z.squeezeV?1<q[Q]?(t-R[Q])/(q[Q]-1):0:z.squeezeV?1<q[Q]?Math.max(z.spacingV,(t-R[Q])/(q[Q]-1)):0:1<q[Q]?Math.max(z.spacingV,(i-R[Q])/(q[Q]-1)):0),u[Q]=z.squeezeV?"center"==z.valign||"middle"==z.valign?(i-(R[Q]+(q[Q]-1)*(c(t)?z.spacingV:l[Q])))/2:"bottom"==z.valign?i-(R[Q]+(q[Q]-1)*(c(t)?z.spacingV:l[Q])):0:0),j.getBounds(),0==Q&&(c(e)||(d="full"==z.squeezeH?1<o.length?(e-Y[$])/(o.length-1):0:z.squeezeH?1<o.length?Math.max(z.spacingH,(e-Y[$])/(o.length-1)):0:1<o.length?Math.max(z.spacingH,(n-Y[$])/(o.length-1)):0),h=z.squeezeH?"center"==z.align||"middle"==z.align?(n-(Y[$]+(o.length-1)*(c(e)?z.spacingH:d)))/2:"right"==z.align?n-(Y[$]+(o.length-1)*(c(e)?z.spacingH:d)):0:0,finalVAlign=a.Pick.choose(v)),b=U[Q];var p=Z[$][Q][0],f=Z[$][Q][1];z.mirrorH&&Q%2==1&&(j.scaleX=-H[$][Q]),j.pos(r,null),!z.squeezeH&&_?!c(e)||"center"!=b&&"middle"!=b?c(e)&&"right"==b&&(j.x+=X[Q]-j.width):j.x+=(X[Q]-j.width)/2:z.squeezeH?!c(e)||"center"!=z.align&&"middle"!=z.align?c(e)&&"right"==z.align&&(j.x+=p-j.width):j.x+=(p-j.width)/2:!c(e)||"center"!=z.align&&"middle"!=z.align?c(e)&&"right"==z.align&&(j.x+=X[Q]-j.width):j.x+=(X[Q]-j.width)/2,z.mirrorV&&$%2==1&&(j.scaleY=-K[$][Q]),j.pos(null,s[Q]),!z.squeezeV&&D?!c(t)||"center"!=finalVAlign&&"middle"!=finalVAlign?c(t)&&"bottom"==finalVAlign&&(j.y+=W[$]-j.height):j.y+=(W[$]-j.height)/2:z.squeezeV?!c(t)||"center"!=z.valign&&"middle"!=z.valign?c(t)&&"bottom"==z.valign&&(j.y+=f-j.height):j.y+=(f-j.height)/2:!c(t)||"center"!=z.valign&&"middle"!=z.valign?c(t)&&"bottom"==z.valign&&(j.y+=W[$]-j.height):j.y+=(W[$]-j.height)/2,!0!==z.squeezeH&&c(e)?r+=X[Q]+(c(e)?z.spacingH:d):r+=p+(c(e)?z.spacingH:d),j.x+=h,j.y+=u[Q],!0!==z.squeezeV&&c(t)?s[Q]+=W[$]+(c(t)?z.spacingV:l[Q]):s[Q]+=f+(c(t)?z.spacingV:l[Q])}}ee(),te(u,d),this.remake=function(e){return c(e)||(z.items=e),ee(),te(u,d),z},!(this.resize=function(e,t){return c(e)&&(e=u),c(t)&&(t=d),te(u=e,d=t),z})!==I&&P(this,B),this.clone=function(){return z.cloneProps(new a.Tile(e.clone?e.clone():e,z.cols,z.rows,z.spacingH,z.spacingV,u,d,z.squeezeH,z.squeezeV,g,y,b,v,z.items.length,z.mirrorH,z.mirrorV,O,this.style,this.group))}},a.extend(a.Tile,a.Container,"clone","zimContainer",!1),a.Layout=function(e,t,n,o,r,s,l,u,h,d,p){var f;if(f=m(a.Layout,arguments,"holder, regions, lastMargin, backgroundColor, vertical, regionShape, scalingObject, hideKey, style, group, inherit",this))return f;C("80"),this.cjsEventDispatcher_constructor(),this.type="Layout",this.group=d;var g=!1===h?{}:a.getStyle(this.type,this.group,p);if(c(e)&&(e=null!=g.holder?g.holder:null),c(l)&&(l=null!=g.scalingObject?g.scalingObject:null),!c(e)&&e.getBounds)if((l=c(l)?e:l).getBounds&&l.getBounds()){var y=l.getBounds();e.setBounds(0,0,y.width,y.height),c(n)&&(n=null!=g.lastMargin?g.lastMargin:0),c(r)&&(r=null==g.vertical||g.vertical),c(o)&&(o=null!=g.backgroundColor?g.backgroundColor:""),c(u)&&(u=null!=g.hideKey?g.hideKey:"B"),c(s)&&(s=null!=g.regionShape?g.regionShape.clone():null);var b=new createjs.Shape,v=this;if(this.active=!0,c(t)&&(t=null!=g.regions?a.copy(g.regions):null),!c(t)){var w;this.regions=t;var x=0,k="minWidth",T="width",O="height",A="marginLeft",S="maxHeight";r&&(k="minHeight",T="height",O="width",A="marginTop",S="maxWidth");for(var I=0;I<t.length;I++){if(!(w=t[I]).object||!w.object.getBounds())return void i("zim controls - Layout(): each region object must have an object with setBounds() set");w[k]||(w[k]=0),w[T]||(w[T]=0),w.backgroundColor||(w.backgroundColor=""),w.given=0,w.maxGiven=0,c(w[A])&&(w[A]=1e-4),w[S]||(w[S]=100),r?(w.align||(w.align="middle"),w.valign||(w.valign=0==I?"top":I==t.length-1?"bottom":"middle",1==t.length&&(w.valign="middle"))):(w.valign||(w.valign="top"),w.align||(w.align=0==I?"left":I==t.length-1?"right":"middle",1==t.length&&(w.align="middle"))),w[T]&&(w[k]=0),x+=w[T]+w[A]}if(100<(x+=n))i("zim controls - Layout(): cannot fit regions into 100% bounds");else{var E=100-x;M(),this.resize=function(){if(v.active){y=l.getBounds(),e.setBounds(0,0,y.width,y.height),b.graphics.clear(),""!=o&&b.graphics.f(o).r(0,0,y.width,y.height);for(var c=0;c<t.length;c++)(w=t[c]).maxGiven=0,w.marginGiven=0;for(var u,h,d=!0,p=E;d;){for(u=!(d=!1),c=0;c<t.length;c++)0<(w=t[c]).given&&0==w.maxGiven&&(I=w.object.getBounds()[T],B=w.object.getBounds()[O],(h=w[S]*y[O]/100)<B/I*(w.given*y[T]/100)?(w.maxGiven=I/B*h*100/y[T],p-=w.maxGiven):u=!1);if(u)break;for(c=totalPrimaries=0;c<t.length;c++)0==(w=t[c])[T]&&0==w.maxGiven&&(totalPrimaries+=w.object.getBounds()[T]);for(c=0;c<t.length;c++)0==(w=t[c])[T]&&0==w.maxGiven&&(w.given=w.object.getBounds()[T]/totalPrimaries*p)}var f=!0;if(0<(w=t[0]).maxGiven?w.maxGiven<w[k]&&(w[T]=w[k],f=!1):0<w.given&&w.given<w[k]&&(w[T]=w[k],f=!1),0<(w=t[t.length-1]).maxGiven?w.maxGiven<w[k]&&(w[T]=w[k],f=!1):0<w.given&&w.given<w[k]&&(w[T]=w[k],f=!1),!f){for(c=x=0;c<t.length;c++)x+=(w=t[c])[T]+w[A];return 100<(x+=n)?void i("zim display - Layout(): cannot fit regions into 100% bounds"):(E=100-x,M(),void v.resize())}var g=!0,m=0,C=0;for(c=0;c<t.length;c++)m+=(w=t[c])[A],0<w[T]?C+=w[T]:0<w.maxGiven?C+=w.maxGiven:0<w.given&&(C+=w.given),0==w[T]&&(g=!1);if(g||u){var P=100-C-(m+=n);if(m-=n+t[0][A],0!=P&&0!=m)for(c=0;c<t.length;c++)0!=c&&((w=t[c]).marginGiven=w[A]/m*(m+P))}var I,B,z,j,_,D=0,L=0;if(s&&s.graphics){var Y=s.graphics;Y.c()}for(c=0;c<t.length;c++)0<(w=t[c]).marginGiven?D+=w.marginGiven*y[T]/100:D+=w[A]*y[T]/100,I=(I=0<w[T]?w[T]:0<w.maxGiven?w.maxGiven:0<w.given?w.given:0)*y[T]/100,L=(y[O]-(B=w[S]*y[O]/100))/2,z=r?a.fit(w.object,L,D,B,I):a.fit(w.object,D,L,I,B),"top"==w.valign?w.object.y=z.bY:"bottom"==w.valign&&(w.object.y=z.bY+z.bHeight-z.height),"left"==w.align?w.object.x=z.bX:"right"==w.align&&(w.object.x=z.bX+z.bWidth-z.width),s&&s.graphics&&(Y.s("white").ss(2).r(z.bX,z.bY,z.bWidth,z.bHeight),Y.s("#ff8203").sd([20,20]).r(z.bX,z.bY,z.bWidth,z.bHeight).sd()),_=j=0,0!=D&&D+I!=y[T]||(r?_=1:j=1),B==y[O]&&(r?j=1:_=1),""!=w.backgroundColor&&b.graphics.f(w.backgroundColor).r(z.bX,z.bY,z.bWidth+j,z.bHeight+_),D+=I}},this.resize(),s&&e.addChild(s),e.addChildAt(b,0),window.addEventListener("keydown",B),this.disable=function(){v.active=!1,window.removeEventListener("keydown",B),s&&(s.alpha=0)},this.enable=function(){v.active=!0,window.addEventListener("keydown",B),v.resize(),s&&(s.alpha=1)},this.removeShape=function(){s&&(s.graphics.clear(),e.removeChild(s),s=null,s=!1),window.removeEventListener("keydown",B)},this.toggled=!0,this.toggle=function(e){return s.visible=!0===e||!1!==e&&!s.visible,v.toggled=s.visible,v},!(this.addShape=function(t,n){v.removeShape(),s=t,window.addEventListener("keydown",B),e.addChild(s),v.resize()})!==h&&P(this,g),this.dispose=function(){return v.removeShape(),!0}}}}else i("zim controls - Layout(): holder must have bounds set or provide a scalingObject with bounds");else i("zim controls - Layout(): please provide an object with bounds set that holds the objects being laid out");function M(){for(var e=0,n=0;n<t.length;n++)((w=t[n]).given=0)==w[T]&&(e+=w.object.getBounds()[T]);for(n=0;n<t.length;n++)0==(w=t[n])[T]&&(w.given=w.object.getBounds()[T]/e*E)}function B(e){e||(e=event),s&&String.fromCharCode(e.keyCode)==u.toUpperCase()&&(v.toggle(),s.stage&&s.stage.update())}},a.extend(a.Layout,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),a.Accessibility=function(n,i,o,s,l,u,h,d,p,f,g,y,b,v,w){var x;if(x=m(a.Accessibility,arguments,"appName, tabOrder, tabIndex, cycle, decimals, frame, application, alwaysHighlight, AHTime, AHColor, AHBorderWidth, AHBorderPadding, AHAlpha, AHObject, AHObjectScale",this))return x;if(C("30.5"),this.cjsEventDispatcher_constructor(),this.type="Accessibility",c(n)&&(n="application"),c(s)&&(s=!1),c(l)&&(l=2),c(u)&&(u=t),c(h)&&(h=!a.mobile()),c(d)&&(d=!1),c(p)&&(p=700),c(f)&&(f="brown"),c(g)&&(g=3),c(y)&&(y=5),c(b)&&(b=.8),c(w)&&(w=.8),c(v)){var k=new a.Shape({style:!1});k.mouseEnabled=!1}else v.mouseEnabled&&(v.mouseEnabled=!1);var T=u.retina&&window.devicePixelRatio||1,P=this;P.cycle=s,P.decimals=l,P.alwaysHighlight=d,P.AHTime=p,P.AHColor=f,P.AHBorderWidth=g,P.AHBorderPadding=y,P.AHAlpha=b,P.AHObjectScale=w;var O,A,S,I,E,M,B,z,j=-1,_=-1,D=[],L=[],Y={RadioButtons:"option",Tabs:"tab",Pad:"key"},R=u.canvas.id,X=a.mobile(),W=!1,F=null,V=[];function N(e){var t=e.currentTarget.boundsToGlobal(),n=t.x+t.width/2,i=t.y+t.height/2;e.stageX/e.target.stage.scaleX<n-5||e.stageX/e.target.stage.scaleX>n+5||e.stageY/e.target.stage.scaleY<i-5||e.stageY/e.target.stage.scaleY>i+5?K():H()}function G(){I&&(I.innerHTML="")}function H(){var t,n;F=!0,J(),I&&I.setAttribute("aria-hidden",!1),a.ACTIONEVENT="click",e||(ACTIONEVENT="click"),u.stage.removeChild(O),P.alwaysHighlight=!1,u.stage.update();for(var i=0;i<j.length;i++)(n=(t=j[i]).obj.zimTabTag).disabled=!1,t.title=t.title.replace(/\s\(use arrow keys\)/,""),n.setAttribute("aria-label",t.title),n.addEventListener("focus",q)}function K(){F=!1;for(var e=0;e<j.length;e++)j[e].obj.zimTabTag.disabled=!1;J(),d&&function(){for(var e=0;e<D.length;e++){var t=D[e];t.zimObject&&("Loader"==t.zimObject.type||"TextArea"==t.zimObject.type||"Tag"==t.zimObject.type)||(D[e].style.left="-2000px")}}()}function q(e){var t=e.currentTarget,n=t.zimObject;_=n.zimTabIndex,n.focus=!0;var i=new createjs.Event("change");i.title=t.getAttribute("aria-label"),P.dispatchEvent(i)}function U(e){F=!1,e.target.focusTab.focus()}function Z(){c(F)||F?H():K()}function J(){W=!0,A.removeEventListener("focus",Z),S.removeEventListener("focus",Z),E.removeEventListener("focus",U),M.removeEventListener("focus",U),E.parentNode.removeChild(E),M.parentNode.removeChild(M),B.removeEventListener("focus",U),z.removeEventListener("focus",U),B.parentNode.removeChild(B),z.parentNode.removeChild(z);for(var e=0;e<V.length;e++)V[e][0].off("mousedown",V[e][1])}function $(e){var t=e.currentTarget;if("RadioButton"==t.type||"TabsButton"==t.type||"PadButton"==t.type)for(var n=0;n<t.zimTabParent.buttons.length;n++){var i=t.zimTabParent.buttons[n];i.zimTabTag.setAttribute("aria-label",i.zimTabTag.getAttribute("aria-label").split(" - currently")[0]+(t.zimTabParent.selectedIndex==i.tabIndex?" - currently selected.":" - currently not selected."))}P.tabIndex=e.currentTarget.zimTabIndex,P.activatedObject=t}function Q(e){return e.talk?e.talk:"TextArea"==e.type||"RadioButtons"==e.type||"Tabs"==e.type||"Pad"==e.type?e.type:"Waiter"==e.type?"Waiter active - please wait":e.text?e.type+" - "+("a"==e.text||"A"==e.text?"eh":e.text):e.type+("Dial"==e.type||"Slider"==e.type||"ColorPicker"==e.type||"Stepper"==e.type?" (use arrow keys)":"")+("TextArea"==e.type?" (press ENTER to edit)":"")}function ee(e){var t=e.obj;e.title=e.title.replace(/\.$/,""),"RadioButton"==t.type||"TabsButton"==t.type||"PadButton"==t.type?e.title=e.title+(t.tabIndex==t.zimTabParent.selectedIndex?" - currently selected":" - currently not selected"):"CheckBox"==t.type?e.title=e.title+(t.checked?" - currently checked":" - currently not checked"):"Stepper"==t.type?e.title=e.title+" - currently displaying "+t.currentValue:"Slider"==t.type||"Dial"==t.type?e.title=e.title+" - currently at "+a.decimals(t.currentValue,P.decimals):"ColorPicker"==t.type?e.title=e.title+" - currently at "+t.selectedColor:"TextArea"==t.type?e.title=e.title+(""!=t.tag.value?"":" - placeholder: "+t.tag.placeholder):"Indicator"==t.type&&(e.title=e.title+" - currently "+(0<=t.selectedIndex?"at "+(t.selectedIndex+1)+" of "+t.num:"not indicating")),e.title+="."}function te(e,t,n,i,o){var r;if(i&&(p=i.obj),i&&("TextArea"==p.type||"Loader"==p.type))return(r=p.tag).setAttribute("aria-label",t),p&&r.setAttribute("aria-hidden",!p.stage),n.parentNode.insertBefore(r,"before"==o?n:n.nextSibling),r.style.zIndex=-5,r.zimObject=p,i.obj.zimTabTag=r,D.push(r),r;if(!i||"Dial"!=p.type&&"Slider"!=p.type&&"Stepper"!=p.type&&"ColorPicker"!=p.type)r=document.createElement("div"),p&&(r.zimObject=p),r.innerHTML="tag",r.setAttribute("role",h?"application":"button");else{var a,s,l=[];if("Dial"==p.type||"Slider"==p.type)for(var c=p.step<=0?(p.max-p.min)/20:p.step,d=p.min;d<p.max;d+=c)l.push(p.min+d);else"Stepper"==p.type?l=p.stepperArray:"ColorPicker"==p.type&&(l=p.colors);for((r=document.createElement("select")).disabled=!0,r.zimObject=p,r.addEventListener("change",function(e){F&&(e.currentTarget.zimObject.zimTabParent.currentValueEvent=e.target.value,u.stage.update())}),r.size=1,d=0;d<l.length;d++)a=l[d],(s=document.createElement("option")).setAttribute("aria-label",a),s.innerHTML=a,r.add(s),a==p.zimTabParent.currentValue&&s.setAttribute("selected","selected");r.setAttribute("role","button")}if(r.setAttribute("id",e),r.setAttribute("tabindex",0),r.setAttribute("aria-label",t),p&&r.setAttribute("aria-hidden",!p.stage),n.parentNode.insertBefore(r,"before"==o?n:n.nextSibling),r.style.position="absolute",i){var p,f=(p=i.obj).boundsToGlobal();u.retina?(r.style.left=u.x+f.x*u.scale/T+"px",r.style.top=u.y+f.y*u.scale/T+"px",r.style.width=f.width*u.scale/T+"px",r.style.height=f.height*u.scale/T+"px"):(r.style.left=u.x+f.x*u.scale+"px",r.style.top=u.y+f.y*u.scale+"px",r.style.width=f.width*u.scale+"px",r.style.height=f.height*u.scale+"px"),i.obj.zimTabTag=r}else r.style.left="-1000px",r.style.top=u.y+"px";return r.style.overflow="hidden",r.style.zIndex=-5,r.style.fontSize="20px",r.style.color="rgba(0,0,0,.01)",D.push(r),r}Object.defineProperty(this,"tabOrder",{get:function(){return j},set:function(e){A&&A.removeEventListener("focus",G),S&&S.removeEventListener("focus",G);for(var t=0;t<D.length;t++)D[t].parentElement&&(D[t].outerHTML="");var i,o;for(D=[],t=0;t<L.length;t++)(i=j[t])&&L[t][0].off("mousedown",L[t][1]);L=[],j=[];var r=[],a=u.canvas,s=0;for(t=0;t<e.length;t++){if("HotSpots"==(i=e[t]).type&&(e.splice.apply(e,[t,1].concat(i.hotSpots)),i=i.hotSpots[0]),"HotSpot"==i.type&&(i=i.spot),i.constructor=={}.constructor){if(!(o=i.obj)||!o.getStage)continue;i.title||(i.title=Q(o))}else i={obj:o=i,title:Q(i)};if("RadioButtons"==o.type||"Tabs"==o.type||"Pad"==o.type){var l=[];s--;for(var c=0;c<o.buttons.length;c++){s++;var h=o.buttons[c],d={obj:h,title:i.title+" - "+Y[o.type]+": "+("a"==h.text||"A"==h.text?"eh":h.text)};l.push(d),h.zimTabParent=o,h.zimTabParent.zimAccessibility=P,h.zimTabIndex=t+s,h.tabIndex=c,h.zimAccessibility=P,ee(d),a=te(R+"Tab"+(t+s),d.title,a,d),L.push([h,h.on("mousedown",$)]),W||V.push([h,h.on("mousedown",N)])}r=r.concat(l)}else o.zimTabIndex=t+s,o.zimTabParent=o,ee(i),o.zimAccessibility=P,L.push([o,o.on("mousedown",$)]),W||V.push([o,o.on("mousedown",N)]),r.push(i),a=te(R+"Tab"+(t+s),i.title,a,i)}(A=P.startAppTag=te(R+"PrefixTab",n+" start",u.canvas,null,"before")).addEventListener("focus",G),W||(A.addEventListener("focus",Z),(E=te(R+"noAriaTab","",A,null,"before")).setAttribute("aria-hidden",!0),E.focusTab=A,E.addEventListener("focus",U),(B=te(R+"noAriaTab","",A)).setAttribute("aria-hidden",!0),B.focusTab=A,B.addEventListener("focus",U)),a=te(R+"BufferTab","",a),X&&a.setAttribute("aria-hidden",!0),a=S=P.endAppTag=te(R+"SuffixTab",n+" end",a),S.addEventListener("focus",G),W||(S.addEventListener("focus",Z),a=M=te(R+"noAriaTab","",S),M.setAttribute("aria-hidden",!0),M.focusTab=S,M.addEventListener("focus",U),(z=te(R+"noAriaTab","",S,null,"before")).setAttribute("aria-hidden",!0),z.focusTab=S,z.addEventListener("focus",U)),j=r}}),Object.defineProperty(this,"tabIndex",{get:function(){return _},set:function(e){if(_state)if(e<0||e>=j.length)d();else{e!=_&&h();var t=j[e].obj;if(t.stage){if(_=e,t.focus=!0,oe=!(ie=!0),P.changeTitle(t),t.zimTabTag.focus(),setTimeout(function(){t.zimTabTag.focus();var e=new createjs.Event("change");e.title=t.zimTabTag.getAttribute("aria-label"),P.dispatchEvent(e)},150),P.alwaysHighlight&&!F){if(P.AHObject){O=P.AHObject;var n=a.boundsToGlobal(t);P.AHObject.alp(P.AHAlpha).addTo(u.stage,null,!1),P.AHObject.fit(n.x,n.y,n.width,n.height),P.AHObject.sca(P.AHObject.scaleX*P.AHObjectScale),0<P.AHTime&&(ne=setTimeout(function(){u.stage.removeChild(P.AHObject),u.stage.update()},P.AHTime))}else{O=k;var i=t.getBounds(),o=t.localToGlobal(i.x-5,i.y-5),r=t.localToGlobal(i.x+i.width+5,i.y-5),s=t.localToGlobal(i.x+i.width+5,i.y+i.height+5),l=t.localToGlobal(i.x-5,i.y+i.height+5),c=k.graphics;c.clear(),c.s(P.AHColor).ss(P.AHBorderWidth).mt(o.x,o.y).lt(r.x,r.y).lt(s.x,s.y).lt(l.x,l.y).lt(o.x,o.y).cp(),k.alpha=P.AHAlpha,0<P.AHTime&&(ne=setTimeout(function(){u.stage.removeChild(k),u.stage.update()},P.AHTime))}u.stage.addChild(O),u.stage.update()}}else d()}function h(){if(_&&-1<_)j&&j[_]&&(j[_].obj.focus=!1);else for(var e=0;e<j.length;e++)j[e].obj.focus=!1}function d(){h(),ie=!1,P.AHObject&&u.stage.removeChild(P.AHObject),P.alwaysHighlightShape&&u.stage.removeChild(P.alwaysHighlightShape),u.stage.update(),_=-1}}}),Object.defineProperty(this,"aria",{get:function(){return F},set:function(e){(F=e)&&H()}}),c(i)?setTimeout(function(){if(-1==j){j=[];var e=[];a.loop(u.stage,function(t){t.type&&e.push(t)}),P.tabOrder=e,c(o)||(P.tabIndex=o)}},50):(j=[],P.tabOrder=i,c(o)||(P.tabIndex=o));var ne,ie=!1,oe=!0,re=u.on("keydown",function(e){if(9==e.keyCode&&(function(){for(var e=!1,t=0;t<D.length;t++)if(document.activeElement==D[t]){e=!0;break}return!(document.activeElement!=u.canvas&&!e)}()||(ie=!1,-1!=P.tabIndex&&(P.tabIndex=-1)),ie?ae(e):function(e){u.shiftKey||r(R+"PrefixTab")!=document.activeElement&&u.canvas!=document.activeElement?!u.shiftKey||r(R+"SuffixTab")!=document.activeElement&&r(R+"BufferTab")!=document.activeElement||(0<j.length&&(j[0].obj.focus=!0),ie=oe=!0,ae(e)):(0<j.length&&(j[j.length-1].obj.focus=!0),ie=oe=!0,ae(e))}(e)),ie&&0<j.length&&0<=P.tabIndex&&13==e.keyCode){var t=j[P.tabIndex],n=t.obj;if(t&&n.stage){var i=new createjs.Event("mousedown"),o=new createjs.Event("click");i.fromEnter=o.fromEnter=!0,"Pane"==n.type?(n.backdrop.dispatchEvent(i),n.backdrop.dispatchEvent(o)):(n.dispatchEvent(i),n.dispatchEvent(o))}}});function ae(e){e.ctrlKey?se(e.shiftKey?-1:1):(P.tab(e.shiftKey?-1:1),e.preventDefault())}function se(e){ie=!1,r(R+(1==e?"SuffixTab":"PrefixTab")).focus(),u.stage.removeChild(v),u.stage.update(),P.tabIndex=-1}this.tab=function(e){if(clearTimeout(ne),O&&u.stage.removeChild(O),c(e)&&(e=1),0!=j.length)for(var t=0;t<j.length;t++){var n=j[t].obj;if(n.focus){n.focus=!1;var i=t+e,o=(i+1e4*j.length)%j.length,r=j[o];n=r.obj;for(var a=0,s=!1;!n.stage||!(!n.zimTabParent&&(c(n.enabled)||n.enabled)||n.zimTabParent&&(c(n.zimTabParent.enabled)||n.zimTabParent.enabled));)if(o=((i+=e)+100*j.length)%j.length,n=(r=j[o]).obj,++a==j.length){s=!0;break}if(s||!P.cycle&&i!=o&&!oe)return void se(e);oe=!1,P.tabIndex=o;break}}else se(e)};var le=!(this.changeTitle=function(e,t,n){if("number"!=typeof e&&(e=e.zimTabIndex),!c(e))if(n&&c(t))P.tabIndex=e;else{var i=j[e],o=i.obj;c(t)&&(t=o.zimTabTag.getAttribute("aria-label").split(" - currently")[0]),i.title=t,ee(i),o.zimTabTag.setAttribute("aria-label",i.title),n&&(P.tabIndex=e)}});this.talk=function(e){le||((I=te(R+"TalkTab","",S)).setAttribute("role","alert"),le=!0),I.setAttribute("aria-label",e),I.innerHTML=" ",I.innerHTML=e;var t=new createjs.Event("change");t.title=e,P.dispatchEvent(t)},this.resize=function(e){if(c(e)){if(P.alwaysHighlight&&!c(F))return;for(var t=0;t<j.length;t++)i(j[t].obj)}else{if("number"!=typeof e&&(e=e.zimTabIndex),e<0)return;var n=j[e].obj;if(!n.stage&&O&&n==P.currentObject&&(u.stage.removeChild(O),u.stage.update()),P.alwaysHighlight&&!c(F))return;i(n)}function i(e){if("TextArea"!=e.type&&"Loader"!=e.type){var t=e.boundsToGlobal(),n=e.zimTabTag;u.retina?(n.style.left=u.x+t.x*u.scale/T+"px",n.style.top=u.y+t.y*u.scale/T+"px",n.style.width=t.width*u.scale/T+"px",n.style.height=t.height*u.scale/T+"px"):(n.style.left=u.x+t.x*u.scale/T/T+"px",n.style.top=u.y+t.y*u.scale/T/T+"px",n.style.width=t.width*u.scale/T/T+"px",n.style.height=t.height*u.scale/T/T+"px"),n.setAttribute("aria-hidden",!e.stage),n.hidden=!e.stage}else e.resize()}},Object.defineProperty(this,"currentObject",{get:function(){return j[_]&&j[_].obj?j[_].obj:null},set:function(e){for(var t=0;t<j.length;t++)if(j[t].obj==e){P.tabIndex=t;break}}}),_state=!0,Object.defineProperty(this,"enabled",{get:function(){return _state},set:function(e){_state=e}}),this.dispose=function(){P.tabOrder=[];for(var e=0;e<D.length;e++)D[e].parentElement&&(D[e].outerHTML="");P.removeAllEventListeners(),u.off("keydown",re)}},a.extend(a.Accessibility,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),a.Manager=function(e){C("75");var t=this;this.type=e,this.items=[],this.add=function(e){Array.isArray(e)?t.items=t.items.concat(e):t.items.push(e)},this.remove=function(e){if(c(e))t.items=[];else{Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var i=t.items.indexOf(e[n]);-1!=i&&t.items.splice(i,1)}}},this.resize=function(){if(t)for(var e=0;e<t.items.length;e++)t.items[e].resize?t.items[e].resize():t.items.splice(e)},this.toggle=function(e){if(t)for(var n=0;n<t.items.length;n++)t.items[n].toggle?t.items[n].toggle(e):t.items.splice(n)},this.dispose=function(){for(var e=t.items.length-1;0<=e;e--)t.items[e].dispose();return t.items=[],!(t=null)}},a.ResizeManager=function(){C("75.5"),a.Manager.call(this,"ResizeManager")},a.ResizeManager.prototype=new a.Manager,a.ResizeManager.prototype.constructor=a.ResizeManager,a.TransformManager=function(e,t){C("75.7");var r=this;function a(e){!localStorage||e&&!e.pressup||r.savePersist(e)}this.type="TransformManager",this.items=[],this.add=function(e){var t,n;n=Array.isArray(e)?e:[e];for(var i=!1,o=0;o<n.length;o++)0==r.items.length&&0==o&&(i=!0),"Blob"==(t=n[o]).type||"Squiggle"==t.type?(r.persistID||(i?(i=!1,t.controlsVisible=!0,r.currentObject=t):t.controlsVisible=!1),t.on("change",function(e){var t=new createjs.Event("transformed");t.transformObject=e.target,t.transformType=e.controlType,r.dispatchEvent(t)}),t.on("controlsshow",function(e){var t=new createjs.Event("transformshow");r.currentObject=t.transformObject=e.target,r.dispatchEvent(t)}),t.on("controlshide",function(e){var t=new createjs.Event("transformhide");t.transformObject=e.target,r.currentObject=null,r.dispatchEvent(t)}),t.on("update",function(e){var t=new createjs.Event("transformed");t.transformObject=e.target,t.transformType=e.controlType,r.dispatchEvent(t)})):(transObj=t.transformControls,r.persistID||(i&&"Layer"!=t.type?(i=!1,transObj&&transObj.visible&&transObj.show(),r.currentObject=t):transObj&&transObj.hide()),t.on("transformed",function(e){var t=new createjs.Event("transformed");t.transformObject=e.target,t.transformType=e.transformType,r.dispatchEvent(t)}),t.on("transformshow",function(e){var t=new createjs.Event("transformshow");r.currentObject=t.transformObject=e.target,r.dispatchEvent(t)}),t.on("transformhide",function(e){var t=new createjs.Event("transformhide");t.transformObject=e.target,r.currentObject=null,r.dispatchEvent(t)}));r.items=r.items.concat(e)},this.remove=function(e){if(c(e))r.items=[];else{var n;Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++){r.currentObject==(n=e[i])&&(r.currentObject=null),n.transformedEvent&&(n.off("transformed",n.transformedEvent),n.transformedEvent=null),"Blob"==n.type||"Squiggle"==n.type?n.controlsVisible=!1:n.transformControls.remove();var o=r.items.indexOf(n);-1!=o&&r.items.splice(o,1)}t&&r.savePersist()}},this.show=function(e){if(!c(e)){if("Blob"==e.type||"Squiggle"==e.type)e.controlsVisible||(e.controlsVisible=!0);else{var t=e.transformControls;if(!t||t.visible)return;t.show()}r.currentObject=e}},this.hide=function(e){if(!c(e))if(r.currentObject==e&&(r.currentObject=null),"Blob"==e.type||"Squiggle"==e.type)e.controlsVisible&&(e.controlsVisible=!1);else{var t=e.transformControls;if(!t||t.visible)return;t.hide()}},this.hideAll=function(e){for(var t,n,i=0;i<r.items.length;i++)if((n=r.items[i])&&(n.transformControls||n.update)){if(r.items[i]==e)continue;"Blob"==n.type||"Squiggle"==n.type?n.controlsVisible&&(n.controlsVisible=!1):(t=r.items[i].transformControls).visible&&t.hide()}else r.items.splice(i);r.currentObject=null},this.resize=function(){if(r){for(var e,n=0;n<r.items.length;n++)(e=r.items[n])&&(e.transformControls||e.update)?"Blob"==e.type||"Squiggle"==e.type?e.update():e.transformControls.resize():r.items.splice(n);t&&r.savePersist()}},c(e)||r.add(e);var s="TransformManager persist(persistID) - sorry, must provide id";this.persist=function(e){if(c(e)&&n)i(s);else{r.persistID=e;var t,o=0;if(localStorage&&localStorage[e]){var l=r.persistData=JSON.parse(localStorage[e]);if(l.length==r.items.length)for(var u=0;u<r.items.length;u++)l[u].controlsVisible&&(r.currentObject=r.items[u]),!l[u]||"Blob"!=l[u].type&&"Squiggle"!=l[u].type?l[u]&&(c(r.items[u].transformControls)?function(){var e=r.items[u],t=l[u];interval(50,function(n){e.transformControls&&(e.transformControls.setData(t),e.dispatchEvent("persistset"),++o==l.length&&setTimeout(function(){r.dispatchEvent("persistcomplete")},100),n.clear())},20)}():(r.items[u].transformControls.setData(l[u]),function(){var e=r.items[u];timeout(50,function(t){e.dispatchEvent("persistset"),++o==l.length&&setTimeout(function(){r.dispatchEvent("persistcomplete")},100)})}())):(r.items[u].points.length!=l[u].points.length&&(r.items[u].points=l[u].points),r.items[u].setData(l[u]))}for(u=0;u<r.items.length;u++)(t=r.items[u]).transformedEvent||("Blob"==t.type||"Squiggle"==t.type?(t.transformedEvent=t.on("change",a),t.transformedEvent=t.on("update",a),t.transformedEvent=t.on("controlsshow",a),t.transformedEvent=t.on("controlshide",a)):(t.transformedEvent=t.on("transformed",a),t.transformedEvent=t.on("transformshow",a),t.transformedEvent=t.on("transformhide",a)))}},this.savePersist=function(e){for(var t=[],n=0;n<r.items.length;n++)it=r.items[n],"Blob"==it.type||"Squiggle"==it.type?it.recordData&&t.push(it.recordData()):it.transformControls&&it.transformControls.recordData&&t.push(it.transformControls.recordData());r.persistData=t,localStorage[r.persistID]=JSON.stringify(t)},this.clearPersist=function(e){c(e)&&n?i(s):(r.persistData=null,localStorage&&localStorage.removeItem(e))},this.stopPersist=function(){for(var e=0;e<r.items.length;e++)it=r.items[e],it.transformedEvent&&("Blob"==it.type||"Squiggle"==it.type?it.off("change",it.transformedEvent):it.off("transformed",it.transformedEvent),it.transformedEvent=null);r.persistData=null},c(t)||r.persist(t),this.dispose=function(e,t){if(c(e)&&(e=!0),r.removeAllEventListeners(),r.persistID&&e&&r.stopPersist(),t)for(var n=0;n<r.items.length;n++)o=r.items[n],"Blob"==o.type||"Squiggle"==o.type?o.dispose():o.transformControls.dispose()}},a.extend(a.TransformManager,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),a.GuideManager=function(){C("77"),a.Manager.call(this,"GuideManager")},a.GuideManager.prototype=new a.Manager,a.GuideManager.prototype.constructor=a.GuideManager,a.GridManager=function(){C("79"),a.Manager.call(this,"GridManager")},a.GridManager.prototype=new a.Manager,a.GridManager.prototype.constructor=a.GridManager,a.LayoutManager=function(){C("81"),this.type="LayoutManager";var e=this;this.items=[],this.add=function(t){e.items.push(t)},this.resize=function(){for(var t=0;t<e.items.length;t++)e.items[t].resize()},this.disable=function(){for(var t=0;t<e.items.length;t++)e.items[t].disable()},this.enable=function(){for(var t=0;t<e.items.length;t++)e.items[t].enable()},this.dispose=function(){for(var t=0;t<e.items.length;t++)e.items[t].removeShape();return!0}},a.SelectionSet=function(e){C("81.5"),this.type="SelectionSet",c(e)&&(e=[]),this.selections=e,this.clear=function(){this.selections=[]},this.isSelected=function(e){return 0<=this.selections.indexOf(e)},this.add=function(e,t,n,i){if(!(c(e)||(c(t)&&(c(this.selectionManager)||(t=this.selectionManager.multiple)),c(this.selectionManager)||(this.selectionManager.setCurrent(this),!t&&this.selectionManager.multipleSets&&this.selectionManager.clear()),t||this.clear(),0<=this.selections.indexOf(e)))){if(this.selections.push(e),!c(n)){Array.isArray(n)||(n=[n]);for(var o=0;o<=n.length;o++)n[o].add(e,t)}if(!c(i))for(Array.isArray(i)||(i=[i]),o=0;o<=i.length;o++)i[o].remove(e,t)}},this.remove=function(e,t,n,i){if(!c(e)){c(t)&&(c(this.selectionManager)||(t=this.selectionManager.multiple)),c(this.selectionManager)||this.selectionManager.setCurrent(this),t||this.clear();var o=this.selections.indexOf(e);if(c(this.selectionManager)||(this.selectionManager.setCurrent(this),!t&&this.selectionManager.multipleSets&&this.selectionManager.clear()),t||this.clear(),t?0<=o&&this.selections.splice(o,1):this.clear(),!c(n)){Array.isArray(n)||(n=[n]);for(var r=0;r<=n.length;r++)n[r].remove(e,t)}if(!c(i))for(Array.isArray(i)||(i=[i]),r=0;r<=i.length;r++)i[r].add(e,t)}},this.toggle=function(e,t,n,i){this.isSelected(e)?this.remove(e,t,n,i):this.add(e,t,n,i)},this.dispose=function(){return this.clear(),!(this.selections=null)}},a.SelectionManager=function(e,t,n){C("81.6"),this.cjsEventDispatcher_constructor(),this.type="SelectionManager",c(e)&&(e=[]),c(n)&&(n=!0),Array.isArray(e)||(e=[e]),this.sets=e,this.multipleKey=t,this.multipleSets=n,this.multiple=!1;for(var i=this,o=0;o<e.length;o++)e[o].selectionManager=this;this.clear=function(){this.currentSet=null;for(var t=0;t<e.length;t++)e[t].clear()},this.setCurrent=function(t){this.currentSet=t;for(var n=0;n<e.length;n++)e[n]!=t&&(this.multipleSets||e[n].clear())};var r=new createjs.Event("keydown");this.eventRemove=r.remove,this.keydownEvent=window.addEventListener("keydown",function(e){e.remove=i.eventRemove,i.multipleKey&&(i.multiple=e[i.multipleKey+"Key"]),i.ctrlKey=e.ctrlKey,i.shiftKey=e.shiftKey,i.metaKey=e.metaKey,i.dispatchEvent(e),90==e.keyCode&&(i.ctrlKey||i.metaKey)&&i.dispatchEvent("undo")}),this.keyupEvent=window.addEventListener("keyup",function(e){i.multipleKey&&(i.multiple=e[i.multipleKey+"Key"]),i.ctrlKey=e.ctrlKey,i.shiftKey=e.shiftKey,i.metaKey=e.metaKey,e.remove=i.eventRemove,i.dispatchEvent(e)}),this.dispose=function(){window.removeEventListener("keydown",this.keydownEvent),window.removeEventListener("keyup",this.keyupEvent)}},a.extend(a.SelectionManager,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),a.Swipe=function(e,t,n,o){var r;if(r=m(a.Swipe,arguments,"obj, distance, duration, isometric",this))return r;if(C("70"),this.cjsEventDispatcher_constructor(),this.type="Swipe",!c(e)&&e.on){var s,l,u,h,d,p;c(t)&&(t=30),c(n)&&(n=80),this.distance=t,this.duration=n,this.active=!0;var f,g=this;e.on("mousedown",function(t){function n(){var e=new createjs.Event("swipe");if(e.obj=g.obj,e.stageX=t.stageX/f.scaleX,e.stageY=t.stageY/f.scaleY,e.rawX=t.rawX/f.scaleX,e.rawY=t.rawY/f.scaleY,e.swipeX=e.swipeY=0,g.direction="none",o){if(Math.abs(u-s)>g.distance||Math.abs(h-l)>g.distance){var n=180*Math.atan2(h-l,u-s)/Math.PI;270<=(n=(n+360)%360)&&n<360?(e.swipeY=-1,g.direction="up"):0<=n&&n<90?(e.swipeX=1,g.direction="right"):90<=n&&n<180?(e.swipeY=1,g.direction="down"):180<=n&&n<270&&(e.swipeX=-1,g.direction="left")}}else Math.abs(u-s)>Math.abs(h-l)?(u-s>g.distance&&(e.swipeX=1,g.direction="right"),s-u>g.distance&&(e.swipeX=-1,g.direction="left")):(h-l>g.distance&&(e.swipeY=1,g.direction="down"),l-h>g.distance&&(e.swipeY=-1,g.direction="up"));g.dispatchEvent(e)}g.active&&!t.target.zimNoSwipe&&(g.obj=t.target,u=s=t.stageX/(f=t.target.stage).scaleX,h=l=t.stageY/f.scaleY,d=!0,g.dispatchEvent("swipedown"),clearTimeout(p),p=setTimeout(function(){d&&(n(),d=!1)},g.duration),e.on("pressmove",function(e){u=e.stageX/f.scaleX,h=e.stageY/f.scaleY}),e.on("pressup",function(e){d&&(n(),d=!1,clearTimeout(p))}))}),this.disable=function(){g.active=!1},this.enable=function(){g.active=!0}}else i("zim controls - Swipe():\nPlease pass in object")},a.extend(a.Swipe,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),a.Swiper=function(e,t,n,o,r,s,l,u,h,d,p,f){var g;if(g=m(a.Swiper,arguments,"swipeOn, target, property, sensitivity, horizontal, min, max, damp, integer, factor, loop, pauseTime",this))return g;if(C("69.5"),this.cjsEventDispatcher_constructor(),this.type="Swiper",!c(e)&&e.getStage&&e.stage){if(!c(t)){c(o)&&(o=1),c(r)&&(r=!0),c(u)&&(u=.1),c(h)&&(h=!1),c(d)&&(d=1),c(p)&&(p=!1),c(f)&&(f=200);var y,b,v,w,x,k=this,T=e,P=k.desiredValue=t[n];this.target=t,this.property=n,this.sensitivity=o;var O,A=!1;T.canvas?(v=T.on("stagemousedown",function(e){A=!0,B(e),w=T.on("stagemousemove",z),x=T.on("stagemouseup",function(){A=!1,T.off("stagemousemove",w),T.off("stagemouseup",x),k.dispatchEvent("swipeup")})}),O=T):(O=T.stage,j(),v=T.on("mousedown",B),w=T.on("pressmove",z),x=T.on("pressup",function(){A=!1,k.dispatchEvent("swipeup")}));var S=new a.Damp(k.target[k.property],u),I=0,E=null;k.target.swiperTicker=a.Ticker.add(function(){P==I?P!=E&&(k.pauseTimeout&&k.pauseTimeout.clear(),E=P,k.pauseTimeout=a.timeout(f,function(){k.dispatchEvent("swipepause"),k.pauseTimeout=null})):(E=null,I=P,k.pauseTimeout&&k.pauseTimeout.clear()),k.swiperMoving&&(k.target[k.property]=h?Math.round(S.convert(P)):S.convert(P),!A&&!c(s)&&!c(l)&&Math.abs(k.target[k.property]-P)<Math.abs(l-s)/1e3&&(k.swiperMoving=!1,k.target[k.property]=P,k.immediate(k.target[k.property]),k.dispatchEvent("swipestop")))},O),this.immediate=function(e){S.immediate(e),k.target[k.property]=h?Math.round(e):e,k.desiredValue=P=e};var M=!0;Object.defineProperty(k,"enabled",{get:function(){return M},set:function(e){M!=e&&(e?(T.canvas?v=T.on("stagemousedown",v):(v=T.on("mousedown",v),w=T.on("pressmove",w),x=T.on("pressup",x)),k.immediate(k.target[k.property]),k.target.swiperTicker=a.Ticker.add(k.target.swiperTicker,O)):_(),M=Boolean(e))}}),Object.defineProperty(k,"desiredValue",{get:function(){return P},set:function(e){P=e}}),this.dispose=function(){_(),S=null}}}else i("zim.Swiper() - please provide container on stage");function B(e){O=e.target.stage,A=!0,y=r?e.stageX/O.scaleX:e.stageY/O.scaleY,b=k.target[k.property],k.dispatchEvent("swipedown")}function z(e){var t=y-(r?e.stageX/O.scaleX:e.stageY/O.scaleY);if(0<Math.abs(t)&&(k.swiperMoving=!0),P=b-t*k.sensitivity*d,c(s)||c(l)||!p)c(s)||(P=Math.max(P,s)),c(l)||(P=Math.min(P,l));else{var n=P;P=(P+1e4*(l-s)-s)%(l-s)+s,Math.abs(n-P)>.8*Math.abs(l-s)&&(k.immediate(P),y=r?e.stageX/O.scaleX:e.stageY/O.scaleY,b=k.target[k.property])}k.desiredValue=P,k.dispatchEvent("swipemove")}function j(){T.off("mousedown",v),T.off("pressmove",w),T.off("pressup",x)}function _(){T.canvas?(T.off("stagemousedown",v),T.off("stagemousemove",w),T.off("stagemouseup",x)):j(),a.Ticker.remove(k.target.swiperTicker)}},a.extend(a.Swiper,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),a.MotionController=function(e,n,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,P,O,A){var S;if(S=m(a.MotionController,arguments,"target, type, speed, axis, boundary, map, diagonal, damp, flip, rotate, constant, firstPerson, turnSpeed, moveThreshold, stickThreshold, container, localBounds, mouseMoveOutside, mousedownIncludes, minPercentSpeed, maxPercentSpeed, dampKeyup",this))return S;C("69.7"),this.cjsEventDispatcher_constructor(),this.type="MotionController";var I="zim MotionController(): Please pass in a reference to the stage or a container on the stage";if(c(w)){if(!t)return void i(I);F=w=t.stage}else if(c(w.stage)){if(!t)return void i(I);F=t.stage}else F=w.stage;c(e)&&(e=new a.Container(1,1,null,null,!1));var E="Accelerator"==e.type;c(o)&&(o=7),(c(n)||"mousemove"!=n&&"pressmove"!=n&&"keydown"!=n&&"gamebutton"!=n&&"gamestick"!=n&&"swipe"!=n&&"follow"!=n&&"manual"!=n)&&(n="mousedown"),c(r)&&(r=E?"horizontal":"both"),"keydown"==n&&c(l)&&(l=[[65,37],[68,39],[87,38],[83,40]]),"gamebutton"==n&&c(l)&&(l=g?[14,15,a.GamePad.RT,a.GamePad.LT]:[14,15,12,13]),"gamestick"==n&&c(l)&&(l=g?[[0,2],[0,2],[1],[1]]:[0,0,1,1]),"gamestick"==n&&c(l)&&(l=[0,0,1,1]),c(u)&&(u=!0),"horizontal"!=r&&"vertical"!=r||(u=!1),c(h)&&(h="keydown"==n||"gamebutton"==n?1:"pressmove"==n?.2:.1),c(g)&&(g=!1),c(y)&&(y=.4*o),c(b)&&(b=4),c(v)&&(v=.2),c(k)&&(k=!1),F.mouseMoveOutside=k,c(T)&&(T=[]),Array.isArray(T)||(T=[T]),"Pen"!=e.type||e.draggable?T.push(e):T.push(e,e.paper),(e.motionController=this).mousedownIncludes=T,c(A)&&(A=.3);var M=this;M.dampKeyup=A,this.dirX=0,this.dirY=0,this.speed=o,this.turnSpeed=y,this.axis=r,this.target=e,this.moveThreshold=b,this.stickThreshold=v,this.boundary=s;var B,z,j,_=M.speed,D=M.speed,L=0;M.rotation=0,E?(j=!(z=w.getBounds())||"vertical"==r&&!z.height||"vertical"!=r&&!z.width?1e3:"vertical"==r?z.height:z.width,c(P)&&(P=0),c(O)&&(O=100),c(this.target.percentSpeed)&&(this.target.percentSpeed=(O-P)/2),M.x=j/2,M.y=j/2,B=new a.Proportion(0,j,P,O)):(M.x=this.target.x,M.y=this.target.y);var Y,R,X,W,F,V=M.scaleX=e.scaleX,N=(M.scaleY=e.scaleY,!1),G=!1;if("keydown"==n||"gamebutton"==n){for(var H=0;H<4;H++)Array.isArray(l[H])||(l[H]=[l[H]]);var K=[0,0,0,0],q=[],U=["X","X","Y","Y"],Z=[-1,1,-1,1],J={dirX:0,dirY:0};if("keydown"==n)var $=frame.on("keydown",ee);else var Q=(se=M.gamepad=new a.GamePad).on("buttondown",ee);function ee(e){var t,i="keydown"==n?e.keyCode:e.buttonCode;for(H=0;H<4;H++)if(-1<l[H].indexOf(i)){if(u||"both"!=M.axis||(J.dirX=J.dirY=0),J["dir"+U[H]]=Z[H],K[H]=1,0==(t=q.indexOf(H)))return;return 0<t&&q.splice(t,1),void q.unshift(H)}}if(c(f))if("keydown"==n)var te=frame.on("keyup",ie);else var ne=se.on("buttonup",ie);function ie(e){var t,i="keydown"==n?e.keyCode:e.buttonCode;for(H=0;H<4;H++)if(-1<l[H].indexOf(i)){if((K[H]=0)<=(t=q.indexOf(H))&&q.splice(t,1),"both"!=M.axis||u)J["dir"+U[H]]=-K[2*Math.floor(H/2)]+K[2*Math.floor(H/2)+1];else if(0<q.length){J["dir"+U[H]]=0;var o=q[0];J["dir"+U[o]]=Z[o]}else J.dirX=J.dirY=0;return}}var oe={rotation:0,speedX:M.speed,speedY:M.speed},re=a.Ticker.add(function(){if(g)de(J);else{var e=M.speed,t=M.speed;if("both"==M.axis&&0!=J.dirX&&0!=J.dirY){var n=ge(J.dirX,J.dirY);e=n.speedX,t=n.speedY}"horizontal"!=M.axis&&"both"!=M.axis||(M.x+=e*J.dirX),"vertical"!=M.axis&&"both"!=M.axis||(M.y+=t*J.dirY),pe()}},F)}else if("mousedown"==n||"mousemove"==n)Y=F.on("stage"+n,function(e){if(F=e.target.stage,"mousedown"==n){if(Array.isArray(M.mousedownIncludes)||(M.mousedownIncludes=[M.mousedownIncludes]),M.mousedownIncludes.indexOf(w)<0)for(var t=0;t<w.numChildren;t++){var i=w.getChildAt(t);if(-1==M.mousedownIncludes.indexOf(i)&&i.mouseEnabled&&i.hitTestPoint&&i.hitTestPoint(e.stageX/F.scaleX,e.stageY/F.scaleY))return}M.dispatchEvent("mousedown")}var o=w.globalToLocal(k?e.rawX/F.scaleX:e.stageX/F.scaleX,k?e.rawY/F.scaleY:e.stageY/F.scaleY);M.x=o.x,M.y=o.y,pe()});else if("pressmove"==n||"follow"==n){function ae(){var t=w.globalToLocal(M.moveX,M.moveY);M.x=t.x,M.y=t.y,pe(),"Pen"==e.type&&!G&&e.drawing&&(G=!0)}"Pen"==e.type&&(e.write=!1),Y=F.on("stagemousedown",function(t){G=!1,Array.isArray(M.mousedownIncludes)||(M.mousedownIncludes=[M.mousedownIncludes]);var i,o=!1;M.mouseDownIncludes&&(i=F.getObjectUnderPoint(t.stageX,t.stageY));for(var r=0;r<M.mousedownIncludes.length;r++)i&&M.mousedownIncludes[r].hitTestPoint&&M.mousedownIncludes[r].hitTestPoint(t.stageX,t.stageY)&&M.mousedownIncludes[r].contains(i)&&(o=!0);if(!o)for(r=0;r<w.numChildren;r++){var s=w.getChildAt(r);if(-1==M.mousedownIncludes.indexOf(s)&&s.mouseEnabled&&s.hitTestPoint&&s.hitTestPoint(t.stageX/F.scaleX,t.stageY/F.scaleY))return}var l=w.globalToLocal(k?t.rawX/F.scaleX:t.stageX/F.scaleX,k?t.rawY/F.scaleY:t.stageY/F.scaleY);"follow"!=n&&M.immediate(l.x,l.y),pe(),M.dispatchEvent("mousedown"),N=!0,M.moveX=k?t.rawX/F.scaleX:t.stageX/F.scaleX,M.moveY=k?t.rawY/F.scaleY:t.stageY/F.scaleY,R=F.on("stagemousemove",function(e){M.moveX=k?e.rawX/F.scaleX:e.stageX/F.scaleX,M.moveY=k?e.rawY/F.scaleY:e.stageY/F.scaleY,"follow"!=n&&ae()}),W&&a.Ticker.remove(W),"follow"==n&&(W=a.Ticker.add(ae)),"Pen"==e.type&&(e.write=!0,e.zimDragCheck=!0)}),X=F.on("stagemouseup",function(t){"Pen"==e.type&&(e.write=!1,e.zimDragCheck=!1,G&&e.stopCheck()),W&&a.Ticker.remove(W),F.off("stagemousemove",R),N=!1})}else if("gamestick"==n){var se=this.gamepad=new a.GamePad;for(H=0;H<4;H++)Array.isArray(l[H])||(l[H]=[l[H]]);oe={rotation:0,speedX:M.speed,speedY:M.speed};var le=se.on("data",function(e){J={dirX:0,dirY:0};for(var t=0;t<l[0].length;t++){var n=e.axes[l[0][t]];if(Math.abs(n)>M.stickThreshold){J.dirX=n;break}}for(t=0;t<l[2].length;t++)if(n=e.axes[l[2][t]],Math.abs(n)>M.stickThreshold){J.dirY=n;break}g?de(J):(M.x+=M.speed*J.dirX,M.y+=M.speed*J.dirY,pe())})}else if("swipe"==n)var ce=new a.Swiper(F,M,"x",.8),ue=new a.Swiper(F,M,"y",.8,!1),he=ce.on("swipemove",function(){pe()});function de(e){oe.rotation+=e.dirX*M.turnSpeed,M.rotation=oe.rotation,oe.speedX=Math.sin(oe.rotation*Math.PI/180)*M.speed*-e.dirY,oe.speedY=-Math.cos(oe.rotation*Math.PI/180)*M.speed*-e.dirY,M.x+=oe.speedX,M.y+=oe.speedY}function pe(){var e=ge(M.x-(E?M.target.percentSpeed:M.target.x),M.y-(E?M.target.percentSpeed:M.target.y));if(_=e.speedX,D=e.speedY,p)if(M.rotation=e.angle,c(M.rotation))M.rotation=M.target.rotation;else{M.rotation+=L;var t=fe(M.rotation),n=M.target.rotation=fe(M.target.rotation);180<Math.abs(t-n)&&(t<n?n-=360:t-=360),M.dampR.immediate(n),M.target.rotation=n,M.rotation=t}}function fe(e){return(e%360+360)%360}function ge(e,t){var n,i=M.speed,o=M.speed,r=Math.sqrt(Math.pow(e,2)+Math.pow(t,2));return 0<r&&(i=Math.abs(e)/r*M.speed,o=Math.abs(t)/r*M.speed,n=90-180*Math.atan2(e,t)/Math.PI),{speedX:i,speedY:o,angle:n}}var me=this.x=E?j/2:this.target.x,ye=this.y=E?j/2:this.target.y;this.dampX=new a.Damp(me,h),this.dampY=new a.Damp(ye,h),this.dampR=new a.Damp(this.target.rotation,h);var be=0,ve=0,we=a.Ticker.add(function(){if("manual"==n&&pe(),M.boundary&&(M.x=a.constrain(M.x,M.boundary.x,M.boundary.x+M.boundary.width),M.y=a.constrain(M.y,M.boundary.y,M.boundary.y+M.boundary.height)),"horizontal"==M.axis||"both"==M.axis){if(M.dirX=a.sign(M.x-me),Math.abs(M.x-me)<_?me=M.x:me+=M.dirX*_,J&&0==J.dirX){var t=M.boundary?M.boundary.width/2:F.width/2;M.x=me=M.x-(M.x-t)*(E?M.dampKeyup:0)}E&&z&&z.width?M.target.percentSpeed=B.convert(M.dampX.convert(me)):M.target.x=M.dampX.convert(me)}if("vertical"!=M.axis&&"both"!=M.axis||(M.dirY=a.sign(M.y-ye),Math.abs(M.y-ye)<D?ye=M.y:ye+=a.sign(M.y-ye)*D,J&&0==J.dirY&&(M.y=ye=M.y-(M.y-(t=M.boundary?M.boundary.height/2:F.height/2))*(E?M.dampKeyup:0)),E&&z&&z.height?M.target.percentSpeed=B.convert(M.dampY.convert(ye)):M.target.y=M.dampY.convert(ye)),"pressmove"==n&&N&&M.dispatchEvent("pressing"),M.movingX=Math.abs(me-(E?M.target.percentSpeed:M.target.x))>M.moveThreshold,M.movingY=Math.abs(ye-(E?M.target.percentSpeed:M.target.y))>M.moveThreshold,!M.moving||M.movingX||M.movingY?M.moving||!M.movingX&&!M.movingY||M.dispatchEvent("startmoving"):M.dispatchEvent("stopmoving"),M.moving=M.movingX||M.movingY,M.moving&&M.dispatchEvent("moving"),M.dirX!=be||M.dirY!=ve){var i=new createjs.Event("change");if(M.dirX!=be){var o=["left",null,"right"];i.dir=o[M.dirX+1],be=M.dirX,"horizontal"!=d&&"both"!=d||(M.scaleX=e.scaleX=M.dirX?Math.abs(e.scaleX)*M.dirX:e.scaleX,L=0!=V&&-1==Math.round(M.scaleX/V)?180:0)}else i.dir=(o=["up",null,"down"])[M.dirY+1],ve=M.dirY,"vertical"!=d&&"both"!=d||(M.scaleY=e.scaleY=M.dirY?Math.abs(e.scaleY)*-M.dirY:e.scaleY);M.dispatchEvent(i)}p&&!c(M.rotation)&&(M.target.rotation=M.dampR.convert(M.rotation))},F);this.immediate=function(e,t,n){return!c(e)&&M.dampX&&(M.dampX.immediate(e),M.x=E?M.target.percentSpeed=me=e:M.target.x=me=e,ce&&ce.immediate(e)),!c(t)&&M.dampY&&(M.dampY.immediate(t),M.y=E?M.target.percentSpeed=ye=t:M.target.y=ye=t,ue&&ue.immediate(t)),!c(n)&&M.dampR&&(M.dampR.immediate(n),M.rotation=M.target.rotation=n),M},this.convert=function(e,t){c(e)||(M.x=e),c(t)||(M.y=t),pe()};var xe=!0;function Ce(){"keydown"==n?(frame.off("keydown",$),frame.off("keyup",te),a.Ticker.remove(re)):"gamebutton"==n?(se.off("buttondown",Q),se.off("buttonup",ne),a.Ticker.remove(re)):"gamestick"==n?se.off("data",le):"swipe"==n?(ce.enabled=!1,ue.enabled=!1,ce.off("swipemove",he)):"mousedown"==n||"mousemove"==n?F.off("stage"+n,Y):"pressmove"==n&&(F.off("stagemousedown",Y),F.off("stagemousemove",R),F.off("stagemouseup",X)),a.Ticker.remove(we)}Object.defineProperty(M,"enabled",{get:function(){return xe},set:function(e){xe!=e&&(e?("keydown"==n?($=frame.on("keydown",$),te=frame.on("keyup",te),re=a.Ticker.add(re,F)):"gamebutton"==n?(Q=se.on("buttondown",Q),ne=se.on("buttonup",ne),re=a.Ticker.add(re,F)):"gamestick"==n?le=se.on("data",le):"swipe"==n?(ce.enabled=!0,ue.enabled=!0,he=ce.on("swipemove",he)):"mousedown"==n||"mousemove"==n?Y=F.on("stage"+n,Y):"pressmove"==n&&(Y=F.on("stagemousedown",Y),R=F.on("stagemousemove",R),X=F.on("stagemouseup",X)),we=a.Ticker.add(we,F)):Ce(),xe=Boolean(e))}}),this.dispose=function(){Ce(),se&&se.dispose(),ce&&ce.dispose(),ue&&ce.dispose()}},a.extend(a.MotionController,createjs.EventDispatcher,"enabled","cjsEventDispatcher"),a.GamePad=function(){if(C("69.8"),this.type="GamePad",this.cjsEventDispatcher_constructor(),!navigator.getGamepads)return this.error=!0,void(n&&i("zim.GamePad() - no browswer support"));var e;window.addEventListener("gamepadconnected",o),this.currentIndex=0;var t=this;function o(n){t.connected=!0,function(e,n){var i=new createjs.Event("gamepadconnected");i.index=n.gamepad.index,i.id=n.gamepad.id,i.buttons=n.gamepad.buttons,i.axes=n.gamepad.axes,t.dispatchEvent(i)}(0,n);var i=navigator.getGamepads()[t.currentIndex];t.lastData=[];for(var o=0;o<i.buttons.length;o++)t.lastData[o]=i.buttons[o].pressed;!function n(){if(e=requestAnimationFrame(n),t.data=navigator.getGamepads()[t.currentIndex],t.data){for(var i=t.buttons=[],o=0;o<t.data.buttons.length;o++)if(i[o]=t.data.buttons[o].pressed,i[o]!=t.lastData[o]){if(t.lastData[o]=i[o],i[o])var r=new createjs.Event("buttondown");else r=new createjs.Event("buttonup");r.buttonCode=o,r.button=O[o],t.dispatchEvent(r)}(r=new createjs.Event("data")).axes=t.axes=t.data.axes,r.buttons=t.buttons,t.dispatchEvent(r)}}()}var r=setInterval(function(){navigator.getGamepads&&navigator.getGamepads()[0]&&(t.connected||o(),clearInterval(r))},500),a=window.addEventListener("gamepaddisconnected",function(n){n.gamepad.index==t.currentIndex&&(cancelAnimationFrame(e),connected=!1,t.dispatchEvent("gamepaddisconnected"))});this.dispose=function(){window.removeEventListener("gamepadconnected",o),window.addEventListener("gamepaddisconnected",a),cancelAnimationFrame(e),clearInterval(r),t.connected=!1}};for(var O=["A","B","X","Y","LB","RB","LT","RT","BACK","START","LS","RS","DPAD_UP","DPAD_DOWN","DPAD_LEFT","DPAD_RIGHT"],A=0;A<O.length;A++)a.GamePad[O[A]]=A;var S,I,E=["LSX","LSY","RSX","RSY"];for(A=0;A<E.length;A++)a.GamePad[E[A]]=A;return a.extend(a.GamePad,createjs.EventDispatcher,null,"cjsEventDispatcher"),a.Portal=function(e,t){var o;if(o=m(a.Portal,arguments,"obj, lands",this))return o;if(C("69.96"),!c(e)&&e.stage){this.type="Portal";var r=this,s=t&&t.numChildren&&0<t.numChildren;if(s){var l=t.getChildAt(t.numChildren-1),u=t.getChildAt(t.numChildren-2);t.setChildIndex(u,t.numChildren-1),u.setMask(e)}e.on(a.mobile()?"mousedown":"mouseover",function(){r._enabled&&(s&&h(),r.dispatchEvent("enter"))}),e.on(a.mobile()?"pressup":"mouseout",function(){r._enabled&&r.dispatchEvent("exit")}),Object.defineProperty(this,"portal",{get:function(){return e},set:function(t){!c(t)&&t.stage||!n?u.setMask(e):i("zim.Portal() - please provide a Display Object to act as the portal")}}),Object.defineProperty(this,"currentLand",{get:function(){return l},set:function(e){if(t.contains(e))for(;e!=l;)h()}}),Object.defineProperty(this,"nextLand",{get:function(){return u},set:function(e){n&&i("zim.Portal() - nextLand is read only - remake Portal to change")}}),this._enabled=!0,Object.defineProperty(r,"enabled",{get:function(){return r._enabled},set:function(e){r._enabled=e}}),this.dispose=function(){}}function h(){t.setChildIndex(l,0),l=u,u=t.getChildAt(t.numChildren-2),t.setChildIndex(u,t.numChildren-1),l.setMask(null),u.setMask(e),e.stage.update()}},a.extend(a.Portal,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),zimContactListener=null,a.Parallax=function(e,n,i,o,r,s,l){var u;if(u=m(a.Parallax,arguments,"layers, damp, auto, stage, startPaused, mouseMoveOutside, clamp",this))return u;if(C("68"),this.type="Parallax",c(o))if(e&&e[0]&&e[0].obj&&e[0].obj.stage)o=e[0].obj.stage;else{if(!t)return;o=t.stage}i=!!c(i),c(r)&&(r=!1),c(s)&&(s=!1);var h=o.getBounds().width,d=o.getBounds().height;o.mouseMoveOutside=s;var p=this;o.on("stagemousemove",function(e){p.mouseX=e.rawX/o.scaleX,p.mouseY=e.rawY/o.scaleY});var f=c(n)?.1:n;this.addLayer=function(e){if(!(c(e.obj)||c(e.prop)||c(e.propChange))){var t={obj:e.obj,prop:e.prop};t[t.prop]=e.propChange,c(e.input)&&(e.input="mouseX"),t.input=e.input,t.split=c(e.split)?!("mouseX"!=e.input||!i):e.split;var n=c(e.inMin)?0:e.inMin,o=c(e.inMax)?"mouseX"==e.input||"scrollX"==e.input?h:d:e.inMax,r=c(e.factor)?1:e.factor,s=!c(e.integer)&&e.integer;return t["p_"+t.prop]=new a.ProportionDamp(n,o,0,t[t.prop],f,r,s,l),t["s_"+t.prop]="scale"==t.prop?t.obj.scaleX:"frame"==t.prop?t.obj.currentFrame:t.obj[t.prop],c(e.immediate)||t["p_"+t.prop].immediate(e.immediate),g.push(t),g.length-1}},this.removeLayer=function(e){if(!c(e)){var t=g[e];t["p_"+t.prop].dispose(),g.splice(e,1)}},this.immediate=function(e){for(var t,n=0;n<g.length;n++)(t=g[n])["p_"+t.prop].immediate(e[n])},this.dispose=function(){return g=null,i&&a.Ticker.remove(b),!0},e=c(e)?[]:e;for(var g=[],y=0;y<e.length;y++)this.addLayer(e[y]);if(i){var b=a.Ticker.add(function(e){p.step()},o);r&&a.Ticker.remove(b)}this.step=function(e){for(var t,n,i=0;i<g.length;i++)t=g[i],c(e)?"mouseX"==t.input?n=p.mouseX:"mouseY"==t.input?n=p.mouseY:"scrollX"==t.input?n=a.scrollX():"scrollY"==t.input&&(n=a.scrollY()):n=e,"scale"==t.prop?t.obj.scaleX=t.obj.scaleY=t["s_"+t.prop]+t["p_"+t.prop].convert(n):"frame"==t.prop?t.obj.gotoAndStop(t["s_"+t.prop]+t["p_"+t.prop].convert(n)):(t.obj[t.prop]=t["s_"+t.prop]+t["p_"+t.prop].convert(n),t.split&&(t.obj[t.prop]-=t[t.prop]/2))},p.paused=r,p.pause=function(e){c(e)&&(e=!0),p.paused!=e&&(p.paused=e,b&&(e?a.Ticker.remove(b):b=a.Ticker.add(b)))},Object.defineProperty(p,"damp",{get:function(){return f},set:function(e){var t;f=e;for(var n=0;n<g.length;n++)(t=g[n])["p_"+t.prop].damp=f}})},a.Scroller=function(e,t,o,r,s,l,u,h,d,p){var f;if(f=m(a.Scroller,arguments,"backing, speed, direction, horizontal, gapFix, stage, container, style, group, inherit",this))return f;C("69"),this.cjsEventDispatcher_constructor(),this.type="Scroller",this.group=d;var g=!1===h?{}:a.getStyle(this.type,this.group,p);if(c(e)&&(e=null!=g.backing?g.backing:null),!c(e)){var y=this.backing1=e;if(!c(y)&&y.getBounds){var b=this.backing2=e.clone();c(r)&&(r=null==g.horizontal||g.horizontal),c(s)&&(s=null!=g.gapFix?g.gapFix:0),c(u)&&(u=null!=g.container?g.container:null),c(l)&&(l=null!=g.stage?g.stage:null);var v=this;c(t)&&(t=null!=g.speed?g.speed:1),this.speed=t;var w=this.baseSpeed=this.speed;c(o)&&(o=null!=g.direction?g.direction:1),this.direction=o;var x=r?y.scaleX:y.scaleY;if(y.getBounds())if(l||y.stage)if(y.parent)if(y.parent.addChildAt(b,y.parent.getChildIndex(y)),l=l||y.stage,c(u)&&(u=l),u.getBounds()){var k,T,O=y.getBounds().width*x-s,A=y.getBounds().height*x-s;r?b.x=O:b.y=A;var S=!1,I=a.Ticker.add(function(e){k||(k=u.getBounds().width,T=u.getBounds().height),0!=v.speed&&0!=v.direction&&(r?(y.x-=v.speed*v.direction,b.x=y.x<b.x?y.x+O:y.x-O,0<v.direction*v.speed?b.x<0&&y.x<b.x?y.x=b.x+O:y.x<0&&b.x<y.x&&(b.x=y.x+O):b.x>k&&b.x>y.x?b.x=y.x-O:y.x>k&&y.x>b.x&&(y.x=b.x-O)):(y.y-=v.speed*v.direction,b.y=y.y<b.y?y.y+A:y.y-A,0<v.direction*v.speed?b.y<0&&y.y<b.y?y.y=b.y+A:y.y<0&&b.y<y.y&&(b.y=y.y+A):b.y>T&&b.y>y.y?b.y=y.y-A:y.y>T&&y.y>b.y&&(y.y=b.y-A)))},l);this.paused=!1,this.pause=function(e,t){return c(e)&&(e=!0),c(t)&&(t=0),e?(w=v.speed,0<t?(S=!0,a.animate({target:v,obj:{pausingSpeed:0},ticker:!1,time:t,call:function(){v.speed=0,v.paused=!0,S=!1,v.dispatchEvent("pause")}})):(S=!1,v.speed=0,v.paused=!0,setTimeout(function(){v.dispatchEvent("pause")},10))):(S=!1,0<t?a.animate({target:v,obj:{pausingSpeed:w},ticker:!1,time:t,call:function(){v.speed=w,v.paused=!1,S=!1}}):(v.speed=w,v.paused=!1)),v},Object.defineProperty(v,"percentSpeed",{get:function(){return 0==v.baseSpeed?NaN:v.speed/v.baseSpeed*100},set:function(e){S||v.paused||(v.speed=v.baseSpeed*e/100)}}),Object.defineProperty(v,"pausingSpeed",{get:function(){return 0==v.baseSpeed?NaN:v.speed/v.baseSpeed*100},set:function(e){v.speed=v.baseSpeed*e/100}}),!1!==h&&P(this,g),this.dispose=function(){return n&&i("bye from Scroller"),a.Ticker.remove(I),!0}}else i("zim display - Scroller(): please setBounds() on container or stage if no container");else i("zim display - Scroller(): please add object to container or stage before adding to Scroller");else i("zim display - Scroller(): please pass in stage parameter or add backing objects to stage to start");else i("zim display - Scroller(): please setBounds() on backing objects")}}},a.extend(a.Scroller,createjs.EventDispatcher,null,"cjsEventDispatcher"),a.Dynamo=function(e,t,n,i,o,r,s,l,u,h,d,p){var f;if(f=m(a.Dynamo,arguments,"sprite, speed, label, startFrame, endFrame, update, reversible, flip, flipVertical, style, group, inherit",this))return f;C("69.2"),this.cjsEventDispatcher_constructor(),this.type="Dynamo",this.group=d;var g=!1===h?{}:a.getStyle(this.type,this.group,p);if(c(e)&&(e=null!=g.sprite?g.sprite:null),!c(e)){var y=this.frames=e.parseFrames(n,i,o,!0);if(0!=y.length){this.totalFrames=y.length;var b=0;c(t)&&(t=null!=g.speed?g.speed:30),c(s)&&(s=null==g.reversible||g.reversible);var v=this.baseSpeed=this.speed=t;c(r)&&(r=null!=g.update&&g.update),c(l)&&(l=null!=g.flip?g.flip:null),c(l)&&0==s&&(l=!0);var w,x,k,T,O,A=this,S=Date.now(),I=!1;A.scaleX=e.scaleX,A.scaleY=e.scaleY,function t(){if(w=requestAnimationFrame(t),x=y[b].s,0!=A.speed&&0!=x&&(T=1e3/Math.abs(A.speed)*x,k=Date.now(),T<k-S)){S=k;var n=A.frame+(0<A.speed||!s?1:-1),i=!1;n>=y.length&&(i=!0,n=0),n<0&&(i=!0,n=y.length-1),A.frame=n,l&&(e.scaleX=A.speed<0?-A.scaleX:A.scaleX),u&&(e.scaleY=A.speed<0?-A.scaleY:A.scaleY),i&&A.dispatchEvent("loop"),A.dispatchEvent("change"),r&&e.stage&&e.stage.update(),c(O)||O!=A.frame||(I=!1,A.speed=0,A.paused=!0,A.dispatchEvent("pause"))}}(),this.paused=!1,this.pause=function(e,t,n){if(c(e)&&(e=!0),e!=A.paused)return c(t)&&(t=0),e?(v=A.speed,c(n)?0<t?(I=!0,a.animate({target:A,obj:{pausingSpeed:0},ticker:!1,time:t,call:function(){I=!1,A.speed=0,A.paused=!0,A.dispatchEvent("pause")}})):(I=!1,A.speed=0,A.paused=!0,setTimeout(function(){A.dispatchEvent("pause")},10)):(I=!0,O=n)):(O=null,0<t?(I=!0,a.animate({target:A,obj:{pausingSpeed:v},ticker:!1,time:t,call:function(){I=!1,A.speed=v,A.paused=!1}})):(I=!1,A.speed=v,A.paused=!1)),A},Object.defineProperty(A,"frame",{get:function(){return b},set:function(t){b=Math.round(t)%y.length;var n=y[b];c(n)||(e.frame=n.f)}}),Object.defineProperty(A,"percentSpeed",{get:function(){return 0==A.baseSpeed?NaN:I||A.paused?v/A.baseSpeed*100:A.speed/A.baseSpeed*100},set:function(e){I||A.paused?v=A.baseSpeed*e/100:A.speed=A.baseSpeed*e/100}}),Object.defineProperty(A,"pausingSpeed",{get:function(){return 0==A.baseSpeed?NaN:A.speed/A.baseSpeed*100},set:function(e){A.speed=A.baseSpeed*e/100}}),!1!==h&&P(this,g),this.dispose=function(){cancelAnimationFrame(w)}}}},a.extend(a.Dynamo,createjs.EventDispatcher,null,"cjsEventDispatcher"),a.Accelerator=function(e){C("69.3"),this.cjsEventDispatcher_constructor();var t=this;this.type="Accelerator",this.paused=!1,this.items=[],this.paused=!1,this._percentSpeed=100,this.add=function(e){var n;n=Array.isArray(e)?e:[e];for(var i=0;i<n.length;i++)t.items.indexOf(n[i])<0&&t.items.push(n[i]);return t},e&&this.add(e),this.remove=function(e){var n,i;n=Array.isArray(e)?e:[e];for(var o=0;o<n.length;o++)0<=(i=t.items.indexOf(n[o]))&&t.items.splice(i,1);return t},this.pause=function(e,n,i){if(c(e)&&(e=!0),e!=t.paused){var o=[];if(e){c(i)||(n=null);for(var r=!1,a=0;a<t.items.length;a++)(c(n)||!c(i)||t.items[a].totalFrames)&&(!t.items[a].totalFrames||c(n)&&c(i))||(t.items[a].pause(!0,n,i),r=!0,o[a]=1,t.items[a].on("pause",function(){t.paused||(s(),t.paused=!0,t.dispatchEvent("pause"))},null,!0));r||(s(),t.paused=!0,setTimeout(function(){t.dispatchEvent("pause")},10))}else t.paused=!1,s()}function s(){for(var n=0;n<t.items.length;n++)1!=o[n]&&t.items[n].pause(e)}},Object.defineProperty(t,"percentSpeed",{get:function(){return t._percentSpeed},set:function(e){t._percentSpeed=e;for(var n=0;n<t.items.length;n++)t.items[n].percentSpeed=e}}),this.dispose=function(){for(var e=0;e<t.items.length;e++)t.items[e].dispose();return!0}},a.extend(a.Accelerator,createjs.EventDispatcher,null,"cjsEventDispatcher"),a.Emitter=function(e,t,n,i,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,T,O,A,S,I,E,M,B,z,j,_,D,L,Y,R){var X;if(X=m(a.Emitter,arguments,"obj, width, height, interval, num, life, fade, shrink, decayTime, decayStart, trace, traceFadeTime, traceShiftX, traceShiftY, angle, force, gravity, wind, layers, animation, random, horizontal, vertical, sink, sinkForce, cache, events, startPaused, pool, poolMin, particles, style, group, inherit",this))return X;C("69.9"),this.type="Emitter",this.group=Y;var W=!1===L?{}:a.getStyle(this.type,this.group,R);c(e)&&(e=null!=W.obj?W.obj:[new a.Circle(20,"#e472c4"),new a.Circle(20,"#acd241"),new a.Circle(20,"#50c4b7")]),c(t)&&(t=null!=W.width?W.width:300),c(n)&&(n=null!=W.height?W.height:300),c(i)&&(i=null!=W.interval?W.interval:20),"number"==typeof i&&(i=Math.max(10,i)),c(o)&&(o=null!=W.num?W.num:1),c(d)&&(d=null!=W.trace&&d.size),c(p)&&(p=null!=W.traceFadeTime?W.traceFadeTime:u),c(f)&&(f=null!=W.traceShiftX?W.traceShiftX:0),c(g)&&(g=null!=W.traceShiftY?W.traceShiftY:0),c(r)&&(r=null!=W.life?W.life:1e3),c(s)&&(s=null==W.fade||W.fade),c(l)&&(l=null!=W.shrink?W.shrink:!d),c(u)&&(u=null!=W.decayTime?W.decayTime:1e3),c(y)&&(y=null!=W.angle?W.angle:{min:0,max:360}),c(b)&&(b=null!=W.force?W.force:5),c(v)&&(v=null!=W.gravity?W.gravity:9.8),c(w)&&(w=null!=W.wind?W.wind:0),c(x)&&(x=null!=W.layers?W.layers:"top"),c(t)&&(t=null!=W.width?W.width:100),c(n)&&(n=null!=W.height?W.height:100),c(A)&&(A=null!=W.horizontal&&W.horizontal),c(S)&&(S=null!=W.vertical&&W.vertical),c(I)&&(I=null!=W.sink?W.sink:null),!c(I)&&c(E)&&(E=null!=W.sinkForce?W.sinkForce:10),c(B)&&(B=null!=W.events&&W.events),c(z)&&(z=null!=W.startPaused&&W.startPaused),c(j)&&(j=null==W.pool||W.pool),c(_)&&(_=null!=W.poolMin?W.poolMin:0),c(D)&&(D=null!=W.particles?W.particles:new a.Container),c(T)&&(T=null!=W.animation?W.animation:null),this.zimContainer_constructor(t,n,null,null,!1),this.type="Emitter";var F=this;this.regX=t/2,this.regY=n/2,F.obj=e,F.particles=D,F.interval=i,F.num=o,F.life=r,F.fade=s,F.shrink=l,F.decayTime=u,F.decayStart=h,F.trace=d,F.traceFadeTime=p,F.traceShiftX=f,F.traceShiftY=g,F.angle=y,F.emitterForce=b,F.gravity=v,F.wind=w,F.layers=x,F.animation=T,F.random=O,F.horizontal=A,F.vertical=S,F.sink=I,F.sinkForce=E,F.events=B,F.startEmitterPaused=z,F.pool=j,F.poolMin=_,F.particlesEmitted=0;var V,N,G=[],H=0,K=0;function q(e){if(F.events&&U("fizzed",e),(e.trace?e.getChildAt(0).endSpurt:e.endSpurt)&&(U("spurtfizzed",e),F.spurting=!1),F.pool&&"end"!=e.pooled)return e.pooled||(e.pooled=!0,G.push(e)),void(e.visible=!1);F.removeChild(e),F.trace&&e.uncache(),e=null}function U(e,t){var n=new createjs.Event(e);n.particle=t.trace?t.getChildAt(0):t,F.dispatchEvent(n)}function Z(e){F.pauseEmitter(),F.spurtCount=F.spurtNum=null,U("spurted",e),e.endSpurt=!0}a.added(F,function(i){if(N=i,c(M)&&(M=!N.isWebGL&&a.mobile()),M&&(N.snapToPixelEnabled=!0),N){var o=F.parent.getChildIndex(F);F.parent.addChildAt(D,o),A||S||F.centerReg(null,null,!1),F.zimInterval=a.interval(F.interval,function(){var i,o;function r(e,t){return e-t}F.startEmitterPaused?F.pauseEmitter():(e=Array.isArray(F.obj)?F.obj:[F.obj]).length<=0||(i=Array.isArray(F.interval)?(F.interval.sort(r),F.interval[0]):F.interval.constructor=={}.constructor?F.interval.min:F.interval,o=Array.isArray(F.num)?(F.num.sort(r),F.num[F.num.length-1]):F.num.constructor=={}.constructor?F.num.max:F.num,a.loop(a.Pick.choose(F.num),function(){if(0<F.decayTime){var r={};F.shrink&&(r.scale=0),F.fade&&(r.alpha=0)}if(F.pool&&0<G.length&&K>=Math.max(F.poolMin,(F.life/i+5)*o)){if((l=G[H++%G.length]).visible=!0,(u=l.trace?l.getChildAt(0):l).emitShape){var s=u.template;u.graphics.c().s(s.s?a.Pick.choose(s.s):null).ss(s.ss?a.Pick.choose(s.ss):null).sd(s.sd?a.Pick.choose(s.sd):null,s.offset?a.Pick.choose(s.offset):null)}l.trace&&l.updateCache(),"top"==F.layers?u.emitShape?l.addTo(D,null,!1):l.centerReg(D):u.emitShape?l.addTo(D,"bottom"==F.layers?0:a.rand(D.numChildren),!1):l.centerReg(D,"bottom"==F.layers?0:a.rand(D.numChildren)),l.alpha=1,l.scaleX=1,l.scaleY=1,u.alpha=u.originalAlpha,u.scaleX=u.originalScaleX,u.scaleY=u.originalScaleY,u.endSpurt=!1}else{var l;K++,F.trace&&((l=new a.Container(t,n,null,null,!1)).trace=!0);var u,h=a.Pick.choose(a.shuffle(e)[0]);"shape"==h.type?(s=h,(u=new a.Shape(1,1,null,null,null,!1)).emitShape=!0,u.template=s,u.graphics.s(s.s?a.Pick.choose(s.s):null).ss(s.ss?a.Pick.choose(s.ss):null).sd(s.sd?a.Pick.choose(s.sd):null,s.offset?a.Pick.choose(s.offset):null),F.trace?u.addTo(l,null,!1):"top"==F.layers?u.addTo(D,null,!1):u.addTo(D,"bottom"==F.layers?0:a.rand(D.numChildren),null,!1)):((u=h.clone()).centerReg||k(u),F.trace?u.centerReg(l).pos({x:-1e3,y:-1e3,reg:!0}):"top"==F.layers?u.centerReg(D):u.centerReg(D,"bottom"==F.layers?0:a.rand(D.numChildren))),F.trace&&(l.addTo(D,"top"==F.layers?null:"bottom"==F.layers?0:a.rand(D.numChildren),!1),l.cache(f,g,t,n)),F.trace||(l=u),(l.particle=u).originalAlpha=u.alpha,u.originalScaleX=u.scaleX,u.originalScaleY=u.scaleY}F.currentParticle=u,F.particlesEmitted++,l.particleNormal=!0,l.particleDecaying=!1,l.particleFizzing=!1;var d=a.Pick.choose(F.angle),p=a.Pick.choose(F.emitterForce),m=p*Math.cos(d*Math.PI/180),y=p*Math.sin(d*Math.PI/180);u.info={position:{x:F.x,y:F.y},velocity:{x:m,y:y}},F.horizontal&&(u.info.position={x:F.x-F.regX+a.rand(0,t),y:F.y-F.regY+(F.vertical?n/2:0)}),F.vertical&&(u.info.position={x:F.x-F.regX+(F.horizontal?t/2:0),y:F.y-F.regY+a.rand(0,n)}),u.emitShape?u.graphics.mt(u.info.position.x,u.info.position.y):(u.x=u.info.position.x,u.y=u.info.position.y),F.random&&a.loop(F.random,function(e,i){val=a.Pick.choose(i),"scale"==e?u.sca(val):("x"==e?u.info.position.x=F.horizontal||F.vertical?val:val+t/2:"y"==e&&(u.info.position.y=F.horizontal||F.vertical?val:val+n/2),"x"!=e&&"y"!=e||!u.emitShape||u.graphics.mt(u.info.position.x,u.info.position.y),u[e]=val,u.emitShape&&(u.x=0,u.y=0))}),M&&!u.emitShape&&u.cache(u.getBounds().x-10,u.getBounds().y-10,u.getBounds().width+20,u.getBounds().height+20);var b,v=!u.emitShape&&F.shrink;if(0<F.decayTime&&(F.fade||v||F.trace&&0<F.traceFadeTime)){if(F.trace&&0<F.traceFadeTime&&l.animate({obj:{alpha:0},time:F.traceFadeTime,wait:F.life-F.traceFadeTime,waitedCall:function(e){e.particleNormal=!1,e.particleFizzing=!0},call:q,override:!1,id:"decay"}),F.fade||v){var w={};F.fade&&(w.alpha=0),v&&(w.scaleX=0,w.scaleY=0),u.animate({obj:w,time:F.decayTime,wait:c(F.decayStart)?F.life-F.decayTime:F.decayStart,waitedCall:function(e){e.parent!=F&&(e=e.parent),e.particleNormal=!1,e.particleDecaying=!0},call:function(e){var t;F.events&&U("decayed",e),e.endSpurt&&U("spurtdecayed",e),F.trace&&0<F.traceFadeTime||(c(F.decayStart)||F.decayStart+F.decayTime>F.life?e.parent&&q(e.parent.trace?e.parent:e):(t=l,a.timeout(F.life-(F.decayStart+F.decayTime),function(){q(t)})))},override:!1,id:"decay"})}}else 0<F.life&&((b=l).timeOut=a.timeout(F.life,function(){q(b)}));if(F.events&&U("emitted",l),function(e){c(F.spurtCount)&&c(F.spurtNum)||(F.spurtCount++,F.spurtCount>=F.spurtNum&&Z(e))}(u),F.animation){var x=a.Pick.choose(F.animation);c(x.override)&&(x.override=!1),u.animate(a.copy(x))}}))},null,!0),V=F.emitterTicker=a.Ticker.add(function(){a.loop(D,function(e){if(e.trace){var t=e;e=e.getChildAt(0)}var n=e.info,i=0,o=0;if(!c(F.sink)){var r=F.particles.localToGlobal(n.position.x,n.position.y);if(F.sink.parent&&F.sink.parent.localToGlobal)var s=F.sink.parent.localToGlobal(F.sink.x,F.sink.y);else s=new createjs.Point(a.Pick.choose(F.sink.x),a.Pick.choose(F.sink.y));var l=a.angle(r.x,r.y,s.x,s.y);i=F.sinkForce*Math.cos(l*Math.PI/180),o=F.sinkForce*Math.sin(l*Math.PI/180)}var u=F.gravity+o;n.velocity.x+=(F.wind+i)*frameRate,n.velocity.y+=u*frameRate,n.position.x+=n.velocity.x*frameRate*100,n.position.y+=n.velocity.y*frameRate*100,e.emitShape?e.graphics.lt(n.position.x,n.position.y):(e.x=n.position.x,e.y=n.position.y),F.trace&&t&&t.updateCache(e.emitShape?null:"source-over")})},N),frameRate=1/a.Ticker.framerate}}),Object.defineProperty(F,"interval",{get:function(){return i},set:function(e){i=e,F.zimInterval&&(F.zimInterval.time=i)}}),this.spurting=!1,this.spurt=function(e,t,n){var i;return(i=m(F.spurt,arguments,"num, time, restart"))?i:(c(t)||(a.timeout(a.Pick.choose(t),function(){Z(F.currentParticle)}),F.spurting=!0),c(e)||(F.spurtNum=a.Pick.choose(e),F.spurtCount=0,F.spurting=!0),F.pauseEmitter(!1,n,null,!0),F)},this.clearPool=function(){a.loop(F,function(e){e.pooled="end",e.visible||F.removeChild(e)},!0),H=K=0,G=[]},F.startEmitterPaused||(this.emitterPaused=!1),this.pauseEmitter=function(e,t,n,i){if(F.startEmitterPaused=null,c(e)&&(e=!0),c(t)&&(t=!1),c(n)&&(n=!1),e){if(F.emitterPaused)return F;n&&(V&&a.Ticker.remove(V),a.loop(F,function(e){e.pauseAnimate(),e.trace&&e.getChildAt(0).pauseAnimate(),e.timeOut&&e.timeOut.pause()})),F.zimInterval.pause(),F.emitterPaused=!0}else{if(!F.emitterPaused)return F;t&&(a.loop(F,function(e){e.stopAnimate(),e.timeOut&&e.timeOut.clear(),e.trace&&e.getChildAt(0).pauseAnimate()}),F.removeAllChildren()),N&&V&&!a.Ticker.has(N,V)&&(a.Ticker.add(V,N),a.loop(F,function(e){e.pauseAnimate(!1),e.timeOut&&e.timeOut.pause(!1),e.trace&&e.getChildAt(0).pauseAnimate(!1)})),F.zimInterval.pause(!1,i),F.emitterPaused=!1}return F},!(this.resize=function(e,i){c(e)||(t=e),c(i)||(n=i),F.setBounds(0,0,t,n),A||S||F.centerReg(),F.clearPool()})!==L&&P(this,W),this.clone=function(){var e;return e=Array.isArray(F.obj)||F.obj.constructor=={}.constructor?a.copy(F.obj):F.obj.clone?F.obj.clone():F.obj,F.cloneProps(new a.Emitter(e,t,n,F.interval,F.num,F.life,F.fade,F.shrink,F.decayTime,F.decayStart,F.trace,F.traceFadeTime,F.traceShiftX,F.traceShiftY,F.angle,F.emitterForce,F.gravity,F.wind,F.layers,F.animation,a.copy(F.random),F.horizontal,F.vertical,F.sink,F.sinkForce,M,F.events,z,F.pool,F.poolMin))},this.dispose=function(){return V&&a.Ticker.remove(V),a.loop(F,function(e){e.stopAnimate()}),F.zimInterval&&F.zimInterval.clear(),!0}},a.extend(a.Emitter,a.Container,"clone","zimContainer",!1),a.Pen=function(e,n,i,o,r,s,l,u,h,d,p,f,g,y,b,v,w,x,k,T,O,A,S,I,E){var M;if(M=m(a.Pen,arguments,"size, color, penType, damp, spread, borderColor, borderWidth, end, paper, nib, cache, ctrlKey, cropScale, undo, undoKeys, draggable, onTop, deleteable, doubleClickDelete, immediateStop, lineAlpha, lineBlendMode, style, group, inherit",this))return M;C("69.93"),this.zimContainer_constructor(),this.type="Pen",this.group=I;var B=!1===S?{}:a.getStyle(this.type,this.group,E);c(i)&&(i=null!=B.penType?B.penType:"line");var z={size:2,color:"#333",spread:{min:5,max:20},borderColor:"#111",borderWidth:0},j={line:{size:2},kitetail:{size:{min:5,max:20},color:a.series(a.pink,a.blue,a.green),borderColor:"rgba(0,0,0,.5)",borderWidth:1},grass:{color:"#acd241",size:3,spread:{min:10,max:30}},hair:{color:["#e472c4","#50c4b7"],size:3,spread:{min:20,max:50}},city:{size:{min:30,max:70},spread:{min:50,max:200},color:["#333","#111","#555"]},barbwire:{},splatter:{size:{min:5,max:20},color:"rgba(0,0,0,.5)"}};c(j[i])&&(i="line"),c(e)&&(e=null!=B.size?B.size:c(j[i].size)?z.size:j[i].size),c(n)&&(n=null!=B.color?B.color:c(j[i].color)?z.color:j[i].color),c(o)&&(o=null!=B.damp?B.damp:.1),!1===o&&(o=1),c(r)&&(r=null!=B.spread?B.spread:c(j[i].spread)?z.spread:j[i].spread),c(s)&&(s=null!=B.borderColor?B.borderColor:c(j[i].borderColor)?z.borderColor:j[i].borderColor),c(l)&&(l=null!=B.borderWidth?B.borderWidth:c(j[i].borderWidth)?z.borderWidth:j[i].borderWidth),c(u)&&(u=null!=B.end?B.end:"butt"),c(g)&&(g=null!=B.cropScale?B.cropScale:1),c(p)&&(p=null==B.cache||B.cache),c(y)&&(y=null!=B.undo?B.undo:0),c(b)&&(b=null==B.undoKeys||B.undoKeys),c(v)&&(v=null==B.draggable||B.draggable),c(x)&&(x=null==B.deleteable||B.deleteable),c(k)&&(k=null==B.doubleClickDelete||B.doubleClickDelete),c(w)&&(w=null==B.onTop||B.onTop),c(T)&&(T=null!=B.immediateStop?B.immediateStop:"both"),c(O)&&(O=null!=B.lineAlpha?B.lineAlpha:1),c(A)&&(A=null!=B.lineBlendMode?B.lineBlendMode:"normal"),c(h)&&(h=null!=B.paper?B.paper:new a.Container),c(d)&&(d=null!=B.nib?B.nib.clone():null);var _=this;this.dampX=new a.Damp(null,o),this.dampY=new a.Damp(null,o);var D=!0;this.drawing=!1,this.immediateStop=T,this.undoLevels=y,this.undoKeys=b,this.draggable=v,this.lineAlpha=O,this.lineBlendMode=A;var L,Y,R,X,W=new a.Shape,F=t?t.stage.width:1024,V=t?t.stage.height:768;_.paperNum=0,_.sizeScale=1,_.spreadScale=1,_.sizeFactor=1,_.spreadFactor=1,_.stop=function(){},W.addTo(h),this.added(function(){if(_.paper=h,!c(d))if(_.zimDown)_.nib=d.addTo(_);else{var t;function o(e){_.drawing&&(_.nib.x=e.stageX/t.scaleX,_.nib.y=e.stageY/t.scaleY)}_.nib=d.addTo(_.parent,_.parent.getChildIndex(_)),_.nib.x=_.x,_.nib.y=_.y,_.nib.mouseEnabled=!1,_.stage.on("stagemousedown",function(e){t=e.target.stage,_.nibEvent=_.stage.on("stagemousemove",o)}),_.stage.on("stagemouseup",function(e){_.stage.off("stagemousemove",_.nibEvent)})}_.zimDragCheck=!1,_.stop=function(){_.stopCheck(!0)},_.infinite=!1,_.stopCheck=function(e){if(e)_.drawing=!1,_.infinite=!1;else{if(_.infinite)return;if(_.zimDragCheck)return;if(!_.immediateStop&&_.drawing)return}_.immediate(_.x,_.y),setTimeout(function(){if(!_.drawing){if(p){W.cache(-(F*g-F)/2,-(V*g-V)/2,F*g,V*g);var e=h.bitmap=new a.Bitmap(W.cacheCanvas).reg((F*g-F)/2,(V*g-V)/2).addTo(h);W.graphics.clear(),W.uncache(),W.top()}else e=W;0<_.undoLevels&&(y.push({paper:h,line:e}),y.length>_.undoLevels&&y.unshift(),_.dispatchEvent("recordUndo")),p||(W=(new a.Shape).clone().addTo(h)),_.lastSegment=e,(_.lastSelected=e).alpha=_.lineAlpha,e.blendMode=_.lineBlendMode,e.paper=h,_.dispatchEvent("stop"),_.dispatchEvent("change")}},_.immediateStop||e?0:50)};var f=0;_.dampX.immediate(_.x),_.dampY.immediate(_.y),_.lastX=_.x,_.lastY=_.y,_.ticker=a.Ticker.add(function(){var t=_.dampX.convert(D?_.x:_.finishX),o=_.dampY.convert(D?_.y:_.finishY),c=_.parent.localToLocal(t,o,W),d=a.Pick.choose(e)*_.sizeScale*_.sizeFactor,p=a.Pick.choose(r)*_.spreadScale*_.spreadFactor;if(Math.abs(_.lastX-t)+Math.abs(_.lastY-o)<1)return _.drawing&&(_.drawing=!1,_.zimDown?(_.x=_.lastX=D?_.x:_.finishX,_.y=_.lastY=D?_.y:_.finishY,_.dampX.immediate(_.x),_.dampY.immediate(_.y)):(_.x=_.finishX=_.lastX=t,_.y=_.finishY=_.lastY=o),_.stopCheck()),_.lastX=t,void(_.lastY=o);if(_.drawing||(N=[],h.getChildIndex(W)!=h.numChildren-1&&W.top()),_.drawing=!0,_.dispatchEvent("drawing"),"splatter"==i)for(var g=0;g<=3;g++){var m=a.rand(360)*Math.PI/180,y=p,b={x:t+y*Math.cos(m),y:o+y*Math.sin(m)},v=_.parent.localToLocal(b.x,b.y,W);W.graphics.mt(v.x,v.y).f(a.Pick.choose(n)).dc(v.x,v.y,d/2)}else if("grass"==i||"hair"==i||"city"==i){if("grass"==i||"hair"==i){var w=_.lastX+(t-_.lastX)/2,x=_.lastY+(o-_.lastY)/2,C=_.parent.localToLocal(w,x,W);W.graphics.s(a.Pick.choose(n)).ss(d,u).mt(C.x,C.y).lt(C.x+rand(-p/4,p/4),"hair"==i?C.y+p:C.y-p)}("grass"==i||"hair"==i||"city"==i&&f%3==0)&&W.graphics.s(a.Pick.choose(n)).ss(d,u).mt(c.x,c.y).lt(c.x+("city"==i?0:rand(-p/4,p/4)),"hair"==i?C.y+p:c.y-p),f++}else"kitetail"==i&&W.graphics.s(a.Pick.choose(n)).ss(d,u),"barbwire"==i?(W.graphics.s(a.Pick.choose(n)).ss(d,u),w=_.lastX+(t-_.lastX)/2+rand(-p,p),x=_.lastY+(o-_.lastY)/2+rand(-p,p)):(w=_.lastX+(t-_.lastX)/2,x=_.lastY+(o-_.lastY)/2),C=_.parent.localToLocal(w,x,W),W.graphics.qt(C.x,C.y,c.x,c.y);var k=_.parent.localToLocal(_.lastX,_.lastY,W);0<l&&"line"!=i&&(C=_.parent.localToLocal(w=_.lastX+(t-_.lastX)/2,x=_.lastY+(o-_.lastY)/2,W),W.graphics.s(a.Pick.choose(s)).ss(a.Pick.choose(l)).mt(k.x,k.y).qt(C.x,C.y,c.x,c.y),"splatter"==i&&W.graphics.es()),"splatter"==i?W.graphics.f(a.Pick.choose(n)):"kitetail"==i||W.graphics.s(a.Pick.choose(n)).ss(d,u),"grass"!=i&&"hair"!=i&&"city"!=i&&"splatter"!=i&&W.graphics.mt(k.x,k.y).qt(C.x,C.y,c.x,c.y),_.lastX=t,_.lastY=o}),_.stage.on("stagemouseup",function(){})}),_.mouseChildren=!1,y=[];var N=[];this.saveState=function(e,t,n){var i="Container"==e.type?"paper":"line",o={paper:_.paper};o[i]=e,o[i+"Transform"]={x:e.x,y:e.y,r:e.rotation,a:e.alpha,rX:e.regX,rY:e.regY,sX:e.scaleX,sY:e.scaleY,skX:e.skewX,skY:e.skewY,v:e.visible},c(t)||c(n)||t==n||(o.startLayer=t,o.endLayer=n),y.push(o),_.dispatchEvent("recordUndo"),y.length>_.undoLevels&&y.unshift()};var G,H,K={x:0,y:0,r:0,a:1,rX:0,rY:0,sX:1,sY:1,skX:0,skY:0,v:!0};function q(e,t){for(var n,i=y.length-1;0<=i;i--)if(y[i][e]==t&&y[i][e+"Transform"]){n=y[i][e+"Transform"];break}n||(n=a.copy(K)),t.x=n.x,t.y=n.y,t.alpha=n.a,t.rotation=n.r,t.regX=n.rX,t.regY=n.rY,t.scaleX=n.sX,t.scaleY=n.sY,t.skewX=n.skX,t.skewY=n.skY,t.visible=n.v,"line"==e&&p&&(t.regX=(F*g-F)/2,t.regY=(V*g-V)/2)}this.undo=function(){var e=y.pop();if(e){if(N.push(e),e.clear){for(var t=0;t<e.clear.length;t++)e.paper.addChild(e.clear[t]);e.paper.addChild(W)}else e.line&&e.lineTransform?(c(e.startLayer)||(W.top(),e.paper.setChildIndex(e.line,R)),q("line",e.line)):e.line?e.line.removeFrom():e.paperTransform&&q("paper",e.paper);_.lastPaper=_.paper,e.paper!=_.paper&&(_.paper=e.paper,_.dispatchEvent("paperChange")),_.dispatchEvent("change"),!OPTIMIZE&&_.stage&&_.stage.update()}},this.redo=function(){var e=N.pop();if(e){if(y.push(e),e.clear)e.paper.removeAllChildren(),e.paper.addChild(W);else if(e.line&&e.lineTransform){c(e.endLayer)||(W.top(),e.paper.setChildIndex(e.line,X));var t=e.lineTransform,n=e.line}else e.line?e.line.addTo(e.paper):e.paperTransform&&(t=e.paperTransform,n=e.paper);n&&(n.x=t.x,n.y=t.y,n.alpha=t.a,n.rotation=t.r,n.regX=t.rX,n.regY=t.rY,n.scaleX=t.sX,n.scaleY=t.sY,n.skewX=t.skX,n.skewY=t.skY,n.visible=t.v),_.lastPaper=_.paper,e.paper!=_.paper&&(_.paper=e.paper,_.dispatchEvent("paperChange")),_.dispatchEvent("change"),!OPTIMIZE&&_.stage&&_.stage.update()}},_.ctrlKey=!1,_.shiftKey=!1,_.ctrlKeyCheck=!1,_.zimkeydownEvent=window.addEventListener("keydown",function(e){_.ctrlKey=e.ctrlKey,_.shiftKey=e.shiftKey,17==e.keyCode&&v&&!_.ctrlKeyCheck&&(_.ctrlKeyCheck=!0,h.noDrag(),h.drag({onTop:w,all:!0})),_.undoLevels<=0||_.undoKeys&&(e.ctrlKey&&(e.shiftKey&&90==e.keyCode||89==e.keyCode)?_.redo():e.ctrlKey&&90==e.keyCode&&_.undo())}),_.zimkeyupEvent=window.addEventListener("keyup",function(e){17==e.keyCode&&v&&_.ctrlKeyCheck&&(_.ctrlKeyCheck=!1,h.noDrag(),h.drag({onTop:w})),e.ctrlKey||(_.ctrlKey=!1),e.shiftKey||(_.shiftKey=!1)}),Object.defineProperty(this,"paper",{get:function(){return h},set:function(t){"Container"==t.type&&(W.addTo(h=t,0,!1),h.shape=W,_.dampX.immediate(_.x),_.dampY.immediate(_.y),_.lastX=_.finishX=_.x,_.lastY=_.finishY=_.y,"barbwire"==i&&W.graphics.s(a.Pick.choose(n)).ss(a.Pick.choose(e)*_.sizeScale*_.sizeFactor,u),W.graphics.mt(_.x,_.y),h.parent||h.addTo(_.parent,_.parent.getChildIndex(_)),c(h.paperNum)&&(h.paperNum=++_.paperNum,x&&h.on("mousedown",function(e){_.lastSelected=e.target,_.nibEvent&&_.stage.off("stagemousemove",_.nibEvent);var t=e.target.paper;t&&(t!=_.paper&&(_.paper=t,_.dispatchEvent("paperChange")),_.shiftKey&&(_.ctrlKey?_.clear():(e.target.visible=!1,0<_.undoLevels&&_.saveState(e.target),_.dispatchEvent("change"))))}),k&&h.on("dblclick",function(e){e.target.visible=!1,0<_.undoLevels&&_.saveState(e.target)}),v&&(h.on("mousedown",function(e){stage=e.target.stage,_.shiftKey&&x||(L=e.stageX/stage.scaleX,Y=e.stageY/stage.scaleY,W.top(),R=h.getChildIndex(e.target))}),h.drag({onTop:w}),h.on("pressup",function(e){x&&_.shiftKey||0!=e.target.visible&&(_.undoLevels<=0||(Math.abs(e.stageX/stage.scaleX-L)<1&&Math.abs(e.stageY/stage.scaleY-Y)<1?w&&(W.top(),X=h.getChildIndex(e.target),R!=X&&_.saveState(e.target,R,X)):(_.ctrlKey?(_.saveState(h),_.dispatchEvent("paperChange")):(W.top(),X=h.getChildIndex(e.target),_.saveState(e.target,R,X)),_.dispatchEvent("change"),W.top())))}))))}}),Object.defineProperty(this,"write",{get:function(){return D},set:function(e){D&&!1===e&&(_.finishX=_.x,_.finishY=_.y),!D&&e&&(W.graphics.es(),W.graphics.ef(),_.dampX.immediate(_.x),_.dampY.immediate(_.y),_.lastX=_.x,_.lastY=_.y),D=e}}),Object.defineProperty(this,"size",{get:function(){return e},set:function(t){W.graphics.es(),W.graphics.ef(),e=t,"splatter"!=i&&W.graphics.ss(a.Pick.choose(e)*_.sizeScale*_.sizeFactor,u)}}),Object.defineProperty(this,"color",{get:function(){return n},set:function(e){n=e,W.graphics.es(),W.graphics.ef(),"splatter"!=i&&W.graphics.s(a.Pick.choose(n))}}),Object.defineProperty(this,"penType",{get:function(){return i},set:function(t){i=t,W.graphics.ef().es(),"splatter"!=i?W.graphics.s(a.Pick.choose(n)):W.graphics.s(a.Pick.choose(n)).ss(a.Pick.choose(e)*_.sizeScale*_.sizeFactor,u)}}),Object.defineProperty(this,"damp",{get:function(){return o},set:function(e){_.dampX.damp=o=e,_.dampY.damp=o}}),Object.defineProperty(this,"spread",{get:function(){return r},set:function(e){r=e}}),this.setColorRange=function(e,t){return H=c(t)?(G=_.color,e):(G=c(e)?_.color:e,t),_};var U=0;Object.defineProperty(_,"colorRange",{get:function(){return U},set:function(e){U=e,c(G)||c(H)||(_.color=a.colorRange(G,H,e))}}),Object.defineProperty(this,"borderColor",{get:function(){return s},set:function(e){s=e}}),Object.defineProperty(this,"borderWidth",{get:function(){return l},set:function(e){l=e}}),t&&(t.on("keydown",function(){frame.ctrlKey&&_.write&&(_.lastWrite=_.write,_.write=!1)}),t.on("keyup",function(){frame.ctrlKey||0!=_.write||(_.write=_.lastWrite)})),_.setPen=function(e){_.dampX.immediate(_.x),_.dampY.immediate(_.y),_.lastX=_.finishX=_.x,_.lastY=_.finishY=_.y,c(e)&&(e=i),c(j[e])&&(e="line"),_.penType=i=e;var t=a.merge(z,j[e]);for(var n in t)_[n]!=t[n]&&(_[n]=t[n]);return _},_.immediate=function(e,t){return c(e)||(_.x=e,_.dampX.immediate(_.x),_.lastX=_.finishX=_.x),c(t)||(_.y=t,_.dampY.immediate(_.y),_.lastY=_.finishY=_.y),_},_.clear=function(){if(!(h.numChildren<=1)){for(var e=[],t=0;t<h.numChildren-1;t++)e.push(h.getChildAt(t));return y.push({paper:h,clear:e}),y.length>_.undoLevels&&y.unshift(),_.dispatchEvent("recordUndo"),h.removeAllChildren(),W.graphics.clear(),h.addChild(W),_.dispatchEvent("change"),_.stage&&_.stage.update(),_}},this.delete=function(e){h.getChildAt(e).visible=!1,0<_.undoLevels&&_.saveState(h.getChildAt(e))},this.deleteSegment=function(e){e.visible=!1,0<_.undoLevels&&_.saveState(e)},!(_.dispose=function(e){return c(e)?(window.removeEventListener("keydown",_.zimkeydownEvent),window.removeEventListener("keyup",_.zimkeyupEvent),Ticker.remove(_.Ticker),_.removeAllEventListeners(),e.removeAllEventListeners(),W.graphics.clear(),p?_.bitmap.removeFrom():W.removeFrom(),d.removeFrom(),!0):(e.removeAllEventListeners(),e.shape.graphics.clear(),void(p?e.bitmap.removeFrom():e.shape.removeFrom()))})!==S&&P(this,B)},a.extend(a.Pen,a.Container,"clone","zimContainer",!1),a.SoundWave=function(e,t,n,o,r,s,l,u,h,d){var p;if(p=m(a.SoundWave,arguments,"num, input, include, smoothing, min, max, operation, baseline, magnify, reduce",this))return p;C("69.95"),this.type="SoundWave",c(e)&&(e=120),c(t)&&(t="mic"),c(n)&&(n=.1171875),c(o)&&(o=.85),c(r)&&(r="mic"==t?-80:-100),c(s)&&(s="mic"==t?-40:-10),c(l)&&(l=function(e,t){return e*(.5+1*t/Math.pow(a.SoundWave.bufferLength,.95))}),c(u)&&(u="mic"==t?0:30),c(h)&&(h="mic"==t?1:10),c(d)&&(d=0),a.SoundWave.bufferLength=1024,_num=e;var f=this;f.baseline=u,f.magnify=h,f.reduce=d;var g=new(window.AudioContext||window.webkitAudioContext),y=f.analyser=g.createAnalyser();if(y.minDecibels=r,y.maxDecibels=s,y.smoothingTimeConstant=o,Object.defineProperty(this,"smoothing",{get:function(){return y.smoothingTimeConstant},set:function(e){y.smoothingTimeConstant=e}}),Object.defineProperty(this,"num",{get:function(){return _num},set:function(e){_num=e,(w=Math.floor(n*a.SoundWave.bufferLength/_num))<1&&i("ZIM SoundWave: num is too big")}}),"mic"==t)return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,void(navigator.getUserMedia?navigator.getUserMedia({audio:!0},function(e){x(f.source=g.createMediaStreamSource(e))},function(e){i("ZIM SoundWave: Error occured: "+e)}):i("ZIM SoundWave: Sorry, mic not supported"));if(t.type&&"sound"==t.type)i("ZIM SoundWave: pass in the result of a zim.asset('somesound').play() for the input");else{if(t.playbackResource)var b=t.playbackResource,v=g.createMediaElementSource(b);else v=g.createMediaElementSource(b=t);var w;x(v)}function x(e){if(e.connect(y),"mic"!=t&&y.connect(g.destination),y.fftSize=2*a.SoundWave.bufferLength,(w=Math.floor(n*a.SoundWave.bufferLength/_num))<1)i("ZIM SoundWave: include param is too small or num param is too big");else{var o=new Uint8Array(y.frequencyBinCount);f.calculate=function(){y.getByteFrequencyData(o);var e=o.map(l);if(1==w)return e;for(var i=[],r=0,s=0;s<=n*a.SoundWave.bufferLength;s++)r+=e[s],0!=s&&s%w==0&&(i.push(Math.max(0,(r/w-f.baseline)*f.magnify-f.reduce)),r=0);return"mic"!=t&&(i[0]*=.75,i[1]*=.85,i[2]*=.9,i[i.length-2]*=.8,i[i.length-1]*=.75),i[i.length-1]*=1.3,i[i.length-2]*=1.2,i[i.length-3]*=1.1,i},setTimeout(function(){f.dispatchEvent("ready")},50)}}},a.extend(a.SoundWave,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),a.VR=function(o,r,s,l,u,h,d,p,f,g,y,b){var v;if(v=m(a.VR,arguments,"content, angle, distance, parallax, parallaxAngle, damp, parallaxDamp, startAngle, negativeParallax, boundaryMarkers, swiper, holder",this))return v;if(C("69.98"),this.type="VR",t){var w=t;!c(b)&&b.getBounds&&b.getBounds().width||(b=w.stage),c(r)&&(r=0),c(s)&&(s=100),c(h)&&(h=.5),c(l)&&(l=0),c(u)&&(u=60),c(d)&&(d=.1),c(p)&&(p=0),c(f)&&(f=!1),c(g)&&(g=!0),c(y)&&(y=!0),this.angle=r,this.currentAngle=p,a.mobile()&&(y=!1);var x=this,k=b.width,T=b.height;x.zimContainer_constructor();var P=x.left=new a.Container(k/2,T,null,null,!1),O=new a.Rectangle(k/2,T,"rgba(0,0,0,.01)",null,null,null,null,null,!1);P.addChild(O);var A=x.right=P.clone();x.addChild(P,A),A.x=k/2;var S=x.contentLeft=x.content=o,I=x.contentRight=o.clone();if(0!=p)var E=setTimeout(Q,100);else Q();var M=[],B=[];if(ee(S,I),te(M,"left"),te(B,"right"),0!=r&&0!=s){var z=new a.Damp(180+p,h);z.immediate(180+p);var j=!1,_=!1;function D(e){x.currentAngle=e;var t=-x.currentAngle*s/r;if(x.contentLeft.x=t,x.contentRight.x=t,Math.round(x.currentAngle)<=-r/2&&!j)(n=new createjs.Event("boundaryout")).boundary="left",j=!0,x.dispatchEvent(n);else if(Math.round(x.currentAngle)>=r/2&&!_)(n=new createjs.Event("boundaryout")).boundary="right",_=!0,x.dispatchEvent(n);else if(Math.round(x.currentAngle)>-r/2&&Math.round(x.currentAngle)<r/2){var n=new createjs.Event("boundaryin");j?(n.boundary="left",x.dispatchEvent(n),j=!1):_&&(n.boundary="right",x.dispatchEvent(n),_=!1)}}function L(e){var t=e.parent.localToLocal(e.vrStartX,0,b),n=e.vrParallaxDamp.convert("left"==e.vrChannel?x.contentLeft.x+t.x-k/4:x.contentRight.x+t.x-k/2-k/4);e.depth<=0&&!f&&(n=0),e.vrParallaxDistance=Math.max(-s/r*u/2,Math.min(s/r*u/2,n)),e.dep(e.depth)}w.on("deviceorientation",function(e){D(z.convert((180<e.rotation.z?-180:180)+e.rotation.z+p)-180)}),a.Ticker.always()}if(0!=l&&0!=s){var Y=new a.ProportionDamp(180-u/2,180+u/2,-u/2,u/2,d);if(Y.immediate(180),0==r)function R(e,t){e.vrParallaxDistance=e.depth<=0&&!f?0:t,e.dep(e.depth)}function X(e){0!=r&&0!=s?(a.loop(M,L),a.loop(B,L)):(a.loop(M,function(t){R(t,e)}),a.loop(B,function(t){R(t,e)}))}w.on("deviceorientation",function(e){var t=0;0==r&&0!=l&&0!=s&&(t=Y.convert((180<e.rotation.z?-180:180)+e.rotation.z)),X(t)}),a.Ticker.always()}!y||0==s||0==r&&0==l||x.added(function(){var e={swipeAngle:0};x.swiper=new a.Swiper({swipeOn:x,target:e,property:"swipeAngle",sensitivity:.2,damp:.05,factor:-1,min:-330,max:330}),Ticker.add(function(){0!=r&&0!=s&&D(e.swipeAngle),0!=l&&0!=s&&X(Y.convert(e.swipeAngle+180))})});var W=localStorage&&localStorage.zimEyeAdjust?Number(localStorage.zimEyeAdjust):0,F=W,V=!1;S.startRegX=S.regX,I.startRegX=I.regX;var N=this.adjuster=new a.Container(800,300,null,null,!1),G=(O=N.backing=new a.Rectangle(N.width,N.height,a.lighter,null,null,null,null,null,!1).center(N).alp(1).sha("rgba(0,0,0,.2)",0,0,30),N.strip=new a.Rectangle(N.width,N.height/3,a.white,null,null,null,null,null,!1).center(N).alp(1),N.label=new a.Label({text:"slide to adjust center of left and right",size:28,color:a.dark,align:"center",valign:"center"}).center(N).pos({y:50,reg:!0}),N.close=new a.Rectangle(50,50,a.light,null,null,null,null,null,!1).addTo(N).mov(N.width-70,26)),H=new a.Shape(-40,-40,80,80,null,!1);H.graphics.f(a.dark).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),H.center(G).sca(.3),G.cursor="pointer",G.on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(){x.hideAdjuster(),U.currentValue=(U.max-U.min)/2+F,x.dispatchEvent("closed")});var K=new a.Circle(30,a.dark,null,null,null,null,null,!1).center(N).pos({x:N.width/4,reg:!0});K.shape.alpha=.2,new a.Circle(12,a.dark,null,null,null,null,!1).center(K);var q=new a.Circle(30,a.dark,null,null,null,null,!1).center(N).pos({x:N.width/4*3,reg:!0});q.shape.alpha=.2,new a.Circle(12,a.dark,null,null,null,null,null,!1).center(q);var U=N.slider=new a.Slider({min:0,max:30,step:1,useTicks:!0,style:!1}).centerReg(N).pos({y:N.height-40,reg:!0});U.currentValue=(U.max-U.min)/2+W;var Z=new a.Proportion(U.min,U.max,K.x-N.width/4,K.x+N.width/4,-1),J=new a.Proportion(U.min,U.max,q.x-N.width/4,q.x+N.width/4);U.on("change",function(){K.x=Z.convert(U.currentValue),q.x=J.convert(U.currentValue)}),new a.Label("closer",24,null,a.silver).centerReg(N).pos({x:U.x-220,y:U.y,reg:!0}),new a.Label("farther",24,null,a.silver).centerReg(N).pos({x:U.x+220,y:U.y,reg:!0}),(x.ok=new a.Button({label:"OK",width:90,height:60,corner:0,backgroundColor:a.blue,rollBackgroundColor:a.green,shadowColor:-1,style:!1}).centerReg(N).sca(.8).pos({x:N.width-58,y:U.y,reg:!0})).on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(){localStorage&&(localStorage.zimEyeAdjust=U.currentValue-(U.max-U.min)/2),ne(),x.hideAdjuster(),x.dispatchEvent("saved"),x.dispatchEvent("closed")}),(x.zero=new a.Button({label:">|<",width:90,height:60,corner:0,backgroundColor:a.yellow,rollBackgroundColor:a.green,shadowColor:-1,style:!1}).centerReg(N).sca(.8).pos({x:58,y:U.y,reg:!0})).on((e?"mousedown"==a.ACTIONEVENT:"mousedown"==ACTIONEVENT)?"mousedown":"click",function(){U.currentValue=(U.max-U.min)/2,K.x=Z.convert(U.currentValue),q.x=J.convert(U.currentValue)});var $=new a.Proportion(0,30,-b.width/4,b.width/4);ne(),this.showAdjuster=function(){if(V)return x;V=!0,K.x=Z.convert(U.currentValue),q.x=J.convert(U.currentValue),F=U.currentValue-(U.max-U.min)/2,N.scaleTo(b).center(this),b.stage.update()},this.hideAdjuster=function(){if(!V)return x;V=!1,N.removeFrom(this),b.stage.update()},this.position=function(e,t,n){function i(e){e.vrStartX=t,e.vrParallaxDamp&&e.vrParallaxDamp.immediate(t),e.mov(t,n)}return i(e),i(e.vrMatch),e},this.register=function(e){if(!e.parent||!e.parent.vrMatch)return n&&i("ZIM VR() - please only register objects already inside content container"),e;var t=e.clone().addTo(e.parent.vrMatch),o=[],r=[];return ee(e,t,o,r),te(o,"left"),te(r,"right"),e},0!=r&&0!=s&&g&&(x.boundaryRight=new a.Container({style:!1}),new a.Circle(24,a.light,null,null,null,null,null,!1).addTo(x.boundaryRight).dep(-2),new a.Triangle(16,16,16,a.yellow,a.grey,null,null,-3,null,null,!1).rot(-90).center(x.boundaryRight).dep(-6),x.boundaryRight.center(o).mov(s/2+24),x.boundaryLeft=new a.Container({style:!1}),new a.Circle(24,a.light,null,null,null,null,null,!1).addTo(x.boundaryLeft).dep(-2),new a.Triangle(16,16,16,a.yellow,a.grey,null,null,-3,null,null,!1).rot(90).center(x.boundaryLeft).dep(-6),x.boundaryLeft.center(o).mov(-s/2-24),x.register(x.boundaryRight),x.register(x.boundaryLeft)),this.remove=function(e){return a.loop(arguments,function(e,t){o.contains(t)&&(function e(t){var n=M.indexOf(t);0<=M.indexOf(t)&&(M.splice(n,1),B.splice(n,1)),a.loop(t,function(t){e(t)})}(t),t.parent.removeChild(t),t.vrMatch.parent.removeChild(t.vrMatch))}),x},this.resize=function(){k=b.width,T=b.height,P.getChildAt(0).widthOnly=A.getChildAt(0).widthOnly=k/2,P.getChildAt(0).heightOnly=A.getChildAt(0).heightOnly=T,A.x=k/2,P.setBounds(0,0,k/2,T),A.setBounds(0,0,k/2,T),0!=p?(clearTimeout(E),E=setTimeout(Q,100)):Q(),N.scaleTo(b).center(this,null,!1)}}else n&&i("zim.VR() - please use ZIM Frame");function Q(){S.addTo(P,null,!1).setMask(P.getChildAt(0)).pos({y:(b.height-S.height)/2,reg:!0}),I.addTo(A,null,!1).setMask(A.getChildAt(0)).pos({y:(b.height-S.height)/2,reg:!0})}function ee(e,t,n,i){((e.vrMatch=t).vrMatch=e).cacheCanvas&&t.cache(),e.dep&&!c(e.depth)&&(M.push(e),B.push(t),c(n)||n.push(e),c(i)||i.push(t),t.dep(e.depth)),a.loop(e,function(e,o){ee(e,t.getChildAt(o),n,i)})}function te(e,t){a.loop(e,function(e){e.vrChannel=t,e.vrStartX=e.x,0!=r&&0!=s&&(e.vrAngle=r,e.vrDistance=s),0!=l&&0!=s&&(e.vrParallax=l/100,(e.vrParallaxDistance=0)!=r&&(e.vrParallaxDamp=new a.Damp(0,d))),e.dep(e.depth)})}function ne(){var e=$.convert(U.currentValue);S.regX=S.startRegX+e,I.regX=I.startRegX-e}},a.extend(a.VR,a.Container,"clone","zimContainer",!1),a.Frame=function(o,s,u,h,f,g,y,b,v,w,x,k,T,P,O,A,S,I,E,M,B,z,j,_,D,L,Y,R){var X;if(X=m(a.Frame,arguments,"scaling, width, height, color, outerColor, assets, path, progress, rollover, touch, scrollTop, align, valign, canvasID, rollPerSecond, delay, canvasCheck, gpu, gpuObj, nextFrame, nextStage, allowDefault, loadFailObj, sensors, retina, mouseMoveOutside, captureMouse, shim",this))return X;C("83"),n&&i("ZIM FRAME"),this.cjsEventDispatcher_constructor(),this.type="Frame";var W=this;if(void 0===t&&(t=this),c(S)&&(S=!0),window.HTMLCanvasElement||!S){var F=a.mobile();c(o)&&(o="full"),c(v)&&(v=!F),c(w)&&(w=!0),c(x)&&(x=!1),c(k)&&(k="center"),c(T)&&(T="center"),c(P)&&(P=t!=this?"myCanvas"+a.makeID(5):"myCanvas"),c(O)&&(O=20),c(A)&&(A=F?50:0),c(I)&&(I=!1),c(z)&&(z=!1),c(j)&&(j="circles"),this.loadFailObj=j,c(_)&&(_=!1),c(D)&&(D=!0),this.retina=D,c(L)&&(L=!1),c(Y)&&(Y=!0),c(R)&&(R=!1);var V,N,G=["fit","outside","full"];if(R){var H=this.canvas=R.canvas;this.scale=R.stage.scale,this.x=R.stage.x,this.y=R.stage.y;var K=(U=R.stage).getBounds().width,q=U.getBounds().height;h=H.style.backgroundColor}else{var U;this.scale=1,this.x=0,this.y=0,K=s,q=u}var Z,J,$,Q=!1,ee=!1,te=!1,ne=!1;R||("interactive"===document.readyState||"complete"===document.readyState?setTimeout(function(){pe()},200):document.addEventListener("DOMContentLoaded",pe));var ie,oe=!1,re="full"==o&&"undefined"!=typeof InstallTrigger;if(this.swapRotation=!1,F){var ae=isNaN(window.innerWidth)?window.clientWidth:window.innerWidth,se=isNaN(window.innerHeight)?window.clientHeight:window.innerHeight;this.swapRotation=(0==window.orientation||180==window.orientation)&&se<ae||90==Math.abs(window.orientation)&&ae<se}window.addEventListener("resize",de),this.update=function(){ye(),W.dispatchEvent("update")},this.loadAssets=function(e,t,n,o,r,s,l,u,h,d){if(!c(e)){var p;if(c(e.src)&&(p=m(W.loadAssets,arguments,"assets, path, progress, xhr, time, loadTimeout, outputAudioSprite, crossOrigin, fileType, queueOnly")))return p;if(!c(n)&&"ProgressBar"==n.type&&c(o)&&(o=!0),Array.isArray(e)||(e=[e]),0!=e.length){c(r)&&(r=0),c(s)&&(s=8e3),c(l)&&(l=!1),c(u)&&(u="anonymous"),c(d)&&(d=!1);var f,g,y,b=!1,v=[],w=/\.([^.]+)$/i,x=[],C=[],k=0,T=!0;for(_=0;_<e.length;_++){if((f=e[_]).constructor=={}.constructor)if(f.audioSprite){R(f=(A=a.copy(f)).src);var P,O=[];for(y=0;y<A.audioSprite.length;y++)O.push({id:(P=A.audioSprite[y])[0],startTime:Math.round(1e3*P[1]),duration:Math.round(1e3*(P[2]-P[1]))});delete A.audioSprite,A.data={audioSprite:O},l&&i(JSON.stringify(A)),v.push(A)}else if(f.data&&f.data.audioSprite){var A;R(f=(A=a.copy(f)).src),v.push(A)}else if(f.id){W.assetIDs[f.id]=f.src,R(f=f.src);var S={src:f,loadTimeout:s};c(h)||(S.type=h),v.push(S)}else f.src.match(/fonts\.googleapis\.com/)?C.push(f):x.push(f);else R(f),S={src:f,loadTimeout:s},c(h)||(S.type=h),v.push(S);if(b&&T){var I=document.createElement("audio");I.setAttribute("src",(c(t)?"":t)+f),document.body.appendChild(I),T=!1}}W.loadAssetsCount++,W.isLoading=!0;var E,M=new a.Queue;if(M.isLoading=!0,M.loadAssetsCount=0,!c(n)&&n.show&&(n.zimActiveLoader=M,n.show()),0<x.length){for(var B,z,j=[],_=0;_<x.length;_++)B={src:"url("+((z=x[_]).src.match(/^http/i)?"":t||"")+z.src+")"+(z.type?" format('"+z.type+"')":""),family:z.font},z.weight&&(B.weight=z.weight),z.style&&(B.style=z.style),j.push(B);(E=new createjs.FontLoader({src:j},!0)).on("complete",X),E.on("error",X),E.load(),M.loadAssetsCount++}if(0<C.length)for(_=0;_<C.length;_++)B={src:(z=C[_]).src,type:"fontcss"},M.loadAssetsCount++,(E=new createjs.FontLoader(B,!0)).on("complete",X),E.on("error",X),E.load();var D=Date.now(),L=new createjs.Event("complete");if(0<k){M.loadAssetsCount++;var Y=M.preload=W.preload=new createjs.LoadQueue(o,t,u);b&&Y.installPlugin(createjs.Sound),Y.on("progress",function(e){M.dispatchEvent(e),d||W.dispatchEvent(e)}),Y.on("error",function(e){M.dispatchEvent(e),d||W.dispatchEvent(e)}),Y.on("fileload",function(e){var n,i=e.item,o=e.item.type;if(i.id.match(w),o&&"sound"==o){var r=[];if(i.data&&i.data.audioSprite)for(var s=0;s<i.data.audioSprite.length;s++)r.push(i.data.audioSprite[s].id);else r.push(i.id);for(s=0;s<r.length;s++)!function(){var e=r[s];n=W.assets[r[s]]={type:"sound",path:t,id:e,play:function(t){t&&!0===t.loop&&(t.loop=-1),t&&t.loopCount&&(t.loop=t.loopCount);var n=createjs.Sound.play(e,t);return n.getStage=function(){return U},n}}}()}else n=W.assets[i.id]="image"==o?new a.Bitmap(e.result,e.result.width,e.result.height,i.id):e.result;var l=new createjs.Event("assetload");l.item=i,l.asset=n,M.dispatchEvent(l),d||W.dispatchEvent(l)}),W.preloadEvent=Y.on("complete",function(e){L=e,M.loadAssetsCount--,0==M.loadAssetsCount&&F()});try{Y.loadManifest(v)}catch(e){}}return M}}function R(e){k++,(g=e.match(w))&&0<=createjs.Sound.SUPPORTED_EXTENSIONS.indexOf(g[1])&&(b=!0)}function X(){M.loadAssetsCount--,0==M.loadAssetsCount&&F()}function F(){var e=Date.now();r=Math.max(0,r-(e-D)),setTimeout(function(){W.loadAssetsCount--,W.loadAssetsCount<=0&&(W.isLoading=!1),M.isLoading=!1,M.dispatchEvent(L),d||W.dispatchEvent(L)},r)}},this.asset=function(e){if(!c(e)){var t=W.assetIDs[e];if(t&&(e=t),W.assets[e])return W.assets[e];if("circles"==W.loadFailObj)var o=frame.makeCircles(14);else o=W.loadFailObj;return o&&(o.type="EmptyAsset",o.id=e,o.play=function(){if(n)return i("zim.Frame - asset("+e+") not found"),{}}),o}},Object.defineProperty(W,"stage",{get:function(){return U},set:function(e){i("zim.Frame(): stage is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(W,"width",{get:function(){return K},set:function(e){i("zim.Frame(): width is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(W,"height",{get:function(){return q},set:function(e){i("zim.Frame(): height is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(this,"color",{get:function(){return h},set:function(e){c(h=e)?r(P).style.backgroundColor="default":!c(r(P).style.backgroundColor=h)&&I&&U.setClearColor(a.convertColor(h))}}),Object.defineProperty(this,"outerColor",{get:function(){return ie},set:function(e){ie=e,p("body").css({backgroundColor:ie})}});var le=z;Object.defineProperty(W,"allowDefault",{get:function(){return le},set:function(e){e?(U.preventSelection=!1,document.body.style.overflow="visible",W.zil&&(window.removeEventListener("keydown",W.zil[0]),window.removeEventListener("wheel",W.zil[1]),window.removeEventListener("DOMMouseScroll",W.zil[2]),W.zil=null)):(U.preventSelection=!0,document.body.style.overflow="hidden",c(W.zil)&&(W.zil=d())),le=e}});var ce=new createjs.Event("keydown");if(this.eventRemove=ce.remove,window.addEventListener("keydown",we),window.addEventListener("keyup",xe),window.addEventListener("wheel",Ce),_&&window.DeviceMotionEvent&&window.addEventListener("devicemotion",ke),_&&window.DeviceOrientationEvent){var ue=0,he=0;window.addEventListener("deviceorientation",Te)}this.remakeCanvas=function(e,t){"full"!=o&&(c(e)&&(e=K),c(t)&&(t=q),r(P)&&r(P).parentNode.removeChild(r(P)),K=e,q=t,ge(),me())},this.follow=function(e,t,n,i,o,r,s,l,u,h,d,p,f,g){var y;if(y=m(W.follow,arguments,"obj, boundary, damp, dampY, leftOffset, rightOffset, upOffset, downOffset, offsetDamp, offsetDampY, horizontal, vertical, borderLock, lag"))return y;if(W.followObj=null,W.followTicker&&a.Ticker.remove(W.followTicker),!c(e))return e.dirX=e.dirY=0,(W.followObj=e).followDampX=null,e.followDampY=null,c(t)&&(t=new a.Boundary(0,0,W.stage.width,W.stage.height)),W.followBoundary=t,c(n)&&(n=.05),c(i)&&(i=n),c(o)&&(o=0),c(r)&&(r=0),c(s)&&(s=0),c(l)&&(l=0),c(u)&&(u=.02),c(h)&&(h=u),c(d)&&(d=!0),c(p)&&(p=!0),c(f)&&(f=!1),c(g)&&(g=!1),e.parent?b():e.on("added",b),e;function b(){var c=e.parent;W.frameBorderLock=f,d&&(W.followDampX=new a.Damp(c.x,n),W.offsetDampX=new a.Damp(t.x+o+(t.width-o-r)/2,u)),p&&(W.followDampY=new a.Damp(c.y,i),W.offsetDampY=new a.Damp(t.y+s+(t.height-s-l)/2,h)),W.followTicker=Ticker.add(function(){var t=W.followBoundary;if(d){var n=t.x+o+(t.width-o-r)/2;W.followOffsetX=[g?t.x+t.width-o:n,n,g?t.x+o:n],W.followObj&&(c.x=W.followDampX.convert(W.offsetDampX.convert(W.followOffsetX[e.motionController?e.motionController.dirX+1:1])-e.x))}if(p){var i=t.y+s+(t.height-s-l)/2;W.followOffsetY=[g?t.y+t.height-l:i,i,g?t.y+s:i],W.followObj&&(c.y=W.followDampY.convert(W.offsetDampY.convert(W.followOffsetY[e.motionController?e.motionController.dirY+1:1])-e.y))}W.frameBorderLock&&(c.x>W.followBoundary.x&&(c.x=W.followBoundary.x),c.y>W.followBoundary.y&&(c.y=W.followBoundary.y),c.x<W.followBoundary.x+W.followBoundary.width-c.width&&(c.x=W.followBoundary.x+W.followBoundary.width-c.width),c.y<W.followBoundary.y+W.followBoundary.height-c.height&&(c.y=W.followBoundary.y+W.followBoundary.height-c.height))})}},this.dispose=function(){return window.removeEventListener("resize",de),window.removeEventListener("keydown",we),window.removeEventListener("keyup",xe),window.removeEventListener("wheel",Ce),window.removeEventListener("devicemotion",ke),window.removeEventListener("deviceorientation",Te),function e(t){if(t.removeAllEventListeners(),t.numChildren)for(var n=t.numChildren-1;0<=n;n--)e(t.getChildAt(n));t.parent&&t.parent.removeChild(t)}(U),r(P)&&r(P).parentNode.removeChild(r(P)),!(W=U=null)},this.orange="#f58e25",this.green="#acd241",this.pink="#e472c4",this.blue="#50c4b7",this.brown="#d1a170",this.yellow="#ebcb35",this.purple="#993399",this.red="#fb4758",this.silver="#999999",this.tin="#777777",this.grey="#555555",this.gray="#555555",this.lighter="#eeeeee",this.moon="#dddddd",this.light="#cccccc",this.dark="#333333",this.darker="#111111",this.black="#000000",this.white="#ffffff",this.clear="rgba(0,0,0,0)",this.faint="rgba(0,0,0,.01)",this.makeCircles=function(e,t){c(e)&&(e=100);var n=[W.orange,W.green,W.pink,W.blue,W.brown,W.dark];if(t){(o=new a.Container({style:!1})).radius=e;for(var i=0;i<n.length;i++)o.addChild(new a.Circle(o.radius/n.length*(n.length-i),n[i],null,null,null,null,null,!1))}else{var o,r=(o=new a.Shape({style:!1})).graphics;for(o.radius=e,i=0;i<n.length;i++)r.f(n[i]).dc(0,0,o.radius/n.length*(n.length-i));o.setBounds(-o.radius,-o.radius,2*o.radius,2*o.radius)}return o},this.makeIcon=function(e,t,n){var i=new a.Container(-14,-13,90,120).reg(-14,-13);return c(e)&&(e=W.light),c(t)&&(t=W.dark),!0===n&&(n=W.silver),new Rectangle(i.width,i.height,t).loc(-14,-13,i),a.loop([[n||"#E474C3","AieA0IAAgCIAmhlIEXAAIg5Bng",41.7,19.5],[n||"#50C5B7","AiSAzIAnhlID+AAIg5Blg",35.3,33.2],[n||"#F48E25","AiFA0IAmhnIDlAAIg5Bng",28.9,46.7],[n||"#EBCD36","Ah4AzIAmhlIDLAAIg5Blg",22.4,60.5],[n||"#ABD140","AhrA0IAAgFIAlhiICxAAIg5Bng",16.1,74.3],[e,"AlGHRIAnhnIH+AAIgbBngAlGlpIAnhnIJmAAIg5Bng",32.7,46.5]],function(e){var t=(new a.Shape).addTo(i);t.graphics.f(e[0]).p(e[1]),t.setTransform(e[2],e[3])}),i.mouseChildren=!1,i}}else setTimeout(function(){W.dispatchEvent("failed")},100);function de(){if(R){var e=U.getBounds();return K=e.width,q=e.height,void W.dispatchEvent("resize")}re?oe||(oe=!0,$=a.Ticker.update,a.Ticker.update=!1,setTimeout(function(){oe=!1,U==t.stage&&(a.Ticker.update=$)},Math.min(A+10,40)),setTimeout(function(){ye(),ve()},30),30!=A&&setTimeout(function(){ye(),ve()},A)):(ye(),ve(),0<A&&(setTimeout(function(){ye(),ve()},30),30!=A&&setTimeout(function(){ye(),ve()},A)))}function pe(){if(!ne){if(ne=!0,-1==G.indexOf(o)){if(c(r(Z=o)))return void i("zim.Frame - scaling: HTML tag with id="+o+" must exist");J=this.tag=r(Z),o=c(s)||c(u)?"tag":"inline",0==P.indexOf("myCanvas")&&(P=Z+"Canvas")}if(W.canvasID=P,c(s)&&(s=500),c(u)&&(u=500),c(f)||(W.outerColor=f),ge(),me(),F){function e(){ye(),ee=!0,fe(),ve(),U&&U.update()}x&&setTimeout(function(){window.scrollTo(0,0)},50),setTimeout(e,100),100!=A&&setTimeout(e,A)}else ee=!0,fe();var t;W.loadAssetsCount=0,W.assets={},W.assetIDs={},c(g)?(te=!0,fe()):c(t=W.loadAssets(g.constructor!={}.constructor||g.audioSprite||g.id||g.data||g.src?{assets:g,path:y,progress:b,queueOnly:!0}:a.merge(g,{progress:b,queueOnly:!0})))||!t.on?(n&&i("ZIM Frame - load failed"),te=!0,fe()):t.on("complete",function(){te=!0,fe()})}}function fe(){ee&&te&&!Q&&(!c(b)&&b.show&&b.hide(),W.dispatchEvent("ready"),Q=!0,ve())}function ge(){var e=W.canvas=document.createElement("canvas");e.setAttribute("id",P),e.setAttribute("tabindex",0);var t=a.windowWidth(),n=a.windowHeight(),i=window.devicePixelRatio||1;"full"==o||"tag"==o?D?(W.scale=i,e.setAttribute("width",t*W.scale),e.setAttribute("height",n*W.scale),"full"==o&&(e.style.width=t+"px",e.style.height=n+"px")):(e.setAttribute("width",t),e.setAttribute("height",n)):(e.setAttribute("width",K),e.setAttribute("height",q));var s=r(P+"Alternative");s&&e.appendChild(s),"tag"==o||"inline"==o?J.appendChild(e):document.body.appendChild(e),c(h)||(e.style.backgroundColor=h),"full"!=o&&"fit"!=o&&"outside"!=o||(e.style.position="absolute",z||(document.body.style.overflow="hidden"))}function me(){ye(),-1==G.indexOf(o)||z||(W.zil=d()),W.mouseEvent&&U&&U.off("stagemousemove",W.mouseEvent),(U=I?new a.StageGL(P,E):new a.Stage(P)).mouseMoveOutside=L,!c(h)&&I&&U.setClearColor(a.convertColor(h)),U.setBounds(0,0,K,q),U.width=K,U.height=q,D&&ye(),v&&U.enableMouseOver(O),w&&createjs.Touch.enable(U,!1,z),z&&(U.preventSelection=!1),M&&(U.nextStage=M.stage),B&&(U.nextStage=B),Y&&(W.mouseX=0,W.mouseY=0,W.mouseEvent=U.on("stagemousemove",function(e){W.mouseX=e.stageX/W.stage.scaleX,W.mouseY=e.stageY/W.stage.scaleY}))}function ye(){if(W){var e,t,n=r(P),i=a.windowWidth(),c=a.windowHeight();if((V=W.orientation=c<i?"horizontal":"vertical")!=N&&(N=V,W.dispatchEvent("orientation")),F&&x&&setTimeout(function(){window.scrollTo(0,0)},100),n){if("fit"==o)W.scale=K/q<=i/c?c/q:i/K;else if("outside"==o)W.scale=K/q<=i/c?i/K:c/q;else{if("full"==o){if(n.style.left=n.style.top="0px",n.width=K=i,n.height=q=c,U){if(U.setBounds(0,0,K,q),D){var u=window.devicePixelRatio||1;n.width=i*u,n.height=c*u,n.style.width=i+"px",n.style.height=c+"px",W.scale=u,U&&(U.scaleX=U.scaleY=W.scale,U.tickOnUpdate=!1,U.update(),U.tickOnUpdate=!0)}U.width=K,U.height=q,I&&U.updateViewport(K/U.scaleX,q/U.scaleY)}return a.scrollX(0),a.scrollY(0),void be()}if("tag"==o){K=""==J.style.width?J.getAttribute("width")||J.offsetWidth:J.style.width,q=""==J.style.height?J.getAttribute("height")||J.offsetHeight:J.style.height,D?(n.width=K*W.scale,n.height=q*W.scale,n.style.width=K+"px",n.style.height=q+"px",U&&(U.scaleX=U.scaleY=W.scale,U.tickOnUpdate=!1,U.update(),U.tickOnUpdate=!0)):(n.width=K,n.height=q),U&&(U.setBounds(0,0,K,q),U.width=K,U.height=q,I&&U.updateViewport(K/U.scaleX,q/U.scaleY)),J.style.overflow="hidden",n.style.left=n.style.top="0px";var h=n.getBoundingClientRect();return W.x=h.x+a.scrollX(),W.y=h.y+a.scrollY(),void be()}if("inline"==o){if(D){if(document.styleSheets[0])for(var d=document.styleSheets[0].rules||document.styleSheets[0].cssRules,p=0;p<d.length;p++){var f=d[p];if(f.selectorText=="#"+P){var g=f.style.getPropertyValue("width");if(g){var m=l(n.style.width),y=l(n.style.height);n.style.width=g}}}var b=window.getComputedStyle(n),v=l(b.getPropertyValue("width"));m&&(n.style.height=y*v/m+"px",b=window.getComputedStyle(n));var w=l(b.getPropertyValue("height"));u=window.devicePixelRatio||1,W.scale=v/s*u,n.width=K*W.scale,n.height=q*W.scale,n.style.width=v+"px",n.style.height=w+"px",U&&(U.scaleX=U.scaleY=W.scale,U.tickOnUpdate=!1,U.update(),U.tickOnUpdate=!0)}return U&&(U.setBounds(0,0,K,q),U.width=K,U.height=q,I&&U.updateViewport(K/U.scaleX,q/U.scaleY)),n.style.left=n.style.top="0px",h=n.getBoundingClientRect(),W.x=h.x+a.scrollX(),W.y=h.y+a.scrollY(),void be()}}t=q*W.scale,e=K*W.scale,D?(u=window.devicePixelRatio||1,W.scale*=u,n.width=K*W.scale,n.height=q*W.scale,n.style.width=K*W.scale/u+"px",n.style.height=q*W.scale/u+"px",U&&(U.scaleX=U.scaleY=W.scale,U.tickOnUpdate=!1,U.update(),U.tickOnUpdate=!0)):(n.style.width=e+"px",n.style.height=t+"px"),W.x="left"==k?0:"right"==k?i-e:(i-e)/2,W.y="top"==T?0:"bottom"==T?c-t:(c-t)/2,n.style.left=W.x+"px",n.style.top=W.y+"px",a.scrollX(0),a.scrollY(0),be()}}}function be(){if("outside"==o){var e=(l(frame.canvas.style.width)-a.windowWidth())/2;"left"==k?(W.visibleLeft=0,W.visibleRight=a.windowWidth()/(a.windowWidth()+2*e)*K):"right"==k?(W.visibleLeft=2*e/(a.windowWidth()+2*e)*K,W.visibleRight=K):(W.visibleLeft=e/(a.windowWidth()+2*e)*K,W.visibleRight=(a.windowWidth()+e)/(a.windowWidth()+2*e)*K);var t=(l(frame.canvas.style.height)-a.windowHeight())/2;"top"==T?(W.visibleTop=0,W.visibleBottom=a.windowHeight()/(a.windowHeight()+2*t)*q):"bottom"==T?(W.visibleTop=2*t/(a.windowHeight()+2*t)*q,W.visibleBottom=q):(W.visibleTop=t/(a.windowHeight()+2*t)*q,W.visibleBottom=(a.windowHeight()+t)/(a.windowHeight()+2*t)*q)}else W.visibleLeft=W.visibleTop=0,W.visibleRight=K,W.visibleBottom=q}function ve(){Q&&W&&(W.dispatchEvent("resize"),a.OPTIMIZE||!e&&OPTIMIZE||!U||"full"!=o&&"tag"!=o||U.update())}function we(e){e.remove=W.eventRemove,W.altKey=e.altKey,W.ctrlKey=e.ctrlKey,W.metaKey=e.metaKey,W.shiftKey=e.shiftKey,W.dispatchEvent(e)}function xe(e){W.altKey=e.altKey,W.ctrlKey=e.ctrlKey,W.metaKey=e.metaKey,W.shiftKey=e.shiftKey,e.remove=W.eventRemove,W.dispatchEvent(e)}function Ce(e){W.dispatchEvent(e)}function ke(e){e.remove=W.eventRemove,W.dispatchEvent(e)}function Te(e){e.remove=W.eventRemove;var t=360-e.alpha;135<Math.abs(t-ue)&&Math.abs(t-ue)<225&&(he=0==he?180:0),ue=t,e.rotation={x:e.beta,y:e.gamma,z:(t+he)%360},W.dispatchEvent(e)}},a.extend(a.Frame,createjs.EventDispatcher,null,"cjsEventDispatcher",!1),a.Queue=function(){this.cjsEventDispatcher_constructor(),this.isLoading=!0},a.extend(a.Queue,createjs.EventDispatcher,null,"cjsEventDispatcher"),a.distillery=[],a.distill=function(){!window.zns&&a&&(a.DISTILL||window.DISTILL)&&a.distillery.push("83.3","83.35"),i("zim.distill() - go to https://zimjs.com/distill and enter the following:"),i(0<a.distillery.length?a.distillery.join(" "):"must set zim.DISTILL = true;")},a.parseAudioSprite=function(e,t){if(C("83.25"),!(c(e)||c(e.resources)||c(e.spritemap))){var n,o=e.spritemap,r=[],a={src:e.resources[0],data:{}};for(A in o)n=o[A],r.push({id:A,startTime:Math.round(1e3*n.start),duration:Math.round(1e3*(n.end-n.start))});return a.data.audioSprite=r,t&&i(JSON.stringify(a)),a}},a.previewAudioSprite=function(e,n,i){if(C("83.26"),!c(e)){if(c(n)&&(n=3),c(i)){if(c(t))return;stage=(i=t).stage}var o=e,r=[],s=[];if(o.constructor=={}.constructor){o.resources&&(o=a.parseAudioSprite(o)),o.audioSprite?loop(o.audioSprite,function(e){r.push(e[0].substr(0,n)),s.push(e[0])}):o.data&&o.data.audioSprite&&loop(o.data.audioSprite,function(e){r.push(e.id.substr(0,n)),s.push(e.id)});var l=new a.Tabs({tabs:r,width:stageW,currentEnabled:!0}).addTo(stage);return l.on("change",function(){i.asset(s[l.selectedIndex]).play()}),l}}},a.svgToBitmap=function(e,t){if(C("83.27"),!c(e.draggable)){var o=new DOMParser;e=(e=e.innerHTML?o.parseFromString(e.innerHTML,"text/xml"):e).getElementsByTagName("svg")?e.getElementsByTagName("svg")[0]:null}if(XMLSerializer||!n){var r="string"==typeof e?e:(new XMLSerializer).serializeToString(e);r.match(/xmlns/i)||(r=r.replace(/svg /i,"svg  xmlns='http://www.w3.org/2000/svg' "));var s=self.URL||self.webkitURL||self,l=new Image;l.onload=function(){var e=new a.Bitmap(l);t(e)},l.src=s.createObjectURL(new document.Blob([r],{type:"image/svg+xml;charset=utf-8"}))}else i("ZIM svgToBitmap() - sorry, not supported in Browser")},a}(x||{});function C(e){x&&(x.DISTILL||window.DISTILL)&&x.distillery.push(e)}function k(e,t){C("83.3");var o={drag:function(e,t,n,i,o,r,a,s,l,c,u,h,d,p,g,m){return f(arguments)?(e.obj=this,x.drag(e)):x.drag(this,e,t,n,i,o,r,a,s,l,c,u,h,d,p,g,m)},noDrag:function(){return x.noDrag(this)},dragBoundary:function(e){return x.dragBoundary(this,e)},dragRect:function(e){return x.dragBoundary(this,e)},transform:function(e,t,n,i,o,r,a,s,l,c,u,h,d,p,g,m,y,b,v,w,C,k,T,P,O,A,S){return f(arguments)?(e.obj=this,x.transform(e)):x.transform(this,e,t,n,i,o,r,a,s,l,c,u,h,d,p,g,m,y,b,v,w,C,k,T,P,O,A,S)},setSwipe:function(e){return x.setSwipe(this,e)},gesture:function(e,t,n,i,o,r,a,s,l,c,u,h,d,p,g){return f(arguments)?(e.obj=this,x.gesture(e)):x.gesture(this,e,t,n,i,o,r,a,s,l,c,u,h,d,p,g)},noGesture:function(e,t,n){if(f(arguments))return e.obj=this,x.noGesture(e);x.noGesture(this,e,t,n)},gestureBoundary:function(e,t){return x.gestureBoundary(this,e,t)},gestureRect:function(e,t){return x.gestureBoundary(this,e,t)},addPhysics:function(e,t,n,i,o,r,a,s,l,c,u){return f(arguments)?(e.obj=this,x.addPhysics(e)):x.addPhysics(this,e,t,n,i,o,r,a,s,l,c,u)},removePhysics:function(){return x.removePhysics(this)},hitTestPoint:function(e,t,n){return x.hitTestPoint(this,e,t,n)},hitTestReg:function(e,t){return x.hitTestReg(this,e,t)},hitTestRect:function(e,t,n){return x.hitTestRect(this,e,t,n)},hitTestCircle:function(e,t,n){return x.hitTestCircle(this,e,t,n)},hitTestCircles:function(e,t){return x.hitTestCircles(this,e,t)},hitTestBounds:function(e,t,n){return x.hitTestBounds(this,e,t,n)},boundsToGlobal:function(e,t,n){return x.boundsToGlobal(this,e,t,n)},resetBounds:function(e,t,n,i){return x.resetBounds(this,e,t,n,i)},hitTestPath:function(e,t,n){return x.hitTestPath(this,e,t,n)},hitTestGrid:function(e,t,n,i,o,r,a,s,l,c,u,h){return x.hitTestGrid(this,e,t,n,i,o,r,a,s,l,c,u,h)},animate:function(e,t,n,i,o,r,a,s,l,c,u,h,d,p,g,m,y,b,v,w,C,k,T,P,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,X,W,F,V,N){return f(arguments)?(e.target=this,x.animate(e)):x.animate(this,e,t,n,i,o,r,a,s,l,c,u,h,d,p,g,m,y,b,v,w,C,k,T,P,O,A,S,I,E,M,B,z,j,_,D,L,Y,R,X,W,F,V,N)},pauseAnimate:function(){return this},stopAnimate:function(){return this},wiggle:function(e,t,n,i,o,r,a,s,l,c,u,h,d){return f(arguments)?(e.target=this,x.wiggle(e)):x.wiggle(this,e,t,n,i,o,r,a,s,l,c,u,h,d)},loop:function(e,t,n,i,o){return x.loop(this,e,t,n,i,o)},copyMatrix:function(e){return x.copyMatrix(this,e)},duplicate:function(){return x.duplicate(this)},cur:function(e){return x.cur(this,e)},sha:function(e,t,n,i){return x.sha(this,e,t,n,i)},pos:function(e,t,n,i,o,r,a,s,l,c){return f(arguments)?(e.obj=this,x.pos(e)):x.pos(this,e,t,n,i,o,r,a,s,l,c)},loc:function(e,t,n,i,o,r,a){return f(arguments)?(e.obj=this,x.loc(e)):x.loc(this,e,t,n,i,o,r,a)},mov:function(e,t){return f(arguments)?(e.obj=this,x.mov(e)):x.mov(this,e,t)},top:function(){return x.top(this)},bot:function(){return x.bot(this)},ord:function(e){return x.ord(this,e)},dep:function(e){return x.dep(this,e)},alp:function(e){return x.alp(this,e)},hov:function(e,t){return x.hov(this,e,t)},rot:function(e,t,n){return x.rot(this,e,t,n)},siz:function(e,t,n){return x.siz(this,e,t,n)},ske:function(e,t){return x.ske(this,e,t)},reg:function(e,t,n){return x.reg(this,e,t,n)},sca:function(e,t){return x.sca(this,e,t)},scaleTo:function(e,t,n,i,o){return f(arguments)?(e.obj=this,x.scaleTo(e)):x.scaleTo(this,e,t,n,i,o)},fit:function(e,t,n,i,o){return f(arguments)?(e.obj=this,x.fit(e)):x.fit(this,e,t,n,i,o)},outline:function(e,t){return f(arguments)?(e.obj=this,x.outline(e)):x.outline(this,e,t)},addTo:function(e,t,n){return f(arguments)?(e.obj=this,x.addTo(e)):x.addTo(this,e,t,n)},removeFrom:function(e){return x.removeFrom(this,e)},added:function(e,t,n){return x.added(this,e,t,n)},tap:function(e,t,n,i){return x.tap(this,e,t,n,i)},noTap:function(){return x.noTap(this)},change:function(e,t){return x.change(this,e,t)},noChange:function(){return x.noChange(this)},centerReg:function(e,t,n){return f(arguments)?(e.obj=this,x.centerReg(e)):x.centerReg(this,e,t,n)},center:function(e,t,n){return f(arguments)?(e.obj=this,x.center(e)):x.center(this,e,t,n)},place:function(e){return x.place(this,e)},placeReg:function(e){return x.placeReg(this,e)},expand:function(e,t){return x.expand(this,e,t)},setMask:function(e,t){return x.setMask(this,e,t)},cloneProps:function(e){return e.type=this.type,e.group=this.group,e.style=this.style,e.alpha=this.alpha,e.rotation=this.rotation,e.mouseEnabled=this.mouseEnabled,e.tickEnabled=this.tickEnabled,e.x=this.x,e.y=this.y,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.skewX=this.skewX,e.skewY=this.skewY,e.name=this.name,e.regX=this.regX*e.width/this.width,e.regY=this.regY*e.height/this.height,e.visible=this.visible,e.shadow=this.shadow,this.type&&"Shape"!=this.type||x.copyMatrix(e,this),e.compositeOperation=this.compositeOperation,e.snapToPixel=this.snapToPixel,e.filters=null==this.filters?null:this.filters.slice(0),e.mask=this.mask,e.hitArea=this.hitArea,this.type&&"Shape"!=this.type||!this._bounds||e.setBounds(this._bounds.x,this._bounds.y,this._bounds.width,this._bounds.height),e},cloneChildren:function(e){e.children.length&&e.removeAllChildren();for(var t=e.children,n=0,i=this.children.length;n<i;n++){var o=this.children[n].clone();o.parent=e,t.push(o)}return e}};if(!c(t)){for(var r in t=[],o)t.push(r);return t}for(var a in o)o.hasOwnProperty(a)&&(e[a]=o[a]);return Object.defineProperty(e,"width",{enumerable:!0,get:function(){var e=this.getBounds();return c(e)?null:Math.abs(e.width*this.scaleX)},set:function(e){var t=this.getBounds();c(t)||0==t.width?n&&i("width needs bounds set with setBounds()"):this.scaleX=this.scaleY=e/t.width}}),Object.defineProperty(e,"height",{enumerable:!0,get:function(){var e=this.getBounds();return c(e)?null:Math.abs(e.height*this.scaleY)},set:function(e){var t=this.getBounds();c(t)||0==t.height?n&&i("height needs bounds set with setBounds()"):this.scaleX=this.scaleY=e/t.height}}),Object.defineProperty(e,"widthOnly",{enumerable:!0,get:function(){var e=this.getBounds();return c(e)?null:Math.abs(e.width*this.scaleX)},set:function(e){var t=this.getBounds();c(t)||0==t.width?i("widthOnly needs bounds set with setBounds()"):this.scaleX=e/t.width}}),Object.defineProperty(e,"heightOnly",{enumerable:!0,get:function(){var e=this.getBounds();return c(e)?null:Math.abs(e.height*this.scaleY)},set:function(e){var t=this.getBounds();c(t)||0==t.height?i("heightOnly needs bounds set with setBounds()"):this.scaleY=e/t.height}}),Object.defineProperty(e,"depth",{enumerable:!0,get:function(){return this._depth},set:function(e){if(this._depth=e,!c(this.vrChannel)){var t=this.vrParallaxDistance?e*this.vrParallax*this.vrParallaxDistance:0;"left"==this.vrChannel?this.x=this.vrStartX+e+t:"right"==this.vrChannel&&(this.x=this.vrStartX-e+t)}}}),Object.defineProperty(e,"blendMode",{enumerable:!0,get:function(){return this.compositeOperation},set:function(e){this.compositeOperation=e}}),e}return(b=x||{}).ZIMON={stringify:function(e,t){C("83.39"),c(e)||n&&i("ZIMON - set ZIMONON=true before using ZIMON.stringify()")},parse:function(e,t){if(C("83.39"),!c(e)){var o=JSON.parse(e),r=o.obj;return t=o.key,function e(o,a,s){if(!c(o))if(Array.isArray(o))b.loop(o,function(t,n){e(t,o,n)});else if(c(o.zimon)&&o.constructor=={}.constructor)b.loop(o,function(t,n){e(n,o,t)});else if(o.zimon){var l=o.zimon,u="";t&&(t[l]&&t[l].scope?u=t[l].scope+".":t.scope&&(u=t.scope+"."));var h=function(e){try{return Function("return("+e+")")()}catch(a){return n&&i("ZIMON: bad function scope or name: "+e),null}}(u+l),d=o.args;if(c(d)&&(d=[]),e(d),"series"==o.type)var p=b.series(d);else p=h?new(h.bind.apply(h,[null].concat(Array.prototype.slice.call(d)))):null;a?a[s]=p:r=p,t&&t[l]&&t[l].props&&p&&b.loop(t[l].props,function(e,t){c(o.props[t])||(p[e]=o.props[t])})}}(r),r}}},b.Wonder=function(e,t,n,o,r){var a;if(a=m(b.Wonder,arguments,"wid, client, app, notes, server",this))return a;if(C("82"),c(e))i("zim.Wonder() - please provide Wonder ID (see https://zimjs.com/wonder/)");else{c(r)&&(r="http://54.237.229.197:3001/wonder");var s=this;c(b.wonderSession)&&(b.wonderSession="W"+b.rand(1e5,999999));var l,u=[],h=setInterval(y,1e3),d=0,p=setInterval(function(){28<d&&(u.push({id:e,c:t,a:n,n:o,k:l,t:"e",v:"frequency max - terminated",s:b.wonderSession}),i("zim.Wonder() - frequency max - terminated"),s.dispose()),d=0},3e4);this.countsOff={},this.timesOff={},this.ordersOff={},this.count=function(i){v(i,"count")&&(l=i,u.push({id:e,c:t,a:n,n:o,k:i,t:"c",v:1,s:b.wonderSession}))};var f={};this.timeStart=function(e){v(e,"time")&&(s.timeEnd(e),f[l=e]=(new Date).getTime())};var g={};this.timePause=function(e){v(e,"time")&&(g[e]||(g[e]=(new Date).getTime()))},this.timeUnpause=function(e){if(v(e,"time")&&g[e]){var t=(new Date).getTime()-g[e];f[e]&&(f[e]+=t),delete g[e]}},this.timeEnd=function(i){if(v(i,"time")&&f[i]){var r=g[i]?g[i]:(new Date).getTime(),a=Math.round((r-f[i])/1e3);delete g[i],delete f[i],u.push({id:e,c:t,a:n,n:o,k:i,t:"t",v:a,s:b.wonderSession})}},this.order=function(r,a){v(r,"order")&&(l=r,c(a)?i("zim.Wonder order() - please provide an item"):u.push({id:e,c:t,a:n,n:o,k:r,t:"o",v:a,s:b.wonderSession}))},this.countOff=function(e){s.countsOff[e]=1},this.countOn=function(e){delete s.countOff[e]},this.timeOff=function(e){s.timesOff[e]=1},this.timeOn=function(e){delete s.timesOff[e]},this.orderOff=function(e){s.ordersOff[e]=1},this.orderOn=function(e){delete s.ordersOff[e]},this.dispose=function(){return y(),clearInterval(h),clearInterval(p),!0}}function y(){0<u.length&&(b.async(r+"?wonder="+JSON.stringify(u)),u=[],d++)}function v(e,t){return c(e)?(i("zim.Wonder "+t+" - please provide a keyword"),!1):!s[t+"sOff"][e]}},x=b,window.zns||function(e){C("83.35"),document.window=Window,document.window=window,document.Blob=Blob,c(e)&&(e=[]),Array.isArray(e)||(e=[e]);var t=k(null,!0),n=["loop","stopAnimate","pauseAnimate","animate","wiggle"];for(var i in x)(-1==t.indexOf(i)||0<=n.indexOf(i))&&-1==e.indexOf(i)&&(window[i]=x[i]);window.KEYFOCUS=x.KEYFOCUS,window.OPTIMIZE=x.OPTIMIZE,window.ACTIONEVENT=x.ACTIONEVENT,window.STYLE=x.STYLE}(),x.getGlobals=function(){return[i,r,a,s,l,c,u,d,p,m,y,v]},x}},paQs:function(e,t){e.exports=function(e,t,n,i){var o=n||t.fillColor;e.fillStyle="rgba("+((16711680&o)>>>16)+","+((65280&o)>>>8)+","+(255&o)+","+(i||t.fillAlpha)+")"}},pnzC:function(e,t,n){var i,o;void 0===(o="function"==typeof(i=function(){return function(){function e(e,t){if(this.app="loki",this.options=t||{},void 0!==e&&(this.app=e),this.catalog=null,!this.checkAvailability())throw new Error("indexedDB does not seem to be supported for your environment")}function t(e){this.db=null,this.initializeLokiCatalog(e)}return e.prototype.closeDatabase=function(){this.catalog&&this.catalog.db&&(this.catalog.db.close(),this.catalog.db=null)},e.prototype.checkAvailability=function(){return!("undefined"==typeof indexedDB||!indexedDB)},e.prototype.loadKey=e.prototype.loadDatabase=function(e,n){var i=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKey(this.app,e,function(e){if("function"==typeof n){if(0===e.id)return void n(null);n(e.val)}else console.log(e.val)}):this.catalog=new t(function(t){i.catalog=t,i.loadDatabase(e,n)})},e.prototype.saveKey=e.prototype.saveDatabase=function(e,n,i){var o=this;function r(e){i(e&&!0===e.success?null:new Error("Error saving database")),o.options.closeAfterSave&&o.closeDatabase()}null!==this.catalog&&null!==this.catalog.db?this.catalog.setAppKey(this.app,e,n,r):this.catalog=new t(function(t){o.saveDatabase(e,n,r)})},e.prototype.deleteKey=e.prototype.deleteDatabase=function(e,n){var i=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKey(this.app,e,function(e){var t=e.id;0!==t?i.catalog.deleteAppKey(t,n):"function"==typeof n&&n({success:!0})}):this.catalog=new t(function(t){i.catalog=t,i.deleteDatabase(e,n)})},e.prototype.deleteDatabasePartitions=function(e){var t=this;this.getDatabaseList(function(n){n.forEach(function(n){n.startsWith(e)&&t.deleteDatabase(n)})})},e.prototype.getKeyList=e.prototype.getDatabaseList=function(e){var n=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKeys(this.app,function(t){for(var n=[],i=0;i<t.length;i++)n.push(t[i].key);"function"==typeof e?e(n):n.forEach(function(e){console.log(e)})}):this.catalog=new t(function(t){n.catalog=t,n.getDatabaseList(e)})},e.prototype.getCatalogSummary=function(e){var n=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAllKeys(function(t){for(var n,i=[],o=0;o<t.length;o++)i.push({app:(n=t[o]).app,key:n.key,size:2*(n.app||"").length+2*(n.key||"").length+(n.val||"").length+1});"function"==typeof e?e(i):i.forEach(function(e){console.log(e)})}):this.catalog=new t(function(t){n.catalog=t,n.getCatalogSummary(e)})},t.prototype.initializeLokiCatalog=function(e){var t=indexedDB.open("LokiCatalog",1),n=this;t.onupgradeneeded=function(e){var t=e.target.result;if(t.objectStoreNames.contains("LokiAKV")&&t.deleteObjectStore("LokiAKV"),!t.objectStoreNames.contains("LokiAKV")){var n=t.createObjectStore("LokiAKV",{keyPath:"id",autoIncrement:!0});n.createIndex("app","app",{unique:!1}),n.createIndex("key","key",{unique:!1}),n.createIndex("appkey","appkey",{unique:!0})}},t.onsuccess=function(t){n.db=t.target.result,"function"==typeof e&&e(n)},t.onerror=function(e){throw e}},t.prototype.getAppKey=function(e,t,n){var i,o=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").index("appkey").get(e+","+t);o.onsuccess=(i=n,function(e){var t=e.target.result;null==t&&(t={id:0,success:!1}),"function"==typeof i?i(t):console.log(t)}),o.onerror=function(e){return function(t){if("function"!=typeof e)throw t;e({id:0,success:!1})}}(n)},t.prototype.getAppKeyById=function(e,t,n){this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").get(e).onsuccess=function(e,t){return function(n){"function"==typeof t?t(n.target.result,e):console.log(n.target.result)}}(n,t)},t.prototype.setAppKey=function(e,t,n,i){var o,r=this.db.transaction(["LokiAKV"],"readwrite").objectStore("LokiAKV"),a=r.index("appkey").get(e+","+t);a.onsuccess=function(o){var s=o.target.result;null==s?s={app:e,key:t,appkey:e+","+t,val:n}:s.val=n;var l,c=r.put(s);c.onerror=(l=i,function(e){"function"==typeof l?l({success:!1}):(console.error("LokiCatalog.setAppKey (set) onerror"),console.error(a.error))}),c.onsuccess=function(e){return function(t){"function"==typeof e&&e({success:!0})}}(i)},a.onerror=(o=i,function(e){"function"==typeof o?o({success:!1}):(console.error("LokiCatalog.setAppKey (get) onerror"),console.error(a.error))})},t.prototype.deleteAppKey=function(e,t){var n,i=this.db.transaction(["LokiAKV"],"readwrite").objectStore("LokiAKV").delete(e);i.onsuccess=(n=t,function(e){"function"==typeof n&&n({success:!0})}),i.onerror=function(e){return function(t){"function"==typeof e?e({success:!1}):(console.error("LokiCatalog.deleteAppKey raised onerror"),console.error(i.error))}}(t)},t.prototype.getAppKeys=function(e,t){var n,i=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").index("app"),o=IDBKeyRange.only(e),r=i.openCursor(o);r.onsuccess=function(e,t){return function(n){var i=n.target.result;i?(e.push(i.value),i.continue()):"function"==typeof t?t(e):console.log(e)}}([],t),r.onerror=(n=t,function(e){"function"==typeof n?n(null):(console.error("LokiCatalog.getAppKeys raised onerror"),console.error(e))})},t.prototype.getAllKeys=function(e){var t,n=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").openCursor();n.onsuccess=function(e,t){return function(n){var i=n.target.result;i?(e.push(i.value),i.continue()):"function"==typeof t?t(e):console.log(e)}}([],e),n.onerror=(t=e,function(e){"function"==typeof t&&t(null)})},e}()})?i.apply(t,[]):i)||(e.exports=o)},t47D:function(e,t){e.exports=function(e,t,n,i){var o=n||t.strokeColor;e.strokeStyle="rgba("+((16711680&o)>>>16)+","+((65280&o)>>>8)+","+(255&o)+","+(i||t.strokeAlpha)+")",e.lineWidth=t.lineWidth}}}]);